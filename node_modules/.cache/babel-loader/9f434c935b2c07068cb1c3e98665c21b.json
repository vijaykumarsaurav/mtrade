{"ast":null,"code":"var _jsxFileName = \"/Users/B0208058/Documents/slretailer-web-portal/src/components/backoffice/OfferUpload.js\";\nimport React, { useState } from \"react\";\nimport AdminService from \"../service/AdminService\";\nimport Typography from \"@material-ui/core/Typography\";\nimport Button from \"@material-ui/core/Button\";\nimport Table from \"@material-ui/core/Table\";\nimport TableHead from \"@material-ui/core/TableHead\";\nimport TableRow from \"@material-ui/core/TableRow\";\nimport TableCell from \"@material-ui/core/TableCell\";\nimport TableBody from \"@material-ui/core/TableBody\";\nimport Notify from \"../../utils/Notify\";\nimport CloudUploadIcon from '@material-ui/icons/CloudUpload';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport SearchIcon from '@material-ui/icons/Search';\nimport VisibilityIcon from '@material-ui/icons/Visibility';\nimport PostLoginNavBar from \"../PostLoginNavbar\";\nimport { Container } from \"@material-ui/core\";\nimport { resolveResponse } from \"../../utils/ResponseHandler\";\nimport TextField from '@material-ui/core/TextField';\nimport Link from '@material-ui/core/Link';\nimport TablePagination from '@material-ui/core/TablePagination';\nimport Grid from '@material-ui/core/Grid';\nimport Paper from '@material-ui/core/Paper';\nimport Title from './Title';\nimport InputLabel from \"@material-ui/core/InputLabel\";\nimport { CRO_API_BASE_URL } from \"../../utils/config\";\nimport { CSVLink } from \"react-csv\";\nimport md5 from 'md5';\nimport { DEV_PROTJECT_PATH } from \"../../utils/config\";\n\nclass OfferUpload extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.validateUploadFile = file => {\n      const filename = file.name.toString();\n\n      if (/[^a-zA-Z0-9\\.\\-\\_ ]/.test(filename)) {\n        Notify.showError(\"File name can contain only alphanumeric characters including space and dots\");\n        return false;\n      }\n\n      const fileext = filename.split('.').pop();\n      console.log(\"File Extension: \", fileext);\n\n      if (fileext == 'xlsx') {\n        var fileSize = file.size / 1000; //in kb\n\n        if (fileSize >= 5 && fileSize <= 2048) {\n          Object.defineProperty(file, 'name', {\n            writable: true,\n            value: md5(file.name) + \".\" + fileext\n          });\n          return file;\n        } else {\n          Notify.showError(\"File size should be grater than 5KB and less than 2MB\");\n        }\n      } else {\n        Notify.showError(\"Only xlsx file allow to upload\");\n      }\n\n      return false;\n    };\n\n    this.onChangeFileUpload = e => {\n      const fileToUpload = this.validateUploadFile(e.target.files[0]);\n\n      if (fileToUpload) {\n        console.log(e.target.name);\n        this.setState({\n          [e.target.name]: e.target.files[0]\n        });\n        return;\n      } else {\n        console.log(\"Not Valid file: \", e.target.name);\n        document.getElementById(e.target.name).value = \"\";\n      }\n    };\n\n    this.onChange = e => {\n      const re = /^[0-9\\b]+$/;\n\n      if (e.target.value === '' || re.test(e.target.value) && e.target.value.length <= 10) {\n        this.setState({\n          searchby: e.target.value\n        });\n      }\n    };\n\n    this.state = {\n      products: [],\n      retailerOnboardExcelTemplatePath: \"\",\n      retailerDeleteExcelTemplatePath: \"\",\n      deletefile: '',\n      searchby: '',\n      retailerDetails: '',\n      allOfferData: \"\"\n    };\n    this.getAdmminStaticData = this.getAdmminStaticData.bind(this);\n    this.uploadOffer = this.uploadOffer.bind(this);\n    this.relailerDelete = this.relailerDelete.bind(this);\n    this.searchRetailer = this.searchRetailer.bind(this);\n  }\n\n  componentDidMount() {\n    this.getAdmminStaticData();\n    AdminService.downlaodAllOfferData().then(res => {\n      let data = resolveResponse(res);\n      if (data.result) this.setState({\n        allOfferData: data.result\n      });\n    });\n  }\n\n  getAdmminStaticData() {\n    AdminService.getStaticData(\"ADMIN\").then(res => {\n      let data = resolveResponse(res);\n      if (data.result && data.result) this.setState({\n        retailerOnboardExcelTemplatePath: data.result.retailerOnboardExcelTemplatePath,\n        retailerDeleteExcelTemplatePath: data.result.retailerDeleteExcelTemplatePath\n      });\n    });\n  }\n\n  uploadOffer() {\n    console.log(this.state.uploadfile);\n\n    if (!this.state.uploadfile || document.getElementById('uploadfile').value == \"\") {\n      Notify.showError(\"Missing required file to upload\");\n      return;\n    } // var userDetails = localStorage.getItem(\"userDetails\")\n    // userDetails = userDetails && JSON.parse(userDetails);\n\n\n    const formData = new FormData();\n    formData.append('file', this.state.uploadfile); //  formData.append('submittedBy',userDetails && userDetails.loginId);\n    // formData.append('email', '');\n\n    AdminService.uploadOffer(formData).then(data => {\n      // var data = resolveResponse(res, \"Offer Uploaded Successfully.\");\n      console.log('datavijay', data);\n      var data = data && data.data;\n\n      if (data.status == 200) {\n        Notify.showSuccess(\"Offer Uploaded Successfully.\");\n      } else {\n        Notify.showError(data.message);\n      }\n\n      document.getElementById('uploadfile').value = \"\";\n    });\n  }\n\n  relailerDelete() {\n    if (!this.state.deletefile || document.getElementById('deletefile').value == \"\") {\n      Notify.showError(\"Missing required file to upload\");\n      return;\n    }\n\n    var userDetails = localStorage.getItem(\"userDetails\");\n    userDetails = userDetails && JSON.parse(userDetails);\n    const formData = new FormData();\n    formData.append('file', this.state.deletefile);\n    formData.append('submittedBy', userDetails && userDetails.loginId);\n    formData.append('email', '');\n    AdminService.deleteRetailer(formData).then(res => {\n      resolveResponse(res, '');\n      Notify.showSuccess(\"Attached retailer info deleted successfully.\");\n      document.getElementById('deletefile').value = \"\";\n    });\n  }\n\n  searchRetailer() {\n    if (!this.state.searchby) {\n      Notify.showError(\"Type by lapu number or Retailer AirtelId Id \");\n      return;\n    }\n\n    var userDetails = localStorage.getItem(\"userDetails\");\n    userDetails = userDetails && JSON.parse(userDetails);\n    const param = {\n      lapuNumber: this.state.searchby,\n      retailerAirtelId: this.state.searchby\n    };\n    AdminService.searchRetailer(param).then(res => {\n      var data = resolveResponse(res, '');\n      var staticdata = {\n        \"message\": \"string\",\n        \"result\": {\n          \"distributerId\": \"string\",\n          \"distributerMsisdn\": \"string\",\n          \"distributerName\": \"string\",\n          \"district\": \"string\",\n          \"fseId\": \"string\",\n          \"fseMsisdn\": \"string\",\n          \"fseName\": \"string\",\n          \"retailerAirtelId\": \"string\",\n          \"retailerName\": \"string\",\n          \"retailerVLNumber\": \"string\",\n          \"territory\": \"string\",\n          \"tmId\": \"string\",\n          \"tmMsisdn\": \"string\",\n          \"tmName\": \"string\",\n          \"zbmId\": \"string\",\n          \"zbmMsisdn\": \"string\",\n          \"zbmName\": \"string\",\n          \"zone\": \"string\"\n        },\n        \"status\": 0\n      };\n\n      if (data.result) {\n        this.setState({\n          retailerDetails: [data.result]\n        });\n      } else {// this.setState({ retailerDetails :  [staticdata.result] })\n      }\n    });\n  }\n\n  addProduct() {\n    this.props.history.push('/add-product');\n  }\n\n  someAction() {\n    alert(\"action happed in other commpornt\");\n  }\n\n  editProduct(productId) {\n    console.log(\"productid\", productId);\n    window.localStorage.setItem(\"selectedProductId\", productId);\n    this.props.history.push('/edit-doc');\n  }\n\n  convertBool(flag) {\n    return flag ? 'Yes' : 'No';\n  }\n\n  render() {\n    return React.createElement(React.Fragment, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 270\n      },\n      __self: this\n    }, React.createElement(PostLoginNavBar, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 271\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      style: {\n        padding: \"40px\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 273\n      },\n      __self: this\n    }, React.createElement(Paper, {\n      style: {\n        padding: \"15px\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 274\n      },\n      __self: this\n    }, React.createElement(Typography, {\n      component: \"h2\",\n      variant: \"h6\",\n      color: \"primary\",\n      gutterBottom: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 275\n      },\n      __self: this\n    }, \"Customer Offer Upload\"), React.createElement(Grid, {\n      container: true,\n      className: \"flexGrow\",\n      spacing: 3,\n      style: {\n        padding: \"10px\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 278\n      },\n      __self: this\n    }, React.createElement(Grid, {\n      item: true,\n      xs: 12,\n      sm: 3,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 279\n      },\n      __self: this\n    }, React.createElement(InputLabel, {\n      htmlFor: \"Connection Type\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 280\n      },\n      __self: this\n    }, React.createElement(Typography, {\n      variant: \"subtitle1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 281\n      },\n      __self: this\n    }, React.createElement(Link, {\n      color: \"primary\",\n      href: DEV_PROTJECT_PATH + \"/webdata/Offers.xlsx\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 282\n      },\n      __self: this\n    }, \"Download Sample\")))), React.createElement(Grid, {\n      item: true,\n      xs: 12,\n      sm: 3,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 287\n      },\n      __self: this\n    }, React.createElement(Typography, {\n      variant: \"subtitle1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 288\n      },\n      __self: this\n    }, \"Upload Offer\")), React.createElement(Grid, {\n      item: true,\n      xs: 12,\n      sm: 3,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 291\n      },\n      __self: this\n    }, React.createElement(Typography, {\n      variant: \"subtitle1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 292\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      type: \"file\",\n      name: \"uploadfile\",\n      id: \"uploadfile\" // onChange={this.onChangeHandler}\n      ,\n      onChange: this.onChangeFileUpload,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 294\n      },\n      __self: this\n    }))), React.createElement(Grid, {\n      item: true,\n      xs: 12,\n      sm: 3,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 304\n      },\n      __self: this\n    }, React.createElement(Button, {\n      startIcon: React.createElement(CloudUploadIcon, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 305\n        },\n        __self: this\n      }),\n      variant: \"contained\",\n      color: \"primary\",\n      style: {\n        marginLeft: '20px'\n      },\n      onClick: this.uploadOffer,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 305\n      },\n      __self: this\n    }, \"Upload\")))), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 310\n      },\n      __self: this\n    }), React.createElement(Paper, {\n      style: {\n        padding: \"15px\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 312\n      },\n      __self: this\n    }, React.createElement(Typography, {\n      component: \"h2\",\n      variant: \"h6\",\n      color: \"primary\",\n      gutterBottom: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 313\n      },\n      __self: this\n    }, \"Download Offers Details\"), React.createElement(Typography, {\n      variant: \"subtitle1\",\n      gutterBottom: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 317\n      },\n      __self: this\n    }, \"Total Offers:\", this.state.allOfferData.length), this.state.allOfferData ? React.createElement(CSVLink, {\n      data: this.state.allOfferData,\n      filename: \"offers-details.csv\",\n      className: \"btn btn-primary\",\n      target: \"_blank\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 323\n      },\n      __self: this\n    }, React.createElement(Typography, {\n      variant: \"subtitle1\",\n      gutterBottom: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 328\n      },\n      __self: this\n    }, \"Download Offers\")) : \"\")));\n  }\n\n}\n\nconst styles = {\n  tableStyle: {\n    display: 'flex',\n    justifyContent: 'left'\n  }\n};\nexport default OfferUpload;","map":{"version":3,"sources":["/Users/B0208058/Documents/slretailer-web-portal/src/components/backoffice/OfferUpload.js"],"names":["React","useState","AdminService","Typography","Button","Table","TableHead","TableRow","TableCell","TableBody","Notify","CloudUploadIcon","DeleteIcon","SearchIcon","VisibilityIcon","PostLoginNavBar","Container","resolveResponse","TextField","Link","TablePagination","Grid","Paper","Title","InputLabel","CRO_API_BASE_URL","CSVLink","md5","DEV_PROTJECT_PATH","OfferUpload","Component","constructor","props","validateUploadFile","file","filename","name","toString","test","showError","fileext","split","pop","console","log","fileSize","size","Object","defineProperty","writable","value","onChangeFileUpload","e","fileToUpload","target","files","setState","document","getElementById","onChange","re","length","searchby","state","products","retailerOnboardExcelTemplatePath","retailerDeleteExcelTemplatePath","deletefile","retailerDetails","allOfferData","getAdmminStaticData","bind","uploadOffer","relailerDelete","searchRetailer","componentDidMount","downlaodAllOfferData","then","res","data","result","getStaticData","uploadfile","formData","FormData","append","status","showSuccess","message","userDetails","localStorage","getItem","JSON","parse","loginId","deleteRetailer","param","lapuNumber","retailerAirtelId","staticdata","addProduct","history","push","someAction","alert","editProduct","productId","window","setItem","convertBool","flag","render","padding","marginLeft","styles","tableStyle","display","justifyContent"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport AdminService from \"../service/AdminService\";\nimport Typography from \"@material-ui/core/Typography\";\nimport Button from \"@material-ui/core/Button\";\nimport Table from \"@material-ui/core/Table\";\nimport TableHead from \"@material-ui/core/TableHead\";\nimport TableRow from \"@material-ui/core/TableRow\";\nimport TableCell from \"@material-ui/core/TableCell\";\nimport TableBody from \"@material-ui/core/TableBody\";\nimport Notify from \"../../utils/Notify\";\nimport CloudUploadIcon from '@material-ui/icons/CloudUpload';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport SearchIcon from '@material-ui/icons/Search';\nimport VisibilityIcon from '@material-ui/icons/Visibility';\nimport PostLoginNavBar from \"../PostLoginNavbar\";\nimport { Container } from \"@material-ui/core\";\nimport { resolveResponse } from \"../../utils/ResponseHandler\";\nimport TextField from '@material-ui/core/TextField';\nimport Link from '@material-ui/core/Link';\nimport TablePagination from '@material-ui/core/TablePagination';\nimport Grid from '@material-ui/core/Grid';\nimport Paper from '@material-ui/core/Paper';\nimport Title from './Title';\nimport InputLabel from \"@material-ui/core/InputLabel\";\nimport { CRO_API_BASE_URL } from \"../../utils/config\";\nimport { CSVLink } from \"react-csv\";\nimport md5  from 'md5'; \nimport  {DEV_PROTJECT_PATH} from \"../../utils/config\";\n\nclass OfferUpload extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            products: [],\n            retailerOnboardExcelTemplatePath: \"\",\n            retailerDeleteExcelTemplatePath: \"\",\n            deletefile:'', \n            searchby:'',\n            retailerDetails: '',\n            allOfferData:\"\"\n\n\n        };\n        this.getAdmminStaticData = this.getAdmminStaticData.bind(this);\n        this.uploadOffer = this.uploadOffer.bind(this);\n        this.relailerDelete = this.relailerDelete.bind(this);\n        this.searchRetailer = this.searchRetailer.bind(this);\n    }\n\n\n    validateUploadFile = (file) => {\n        const filename = file.name.toString(); \n    \n        if (/[^a-zA-Z0-9\\.\\-\\_ ]/.test(filename)) {\n            Notify.showError(\"File name can contain only alphanumeric characters including space and dots\")\n            return false;\n        }\n    \n        const fileext =  filename.split('.').pop(); \n        console.log(\"File Extension: \",fileext);\n\n        if(fileext == 'xlsx'){\n            var fileSize = file.size / 1000; //in kb\n            if(fileSize >= 5 && fileSize <= 2048){\n              Object.defineProperty(file, 'name', {\n                writable: true,\n                value:  md5(file.name) +\".\"+ fileext\n              });\n              \n              return file;\n            }else{\n              Notify.showError(\"File size should be grater than 5KB and less than 2MB\")\n            }\n        }else {\n          Notify.showError(\"Only xlsx file allow to upload\")\n        }\n        return false;\n      }\n\n\n    onChangeFileUpload = e => {\n        const fileToUpload = this.validateUploadFile(e.target.files[0]);\n\n        if(fileToUpload){\n            console.log(e.target.name);\n            this.setState({[e.target.name]: e.target.files[0]})\n            return;\n        }else{\n            console.log(\"Not Valid file: \",e.target.name); \n            document.getElementById(e.target.name).value = \"\";\n        }\n    }\n\n\n\n    onChange = (e) => {\n\n        const re = /^[0-9\\b]+$/;\n        if (e.target.value === '' || re.test(e.target.value) && e.target.value.length <= 10) {\n            this.setState({searchby: e.target.value})\n        }\n\n    }\n\n\n\n    componentDidMount() {\n        this.getAdmminStaticData();\n\n        AdminService.downlaodAllOfferData()\n        .then((res) => {\n            let data = resolveResponse(res);\n            if (data.result)\n                this.setState({ allOfferData: data.result })\n            });\n\n    }\n\n    getAdmminStaticData() {\n\n            AdminService.getStaticData(\"ADMIN\")\n            .then((res) => {\n                let data = resolveResponse(res);\n                if (data.result && data.result)\n                    this.setState({ retailerOnboardExcelTemplatePath: data.result.retailerOnboardExcelTemplatePath, retailerDeleteExcelTemplatePath: data.result.retailerDeleteExcelTemplatePath })\n                });\n    }\n\n\n    uploadOffer() {\n    \n\n        console.log(this.state.uploadfile);\n\n            if(!this.state.uploadfile || document.getElementById('uploadfile').value ==\"\"){\n                Notify.showError(\"Missing required file to upload\");\n                return;\n            }\n\n            // var userDetails = localStorage.getItem(\"userDetails\")\n            // userDetails = userDetails && JSON.parse(userDetails);\n\n            const formData = new FormData();\n            formData.append('file',this.state.uploadfile);\n          //  formData.append('submittedBy',userDetails && userDetails.loginId);\n           // formData.append('email', '');\n        \n            \n            AdminService.uploadOffer(formData).then(data => {\n\n           // var data = resolveResponse(res, \"Offer Uploaded Successfully.\");\n            console.log('datavijay',data);\n            var data = data && data.data;\n            if(data.status == 200){\n                Notify.showSuccess(\"Offer Uploaded Successfully.\");\n            }else{\n                Notify.showError(data.message);\n            }\n          \n            document.getElementById('uploadfile').value = \"\";\n        \n            });\n    }\n\n\n    relailerDelete() {\n    \n        if(!this.state.deletefile || document.getElementById('deletefile').value ==\"\"){\n        Notify.showError(\"Missing required file to upload\");\n        return;\n        }\n\n        var userDetails = localStorage.getItem(\"userDetails\")\n        userDetails = userDetails && JSON.parse(userDetails);\n\n        const formData = new FormData();\n        formData.append('file',this.state.deletefile);\n        formData.append('submittedBy', userDetails && userDetails.loginId);\n        formData.append('email', '');\n    \n        \n        AdminService.deleteRetailer(formData).then(res => {\n        resolveResponse(res,'');\n        Notify.showSuccess(\"Attached retailer info deleted successfully.\");\n        document.getElementById('deletefile').value = \"\"; \n\n        });\n    }\n\n    searchRetailer(){\n       \n            if(!this.state.searchby){\n                Notify.showError(\"Type by lapu number or Retailer AirtelId Id \");\n                return;\n            }\n    \n            var userDetails = localStorage.getItem(\"userDetails\")\n            userDetails = userDetails && JSON.parse(userDetails);\n    \n            const param = {\n                lapuNumber : this.state.searchby, \n                retailerAirtelId: this.state.searchby, \n            }\n        \n            AdminService.searchRetailer(param).then(res => {\n            var data = resolveResponse(res,'');\n           \n                var staticdata = {\n                    \"message\": \"string\",\n                    \"result\": {\n                    \"distributerId\": \"string\",\n                    \"distributerMsisdn\": \"string\",\n                    \"distributerName\": \"string\",\n                    \"district\": \"string\",\n                    \"fseId\": \"string\",\n                    \"fseMsisdn\": \"string\",\n                    \"fseName\": \"string\",\n                    \"retailerAirtelId\": \"string\",\n                    \"retailerName\": \"string\",\n                    \"retailerVLNumber\": \"string\",\n                    \"territory\": \"string\",\n                    \"tmId\": \"string\",\n                    \"tmMsisdn\": \"string\",\n                    \"tmName\": \"string\",\n                    \"zbmId\": \"string\",\n                    \"zbmMsisdn\": \"string\",\n                    \"zbmName\": \"string\",\n                    \"zone\": \"string\"\n                    },\n                    \"status\": 0\n                }\n                \n                if(data.result){\n                    this.setState({ retailerDetails :  [data.result] })\n                }else{\n                   // this.setState({ retailerDetails :  [staticdata.result] })\n                }\n        });\n    }\n\n    addProduct() {\n        this.props.history.push('/add-product');\n    }\n\n    someAction() {\n        alert(\"action happed in other commpornt\");\n    }\n\n\n    editProduct(productId) {\n        console.log(\"productid\", productId)\n\n        window.localStorage.setItem(\"selectedProductId\", productId);\n        this.props.history.push('/edit-doc');\n    }\n\n    convertBool(flag) {\n        return flag ? 'Yes' : 'No';\n    }\n\n\n\n\n\n    render() {\n\n        return (\n\n            <React.Fragment >\n                <PostLoginNavBar />\n\n            <div style={{ padding: \"40px\" }} >\n                <Paper style={{ padding: \"15px\" }}>\n                    <Typography component=\"h2\" variant=\"h6\" color=\"primary\" gutterBottom>\n                         Customer Offer Upload\n                    </Typography> \n                    <Grid container className=\"flexGrow\" spacing={3} style={{ padding: \"10px\" }}>\n                        <Grid item xs={12} sm={3}>\n                            <InputLabel htmlFor=\"Connection Type\" >\n                                <Typography variant=\"subtitle1\">\n                                    <Link color=\"primary\" href={DEV_PROTJECT_PATH+\"/webdata/Offers.xlsx\"}>Download Sample</Link>\n                                </Typography>\n                            </InputLabel>\n                        </Grid>\n\n                        <Grid item xs={12} sm={3}>\n                            <Typography variant=\"subtitle1\">Upload Offer</Typography>\n                        </Grid>\n\n                        <Grid item xs={12} sm={3}>\n                            <Typography variant=\"subtitle1\">\n\n                            <input\n                                    type=\"file\"\n                                    name=\"uploadfile\"\n                                    id=\"uploadfile\"\n                                    // onChange={this.onChangeHandler}\n                                    onChange={this.onChangeFileUpload}\n                                  />\n                            </Typography>\n                        </Grid>\n\n                        <Grid item xs={12} sm={3}>\n                            <Button startIcon={<CloudUploadIcon />}  variant=\"contained\" color=\"primary\" style={{ marginLeft: '20px' }} onClick={this.uploadOffer}>Upload</Button>\n                        </Grid>\n                    </Grid>\n                </Paper>\n\n                <br />\n\n                <Paper style={{ padding: \"15px\" }}>\n                     <Typography component=\"h2\" variant=\"h6\" color=\"primary\" gutterBottom>\n                         Download Offers Details\n                    </Typography> \n\n                    <Typography variant=\"subtitle1\" gutterBottom>\n                        Total Offers:{this.state.allOfferData.length}\n                    </Typography>\n\n                    {this.state.allOfferData ? \n                        \n                        <CSVLink data={this.state.allOfferData}\n                        filename={\"offers-details.csv\"}\n                        className=\"btn btn-primary\"\n                        target=\"_blank\"\n                        >\n                        <Typography variant=\"subtitle1\"  gutterBottom>\n                            Download Offers\n                        </Typography>\n\n                        </CSVLink> \n                        \n                    :\"\"}\n                </Paper>\n\n        </div>\n\n            </React.Fragment>\n        )\n    }\n\n}\n\nconst styles = {\n    tableStyle: {\n        display: 'flex',\n        justifyContent: 'left'\n    }\n}\n\n\nexport default OfferUpload;"]},"metadata":{},"sourceType":"module"}