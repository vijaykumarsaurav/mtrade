(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{136:function(e,t,a){e.exports=a.p+"static/media/mylogo.92bbdbd4.png"},260:function(e,t,a){e.exports=a(421)},265:function(e,t,a){},269:function(e,t,a){},31:function(e){e.exports={monthlyTargetPer:5,dailyLossPer:1,totalCapital:12e3,perTradeExposurePer:90,perTradeStopLossPer:1}},421:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(29),o=a.n(r),i=(a(265),a(44)),s=a(108),c=a(226),m=a(33),g={packs:[],pack:[],updatedPack:null},u=Object(s.b)({packs:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET PACK LOADED":return Object(m.a)({},e,{packs:t.payload});case"EDIT PACK INFO":return Object(m.a)({},e,{updatedPack:t.payload});case"GET_PACK_INFO_BY_ID":return Object(m.a)({},e,{pack:t.payload});default:return e}}}),d=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||s.c,h=Object(s.d)(u,d(Object(s.a)(c.a))),p=(a(269),a(152)),f=a(39),y=a(12),b=a(7),E=a(10),S=a(13),v=a(11),k=a(26),w=a(14),C=a(25),L=a.n(C),x=new(function(){function e(){Object(b.a)(this,e)}return Object(E.a)(e,[{key:"getLoggedInUserInfo",value:function(){localStorage.getItem("UserInfo")}},{key:"getHeader",value:function(){var e=JSON.parse(localStorage.getItem("userTokens"));return{headers:{Authorization:"Bearer "+(e&&e.jwtToken),"Content-Type":"application/json",Accept:"application/json","X-UserType":"USER","X-SourceID":"WEB","X-ClientLocalIP":"192.168.1.128","X-ClientPublicIP":"91.0.4472.114","X-MACAddress":"f0:18:98:26:c4:cc","X-PrivateKey":"I4O6PJAn"}}}},{key:"loginHeader",value:function(){return{headers:{"Content-Type":"application/json",Accept:"application/json","X-UserType":"USER","X-SourceID":"WEB","X-ClientLocalIP":"192.168.1.128","X-ClientPublicIP":"91.0.4472.114","X-MACAddress":"f0:18:98:26:c4:cc","X-PrivateKey":"I4O6PJAn"}}}},{key:"getImageHeader",value:function(){return{headers:{token:localStorage.getItem("token")}}}},{key:"getScannerHeader",value:function(){return{headers:{"Content-Type":"application/json",Accept:"application/json"}}}},{key:"getNSESessionHeader",value:function(e){return{headers:{sessionId:e,Accept:"application/json"}}}}]),e}()),I="I4O6PJAn",T=new(function(){function e(){Object(b.a)(this,e)}return Object(E.a)(e,[{key:"login",value:function(e){return L.a.post("https://apiconnect.angelbroking.com/rest/auth/angelbroking/user/v1/loginByPassword",e,x.loginHeader())}},{key:"logout",value:function(e){return L.a.post("https://apiconnect.angelbroking.com/rest/secure/angelbroking/user/v1/logout",e,x.getHeader())}},{key:"getUserData",value:function(e){return L.a.get("https://apiconnect.angelbroking.com/rest/secure/angelbroking/user/v1/getProfile",x.getHeader())}},{key:"getFunds",value:function(e){return L.a.get("https://apiconnect.angelbroking.com/rest/secure/angelbroking/user/v1/getRMS",x.getHeader())}},{key:"retrieveOrderBook",value:function(e){return L.a.get("https://apiconnect.angelbroking.com/rest/secure/angelbroking/order/v1/getOrderBook",x.getHeader())}},{key:"retrieveTradeBook",value:function(e){return L.a.get("https://apiconnect.angelbroking.com/rest/secure/angelbroking/order/v1/getTradeBook",x.getHeader())}},{key:"retrieveallTradableInstruments",value:function(e){return L.a.get("https://margincalculator.angelbroking.com/OpenAPI_File/files/OpenAPIScripMaster.json","")}},{key:"placeOrder",value:function(e){return L.a.post("https://apiconnect.angelbroking.com/rest/secure/angelbroking/order/v1/placeOrder",e,x.getHeader())}},{key:"modifyOrder",value:function(e){return L.a.post("https://apiconnect.angelbroking.com/rest/secure/angelbroking/order/v1/modifyOrder",e,x.getHeader())}},{key:"cancelOrder",value:function(e){return L.a.post("https://apiconnect.angelbroking.com/rest/secure/angelbroking/order/v1/cancelOrder",e,x.getHeader())}},{key:"getLTP",value:function(e){return L.a.post("https://apiconnect.angelbroking.com/rest/secure/angelbroking/order/v1/getLtpData",e,x.getHeader())}},{key:"getHistoryData",value:function(e){return L.a.post("https://apiconnect.angelbroking.com/rest/secure/angelbroking/historical/v1/getCandleData",e,x.getHeader())}},{key:"scanStocks",value:function(e){return L.a.post("https://chartink.com/screener/process",e,x.getScannerHeader())}},{key:"autoCompleteSearch",value:function(e){return L.a.get("http://localhost:8081/search/"+e,"")}},{key:"saveWatchList",value:function(e){return L.a.get("http://localhost:8081/saveWatchList/"+e,"")}},{key:"addIntoStaticData",value:function(e){return L.a.post("http://localhost:8081/addIntoStaticData",e,"")}},{key:"saveWatchListJSON",value:function(e){return L.a.post("http://localhost:8081/saveWatchListJSON",e,"")}},{key:"getWatchListJSON",value:function(){return L.a.get("/myJsonWatchList.json","")}},{key:"getStaticData",value:function(){return"vijaykumarsaurav.github.io"==window.location.hostname?L.a.get("/mtrade/staticData.json",""):L.a.get("/staticData.json","")}},{key:"saveCandleHistory",value:function(e){return L.a.post("http://localhost:8081/saveCandleHistory",e,"")}},{key:"getPosition",value:function(e){return L.a.get("https://apiconnect.angelbroking.com/rest/secure/angelbroking/order/v1/getPosition",x.getHeader())}},{key:"getAutoScanStock",value:function(){return L.a.get("http://localhost:8081/getScannedStocks","")}},{key:"getNSETopStock",value:function(){return L.a.get("http://localhost:8081/getNseTopStocks","")}},{key:"getSelectedStockFromDb",value:function(){return L.a.get("http://localhost:8081/getSelectedStock","")}},{key:"getIndiceStock",value:function(e){return L.a.get("https://www.nseindia.com/api/equity-stockIndices?index="+e,"")}},{key:"checkOtherApi",value:function(e){return L.a.get("https://www1.nseindia.com/live_market/dynaContent/live_watch/stock_watch/liveIndexWatchData.json","")}},{key:"checkSectorApiOther",value:function(e){return L.a.get("http://localhost:8081/nse/get_index_stocks?symbol="+e,"")}},{key:"getAllIndices",value:function(){return L.a.get("https://www.nseindia.com/api/allIndices")}},{key:"allIndicesDirectJSON",value:function(){return L.a.get("http://localhost:8081/nse/get_indices","")}},{key:"getBNcpdata",value:function(e){return"NIFTY"==e||"BANKNIFTY"==e?L.a.get("http://localhost:8081/nse/getOptionChain?symbol="+e,""):L.a.get("http://localhost:8081/nse/getOptionChainEquity?symbol="+e,"")}},{key:"getDeliveryData",value:function(e){return L.a.get("http://localhost:8081/nse/get_quote_info?companyName="+e,"")}}]),e}()),D=a(464),P=a(467),O=a(136),N=a.n(O),F=function(e){return l.a.createElement(l.a.Fragment,null,l.a.createElement(D.a,{position:"static"},l.a.createElement(P.a,null,l.a.createElement("img",{alt:"logo",style:{width:"190px"},src:N.a}))))},M=a(477),A=a(504),B=a(476),H=a(470),Y=a(503),j=a(228),R=a.n(j),V=a(505),W=a(109),U=a(468),J=a(469),_=Object(U.a)(function(e){return{"@global":{body:{backgroundColor:e.palette.common.white}},paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:"#df0915"},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}});function q(e){var t=_(),a=function(t){e.loginProps.onChange(t)};return l.a.createElement(l.a.Fragment,null,l.a.createElement(J.a,{component:"main",maxWidth:"xs"},l.a.createElement(H.a,null),l.a.createElement("div",{className:t.paper},l.a.createElement(V.a,{className:t.avatar},l.a.createElement(R.a,null)),l.a.createElement(W.a,{component:"h1",variant:"h5"},"Sign in"),l.a.createElement("form",{className:t.form,noValidate:!0},l.a.createElement(Y.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"email",label:"User Id",name:"userName",autoComplete:"email",autoFocus:!0,onChange:a,value:e.loginProps.userName}),l.a.createElement(Y.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",onChange:a,value:e.loginProps.password}),l.a.createElement(B.a,{type:"submit",fullWidth:!0,variant:"contained",color:"primary",className:t.submit,onClick:e.loginProps.login},"Sign In")))))}var z=a(94),G=new(function(){function e(){Object(b.a)(this,e)}return Object(E.a)(e,[{key:"showError",value:function(e){z.b.error(e,this.options())}},{key:"showSuccess",value:function(e){z.b.success(e,this.options())}},{key:"showWarning",value:function(e){z.b.warn(e,this.options())}},{key:"options",value:function(){return{position:z.b.POSITION.BOTTOM_RIGHT,autoClose:2e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!1}}}]),e}());function K(e,t){var a={};if(200===e.status)return(a=e.data).status?(a.message&&"noPop"!==t&&G.showSuccess(a.message),a):(G.showError(a.message),"Invalid Token"===a.message&&(window.location.replace("#/login"),localStorage.setItem("userTokens",""),localStorage.setItem("userProfile","")),Promise.reject(a.message));e&&!e.status&&G.showError(a.message)}var Q=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(S.a)(this,Object(v.a)(t).call(this,e))).onChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value.trim()))},a.login=function(e){if(a.setState({isError:""}),e.preventDefault(),a.state.userName||a.state.password)if(a.state.userName)if(a.state.password){a.setState({isDasable:!0});var t={clientcode:a.state.userName,password:a.state.password};T.login(t).then(function(e){K(e);(e=e&&e.data).status&&"SUCCESS"!==e.message&&a.setState({isError:e.message}),a.setState({isDasable:!1}),e.data&&(window.localStorage.setItem("userTokens",JSON.stringify(e.data)),T.getUserData().then(function(e){K(e);(e=e&&e.data).status&"SUCCESS"===e.message&&(window.localStorage.setItem("userProfile",JSON.stringify(e.data)),T.getStaticData().then(function(e){var t=e.data;localStorage.setItem("staticData",JSON.stringify(t));var n=Object.keys(t);a.setState({totalWatchlist:n}),localStorage.setItem("totalWatchlist",JSON.stringify(n)),a.setState({staticData:t});var l=[];n.forEach(function(e){t[e].forEach(function(e){l.filter(function(t){return t.token===e.token}).length||l.push(e)})}),localStorage.setItem("watchList",JSON.stringify(l)),window.location.replace("#/home")}))}))})}else a.setState({isError:"Password is required."});else a.setState({isError:"Olms Id is required."});else a.setState({isError:"Olms Id and Password are required."})},a.state={userName:"V193588",password:"",isDasable:!1,isError:!1},a.login=a.login.bind(Object(k.a)(a)),a}return Object(w.a)(t,e),Object(E.a)(t,[{key:"render",value:function(){return l.a.createElement(l.a.Fragment,null,l.a.createElement(F,null),l.a.createElement(q,{loginProps:{onChange:this.onChange,login:this.login,userName:this.state.userName,password:this.state.password}}),l.a.createElement(M.a,{container:!0,justify:"space-around"},l.a.createElement(M.a,{justify:"center",container:!0,xs:12,sm:10},this.state.isDasable?l.a.createElement(A.a,{variant:"subtitle1",style:X.waitMessage}," Please wait..."):"",this.state.isError?l.a.createElement(A.a,{variant:"subtitle1",style:X.errorMessage}," ",this.state.isError," "):"")))}},{key:"componentDidMount",value:function(){window.localStorage.getItem("userTokens")&&this.props.history.push("home")}}]),t}(l.a.Component),X={formStyle:{display:"flex",flexFlow:"row wrap"},label:{display:"flex",justifyContent:"center"},errorMessage:{color:"red",marginTop:"11px"},waitMessage:{color:"gray",marginTop:"11px"}},Z=Q,$=a(5),ee=a.n($),te=a(17),ae=a(16),ne=a(22),le=a(3),re=a(45),oe=a(506),ie=a(475),se=a(490),ce=a(423),me=a(233),ge=a.n(me),ue=a(234),de=a.n(ue),he=a(235),pe=a.n(he),fe=a(422),ye=a(478),be=a(479),Ee=a(230),Se=a.n(Ee),ve=a(177),ke=a.n(ve),we=a(120),Ce=a.n(we),Le=a(59),xe=a.n(Le),Ie=l.a.createElement("div",null,l.a.createElement(fe.a,{button:!0,component:"a",href:"/mtrade/#/sector-heat-map2"},l.a.createElement(ye.a,null,l.a.createElement(xe.a,null)),l.a.createElement(be.a,{primary:"Heat Map2"})),l.a.createElement(fe.a,{button:!0,component:"a",target:"_blank",href:"/mtrade/#/find-fast-movement"},l.a.createElement(ye.a,null,l.a.createElement(xe.a,null)),l.a.createElement(be.a,{primary:"Fast Movement"})),l.a.createElement(fe.a,{button:!0,component:"a",href:"/mtrade/#/position"},l.a.createElement(ye.a,null,l.a.createElement(ke.a,null)),l.a.createElement(be.a,{primary:"Positions"})),l.a.createElement(fe.a,{button:!0,component:"a",href:"/mtrade/#/order-watchlist"},l.a.createElement(ye.a,null,l.a.createElement(ke.a,null)),l.a.createElement(be.a,{primary:"Order Watchlist"})),l.a.createElement(fe.a,{button:!0,component:"a",href:"/mtrade/#/funds"},l.a.createElement(ye.a,null,l.a.createElement(Ce.a,null)),l.a.createElement(be.a,{primary:"Funds"})),l.a.createElement(fe.a,{button:!0,component:"a",href:"/mtrade/#/order"},l.a.createElement(ye.a,null,l.a.createElement(Ce.a,null)),l.a.createElement(be.a,{primary:"Order Book"})),l.a.createElement(fe.a,{button:!0,component:"a",href:"/mtrade/#/trade"},l.a.createElement(ye.a,null,l.a.createElement(Ce.a,null)),l.a.createElement(be.a,{primary:"Trade Book"})),l.a.createElement(fe.a,{button:!0,component:"a",href:"/mtrade/#/sector-heat-map"},l.a.createElement(ye.a,null,l.a.createElement(xe.a,null)),l.a.createElement(be.a,{primary:"Heat Map"})),l.a.createElement(fe.a,{button:!0,component:"a",href:"/mtrade/#/addtowatchlist"},l.a.createElement(ye.a,null,l.a.createElement(Ce.a,null)),l.a.createElement(be.a,{primary:"Watchlist ("+(localStorage.getItem("watchList")&&JSON.parse(localStorage.getItem("watchList")).length)+")"})));var Te=l.a.createElement("div",null,l.a.createElement(p.b,{to:"",style:{textDecoration:"none"},onClick:function(){if(window.confirm("Are you sure to logout?")){var e=localStorage.getItem("userProfile"),t={clientcode:(e=e&&JSON.parse(e))&&e.clientcode};T.logout(t).then(function(e){localStorage.clear(),function(){for(var e=document.cookie.split(";"),t=0;t<e.length;t++){var a=e[t],n=a.indexOf("="),l=n>-1?a.substr(0,n):a;document.cookie=l+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT"}}(),window.location.replace("#/login")})}}},l.a.createElement(fe.a,{button:!0},l.a.createElement(ye.a,null,l.a.createElement(Se.a,null)),l.a.createElement(be.a,{primary:"Logout"})))),De=a(107),Pe=a.n(De),Oe=a(508),Ne=a(481),Fe=a(480),Me=Object(U.a)(function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}});function Ae(){var e=Me(),t=l.a.useState(!0),a=Object(ne.a)(t,2),n=a[0],r=a[1];return l.a.createElement("div",{className:e.root},l.a.createElement(Fe.a,null,l.a.createElement(Ne.a,{control:l.a.createElement(Oe.a,{checked:n,onChange:function(e){localStorage.setItem("invertColorFlag",e.target.checked),r(e.target.checked)},"aria-label":"login switch"}),label:n?"Black & White":"Colorfull"})))}var Be=a(20),He=a(8),Ye=a(485),je=a(482),Re=a(483),Ve=a(484),We=a(71),Ue=a.n(We),Je=a(486),_e=a(487),qe=a(488),ze=a(489),Ge=a(54),Ke=a.n(Ge),Qe=(a(159),a(150));function Xe(e){var t=e.candleChartData,a=e.vwapDataChart,n=[],r=[];if(t)for(var o=0;o<t.length;o++)t[o]&&(n.push(t[o][4]),r.push(new Date(t[o][0]).getHours()+":"+new Date(t[o][0]).getMinutes()));var i={labels:r,datasets:[{label:"Close",data:n,fill:!0,borderColor:e.percentChange>0?"green":"red"},{label:"Vwap",data:a,fill:!0,borderColor:"blue"}]};return l.a.createElement("div",{className:"App"},l.a.createElement(Qe.a,{data:i,options:{maintainAspectRatio:!1,legend:{display:!1}}}))}var Ze=Object(He.a)(function(e){return{root:{margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}})(function(e){var t=e.children,a=e.classes,n=e.onClose,r=Object(Be.a)(e,["children","classes","onClose"]);return l.a.createElement(je.a,Object.assign({disableTypography:!0,className:a.root},r),l.a.createElement(W.a,{variant:"h6"},t),n?l.a.createElement(ce.a,{"aria-label":"close",className:a.closeButton,onClick:n},l.a.createElement(Ue.a,null)):null)}),$e=Object(He.a)(function(e){return{root:{padding:e.spacing(2)}}})(Re.a),et=Object(He.a)(function(e){return{root:{margin:0,padding:e.spacing(1)}}})(Ve.a);function tt(e){var t=l.a.useState(!1),a=Object(ne.a)(t,2),n=a[0],r=a[1],o=l.a.useState({data:[],candledata:{}}),i=Object(ne.a)(o,2),s=(i[0],i[1],function(){r(!1)});return l.a.createElement("div",null,l.a.createElement(B.a,{variant:"outlined",id:"showCandleChart",color:"primary",style:{display:"none"},onClick:function(){r(!0)}},"Chart"),l.a.createElement(Ye.a,{onClose:s,"aria-labelledby":"customized-dialog-title",open:n},l.a.createElement(Ze,{id:"customized-dialog-title",onClose:s},localStorage.getItem("cadleChartSymbol"),"   ",localStorage.getItem("candlePriceShow"),"  (",localStorage.getItem("candleChangeShow"),"%)",l.a.createElement("br",null),localStorage.getItem("chartInfoDetails")?l.a.createElement("span",{style:{fontSize:"12px"}},l.a.createElement("b",null,"FoundAt:"),"  ",localStorage.getItem("chartInfoDetails")&&JSON.parse(localStorage.getItem("chartInfoDetails")).foundAt.substr(0,16)," \xa0\xa0",l.a.createElement("b",null,"Buy: "),localStorage.getItem("chartInfoDetails")&&JSON.parse(localStorage.getItem("chartInfoDetails")).buyExitPrice," \xa0\xa0",l.a.createElement("b",null,"Sell: "),localStorage.getItem("chartInfoDetails")&&JSON.parse(localStorage.getItem("chartInfoDetails")).sellEntyPrice," \xa0\xa0",l.a.createElement("b",null,"Change %: "),"  ",localStorage.getItem("chartInfoDetails")&&JSON.parse(localStorage.getItem("chartInfoDetails")).perChange," \xa0\xa0    ",l.a.createElement("br",null),l.a.createElement("b",null,"Change on High/Low %: "),localStorage.getItem("chartInfoDetails")&&JSON.parse(localStorage.getItem("chartInfoDetails")).perChange," \xa0\xa0",l.a.createElement("b",null,"SquareOffAt:"),localStorage.getItem("chartInfoDetails")&&JSON.parse(localStorage.getItem("chartInfoDetails")).squareOffAt):""),l.a.createElement($e,{dividers:!0,id:"chart"},localStorage.getItem("candleChartData")?l.a.createElement(Ke.a,{options:{chart:{type:"candlestick",height:350},title:{text:"",align:"left"},xaxis:{type:"datetime"},yaxis:{tooltip:{enabled:!0}}},series:[{data:localStorage.getItem("candleChartData")&&JSON.parse(localStorage.getItem("candleChartData"))}],type:"candlestick",width:500,height:350}):"",localStorage.getItem("candleChartDataInside")?l.a.createElement(Ke.a,{options:{chart:{type:"candlestick",height:350},title:{text:"",align:"left"},xaxis:{type:"datetime"},yaxis:{tooltip:{enabled:!0}}},series:[{data:localStorage.getItem("candleChartDataInside")&&JSON.parse(localStorage.getItem("candleChartDataInside"))}],type:"candlestick",width:500,height:350}):""),l.a.createElement(et,null,l.a.createElement(B.a,{autoFocus:!0,onClick:s,color:"primary"},"Close"))))}var at=a(72),nt=a.n(at);Object(He.a)(function(e){return{root:{margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}})(function(e){var t=e.children,a=e.classes,n=e.onClose,r=Object(Be.a)(e,["children","classes","onClose"]);return l.a.createElement(je.a,Object.assign({disableTypography:!0,className:a.root},r),l.a.createElement(W.a,{variant:"h6"},t),n?l.a.createElement(ce.a,{"aria-label":"close",className:a.closeButton,onClick:n},l.a.createElement(Ue.a,null)):null)}),Object(He.a)(function(e){return{root:{padding:e.spacing(2)}}})(Re.a),Object(He.a)(function(e){return{root:{margin:0,padding:e.spacing(1)}}})(Ve.a);var lt=a(31),rt=a(2),ot=a(499),it=a(500),st=a(41),ct=a.n(st),mt=new function e(){var t=this;Object(b.a)(this,e),this.speckIt=function(e){var t=new SpeechSynthesisUtterance;t.text=e.toString(),window.speechSynthesis.speak(t)},this.getMinPriceAllowTick=function(e){e=e.toFixed(2);var t=parseInt(e.split(".")[0]),a=parseFloat(e.split(".")[1]);return e=parseFloat(t+"."+(a-a%5))},this.placeSLMOrder=function(e){var a={triggerprice:e.stopLossPrice,tradingsymbol:e.tradingsymbol,symboltoken:e.symboltoken,quantity:e.quantity,transactiontype:"BUY"===e.transactiontype?"SELL":"BUY",exchange:"NSE",producttype:"INTRADAY",duration:"DAY",price:0,squareoff:"0",stoploss:"0",ordertype:"STOPLOSS_MARKET",variety:"STOPLOSS"};console.log("SLM option data",a),T.placeOrder(a).then(function(a){var n=K(a);n.status&&"SUCCESS"===n.message&&(t.speckIt("hey Vijay, "+e.tradingsymbol+" buy order placed"),document.getElementById("orderRefresh")&&document.getElementById("orderRefresh").click())})},this.getStockTokenDetails=function(e){},this.updateOrderList=function(){T.retrieveOrderBook().then(function(e){var t=K(e,"noPop");if(t&&t.data){var a=t.data;a.sort(function(e,t){return new Date(t.updatetime)-new Date(e.updatetime)}),localStorage.setItem("oderbookData",JSON.stringify(a))}})},this.historyWiseOrderPlace=function(e,a,n,l){var r=e.token,o=e.symbol,i={exchange:"NSE",tradingsymbol:o,symboltoken:r};T.getLTP(i).then(function(n){var i=K(n,"noPop"),s=i&&i.data;console.log(o," ltd data ",s);var c=0;if(s&&s.ltp){var m=lt.totalCapital*lt.perTradeExposurePer/100;c=Math.floor(m/s.ltp)}if(c>0&&e.qtyToTake&&(c=e.qtyToTake),console.log(o,"  quantity can be order ",e,c),c){var g="YYYY-MM-DD HH:mm",u=rt("9:15am","h:mma").format(g);console.log("beginningTime",u);var d=rt.duration("75:10:00"),h=rt(new Date).subtract(d),p={exchange:"NSE",symboltoken:r,interval:"FIVE_MINUTE",fromdate:rt(h).format(g),todate:rt(new Date).format(g)};T.getHistoryData(p).then(function(e){var n=K(e,"noPop");if(n&&n.data&&n.data.length){var i=n.data,m=0,g=0,u=0,d=0,h=0;if(i.reverse(),d=i[0][3],u=i[0][2],i&&i.length>0){for(var p=0;p<20;p++)i[p]&&(m+=i[p][4],g+=i[p][3],h+=i[p][2],i[p][2]>u&&(console.log(p,u,i[p][2]),u=i[p][2]),i[p][3]<=d&&(d=i[p][3]));var f=[],y=[],b=[],E=[],S=[],v=[],k=[],w=[];n.data.forEach(function(e,t){f.push([e[0],e[1],e[2],e[3],e[4]]),y.push([e[5],(e[2]+e[3]+e[4])/3]),b.push(e[4]),E.push(e[2]),S.push(e[3]),v.push(e[3]),k.push(e[5]),w.push((e[2]+e[3]+e[4])/3)});var C={values:b,period:14},L=ot.a.calculate(C);console.log(o,"lastRsiValue",L[L.length-1]);var x={period:20,values:w,stdDev:2},I=it.a.calculate(x);console.log(o,"BB",x,I,I[I.length-1]),console.log(o,"VWAP",y,ct()(y));var T=I[I.length-1],D=i.length>20?20:i.length,P=m/D,O=g/D,N=h/D,F=0,M=0;"BUY"==a&&(F=O-3*(u-d)/100,F=t.getMinPriceAllowTick(F),M=100*(s.ltp-F)/s.ltp,console.log(o,"My stoploss",a," LTP ",s.ltp),console.log(o+"highestHigh:",u,"lowestLow",d,"stoploss after tick:",F,"stoploss%",M),console.log(o+"  close avg middle ",P,"lowerest avg",O,"bbhigerValue",N),T&&(F=T.lower-3*(T.upper-T.lower)/100,F=t.getMinPriceAllowTick(F),M=100*(s.ltp-F)/s.ltp,console.log(o,a,"BB stoploss value",T," LTP ",s.ltp),console.log(o,F,"stoploss%",M))),"SELL"==a&&(F=N+3*(u-d)/100,M=100*((F=t.getMinPriceAllowTick(F))-s.ltp)/s.ltp,console.log(o,a," LTP ",s.ltp),console.log(o+"highestHigh:",u,"lowestLow",d,"stoploss after tick:",F,"stoploss%",M),console.log(o+"  close avg middle ",P,"lowerest avg",O,"bbhigerValue",N));var A={transactiontype:a,tradingsymbol:o,symboltoken:r,buyPrice:0,quantity:c,stopLossPrice:F};c?t.placeOrderMethod(A,l):(G.showError(o+" stoploss is > 1.5% Rejected"),console.log(o+" its not fullfilled"))}}else G.showError(o+" candle data emply"),console.log(o+" candle data emply"),l({transactiontype:a,tradingsymbol:o,symboltoken:r,status:!1})})}else G.showError(c+"  quantity |  "+o+" "+a+" Rejected")}).catch(function(e){})},this.getMinPriceAllowTick=function(e){e=e.toFixed(2);var t=parseInt(e.split(".")[0]),a=parseFloat(e.split(".")[1]);return e=parseFloat(t+"."+(a-a%5))},this.placeOptionOrder=function(e){var a={transactiontype:e.transactiontype,tradingsymbol:e.tradingsymbol,symboltoken:e.symboltoken,quantity:e.quantity,ordertype:0===e.buyPrice?"MARKET":"LIMIT",price:e.buyPrice,producttype:e.producttype?e.producttype:"INTRADAY",duration:"DAY",squareoff:"0",stoploss:"0",exchange:e.exchange?e.exchange:"NSE",variety:"NORMAL"};console.log("place order option",a),t.placeOptionSLMOrder(e)},this.placeOptionSLMOrder=function(e){var a={triggerprice:e.stopLossTriggerPrice,tradingsymbol:e.tradingsymbol,symboltoken:e.symboltoken,quantity:e.quantity,transactiontype:"SELL",exchange:e.exchange,producttype:e.producttype,duration:"DAY",price:e.stopLossPrice,squareoff:"0",stoploss:"0",ordertype:"STOPLOSS_MARKET",variety:"STOPLOSS"};console.log("SLM option data",a),T.placeOrder(a).then(function(a){var n=K(a);n.status&&"SUCCESS"===n.message&&(t.speckIt("hey Vijay, "+e.tradingsymbol+" stop loss order placed"),document.getElementById("orderRefresh")&&document.getElementById("orderRefresh").click(),t.updateOrderList())})},this.placeOrderMethod=function(e,a){var n={transactiontype:e.transactiontype,tradingsymbol:e.tradingsymbol,symboltoken:e.symboltoken,quantity:e.quantity,ordertype:0===e.buyPrice?"MARKET":"LIMIT",price:e.buyPrice,producttype:"INTRADAY",duration:"DAY",squareoff:"0",stoploss:"0",exchange:"NSE",variety:"NORMAL"};console.log("place order option",n),T.placeOrder(n).then(function(n){var l=K(n);if(l.status&&"SUCCESS"===l.message){e.stopLossPrice&&t.placeSLMOrder(e),t.speckIt("hey Vijay, "+e.tradingsymbol+" "+e.transactiontype+" order placed");var r={token:e.symboltoken,status:!0};a(r)}})},this.placeSLMOrder=function(e){var a={triggerprice:e.stopLossPrice,tradingsymbol:e.tradingsymbol,symboltoken:e.symboltoken,quantity:e.quantity,transactiontype:"BUY"===e.transactiontype?"SELL":"BUY",exchange:"NSE",producttype:"INTRADAY",duration:"DAY",price:0,squareoff:"0",stoploss:"0",ordertype:"STOPLOSS_MARKET",variety:"STOPLOSS"};console.log("SLM option data",a),T.placeOrder(a).then(function(a){var n=K(a);n.status&&"SUCCESS"===n.message&&(t.speckIt("hey Vijay, "+e.tradingsymbol+" stop loss order placed"),document.getElementById("orderRefresh")&&document.getElementById("orderRefresh").click(),t.updateOrderList())})}},gt=a(23),ut=a.n(gt),dt=Object(U.a)(function(e){return{root:{display:"flex"},endMenu:{display:"flex",flexDirection:"row reverse"},appBar:{transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{width:"calc(100% - ".concat(240,"px)"),marginLeft:240,transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen})},menuButton:{marginRight:e.spacing(2)},hide:{display:"none"},drawer:{width:240,flexShrink:0},drawerPaper:{width:240},drawerHeader:Object(m.a)({display:"flex",alignItems:"center",padding:"0 8px"},e.mixins.toolbar,{justifyContent:"flex-end"}),content:{flexGrow:1,padding:e.spacing(3),transition:e.transitions.create("margin",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),marginLeft:-240},contentShift:{transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginLeft:0}}});function ht(e){var t=l.a.useState({buyFlag:!0,sellFlag:!0,searchSymbol:""}),a=Object(ne.a)(t,2),n=a[0],r=a[1],o=dt(),i=Object(re.a)(),s=l.a.useState(!1),c=Object(ne.a)(s,2),g=c[0],u=c[1];function d(e){r(Object(m.a)({},n,Object(y.a)({},"buyFlag",e.status))),r(Object(m.a)({},n,Object(y.a)({},"sellFlag",e.status))),r(Object(m.a)({},n,Object(y.a)({},"searchSymbol","")))}function h(e){if(n.token&&n.searchSymbol){if("BUY"==e){r(Object(m.a)({},n,Object(y.a)({},"buyFlag",!1)));var t={token:n.token,symbol:n.searchSymbol,qtyToTake:n.qtyToTake};mt.historyWiseOrderPlace(t,"BUY","no",d)}if("SELL"==e){r(Object(m.a)({},n,Object(y.a)({},"sellFlag",!1)));t={token:n.token,symbol:n.searchSymbol,qtyToTake:n.qtyToTake};mt.historyWiseOrderPlace(t,"SELL","no",d)}}else G.showError("Type Symbol!!!")}var p=localStorage.getItem("userProfile");return p=p&&JSON.parse(p),l.a.createElement("div",{className:o.root},l.a.createElement(H.a,null),l.a.createElement(D.a,{position:"fixed",className:Object(le.a)(o.appBar,Object(y.a)({},o.appBarShift,g))},l.a.createElement(P.a,null,l.a.createElement(ce.a,{"aria-label":"open drawer",onClick:function(){u(!0)},edge:"start",className:Object(le.a)(o.menuButton,g&&o.hide)},l.a.createElement(ge.a,null)),l.a.createElement(M.a,{justify:"space-between",container:!0},l.a.createElement(M.a,{item:!0},l.a.createElement(B.a,{href:"/mtrade/#/home"},l.a.createElement("img",{alt:"logo",style:{width:"125px"},src:N.a}))),l.a.createElement(M.a,{item:!0},l.a.createElement(M.a,{justify:"space-between",container:!0,spacing:2},l.a.createElement(M.a,{item:!0},l.a.createElement(W.a,{style:{marginTop:"20px"},variant:"h6",noWrap:!0},l.a.createElement("span",{id:"niftySpid",onClick:function(){return e.LoadSymbolDetails("NIFTY")}}," "),"  \xa0\xa0  ",l.a.createElement("span",{id:"bankniftySpid",onClick:function(){return e.LoadSymbolDetails("BANKNIFTY")}}," "))),l.a.createElement(M.a,{item:!0},l.a.createElement(Y.a,{label:"Type full Symbol",name:"searchSymbol",value:n.searchSymbol,onChange:function(e){r(Object(m.a)({},n,Object(y.a)({},"searchSymbol",e.target.value))),T.autoCompleteSearch(e.target.value).then(function(t){var a=t.data;if(e.target.value){var l,o=e.target.value.toUpperCase()+"-EQ",i=a.filter(function(e){return"NSE"===e.exch_seg&&"1"===e.lotsize&&e.symbol===o});i.length&&r(Object(m.a)({},n,(l={},Object(y.a)(l,"searchSymbol",i[0].symbol),Object(y.a)(l,"token",i[0].token),l)))}})}})),l.a.createElement(M.a,{item:!0},l.a.createElement(Y.a,{label:"Qty",style:{width:"50px"},type:"number",name:"qtyToTake",value:n.qtyToTake,onChange:function(e){r(Object(m.a)({},n,Object(y.a)({},"qtyToTake",e.target.value)))}})),l.a.createElement(M.a,{item:!0},n.buyFlag?l.a.createElement(B.a,{variant:"contained",color:"primary",style:{marginLeft:"10px",marginTop:"10px"},onClick:function(){return h("BUY")}},"Buy"):l.a.createElement(ut.a,null)),l.a.createElement(M.a,{item:!0},n.sellFlag?l.a.createElement(B.a,{variant:"contained",color:"secondary",style:{marginLeft:"10px",marginTop:"10px"},onClick:function(){return h("SELL")}},"SELL"):l.a.createElement(ut.a,null)))),l.a.createElement(M.a,{item:!0},l.a.createElement(M.a,{container:!0,spacing:1,direction:"row"},l.a.createElement(M.a,{item:!0},l.a.createElement(B.a,{variant:"outlined",target:"_blank",color:"primary",href:"/mtrade/#/order-watchlist"},"Option ",l.a.createElement(Pe.a,null))),l.a.createElement(M.a,{item:!0},l.a.createElement(B.a,{variant:"outlined",target:"_blank",color:"primary",href:"/mtrade/#/sector-heat-map2"},"Hit Map ",l.a.createElement(Pe.a,null))),l.a.createElement(M.a,{item:!0},l.a.createElement(B.a,{variant:"outlined",color:"primary",target:"_blank",href:"/mtrade/#/find-fast-movement"},"Fast Move ",l.a.createElement(Pe.a,null))),l.a.createElement(M.a,{item:!0},l.a.createElement(B.a,{variant:"contained",autoFocus:!0,href:"/mtrade/#/position",color:"primary"},"Position")),l.a.createElement(M.a,{item:!0},l.a.createElement(B.a,{variant:"contained",autoFocus:!0,href:"/mtrade/#/home",color:"primary"},"Home"))))))),l.a.createElement(oe.a,{className:o.drawer,variant:"persistent",anchor:"left",open:g,classes:{paper:o.drawerPaper}},l.a.createElement("div",{className:o.drawerHeader},l.a.createElement(Ae,null),p&&p.name?p.name.split(" ")[0]:"","(",p&&p.clientcode?p.clientcode:"",")",l.a.createElement(ce.a,{onClick:function(){u(!1)}},"ltr"===i.direction?l.a.createElement(de.a,{style:{color:"gray"}}):l.a.createElement(pe.a,{style:{color:"gray"}}))),l.a.createElement(se.a,null),l.a.createElement(ie.a,null,Ie),l.a.createElement(se.a,null),l.a.createElement(ie.a,null,Te)),l.a.createElement("main",{className:Object(le.a)(o.content,Object(y.a)({},o.contentShift,g))},l.a.createElement("div",{className:o.drawerHeader})))}var pt=a(238),ft=a(236),yt=a(496);var bt=function(e){var t=new Date;t.setHours(9,0,0,0),t.setMinutes(15,0,0,0);var a=l.a.useState(t),n=Object(ne.a)(a,2),r=n[0],o=n[1],i=new Date;i.setHours(15,0,0,0),i.setMinutes(30,0,0,0);var s=l.a.useState(i),c=Object(ne.a)(s,2),m=c[0],g=c[1];return l.a.createElement(ft.b,{utils:pt.a},l.a.createElement(M.a,{containers:!0},l.a.createElement(yt.a,{margin:"normal",style:{width:"140px"},id:"date-picker-dialog",label:"Start Date",format:"dd-MM-yyyy",value:r,onChange:function(t){o(t),e.callbackFromParent.myCallback(t,"START_DATE")},KeyboardButtonProps:{"aria-label":"change date"}}),l.a.createElement(yt.a,{style:{width:"140px"},margin:"normal",id:"date-picker-dialog",label:"End Date",format:"dd-MM-yyyy",value:m,onChange:function(t){g(t),e.callbackFromParent.myCallback(t,"END_DATE")},KeyboardButtonProps:{"aria-label":"change date"}})))},Et=a(239),St=a(494),vt=a(497),kt=a(473),wt=a(498),Ct=a(493),Lt=a(153),xt=a(91),It=a(86),Tt=a.n(It),Dt=a(146);function Pt(e){var t=l.a.useState(!1),a=Object(ne.a)(t,2),n=(a[0],a[1],document.createElement("script"));return n.setAttribute("type","text/javascript"),n.setAttribute("src","https://unpkg.com/lightweight-charts@3.4.0/dist/lightweight-charts.standalone.production.js"),document.getElementsByTagName("head")[0].appendChild(n),setTimeout(function(){var t=window.LightweightCharts.createChart(document.getElementById("chart"),{width:600,height:300,rightPriceScale:{scaleMargins:{top:.3,bottom:.25},borderVisible:!1},layout:{backgroundColor:"white",textColor:"#d1d4dc"},grid:{vertLines:{color:"rgba(42, 46, 57, 0)"},horzLines:{color:"rgba(42, 46, 57, 0.6)"}}});t.addHistogramSeries({color:"#26a69a",priceFormat:{type:"volume"},priceScaleId:"",scaleMargins:{top:.8,bottom:0}}).setData(e.ChartData.volumeData);var a=t.addCandlestickSeries({upColor:"green",downColor:"red",borderDownColor:"red",borderUpColor:"green",wickDownColor:"red",wickUpColor:"green"}),n=[{time:"2018-10-19",open:180.34,high:180.99,low:178.57,close:179.85},{time:"2018-10-22",open:180.82,high:181.4,low:177.56,close:178.75},{time:"2018-10-23",open:175.77,high:179.49,low:175.44,close:178.53},{time:"2018-10-24",open:178.58,high:182.37,low:176.31,close:176.97},{time:"2018-10-25",open:177.52,high:180.5,low:176.83,close:179.07},{time:"2018-10-26",open:176.88,high:177.34,low:170.91,close:172.23},{time:"2018-10-29",open:173.74,high:175.99,low:170.95,close:173.2},{time:"2018-10-30",open:173.16,high:176.43,low:172.64,close:176.24},{time:"2018-10-31",open:177.98,high:178.85,low:175.59,close:175.88},{time:"2018-11-01",open:176.84,high:180.86,low:175.9,close:180.46},{time:"2018-11-02",open:182.47,high:183.01,low:177.39,close:179.93},{time:"2018-11-05",open:181.02,high:182.41,low:179.3,close:182.19},{time:"2018-11-06",open:181.93,high:182.65,low:180.05,close:182.01},{time:"2018-11-07",open:183.79,high:187.68,low:182.06,close:187.23},{time:"2018-11-08",open:187.13,high:188.69,low:185.72,close:188},{time:"2018-11-09",open:188.32,high:188.48,low:184.96,close:185.99},{time:"2018-11-12",open:185.23,high:186.95,low:179.02,close:179.43},{time:"2018-11-13",open:177.3,high:181.62,low:172.85,close:179},{time:"2018-11-14",open:182.61,high:182.9,low:179.15,close:179.9},{time:"2018-11-15",open:179.01,high:179.67,low:173.61,close:177.36},{time:"2018-11-16",open:173.99,high:177.6,low:173.51,close:177.02},{time:"2018-11-19",open:176.71,high:178.88,low:172.3,close:173.59},{time:"2018-11-20",open:169.25,high:172,low:167,close:169.05},{time:"2018-11-21",open:170,high:170.93,low:169.15,close:169.3},{time:"2018-11-23",open:169.39,high:170.33,low:168.47,close:168.85},{time:"2018-11-26",open:170.2,high:172.39,low:168.87,close:169.82},{time:"2018-11-27",open:169.11,high:173.38,low:168.82,close:173.22},{time:"2018-11-28",open:172.91,high:177.65,low:170.62,close:177.43},{time:"2018-11-29",open:176.8,high:177.27,low:174.92,close:175.66},{time:"2018-11-30",open:175.75,high:180.37,low:175.11,close:180.32},{time:"2018-12-03",open:183.29,high:183.5,low:179.35,close:181.74},{time:"2018-12-04",open:181.06,high:182.23,low:174.55,close:175.3},{time:"2018-12-06",open:173.5,high:176.04,low:170.46,close:175.96},{time:"2018-12-07",open:175.35,high:178.36,low:172.24,close:172.79},{time:"2018-12-10",open:173.39,high:173.99,low:167.73,close:171.69},{time:"2018-12-11",open:174.3,high:175.6,low:171.24,close:172.21},{time:"2018-12-12",open:173.75,high:176.87,low:172.81,close:174.21},{time:"2018-12-13",open:174.31,high:174.91,low:172.07,close:173.87},{time:"2018-12-14",open:172.98,high:175.14,low:171.95,close:172.29},{time:"2018-12-17",open:171.51,high:171.99,low:166.93,close:167.97},{time:"2018-12-18",open:168.9,high:171.95,low:168.5,close:170.04},{time:"2018-12-19",open:170.92,high:174.95,low:166.77,close:167.56},{time:"2018-12-20",open:166.28,high:167.31,low:162.23,close:164.16},{time:"2018-12-21",open:162.81,high:167.96,low:160.17,close:160.48},{time:"2018-12-24",open:160.16,high:161.4,low:158.09,close:158.14},{time:"2018-12-26",open:159.46,high:168.28,low:159.44,close:168.28},{time:"2018-12-27",open:166.44,high:170.46,low:163.36,close:170.32},{time:"2018-12-28",open:171.22,high:173.12,low:168.6,close:170.22},{time:"2018-12-31",open:171.47,high:173.24,low:170.65,close:171.82},{time:"2019-01-02",open:169.71,high:173.18,low:169.05,close:172.41},{time:"2019-01-03",open:171.84,high:171.84,low:168.21,close:168.61},{time:"2019-01-04",open:170.18,high:174.74,low:169.52,close:173.62},{time:"2019-01-07",open:173.83,high:178.18,low:173.83,close:177.04},{time:"2019-01-08",open:178.57,high:179.59,low:175.61,close:177.89},{time:"2019-01-09",open:177.87,high:181.27,low:177.1,close:179.73},{time:"2019-01-10",open:178.03,high:179.24,low:176.34,close:179.06},{time:"2019-01-11",open:177.93,high:180.26,low:177.12,close:179.41},{time:"2019-01-14",open:177.59,high:179.23,low:176.9,close:178.81},{time:"2019-01-15",open:176.08,high:177.82,low:175.2,close:176.47},{time:"2019-01-16",open:177.09,high:177.93,low:175.86,close:177.04},{time:"2019-01-17",open:174.01,high:175.46,low:172,close:174.87},{time:"2019-01-18",open:176.98,high:180.04,low:176.18,close:179.58},{time:"2019-01-22",open:177.49,high:178.6,low:175.36,close:177.11},{time:"2019-01-23",open:176.59,high:178.06,low:174.53,close:176.89},{time:"2019-01-24",open:177,high:177.53,low:175.3,close:177.29},{time:"2019-01-25",open:179.78,high:180.87,low:178.61,close:180.4},{time:"2019-01-28",open:178.97,high:179.99,low:177.41,close:179.83},{time:"2019-01-29",open:178.96,high:180.15,low:178.09,close:179.69},{time:"2019-01-30",open:180.47,high:184.2,low:179.78,close:182.18},{time:"2019-01-31",open:181.5,high:184.67,low:181.06,close:183.53},{time:"2019-02-01",open:184.03,high:185.15,low:182.83,close:184.37},{time:"2019-02-04",open:184.3,high:186.43,low:183.84,close:186.43},{time:"2019-02-05",open:186.89,high:186.99,low:184.69,close:186.39},{time:"2019-02-06",open:186.69,high:186.69,low:184.06,close:184.72},{time:"2019-02-07",open:183.74,high:184.92,low:182.45,close:184.07},{time:"2019-02-08",open:183.05,high:184.58,low:182.72,close:184.54},{time:"2019-02-11",open:185,high:185.42,low:182.75,close:182.92},{time:"2019-02-12",open:183.84,high:186.4,low:183.52,close:185.52},{time:"2019-02-13",open:186.3,high:188.68,low:185.92,close:188.41},{time:"2019-02-14",open:187.5,high:188.93,low:186,close:187.71},{time:"2019-02-15",open:189.87,high:192.62,low:189.05,close:192.39},{time:"2019-02-19",open:191.71,high:193.19,low:191.28,close:192.33},{time:"2019-02-20",open:192.39,high:192.4,low:191.11,close:191.85},{time:"2019-02-21",open:191.85,high:192.37,low:190.61,close:191.82},{time:"2019-02-22",open:191.69,high:192.54,low:191.62,close:192.39},{time:"2019-02-25",open:192.75,high:193.42,low:189.96,close:189.98},{time:"2019-02-26",open:185.59,high:188.47,low:182.8,close:188.3},{time:"2019-02-27",open:187.9,high:188.5,low:183.21,close:183.67},{time:"2019-02-28",open:183.6,high:185.19,low:183.11,close:185.14},{time:"2019-03-01",open:185.82,high:186.56,low:182.86,close:185.17},{time:"2019-03-04",open:186.2,high:186.24,low:182.1,close:183.81},{time:"2019-03-05",open:184.24,high:185.12,low:183.25,close:184},{time:"2019-03-06",open:184.53,high:184.97,low:183.84,close:184.45},{time:"2019-03-07",open:184.39,high:184.62,low:181.58,close:182.51},{time:"2019-03-08",open:181.49,high:181.91,low:179.52,close:181.23},{time:"2019-03-11",open:182,high:183.2,low:181.2,close:182.44},{time:"2019-03-12",open:183.43,high:184.27,low:182.33,close:184},{time:"2019-03-13",open:183.24,high:183.78,low:181.08,close:181.14},{time:"2019-03-14",open:181.28,high:181.74,low:180.5,close:181.61},{time:"2019-03-15",open:182.3,high:182.49,low:179.57,close:182.23},{time:"2019-03-18",open:182.53,high:183.48,low:182.33,close:183.42},{time:"2019-03-19",open:184.19,high:185.82,low:183.48,close:184.13},{time:"2019-03-20",open:184.3,high:187.12,low:183.43,close:186.1},{time:"2019-03-21",open:185.5,high:190,low:185.5,close:189.97},{time:"2019-03-22",open:189.31,high:192.05,low:188.67,close:188.75},{time:"2019-03-25",open:188.75,high:191.71,low:188.51,close:189.68},{time:"2019-03-26",open:190.69,high:192.19,low:188.74,close:189.34},{time:"2019-03-27",open:189.65,high:191.61,low:188.39,close:189.25},{time:"2019-03-28",open:189.91,high:191.4,low:189.16,close:190.06},{time:"2019-03-29",open:190.85,high:192.04,low:190.14,close:191.89},{time:"2019-04-01",open:192.99,high:195.9,low:192.85,close:195.64},{time:"2019-04-02",open:195.5,high:195.5,low:194.01,close:194.31},{time:"2019-04-03",open:194.98,high:198.78,low:194.11,close:198.61},{time:"2019-04-04",open:199,high:200.49,low:198.02,close:200.45},{time:"2019-04-05",open:200.86,high:203.13,low:200.61,close:202.06},{time:"2019-04-08",open:201.37,high:203.79,low:201.24,close:203.55},{time:"2019-04-09",open:202.26,high:202.71,low:200.46,close:200.9},{time:"2019-04-10",open:201.26,high:201.6,low:198.02,close:199.43},{time:"2019-04-11",open:199.9,high:201.5,low:199.03,close:201.48},{time:"2019-04-12",open:202.13,high:204.26,low:202.13,close:203.85},{time:"2019-04-15",open:204.16,high:205.14,low:203.4,close:204.86},{time:"2019-04-16",open:205.25,high:205.99,low:204.29,close:204.47},{time:"2019-04-17",open:205.34,high:206.84,low:205.32,close:206.55},{time:"2019-04-18",open:206.02,high:207.78,low:205.1,close:205.66},{time:"2019-04-22",open:204.11,high:206.25,low:204,close:204.78},{time:"2019-04-23",open:205.14,high:207.33,low:203.43,close:206.05},{time:"2019-04-24",open:206.16,high:208.29,low:205.54,close:206.72},{time:"2019-04-25",open:206.01,high:207.72,low:205.06,close:206.5},{time:"2019-04-26",open:205.88,high:206.14,low:203.34,close:203.61},{time:"2019-04-29",open:203.31,high:203.8,low:200.34,close:202.16},{time:"2019-04-30",open:201.55,high:203.75,low:200.79,close:203.7},{time:"2019-05-01",open:203.2,high:203.52,low:198.66,close:198.8},{time:"2019-05-02",open:199.3,high:201.06,low:198.8,close:201.01},{time:"2019-05-03",open:202,high:202.31,low:200.32,close:200.56},{time:"2019-05-06",open:198.74,high:199.93,low:198.31,close:199.63},{time:"2019-05-07",open:196.75,high:197.65,low:192.96,close:194.77},{time:"2019-05-08",open:194.49,high:196.61,low:193.68,close:195.17},{time:"2019-05-09",open:193.31,high:195.08,low:191.59,close:194.58},{time:"2019-05-10",open:193.21,high:195.49,low:190.01,close:194.58},{time:"2019-05-13",open:191,high:191.66,low:189.14,close:190.34},{time:"2019-05-14",open:190.5,high:192.76,low:190.01,close:191.62},{time:"2019-05-15",open:190.81,high:192.81,low:190.27,close:191.76},{time:"2019-05-16",open:192.47,high:194.96,low:192.2,close:192.38},{time:"2019-05-17",open:190.86,high:194.5,low:190.75,close:192.58},{time:"2019-05-20",open:191.13,high:192.86,low:190.61,close:190.95},{time:"2019-05-21",open:187.13,high:192.52,low:186.34,close:191.45},{time:"2019-05-22",open:190.49,high:192.22,low:188.05,close:188.91},{time:"2019-05-23",open:188.45,high:192.54,low:186.27,close:192},{time:"2019-05-24",open:192.54,high:193.86,low:190.41,close:193.59}];a.setData(n);for(var l=[n[n.length-19],n[n.length-39]],r=0,o=1;o<l.length;o++)l[o].high<l[r].high&&(r=o);var i=[];for(o=0;o<l.length;o++)o!==r?i.push({time:l[o].time,position:"aboveBar",color:"#e91e63",shape:"arrowDown",text:"Sell @ "+Math.floor(l[o].high+2)}):i.push({time:l[o].time,position:"belowBar",color:"#2196F3",shape:"arrowUp",text:"Buy @ "+Math.floor(l[o].low-2)});i.push({time:n[n.length-48].time,position:"aboveBar",color:"#f68410",shape:"circle",text:"D"}),a.setMarkers(i);var s=function(e,t){for(var a=function(e){for(var t=0,a=0;a<e.length;a++)t+=e[a].close;return t/e.length},n=[],l=t-1,r=e.length;l<r;l++){var o=a(e.slice(l-t+1,l));n.push({time:e[l].time,value:o})}return n}(n,10);t.addLineSeries({color:"rgba(4, 111, 232, 1)",lineWidth:2}).setData(s)},1e3),l.a.createElement("div",{id:"chart"})}var Ot=a(501),Nt=a(491),Ft=a(492),Mt=a(149),At=a.n(Mt),Bt=Object(U.a)(function(e){return{root:{width:"100%"},heading:{fontSize:e.typography.pxToRem(15),fontWeight:e.typography.fontWeightRegular}}});function Ht(e){var t=Bt(),a=e.data;return l.a.createElement("div",{className:t.root},l.a.createElement(Ot.a,{defaultExpanded:!1},l.a.createElement(Nt.a,{expandIcon:l.a.createElement(At.a,null),"aria-controls":"panel1a-content",id:"panel1a-header"},l.a.createElement(W.a,null," ",a.title," (",a.list.length,")")),l.a.createElement(Ft.a,null,l.a.createElement("div",{style:{overflowY:"scroll",width:"100%",height:"50vh"}},a&&a.list.length?a.list.map(function(e,t){return l.a.createElement(l.a.Fragment,null,e?l.a.createElement(fe.a,{button:!0,style:{fontSize:"12px",padding:"0px",paddingLeft:"5px",paddingRight:"5px"}},l.a.createElement(be.a,{style:{color:e.nc&&0!=e.nc?e.nc>0?"#20d020":"#e66e6e":"",background:e.highlisht?"#375a00":""},onClick:function(){return a.LoadSymbolDetails(e.symbol)},primary:e.symbol})," ",e.ltp," (",e.nc,"%)"):"")}):""))))}var Yt=Object(U.a)(function(e){return{root:{width:"100%"},heading:{fontSize:e.typography.pxToRem(15),fontWeight:e.typography.fontWeightRegular}}});function jt(e){var t=Yt(),a=e.data;return l.a.createElement("div",{className:t.root},l.a.createElement(Ot.a,{defaultExpanded:!1},l.a.createElement(Nt.a,{expandIcon:l.a.createElement(At.a,null),"aria-controls":"panel1a-content",id:"panel1a-header"},l.a.createElement(W.a,null," ",a.title," (",a.list&&a.list.length,")")),l.a.createElement(Ft.a,null,l.a.createElement("div",{style:{overflowY:"scroll",width:"100%",height:"50vh"}},a&&a.list?a.list.map(function(e,t){return l.a.createElement(l.a.Fragment,null,e?l.a.createElement(fe.a,{button:!0,style:{fontSize:"10px",padding:"0px",paddingLeft:"5px",paddingRight:"5px"}},l.a.createElement(be.a,{style:{color:e.nc&&0!=e.nc?e.nc>0?"#20d020":"#e66e6e":"",fontSize:"10px"},onClick:function(){return a.LoadSymbolDetails(e.symbol)},primary:e.symbol+" "+e.orderType})," ",l.a.createElement("span",{style:{fontSize:"14px"}},e.ltp," (",e.nc,"%)  ",l.a.createElement("br",null)," At ",e.foundAt," ")):"")}):""))))}var Rt=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(S.a)(this,Object(v.a)(t).call(this,e))).onChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value));var t=e.target.value;T.autoCompleteSearch(t).then(function(e){var t=e.data;localStorage.setItem("autoSearchTemp",JSON.stringify(t)),a.setState({autoSearchList:t})})},a.onInputChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value),function(){this.state.tradingsymbol&&this.showStaticChart(this.state.symboltoken)})},a.onChangePattern=function(e){if(a.setState(Object(y.a)({},e.target.name,e.target.value)),"NR4_Daywide_daterage"==e.target.value){var t=localStorage.getItem("backTestResultDateRange")&&JSON.parse(localStorage.getItem("backTestResultDateRange"));a.setState({dateAndTypeKeys:Object.keys(t||{}),backTestResultDateRange:t})}},a.onChangeWatchlist=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value));var t=a.state.staticData;a.setState({symbolList:t[e.target.value]},function(){this.checkOpenEqualToLow(),this.setState({cursor:""})}),"selectall"==e.target.value&&a.setState({symbolList:localStorage.getItem("watchList")&&JSON.parse(localStorage.getItem("watchList"))},function(){this.checkOpenEqualToLow(),this.setState({cursor:""})})},a.checkOpenEqualToLow=Object(ae.a)(ee.a.mark(function e(){var t,n,l,r;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.setState((t={openEqualHighList:[],openEqualLowList:[]},Object(y.a)(t,"openEqualLowList",[]),Object(y.a)(t,"advanceShareCount",0),Object(y.a)(t,"declineShareCount",0),Object(y.a)(t,"UnchangeShareCount",0),Object(y.a)(t,"volumeCrossedList",[]),t)),n=ee.a.mark(function e(t){var n;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.state.symbolList[t],r={exchange:n.exch_seg,tradingsymbol:n.symbol,symboltoken:n.token},T.getLTP(r).then(function(e){var l=K(e,"noPop"),r=l&&l.data;if(r){var o=(100*(r.ltp-r.close)/r.close).toFixed(2);if(r.nc=o,r.symbol=n.symbol,a.state.symbolList[t].ltp=r.ltp,a.state.symbolList[t].nc=o,r&&r.open==r.low)console.log("o=l",r),a.state.openEqualLowList.filter(function(e){return e.symboltoken==n.token}).length||a.setState({openEqualLowList:[].concat(Object(te.a)(a.state.openEqualLowList),[r])});if(r&&r.open==r.high)console.log("o=h",r),a.state.openEqualHighList.filter(function(e){return e.symboltoken==n.token}).length||a.setState({openEqualHighList:[].concat(Object(te.a)(a.state.openEqualHighList),[r])});r.perChange>0?a.setState({advanceShareCount:a.state.advanceShareCount+1}):r.perChange<0?a.setState({declineShareCount:a.state.declineShareCount+1}):a.setState({UnchangeShareCount:a.state.UnchangeShareCount+1}),a.state.symbolList&&a.state.symbolList.sort(function(e,t){return t.nc-e.nc}),a.setState({symbolList:a.state.symbolList,tradingsymbol:n.symbol,symboltoken:n.token}),a.checkSlowMotionStock(n.token,n)}}),e.next=5,new Promise(function(e){return setTimeout(e,310)});case 5:case"end":return e.stop()}},e)}),l=0;case 3:if(!(l<a.state.symbolList.length)){e.next=8;break}return e.delegateYield(n(l),"t0",5);case 5:l++,e.next=3;break;case 8:case"end":return e.stop()}},e)})),a.myCallback=function(e,t){"START_DATE"===t?a.setState({startDate:e}):"END_DATE"===t&&a.setState({endDate:e})},a.getLTP=function(){var e={exchange:"NSE",tradingsymbol:a.state.tradingsymbol,symboltoken:a.state.symboltoken};T.getLTP(e).then(function(e){var t=K(e,"noPop"),n=t&&t.data;a.setState({InstrumentLTP:n}),n&&n.ltp&&a.setState({InstrumentPerChange:(100*(n.ltp-n.close)/n.close).toFixed(2)})})},a.decodeWebsocketData=function(e){var t=[];try{for(var a=0;a<e.length;a++)t.push(String.fromCharCode(e[a]))}catch(n){}return t.join("")},a.makeConnection=function(e){var t='{"task":"cn","channel":"NONLM","token":"'+a.state.feedToken+'","user": "'+a.state.clientcode+'","acctid":"'+a.state.clientcode+'"}';e.send(t),a.updateSocketWatch(e)},a.updateSocketWatch=function(e){var t=a.state.symbolList.map(function(e){return"nse_cm|"+e.token}),n={task:"mw",channel:t=t.join("&"),token:a.state.feedToken,user:a.state.clientcode,acctid:a.state.clientcode};console.log("updated ws watchlisht",a.state.selectedWatchlist,n),e.send(JSON.stringify(n))},a.updateSocketDetails=function(e){e.onopen=function(t){a.makeConnection(e),a.updateSocketWatch(e)},e.onmessage=function(e){var t=window.atob(e.data),n=a.decodeWebsocketData(Tt.a.inflate(t)),l=JSON.parse(n),r=a.state.symbolList;a.state.symbolList&&a.state.symbolList.forEach(function(e,t){var a=l.filter(function(t){return t.tk==e.token});a.length>0&&a[0].ltp&&a[0].nc&&(r[t].ltp=a[0].ltp,r[t].nc=a[0].nc)}),r&&r.sort(function(e,t){return t.nc-e.nc}),a.setState({symbolList:r})},e.onerror=function(e){console.log("socket error",e)},setInterval(function(){var t='{"task":"hb","channel":"","token":"'+a.state.feedToken+'","user": "'+a.state.clientcode+'","acctid":"'+a.state.clientcode+'"}';e.send(t)},59e3)},a.stopBacktesting=function(){a.setState({stopScaningFlag:!0})},a.backTestAnyPattern=Object(ae.a)(ee.a.mark(function e(){var t,n,l,r,o,i,s,c,m;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.setState({backTestResult:[],backTestFlag:!1}),console.log("this.state.patternType",a.state.patternType),a.state.patternType){e.next=5;break}return G.showError("Select pattern type"),e.abrupt("return");case 5:if("NR4"!==a.state.patternType){e.next=8;break}return a.backTestNR4(),e.abrupt("return");case 8:if("NR4ForNextDay"!==a.state.patternType){e.next=11;break}return a.NR4ForNextDay(),e.abrupt("return");case 11:if("NR4_SameDay"!==a.state.patternType){e.next=14;break}return a.backTestNR4SameDay(),e.abrupt("return");case 14:if("NR4_Daywide_daterage"!==a.state.patternType){e.next=31;break}t=rt(a.state.startDate),n=rt(a.state.endDate),l=t,r=n;case 19:if(!l.isSameOrBefore(r,"day")){e.next=29;break}if(console.log("Loop at ".concat(l.format("DD-MM-YYYY"))),a.backTestNR4DatewiseRange(l),!a.state.stopScaningFlag){e.next=24;break}return e.abrupt("break",29);case 24:return e.next=26,new Promise(function(e){return setTimeout(e,310*a.state.symbolList.length)});case 26:l.add(1,"days"),e.next=19;break;case 29:return a.setState({backTestFlag:!0,stopScaningFlag:!1}),e.abrupt("return");case 31:a.setState({backTestResult:[],backTestFlag:!1}),console.log("pattername",a.state.patternType),o=a.state.symbolList,i=1,s=ee.a.mark(function e(t){var n;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=o[t],m={exchange:"NSE",symboltoken:n.token,interval:"FIFTEEN_MINUTE",fromdate:rt(a.state.startDate).format("YYYY-MM-DD HH:mm"),todate:rt(new Date).format("YYYY-MM-DD HH:mm")},T.getHistoryData(m).then(function(e){var t=K(e,"noPop");if(t&&t.data&&t.data.length)for(var l=t.data,r=0;r<l.length-35;r++){var o=l.slice(r,r+10),s=l.slice(r+10,r+35);if(console.log("\n"),o.length>=10&&new Date(l[r][0]).toLocaleTimeString()<"14:15:00")switch(a.state.patternType){case"TweezerTop":a.backtestTweezerTop(o,n.symbol,s);break;case"TweezerBottom":a.backtestTweezerBottom(o,n.symbol,s)}i+=l.length}else console.log(" candle data emply")}),e.next=5,new Promise(function(e){return setTimeout(e,300)});case 5:a.setState({stockTesting:t+1+". "+n.symbol,runningTest:i});case 6:case"end":return e.stop()}},e)}),c=0;case 37:if(!(c<o.length)){e.next=42;break}return e.delegateYield(s(c),"t0",39);case 39:c++,e.next=37;break;case 42:case"end":return e.stop()}},e)})),a.NR4ForNextDay=Object(ae.a)(ee.a.mark(function e(){var t,n,l,r,o,i;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({FoundPatternList:[],backTestFlag:!1}),t=a.state.symbolList,1,0,n=ee.a.mark(function e(n){var l;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(l=t[n],!a.state.stopScaningFlag){e.next=3;break}return e.abrupt("return","break");case 3:return a.setState({stockTesting:n+1+". "+l.symbol}),r=rt.duration("240:00:00"),o=rt(a.state.endDate).subtract(r),i={exchange:"NSE",symboltoken:l.token,interval:"ONE_DAY",fromdate:rt(o).format("YYYY-MM-DD HH:mm"),todate:rt(a.state.endDate).format("YYYY-MM-DD HH:mm")},T.getHistoryData(i).then(function(e){var t=K(e,"noPop");if(t&&t.data&&t.data.length){var n=t.data;n.reverse();var r=n.slice(0,4);if(r.length>=4){var o=[],i=[];r.forEach(function(e){o.push(e[2]-e[3]),i.push([e[0],e[1],e[2],e[3],e[4]])});var s=o[0],c=0;if(o.forEach(function(e){s<=e&&(s=e,c+=1)}),4==c){var m=r[0],g=n[0];console.log(l.symbol,r,o,c,g);var u=(m[2]+m[2]/100/10).toFixed(2),d=(m[3]-m[3]/100/10).toFixed(2),h={foundAt:new Date(m[0]).toString().substr(0,25),symbol:l.symbol,token:l.token,pattenName:"NR4",SellAt:d,high:m[2],low:m[3],BuyAt:u,candleChartData:i,close:m[4]};a.nr4CheckPastPerfommance(l.token,h)}}}else console.log(l.symbol," candle data emply")}).catch(function(e){G.showError(l.symbol+" Candle data not found!")}),e.next=10,new Promise(function(e){return setTimeout(e,350)});case 10:case"end":return e.stop()}},e)}),l=0;case 5:if(!(l<t.length)){e.next=13;break}return e.delegateYield(n(l),"t0",7);case 7:if("break"!==e.t0){e.next=10;break}return e.abrupt("break",13);case 10:l++,e.next=5;break;case 13:a.setState({backTestFlag:!0,stopScaningFlag:!1});case 14:case"end":return e.stop()}},e)})),a.findShortTraadeOnNextDay=function(e,t,n,l){var r=t[3]-t[3]/100/10,o=r+1*r/100,i=[],s=!0,c={},m="",g=l[0][3];if(console.log(e.symbol,"result candle",l),l&&l.length){for(var u=0;u<l.length;u++){var d=l[u];i.push([new Date(d[0]).getTime(),d[1],d[2],d[3],d[4]]),d[2]<g&&(g=d[3])}for(var h=0;h<l.length;h++){m=l[h],s&&m[3]<r&&(console.log(e.symbol,"taken short enty",m[3]),c={foundAt:"Short-"+new Date(m[0]).toLocaleString(),symbol:e.symbol,sellEntyPrice:r,stopLoss:o,brokerageCharges:.06,quantity:Math.floor(1e5/r),candleChartData:n},s=!1);var p=100*(r-m[3])/r;if(console.log(e.symbol,"perChange",p),!s&&p>=1){var f=r-1*r/100;c.buyExitPrice=f,c.perChange=p,c.squareOffAt=new Date(m[0]).toLocaleString(),c.exitStatus="Flat_1%_Booked";break}if(console.log(e.symbol,"high",m[2]),!s&&m[2]>=o){var y=100*(r-o)/r;c.buyExitPrice=o,c.perChange=y,c.squareOffAt=new Date(m[0]).toLocaleString(),c.exitStatus="SL_Hit";break}}if(!s&&!c.sellEntyPrice){y=100*(m[4]-r)/r;c.buyExitPrice=m[4],c.perChange=y,c.squareOffAt=new Date(m[0]).toLocaleString(),c.exitStatus="Market_End"}if(!s&&Math.floor(1e5/r)&&c.buyExitPrice){var b=100*(r-g)/r;c.highAndLow=g,c.perChngOnHighLow=b,c.candleChartDataInside=i,a.setState({backTestResult:[].concat(Object(te.a)(a.state.backTestResult),[c])})}}},a.findLongsTraadeOnNextDay=function(e,t,n,l){var r=t[2]+t[2]/100/10,o=r-.3*r/100,i=[],s=!0,c=!0,m=0,g={},u="",d=l[0][2];if(l&&l.length){for(var h=0;h<l.length;h++){var p=l[h];i.push([new Date(p[0]).getTime(),p[1],p[2],p[3],p[4]]),d<l[h][2]&&(d=l[h][2])}for(var f=0;f<l.length;f++){u=l[f],s&&u[2]>r&&(g={foundAt:"Long-"+new Date(u[0]).toLocaleString(),symbol:e.symbol,buyExitPrice:r,stopLoss:o,brokerageCharges:.06,quantity:Math.floor(1e5/r),candleChartData:n},s=!1);var y=100*(u[2]-r)/r;if(!s){if(c&&y>=.7){m+=1;var b=r+.1*r/100;g.sellEntyPrice=b,g.perChange=100*(b-r)/r,g.squareOffAt=new Date(u[0]).toLocaleString(),g.exitStatus="Trail by 0.1% "+m+"time",c=!1}else{var E=g.sellEntyPrice,S=(100*(u[2]-E)/E).toFixed(2),v=g.buyExitPrice,k=(100*(u[2]-v)/v).toFixed(2);if(S>.7)m+=1,b=E+.25*E/100,g.sellEntyPrice=b,g.perChange=100*(b-r)/r,g.squareOffAt=new Date(u[0]).toLocaleString(),g.exitStatus="Trail by 0.25% "+m+"time";else if(k>=.3&&k<=.4){m+=1,b=E+.25*E/100,g.sellEntyPrice=b,g.perChange=100*(b-r)/r,g.squareOffAt=new Date(u[0]).toLocaleString(),g.exitStatus="Min range 0.3 -0.4% "+m+"time";break}}if(u[3]<=g.sellEntyPrice){console.log(e.symbol,"trail hit elementInside[3] <= sellEntyPrice",u[3],g.sellEntyPrice,new Date(u[0]).toLocaleString());break}}if(!s&&u[3]<=o){console.log(e.symbol,"SL hit elementInside[3] <= buyentrySL",u[3],o,new Date(u[0]).toLocaleString());var w=100*(o-r)/r;g.sellEntyPrice=o,g.perChange=w,g.squareOffAt=new Date(u[0]).toLocaleString(),g.exitStatus="SL_Hit";break}}if(!s&&!g.sellEntyPrice){w=100*(u[4]-r)/r;g.buyExitPrice=u[4],g.perChange=w,g.squareOffAt=new Date(u[0]).toLocaleString(),g.exitStatus="Market_End"}if(!s&&Math.floor(1e5/r)&&g.buyExitPrice){var C=100*(d-r)/r;g.highAndLow=d,g.perChngOnHighLow=C,g.candleChartDataInside=i,console.log(e.symbol,"longTradeFound",g),a.setState({backTestResult:[].concat(Object(te.a)(a.state.backTestResult),[g])})}}},a.backTestNR4SameDay=Object(ae.a)(ee.a.mark(function e(){var t,n,l,r,o,i,s,c;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({backTestResult:[],backTestFlag:!1,searchFailed:0}),t=a.state.symbolList,n=1,l=0,r=ee.a.mark(function e(l){var r;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t[l],!a.state.stopScaningFlag){e.next=3;break}return e.abrupt("return","break");case 3:return i=rt.duration("240:00:00"),s=rt(a.state.endDate).subtract(i),c={exchange:"NSE",symboltoken:r.token,interval:"ONE_DAY",fromdate:rt(s).format("YYYY-MM-DD HH:mm"),todate:rt(a.state.endDate).format("YYYY-MM-DD HH:mm")},T.getHistoryData(c).then(function(e){var t=K(e,"noPop");if(t&&t.data&&t.data.length){var l=t.data;l.reverse();var o=l.slice(1,5);if(o.length>=4){var i=[],s=[];o.forEach(function(e){i.push(e[2]-e[3]),s.push([e[0],e[1],e[2],e[3],e[4]])});var c=i[0],m=0;if(i.forEach(function(e){c<=e&&(c=e,m+=1)}),4==m){var g=o[0],u=l[0];s.unshift([u[0],u[1],u[2],u[3],u[4]]),console.log(r.symbol,o,i,m,u);var d=rt(u[0]).set({hour:9,minute:15}),h=rt(u[0]).set({hour:15,minute:30}),p={exchange:"NSE",symboltoken:r.token,interval:"ONE_MINUTE",fromdate:rt(d).format("YYYY-MM-DD HH:mm"),todate:rt(h).format("YYYY-MM-DD HH:mm")};T.getHistoryData(p).then(function(e){var t=K(e,"noPop");t=t&&t.data,a.findLongsTraadeOnNextDay(r,g,s,t)}).catch(function(e){G.showError(r.symbol+" FIVE_MINUTE Candle data not found!"),a.setState({searchFailed:a.state.searchFailed+1})})}}n=n+l.length-35}else console.log(r.symbol," candle data emply"),G.showError(r.symbol+" FIVE_MINUTE candle data emply!"),a.setState({searchFailed:a.state.searchFailed+1})}).catch(function(e){G.showError(r.symbol+" 1 day Candle data not found!"),a.setState({searchFailed:a.state.searchFailed+1})}),e.next=9,new Promise(function(e){return setTimeout(e,305)});case 9:a.setState({stockTesting:l+1+". "+r.symbol,runningTest:n});case 10:case"end":return e.stop()}},e)}),o=0;case 5:if(!(o<t.length)){e.next=13;break}return e.delegateYield(r(o),"t0",7);case 7:if("break"!==e.t0){e.next=10;break}return e.abrupt("break",13);case 10:o++,e.next=5;break;case 13:a.setState({backTestFlag:!0,stopScaningFlag:!1}),console.log("sumPercentage",l);case 15:case"end":return e.stop()}},e)})),a.backTestNR4DatewiseRange=function(){var e=Object(ae.a)(ee.a.mark(function e(t){var n,l,r,o,i,s,c;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({backTestFlag:!1}),n=a.state.symbolList,l=1,0,r=ee.a.mark(function e(r){var o;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n[r],!a.state.stopScaningFlag){e.next=3;break}return e.abrupt("return","break");case 3:return i=rt.duration("240:00:00"),s=rt(t).subtract(i),c={exchange:"NSE",symboltoken:o.token,interval:"ONE_DAY",fromdate:rt(s).format("YYYY-MM-DD HH:mm"),todate:rt(t).format("YYYY-MM-DD HH:mm")},T.getHistoryData(c).then(function(e){var n=K(e,"noPop");if(n&&n.data&&n.data.length){var r=n.data;r.reverse();var i=r.slice(1,5);if(i.length>=4){var s=[],c=[];i.forEach(function(e){s.push(e[2]-e[3]),c.push([e[0],e[1],e[2],e[3],e[4]])});var m=s[0],g=0;if(s.forEach(function(e){m<=e&&(m=e,g+=1)}),4==g){var u=i[0],d=r[0];c.unshift([d[0],d[1],d[2],d[3],d[4]]);var h=t.format("DD-MM-YYYY")+" "+a.state.selectedWatchlist,p=localStorage.getItem("backTestResultDateRange")?JSON.parse(localStorage.getItem("backTestResultDateRange")):{},f=p[h]?p[h]:[];console.log(o.symbol,i,s,g,d);var y=(u[2]+u[2]/100/10).toFixed(2);if(d[2]>y){var b=100*(d[4]-y)/y,E=100*(d[2]-y)/y;b,console.log(o.symbol,u[0],"upside","same day high",u[2],"same day low",u[3],"nextdaylow",d[3],"nextdayhigh",d[2],"next day closing",d[4],b+"%");var S={foundAt:"Long - "+new Date(u[0]).toLocaleString(),symbol:o.symbol,sellEntyPrice:d[4],highAndLow:d[2],stopLoss:u[3],buyExitPrice:y,brokerageCharges:.06,perChange:b.toFixed(2),perChngOnHighLow:E.toFixed(2),squareOffAt:new Date(d[0]).toLocaleString(),quantity:Math.floor(1e4/u[2]),candleChartData:c};Math.floor(1e4/u[2])&&(a.setState({backTestResult:[].concat(Object(te.a)(a.state.backTestResult),[S])}),f.push(S),p[h]=f,localStorage.setItem("backTestResultDateRange",JSON.stringify(p)))}var v=(u[3]-u[3]/100/10).toFixed(2);if(d[3]<v){b=100*(v-d[4])/u[3];var k=100*(v-d[3])/u[3];b,console.log(o.symbol,u[0],"dowside","same day high",u[2],"same day low",u[3],"nextdaylow",d[3],"nextdayhigh",d[2],"next day closing",d[4],b+"%");S={foundAt:"Short - "+new Date(u[0]).toLocaleString(),symbol:o.symbol,sellEntyPrice:v,stopLoss:u[2],buyExitPrice:d[4],highAndLow:d[3],brokerageCharges:.06,perChange:b.toFixed(2),perChngOnHighLow:k.toFixed(2),squareOffAt:new Date(d[0]).toLocaleString(),quantity:Math.floor(1e4/u[3]),candleChartData:c};Math.floor(1e4/u[3])&&(a.setState({backTestResult:[].concat(Object(te.a)(a.state.backTestResult),[S])}),f.push(S),p[h]=f,console.log("backTestResultDateRange",p),localStorage.setItem("backTestResultDateRange",JSON.stringify(p)),a.setState({dateAndTypeKeys:Object.keys(p),backTestResultDateRange:p}))}}}l=l+r.length-35}else console.log(o.symbol," candle data emply")}),e.next=9,new Promise(function(e){return setTimeout(e,300)});case 9:a.setState({stockTesting:t.format("YYYY-MM-DD")+" "+r+"1. "+o.symbol,runningTest:l});case 10:case"end":return e.stop()}},e)}),o=0;case 5:if(!(o<n.length)){e.next=13;break}return e.delegateYield(r(o),"t0",7);case 7:if("break"!==e.t0){e.next=10;break}return e.abrupt("break",13);case 10:o++,e.next=5;break;case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.backTestNR4=Object(ae.a)(ee.a.mark(function e(){var t,n,l,r,o,i;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({backTestResult:[],backTestFlag:!1}),t=a.state.symbolList,n=1,l=0,r=ee.a.mark(function e(r){var o;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=t[r],i={exchange:"NSE",symboltoken:o.token,interval:"ONE_DAY",fromdate:rt(a.state.startDate).format("YYYY-MM-DD HH:mm"),todate:rt(a.state.endDate).format("YYYY-MM-DD HH:mm")},T.getHistoryData(i).then(function(e){var t=K(e,"noPop");if(t&&t.data&&t.data.length)for(var r=t.data,i=0;i<r.length-4;i++){var s=r.slice(i,i+4);if(s.length>=4&&new Date(r[i][0]).toLocaleTimeString()<"14:15:00"){s.reverse();var c=[],m=[];s.forEach(function(e){c.push(e[2]-e[3]),m.push([e[0],e[1],e[2],e[3],e[4]])});var g=c[0],u=0;if(c.forEach(function(e){g<=e&&(g=e,u+=1)}),4==u){var d=s[0],h=r[i+4];m.unshift([h[0],h[1],h[2],h[3],h[4]]);var p=(d[2]+d[2]/100/10).toFixed(2);if(h[2]>p){var f=100*(h[a.state.longExitPriceType]-p)/p,y=100*(h[2]-p)/p;l+=f,console.log(o.symbol,d[0],"upside","same day high",d[2],"same day low",d[3],"nextdaylow",h[3],"nextdayhigh",h[2],"next day closing",h[4],f+"%");var b={foundAt:"Long - "+new Date(d[0]).toLocaleString(),symbol:o.symbol,sellEntyPrice:h[a.state.longExitPriceType],stopLoss:d[3],highAndLow:h[2],perChngOnHighLow:y.toFixed(2),buyExitPrice:p,brokerageCharges:.06,perChange:f.toFixed(2),squareOffAt:new Date(h[0]).toLocaleString(),quantity:Math.floor(1e4/d[2]),candleChartData:m};Math.floor(1e4/d[2])&&(a.setState({backTestResult:[].concat(Object(te.a)(a.state.backTestResult),[b])}),a.setState({backTestResult:a.state.backTestResult.reverse()}))}var E=(d[3]-d[3]/100/10).toFixed(2);if(h[3]<E){f=100*(E-h[a.state.shortExitPriceType])/d[3];var S=100*(E-h[3])/d[3];l+=f,console.log(o.symbol,d[0],"dowside","same day high",d[2],"same day low",d[3],"nextdaylow",h[3],"nextdayhigh",h[2],"next day closing",h[4],f+"%");b={foundAt:"Short - "+new Date(d[0]).toLocaleString(),symbol:o.symbol,sellEntyPrice:E,perChngOnHighLow:S.toFixed(2),stopLoss:d[2],highAndLow:h[3],buyExitPrice:h[a.state.shortExitPriceType],brokerageCharges:.06,perChange:f.toFixed(2),squareOffAt:new Date(h[0]).toLocaleString(),quantity:Math.floor(1e4/d[3]),candleChartData:m};Math.floor(1e4/d[3])&&a.setState({backTestResult:[].concat(Object(te.a)(a.state.backTestResult),[b])})}}}n=n+r.length-35}else console.log(o.symbol," candle data emply")}),e.next=5,new Promise(function(e){return setTimeout(e,300)});case 5:a.setState({stockTesting:r+1+". "+o.symbol,runningTest:n});case 6:case"end":return e.stop()}},e)}),o=0;case 5:if(!(o<t.length)){e.next=10;break}return e.delegateYield(r(o),"t0",7);case 7:o++,e.next=5;break;case 10:a.setState({backTestFlag:!0}),console.log("sumPercentage",l);case 12:case"end":return e.stop()}},e)})),a.nr4CheckPastPerfommance=function(e,t){var n=rt.duration("4320:00:00"),l=rt(a.state.endDate).subtract(n),r=0,o=0,i=0,s=0,c=0,m=0,g=[],u=[];console.log("starting function foundStock",t);var d={exchange:"NSE",symboltoken:e,interval:"ONE_DAY",fromdate:rt(l).format("YYYY-MM-DD HH:mm"),todate:rt(a.state.endDate).format("YYYY-MM-DD HH:mm")};T.getHistoryData(d).then(function(n){var l=K(n,"noPop");if(console.log("candle history",l),l&&l.data&&l.data.length){for(var d=l.data,h=0;h<d.length-4;h++){var p=d.slice(h,h+4);if(p.length>=4&&new Date(d[h][0]).toLocaleTimeString()<"14:15:00"){p.reverse();var f=[],y=[];p.forEach(function(e){f.push(e[2]-e[3]),y.push([e[0],e[1],e[2],e[3],e[4]])});var b=f[0],E=0;if(f.forEach(function(e){b<=e&&(b=e,E+=1)}),4==E){var S=p[0],v=d[h+4];y.unshift([v[0],v[1],v[2],v[3],v[4]]),console.log(e,p,f,E,S[0].toString().substr(0,25));var k=(S[2]+S[2]/100/10).toFixed(2);if(v[2]>k){var w=100*(v[4]-k)/k,C=100*(v[2]-k)/k,L={foundAt:"Long - "+new Date(S[0]).toLocaleString(),sellEntyPrice:v[4],stopLoss:S[3],highAndLow:v[2],perChngOnHighLow:C.toFixed(2),buyExitPrice:k,brokerageCharges:.06,perChange:w.toFixed(2),squareOffAt:new Date(v[0]).toLocaleString(),quantity:Math.floor(1e4/S[2]),candleChartData:y};g.push(L),r+=1,i+=w,c+=C}var x=(S[3]-S[3]/100/10).toFixed(2);if(v[3]<x){w=100*(x-v[4])/S[3];var I=100*(x-v[3])/S[3],T={foundAt:"Short - "+new Date(S[0]).toLocaleString(),sellEntyPrice:x,perChngOnHighLow:I.toFixed(2),stopLoss:S[2],highAndLow:v[3],buyExitPrice:v[4],brokerageCharges:.06,perChange:w.toFixed(2),squareOffAt:new Date(v[0]).toLocaleString(),quantity:Math.floor(1e4/S[3]),candleChartData:y};u.push(T),o+=1,s+=w,m+=I}}}}var D={totalLongs:r,totalShort:o,totalLongPer:i.toFixed(2),totalShortPer:s.toFixed(2),totalLongHighPer:c.toFixed(2),totalShortLowPer:m.toFixed(2)};t&&(t.pastPerferm=D),t.longCandles=g,t.shortCandles=u,console.log("foundStock",t),Math.floor(1e4/S[4])&&(a.setState({FoundPatternList:[].concat(Object(te.a)(a.state.FoundPatternList),[t])}),localStorage.setItem("FoundPatternList",JSON.stringify(a.state.FoundPatternList)))}else console.log(e," candle data emply")})},a.backtestTweezerTop=function(e,t,n){if(e&&e.length>0){for(var l=(e=e.reverse())[2]&&e[2][2],r=e[2]&&e[2][3],o=3;o<e.length;o++)l<e[o][2]&&(l=e[o][2]),e[o][3]<r&&(r=e[o][3]);var i=e[9][3],s=e[2][2],c={time:e[0]&&e[0][0],open:e[0]&&e[0][1],high:e[0]&&e[0][2],low:e[0]&&e[0][3],close:e[0]&&e[0][4]},m={time:e[1]&&e[1][0],open:e[1]&&e[1][1],high:e[1]&&e[1][2],low:e[1]&&e[1][3],close:e[1]&&e[1][4]},g=100*(s-i)/i,u=m.low<c.low?m.low:c.low,d=m.high<c.high?m.high:c.high;if(g>=1.5&&l<d&&r<u&&m.open<m.close&&c.open>c.close&&Math.round(m.close)==Math.round(c.open)&&Math.round(m.open)==Math.round(c.close)&&(console.log("%c"+new Date(e[0][0]).toString(),"color: #20d020"),console.log(t,"last 8th candle diff% ",g,"10th Low",i,"3rd high",s),console.log(t,"maxHigh",l,"maxLow",r),console.log("last10Candle",e),console.log(t,"perfect twisser top done close=open || open=close"),console.log("next10Candle",n),n&&n.length)){for(var h=(d+d/100/10).toFixed(2),p=(u-u/100/10).toFixed(2),f=0;f<n.length;f++){if(n[f][2]>h){h,n[f][0];break}if("15:15:00"==new Date(n[f][0]).toLocaleTimeString()){n[f][4],n[f][0];break}}for(var y=n[0][4],b=1;b<n.length&&(n[b][4]<y&&(y=n[b][4],n[b][0]),"15:15:00"!=new Date(n[b][0]).toLocaleTimeString());b++);for(var E=h,S=0;S<n.length;S++){if(!(E>n[S][2])){E=n[S][4].toFixed(2),n[S][0];break}if(E=(n[S][2]+n[S][2]/100/4).toFixed(2),n[S][0],"15:15:00"==new Date(n[S][0]).toLocaleTimeString())break}for(var v=0,k="",w=0;w<n.length;w++){if(100*(n[w][3]-p)/p<-.7){v=n[w][3],k=n[w][0];break}if(n[w][2]>h){v=h,k=n[w][0];break}if("15:15:00"==new Date(n[w][0]).toLocaleTimeString()){v=n[w][3],k=n[w][0];break}}for(var C=0;C<n.length;C++){if(100*(n[C][3]-p)/p<=-1.5){n[C][3],n[C][0];break}if(n[C][2]>h){h,n[C][0];break}if("15:15:00"==new Date(n[C][0]).toLocaleTimeString()){n[C][3],n[C][0];break}}var L=localStorage.getItem("backTestResult")?JSON.parse(localStorage.getItem("backTestResult")):[];if(n[0][3]<u||n[1][3]<u||n[2][3]<u){var x={foundAt:new Date(e[0][0]).toLocaleString(),symbol:t,sellEntyPrice:p,stopLoss:h,orderActivated:!1,buyExitPrice:0,brokerageCharges:.06,quantity:Math.floor(1e4/p)};x.orderActivated=!0,x.squareOffAt=new Date(k).toLocaleString(),x.buyExitPrice=v,x.perChange=(100*(x.sellEntyPrice-x.buyExitPrice)/x.sellEntyPrice).toFixed(2),L.push(x),a.setState({backTestResult:[].concat(Object(te.a)(a.state.backTestResult),[x])})}}}a.setState({backTestFlag:!0})},a.backtestTweezerBottom=function(e,t,n){if(e&&e.length>0){for(var l=(e=e.reverse())[2]&&e[2][2],r=e[2]&&e[2][3],o=3;o<e.length;o++)l<e[o][2]&&(l=e[o][2]),e[o][3]<r&&(r=e[o][3]);var i=e[9][3],s=e[2][2],c={time:e[0]&&e[0][0],open:e[0]&&e[0][1],high:e[0]&&e[0][2],low:e[0]&&e[0][3],close:e[0]&&e[0][4]},m={time:e[1]&&e[1][0],open:e[1]&&e[1][1],high:e[1]&&e[1][2],low:e[1]&&e[1][3],close:e[1]&&e[1][4]},g=100*(s-i)/i,u=m.low<c.low?m.low:c.low,d=m.high<c.high?m.high:c.high;if(g<=-1.5&&d<l&&u<r&&m.open>m.close&&c.close>c.open&&(Math.round(m.close)==Math.round(c.open)||Math.round(m.open)==Math.round(c.close))&&(console.log("%c"+new Date(e[0][0]).toString(),"color: #20d020"),console.log(t,"last 8th candle diff% ",g,"10th Low",i,"3rd high",s),console.log(t,"maxHigh",l,"maxLow",r),console.log("last10Candle",e),console.log(t,"perfect twisser top done close=open || open=close"),console.log("next10Candle",n),n&&n.length)){for(var h=(d+d/100/10).toFixed(2),p=(u-u/100/10).toFixed(2),f=0,y="",b=0;b<n.length;b++){if(n[b][2]<p){f=p,y=n[b][0];break}if("15:15:00"==new Date(n[b][0]).toLocaleTimeString()){f=n[b][4],y=n[b][0];break}}for(var E=n[0][4],S=1;S<n.length&&(E<n[S][4]&&(E=n[S][4],n[S][0]),"15:15:00"!=new Date(n[S][0]).toLocaleTimeString());S++);for(var v=p,k=0;k<n.length;k++){if(!(v>n[k][2])){v=n[k][4].toFixed(2),n[k][0];break}if(v=(n[k][2]+n[k][2]/100/4).toFixed(2),n[k][0],"15:15:00"==new Date(n[k][0]).toLocaleTimeString())break}for(var w=0;w<n.length;w++){if(100*(n[w][3]-h)/h>.7){n[w][3],n[w][0];break}if(n[w][2]>p){p,n[w][0];break}if("15:15:00"==new Date(n[w][0]).toLocaleTimeString()){n[w][3],n[w][0];break}}for(var C=0;C<n.length;C++){if(100*(n[C][3]-h)/h>=-1.5){n[C][3],n[C][0];break}if(n[C][2]>p){p,n[C][0];break}if("15:15:00"==new Date(n[C][0]).toLocaleTimeString()){n[C][3],n[C][0];break}}var L=localStorage.getItem("backTestResult")?JSON.parse(localStorage.getItem("backTestResult")):[];if(n[0][3]<u||n[1][3]<u||n[2][3]<u){var x={foundAt:new Date(e[0][0]).toLocaleString(),symbol:t,sellEntyPrice:0,stopLoss:p,orderActivated:!1,buyExitPrice:h,brokerageCharges:.06,quantity:Math.floor(1e4/h)};x.orderActivated=!0,x.squareOffAt=new Date(y).toLocaleString(),x.sellEntyPrice=f,x.perChange=(100*(x.sellEntyPrice-x.buyExitPrice)/x.sellEntyPrice).toFixed(2),L.push(x),a.setState({backTestResult:[].concat(Object(te.a)(a.state.backTestResult),[x])})}}}a.setState({backTestFlag:!0})},a.placeOrder=function(e){var t={variety:"NORMAL",tradingsymbol:a.state.tradingsymbol,symboltoken:a.state.symboltoken,transactiontype:e,exchange:"NSE",ordertype:0===a.state.buyPrice?"MARKET":"LIMIT",producttype:a.state.producttype,duration:"DAY",price:0,squareoff:"0",stoploss:"0",quantity:a.state.quantity};T.placeOrder(t).then(function(t){var n=K(t);n.status&&"SUCCESS"===n.message&&(localStorage.setItem("ifNotBought","false"),a.setState({orderid:n.data&&n.data.orderid}),a.state.stoploss&&("BUY"==e&&a.placeSLMOrder("SELL"),"SELL"==e&&a.placeSLMOrder("BUY")))})},a.LoadSymbolDetails=function(e,t){console.log("name",e);for(var n="",l=localStorage.getItem("watchList")&&JSON.parse(localStorage.getItem("watchList"))||[],r=0;r<l.length;r++)if(l[r].symbol===e){n=l[r].token,console.log("name % token",e,n),a.setState({tradingsymbol:e,symboltoken:l[r].token},function(){this.setState({cursor:t},function(){this.getLTP(),this.showStaticChart(n)})});break}},a.getTimeFrameValue=function(e){switch(e){case"ONE_MINUTE":return(new Date).toLocaleTimeString()<"10:05:00"?"19:00:00":"01:00:00";case"FIVE_MINUTE":return(new Date).toLocaleTimeString()<"11:00:00"?"23:00:00":"03:00:00";case"TEN_MINUTE":return(new Date).toLocaleTimeString()<"12:35:00"?"24:21:00":"07:00:00";case"FIFTEEN_MINUTE":return(new Date).toLocaleTimeString()<"14:15:00"?"28:01:00":"10:01:00";case"THIRTY_MINUTE":return"100:01:00";case"ONE_HOUR":return"200:01:00";case"ONE_DAY":return"1000:01:00"}},a.calculateSMA=function(e,t){for(var a=function(e){for(var t=0,a=0;a<e.length;a++)t+=e[a].close;return t/e.length},n=[],l=t-1,r=e.length;l<r;l++){var o=a(e.slice(l-t+1,l));n.push({time:e[l].time,value:o})}return n},a.showStaticChart=function(e){a.setState({chartStaticData:""},function(){console.log("reset done",e)}),a.dailyBasisInfoCheck(e),console.log("time in function ",a.state.timeFrame);var t="YYYY-MM-DD HH:mm",n=(rt("9:15am","h:mma"),a.getTimeFrameValue(a.state.timeFrame)),l=rt.duration(n),r=rt(new Date).subtract(l),o={exchange:"NSE",symboltoken:e,interval:a.state.timeFrame,fromdate:rt(r).format(t),todate:rt(new Date).format(t)};T.getHistoryData(o).then(function(n){var l=K(n,"noPop");if(l&&l.data){var o=l.data,i=o.map(function(e){return{time:new Date(e[0]).getTime(),open:parseFloat(e[1]),high:parseFloat(e[2]),low:parseFloat(e[3]),close:parseFloat(e[4])}}),s=[],c=[],m=[],g=[],u=[],d=[],h=[],p=[],f=[];o.forEach(function(e,t){s.push([e[0],e[1],e[2],e[3],e[4]]),c.push([e[5],(e[2]+e[3]+e[4])/3]),m.push(e[4]),g.push(e[2]),u.push(e[3]),d.push(e[3]),h.push(e[5]),p.push((e[2]+e[3]+e[4])/3),f.push({time:new Date(e[0]).getTime(),value:e[5],color:"rgba(211, 211, 211, 1)"})});var y={period:20,values:p,stdDev:2},b=it.a.calculate(y);console.log(e,"Bolinger band",y,b);b=it.a.calculate(y);console.log(e,"Bolinger band",y,b);var E={values:m,period:14},S=ot.a.calculate(E);if(console.log(e,"Rsi",E,S),console.log(e,"vwap",c,ct()(c)),a.setState({chartStaticData:i,bblastValue:b[b.length-1],vwapvalue:ct()(c),rsiValues:S.slice(Math.max(h.length-19,1)),valumeData:h.slice(Math.max(h.length-5,1))},function(){this.state.candleSeries.setData(this.state.chartStaticData),this.state.volumeSeries.setData(f);var e=this.calculateSMA(this.state.chartStaticData,20);this.state.smaLineSeries.setData(e),this.state.chart.subscribeCrosshairMove(function(e){var t=e.seriesPrices[Symbol.iterator](),a="",n="",l=!0,r=!1,o=void 0;try{for(var i,s=t[Symbol.iterator]();!(l=(i=s.next()).done);l=!0){var c=i.value;"object"==typeof c[1]?(a+=" Open: <b>"+c[1].open+"</b>",a+=" High: <b>"+c[1].high+"</b>",a+=" Low: <b>"+c[1].low+"</b>",a+=" Close: <b>"+c[1].close+"</b>",a+=" Chng: <b>"+(n=100*(c[1].close-c[1].open)/c[1].open).toFixed(2)+"%</b>"):a+=" &nbsp; "+c[1].toFixed(2)+" "}}catch(g){r=!0,o=g}finally{try{l||null==s.return||s.return()}finally{if(r)throw o}}e.time?a+=" Time: <b>"+new Date(e.time).toLocaleString()+"</b>":a+=" <b>Time: </b>";var m="<span style=color:green>"+a+"</span> ";n<0&&(m="<span style=color:red>"+a+"</span> "),document.getElementById("showChartTitle").innerHTML=m})}),o&&o.sort(function(e,t){return new Date(t[0])-new Date(e[0])}),o.length>0){localStorage.setItem("InstrumentHistroy",JSON.stringify(o)),a.setState({InstrumentHistroy:o});var v=0,k=0,w=0;o.forEach(function(e){var t=100*(e[4]-e[1])/e[1];t>=.3&&(v+=1),t<=-.3&&(k+=1),w+=t}),a.setState({downMoveCount:k,upsideMoveCount:v,totalPerchentageChange:w,startingFrom:rt(r).format(t)})}}})},a.checkSlowMotionStock=function(e,t){var n=rt.duration("240:00:00"),l=rt(new Date).subtract(n),r={exchange:"NSE",symboltoken:e,interval:"FIVE_MINUTE",fromdate:rt(l).format("YYYY-MM-DD HH:mm"),todate:rt(new Date).format("YYYY-MM-DD HH:mm")};T.getHistoryData(r).then(function(e){var n=K(e,"noPop");if(n&&n.data&&n.data.length){for(var l=n.data,r=0,o=l.length-375;o<l.length;o++){var i=l[o];if(i){var s=100*(i[4]-i[1])/i[1];s>=.4&&(r+=1,console.log(t.symbol,s,i[0])),s<=-.4&&(r+=1,console.log(t.symbol,s,i[0]))}}console.log("Totalcount",t.symbol,r),r<=15&&(t.bigCandleCount=r,a.setState({slowMotionStockList:[].concat(Object(te.a)(a.state.slowMotionStockList),[t])},function(){localStorage.setItem("slowMotionStockList",JSON.stringify(this.state.slowMotionStockList))}))}})},a.checkSlowMotionCheckLive=Object(ae.a)(ee.a.mark(function e(){var t,n,l,r,o;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=ee.a.mark(function e(t){var n;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.state.slowMotionStockList[t],"YYYY-MM-DD HH:mm",l=rt.duration("22:00:00"),r=rt(new Date).subtract(l),o={exchange:"NSE",symboltoken:n.token,interval:"FIVE_MINUTE",fromdate:rt(r).format("YYYY-MM-DD HH:mm"),todate:rt(new Date).format("YYYY-MM-DD HH:mm")},T.getHistoryData(o).then(function(e){var t=K(e,"noPop");if(t&&t.data&&t.data.length){for(var l=t.data,r=0,o=l.length-3;o<l.length;o++){var i=l[o];if(i){var s=100*(i[4]-i[1])/i[1];s>=.7&&(r+=1),s>=0&&1}}r>=1&&(n.highlisht=!0,window.document.title="SM: "+n.symbol,console.log("hey listen, slow motion stock"+n.symbol+" broken"),a.speckIt("hey listen, slow motion stock"+n.symbol+" broken"),a.setState({slowMotionStockList:a.state.slowMotionStockList}))}}),e.next=8,new Promise(function(e){return setTimeout(e,310)});case 8:case"end":return e.stop()}},e)}),n=0;case 2:if(!(n<a.state.slowMotionStockList.length)){e.next=7;break}return e.delegateYield(t(n),"t0",4);case 4:n++,e.next=2;break;case 7:case"end":return e.stop()}},e)})),a.oneHourBullBearCheck=Object(ae.a)(ee.a.mark(function e(){var t,n,l,r,o;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=ee.a.mark(function e(t){var n;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.state.symbolList[t],"YYYY-MM-DD HH:mm",l=rt.duration("02:00:00"),r=rt(new Date).subtract(l),o={exchange:"NSE",symboltoken:n.token,interval:"ONE_HOUR",fromdate:rt(r).format("YYYY-MM-DD HH:mm"),todate:rt(new Date).format("YYYY-MM-DD HH:mm")},T.getHistoryData(o).then(function(e){var t=K(e,"noPop");if(t&&t.data&&t.data.length){var l=t.data,r=l[l.length-1];r[1]==r[3]&&r[2]==r[4]&&(window.document.title="Hourly Buy: "+n.symbol,console.log(n.name,"Hourly Buy",l[l.length-1]),n.orderType=" Hourly Buy",n.foundAt=new Date(l[l.length-1][0]).toLocaleString(),a.speckIt(n.name+" Hourly Bullish "),a.setState({oneHourBullBearCheckList:[].concat(Object(te.a)(a.state.oneHourBullBearCheckList),[n])})),r[1]==r[2]&&r[3]==r[4]&&(window.document.title="Hourly Sell: "+n.symbol,console.log(n.name,"Hourly Sell",l[l.length-1]),n.orderType=" Hourly Sell",n.foundAt=new Date(l[l.length-1][0]).toLocaleString(),a.speckIt(n.name+" Hourly Sell "),a.setState({oneHourBullBearCheckList:[].concat(Object(te.a)(a.state.oneHourBullBearCheckList),[n])}))}}),e.next=8,new Promise(function(e){return setTimeout(e,310)});case 8:case"end":return e.stop()}},e)}),n=0;case 2:if(!(n<a.state.symbolList.length)){e.next=7;break}return e.delegateYield(t(n),"t0",4);case 4:n++,e.next=2;break;case 7:case"end":return e.stop()}},e)})),a.searchValumeBreakoutStock=Object(ae.a)(ee.a.mark(function e(){var t,n,l,r,o;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=ee.a.mark(function e(t){var n;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.state.symbolList[t],"YYYY-MM-DD HH:mm",l=rt.duration("60:00:00"),r=rt(new Date).subtract(l),o={exchange:"NSE",symboltoken:n.token,interval:"FIFTEEN_MINUTE",fromdate:rt(r).format("YYYY-MM-DD HH:mm"),todate:rt(new Date).format("YYYY-MM-DD HH:mm")},T.getHistoryData(o).then(function(e){var t=K(e,"noPop");if(t&&t.data&&t.data.length){for(var l=t.data,r=0,o=l[0][5],i=l[l.length-1][5],s=l[0][4],c=0,m=l[0][4],g=0,u=l.length-6;u<l.length-1;u++){var d=l[u];d&&(r+=d[5],o<d[5]&&(o=d[5]),s<d[4]&&(console.log(n.symbol,s,"upside last candle index ",u,d[4]),s=d[4],c+=1),d[4]<m&&(console.log(n.symbol,s," downside last candle index ",u,d[4]),m=d[4],g+=1))}var h=r/5;i/o>1.75&&c>=4&&(window.document.title="VB: "+n.symbol,n.orderType=" Vol "+(i/o).toFixed(2)+" Time & price incresing",n.foundAt=new Date(l[l.length-1][0]).toLocaleString(),console.log(n.name+" volume crossed "+(i/o).toFixed(2)+" time of average ",h,i,l[l.length-1][0],o),a.speckIt(n.name+" volume crossed "+(i/o).toFixed(2)+" Time and price incresing"),a.setState({volumeBreakoutlast5CandleList:[].concat(Object(te.a)(a.state.volumeBreakoutlast5CandleList),[n])})),i/o>1.75&&g>=4&&(window.document.title="VB: "+n.symbol,n.orderType=" Vol "+(i/o).toFixed(2)+" Time & price decresing",n.foundAt=new Date(l[l.length-1][0]).toLocaleString(),console.log(n.name+" volume crossed "+(i/o).toFixed(2)+" time of average ",h,i,l[l.length-1][0],o),a.speckIt(n.name+" volume crossed "+(i/o).toFixed(2)+" Time and price decresing "),a.setState({volumeBreakoutlast5CandleList:[].concat(Object(te.a)(a.state.volumeBreakoutlast5CandleList),[n])}))}}),e.next=8,new Promise(function(e){return setTimeout(e,310)});case 8:case"end":return e.stop()}},e)}),n=0;case 2:if(!(n<a.state.symbolList.length)){e.next=7;break}return e.delegateYield(t(n),"t0",4);case 4:n++,e.next=2;break;case 7:case"end":return e.stop()}},e)})),a.speckIt=function(e){var t=new SpeechSynthesisUtterance;t.text=e.toString(),window.speechSynthesis.speak(t)},a.dailyBasisInfoCheck=function(e,t){var n=a.getTimeFrameValue("ONE_DAY"),l=rt.duration(n),r=rt(new Date).subtract(l),o={exchange:"NSE",symboltoken:e,interval:"ONE_DAY",fromdate:rt(r).format("YYYY-MM-DD HH:mm"),todate:rt(new Date).format("YYYY-MM-DD HH:mm")};T.getHistoryData(o).then(function(n){var l=K(n,"noPop"),r="";if(l&&l.data&&l.data.length){for(var o=l.data,i=[],s=0,c=o.length-20;c<o.length;c++){var m=o[c];m&&(i.push(m[4]),s+=m[5])}r=Dt.a.calculate({period:20,values:i}),a.setState({dailyAvgValume:s/20});var g=r&&r[r.length-1];console.log(e,"DSMA",g),g&&a.setState({DailyBulishStatus:g,todayCurrentVolume:o[o.length-1][5]}),o[o.length-1][5]>s/20&&(console.log("crosssed voliue",t),a.setState({volumeCrossedList:[].concat(Object(te.a)(a.state.volumeCrossedList),[t])}))}})},a.placeSLMOrder=function(e){var t={tradingsymbol:a.state.tradingsymbol,symboltoken:a.state.symboltoken,transactiontype:e,exchange:"NSE",ordertype:"STOPLOSS_MARKET",producttype:a.state.producttype,duration:"DAY",price:0,squareoff:"0",stoploss:"0",quantity:a.state.quantity,triggerprice:a.state.stoploss,variety:"STOPLOSS"};T.placeOrder(t).then(function(e){var t=K(e);t.status&&"SUCCESS"===t.message&&(localStorage.setItem("ifNotBought","false"),a.setState({orderid:t.data&&t.data.orderid}))})},a.onSelectItem=function(e,t){var n=JSON.parse(localStorage.getItem("autoSearchTemp"));if(n.length>0){for(var l="",r=0;r<n.length;r++)if(n[r].symbol===t){l=n[r];break}var o=[];o.filter(function(e){return e.token===t}).length||(o.push(l),a.setState({tradingsymbol:l.symbol,symboltoken:l.token},function(){this.LoadSymbolDetails(l.symbol)}),a.setState({symbolList:o},function(){}))}},a.onSelectItemChart=function(e,t){var n=JSON.parse(localStorage.getItem("autoSearchTemp"));if(n.length>0){for(var l="",r=0;r<n.length;r++)if(n[r].symbol===t){l=n[r];break}a.setState({tradingsymbol:l.symbol,symboltoken:l.token,seachSumbol:""},function(){this.getLTP(),this.showStaticChart(l.token),this.LoadSymbolDetails(l.symbol)})}},a.getPercentageColor=function(e){return"rgb("+((e*=100)<50?255:Math.floor(255-255*(2*e-100)/100))+","+(e>50?255:Math.floor(2*e*255/100))+",0)"},a.deleteItemWatchlist=function(e){var t=a.state.symbolList,n=t.findIndex(function(t){return t.symbol===e});t.splice(n,1),a.setState({symbolList:t})},a.getAveragePrice=function(e){for(var t=localStorage.getItem("oderbookData"),n=0,l=0;l<t.length;l++)if("orderId"===t[l].orderid){n=t[l].averageprice,a.setState({averageprice:n});break}return n},a.showCandleChart=function(e,t,a){e=e&&e.reverse(),localStorage.setItem("candleChartData",JSON.stringify(e)),localStorage.setItem("cadleChartSymbol",t),a&&localStorage.setItem("chartInfoDetails",JSON.stringify(a)),document.getElementById("showCandleChart").click()},a.showCandleBothChart=function(e){var t=e.candleChartData&&e.candleChartData.reverse();localStorage.setItem("candleChartData",JSON.stringify(t)),localStorage.setItem("cadleChartSymbol",e.symbol);var a=e.candleChartDataInside;a&&localStorage.setItem("candleChartDataInside",JSON.stringify(a)),document.getElementById("showCandleChart").click()},a.handleKeyDown=function(e){console.log("key",e.keyCode),38===e.keyCode&&a.state.cursor>0?a.setState(function(e){return{cursor:e.cursor-1}}):40===e.keyCode&&a.state.cursor<a.state.symbolList.length-1&&a.setState(function(e){return{cursor:e.cursor+1}}),setTimeout(function(){a.updateCandleOnkey()},100)},a.updateCandleOnkey=function(){var e=localStorage.getItem("selectedKeyRow")&&JSON.parse(localStorage.getItem("selectedKeyRow"));e.token&&e.symbol&&a.setState({tradingsymbol:e.symbol,symboltoken:e.token},function(){this.getLTP(),this.showStaticChart(e.token)})},a.state={sumPercentage:0,InstrumentPerChange:"",autoSearchList:[],isDasable:!1,isError:!1,InstrumentLTP:{},ifNotBought:!0,autoSearchTemp:[],backTestResult:[],backTestFlag:!0,patternType:"",symboltoken:"",tradingsymbol:"",buyPrice:0,quantity:1,producttype:"INTRADAY",symbolList:localStorage.getItem("watchList")&&JSON.parse(localStorage.getItem("watchList"))||[],totalWatchlist:localStorage.getItem("totalWatchlist")&&JSON.parse(localStorage.getItem("totalWatchlist"))||[],staticData:localStorage.getItem("staticData")&&JSON.parse(localStorage.getItem("staticData"))||{},selectedWatchlist:"Securities in F&O",longExitPriceType:4,shortExitPriceType:4,candleChartData:[],stopScaningFlag:!1,backTestResultDateRange:[],searchFailed:0,openEqualHighList:[],openEqualLowList:[],chartStaticData:[],volumeCrossedList:[],slowMotionStockList:[],volumeBreakoutlast5CandleList:[],oneHourBullBearCheckList:[],timeFrame:"FIFTEEN_MINUTE",cursor:"",advanceShareCount:0,declineShareCount:0,UnchangeShareCount:0,FoundPatternList:localStorage.getItem("FoundPatternList")&&JSON.parse(localStorage.getItem("FoundPatternList"))||[],fastMovementList:localStorage.getItem("fastMovementList")&&JSON.parse(localStorage.getItem("fastMovementList"))||[]},a.myCallback=a.myCallback.bind(Object(k.a)(a)),a.updateSocketWatch=a.updateSocketWatch.bind(Object(k.a)(a)),a}return Object(w.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){var e=this;window.document.title="Home",this.setState({symbolList:this.state.staticData[this.state.selectedWatchlist]});var t=JSON.parse(localStorage.getItem("userTokens")),a=t&&t.feedToken,n=JSON.parse(localStorage.getItem("userProfile")),l=n&&n.clientcode;this.setState({feedToken:a,clientcode:l});var r=document.getElementById("tvchart");document.getElementById("tvchart").innerHTML="";var o=Object(Lt.a)(r,{width:900,height:400,timeVisible:!0,secondsVisible:!0}),i=o.addCandlestickSeries(),s=o.addLineSeries({color:"rgba(4, 111, 232, 1)",lineWidth:2}),c=o.addHistogramSeries({color:"#26a69a",priceFormat:{type:"volume"},priceScaleId:"",scaleMargins:{top:.8,bottom:0}});this.setState({chart:o,candleSeries:i,smaLineSeries:s,volumeSeries:c}),this.checkOpenEqualToLow();var m=rt("9:15am","h:mma"),g=rt("3:30pm","h:mma"),u=rt(new Date,"h:mma");if(rt().isoWeekday()<=5&&u.isBetween(m,g)){setInterval(function(){e.state.tradingsymbol&&e.getLTP();var t=localStorage.getItem("fastMovementList")&&JSON.parse(localStorage.getItem("fastMovementList"));t&&t.length&&t.reverse(),e.setState({fastMovementList:t})},1e3),setInterval(function(){e.checkSlowMotionCheckLive()},375e3),setInterval(function(){e.searchValumeBreakoutStock()},1125e3);var d=setInterval(function(){var t=new Date;console.log("setinterval ",(new Date).toLocaleString()),t.getMinutes()%60===0&&(setTimeout(function(){e.oneHourBullBearCheck()},9e4),setInterval(function(){e.oneHourBullBearCheck()},367e4),clearInterval(d))},1e3)}this.oneHourBullBearCheck()}},{key:"render",value:function(){var e=this,t={myCallback:this.myCallback,startDate:"",endDate:"",firstLavel:"Start Date and Time",secondLavel:"End Date and Time"},a=0,n=0,r=0,o=0,i=0,s=0,c=0,g=0,u=0;return l.a.createElement(l.a.Fragment,null,l.a.createElement(ht,{LoadSymbolDetails:this.LoadSymbolDetails}),l.a.createElement(tt,null),l.a.createElement(M.a,{direction:"row",container:!0,spacing:1,style:{padding:"5px"}},l.a.createElement(M.a,{item:!0,xs:12,sm:2},l.a.createElement(Et.a,null,l.a.createElement(vt.a,{freeSolo:!0,id:"free-solo-2-demo",disableClearable:!0,style:{paddingLeft:"10px",paddingRight:"10px"},onChange:this.onSelectItem,options:this.state.autoSearchList.length>0?this.state.autoSearchList.map(function(e){return e.symbol}):[],renderInput:function(t){return l.a.createElement(Y.a,Object.assign({onChange:e.onChange},t,{label:"Search Symbol",margin:"normal",variant:"standard",name:"search",onKeyDown:e.handleKeyDown,value:e.state.search,InputProps:Object(m.a)({},t.InputProps,{type:"search"})}))}}),l.a.createElement("div",{style:{marginLeft:"10px"}},l.a.createElement(kt.a,Object(y.a)({style:{paddingLeft:"12px"}},"style",Vt.selectStyle),l.a.createElement(A.a,{htmlFor:"gender"},"Select Watchlist"),l.a.createElement(wt.a,{value:this.state.selectedWatchlist,name:"selectedWatchlist",onChange:this.onChangeWatchlist},l.a.createElement(Ct.a,{value:"selectall"},"Select All"),this.state.totalWatchlist&&this.state.totalWatchlist.map(function(e){return l.a.createElement(Ct.a,{value:e},e)})))),l.a.createElement("div",{style:{overflowY:"scroll",height:"75vh"}},this.state.symbolList&&this.state.symbolList.length?this.state.symbolList.map(function(t,a){return l.a.createElement(l.a.Fragment,null,l.a.createElement(fe.a,{onKeyDown:e.handleKeyDown,button:!0,selected:e.state.cursor===a?"active":null,style:{fontSize:"12px",padding:"0px",paddingLeft:"5px",paddingRight:"5px"}},e.state.cursor===a?localStorage.setItem("selectedKeyRow",JSON.stringify(t)):"",l.a.createElement(be.a,{style:{color:t.nc&&0!=t.nc?t.nc>0?"#20d020":"#e66e6e":""},onClick:function(){return e.LoadSymbolDetails(t.symbol,a)},primary:t.name})," ",t.ltp," (",t.nc,"%)"))}):"")),l.a.createElement(W.a,{style:{fontWeight:"bold"}},l.a.createElement("span",{style:{color:"green"}}," Advance ",this.state.advanceShareCount," ")," ",l.a.createElement("span",{style:{color:"red"}}," Decline ",this.state.declineShareCount," ")," ",l.a.createElement("span",null," Unchange ",this.state.UnchangeShareCount," ")," ")),l.a.createElement(M.a,{item:!0,xs:12,sm:8},l.a.createElement(Et.a,{style:{padding:"10px"}},l.a.createElement(W.a,{style:{textAlign:"center",background:"lightgray"}},"Place Order"),l.a.createElement(M.a,{style:{display:"visible"},spacing:1,direction:"row",alignItems:"center",container:!0},l.a.createElement(M.a,{item:!0,xs:10,sm:3},this.state.tradingsymbol?l.a.createElement(W.a,{variant:"body1",style:{color:this.state.InstrumentPerChange>0?"#20d020":"#e66e6e"}},this.state.tradingsymbol," : ",this.state.InstrumentLTP?this.state.InstrumentLTP.ltp:""," (",this.state.InstrumentPerChange+"%",")"):l.a.createElement(W.a,{variant:"h5"},"Select Symbol "),"O: ",this.state.InstrumentLTP?this.state.InstrumentLTP.open:""," \xa0 H: ",this.state.InstrumentLTP?this.state.InstrumentLTP.high:""," \xa0 L: ",this.state.InstrumentLTP?this.state.InstrumentLTP.low:"","\xa0 C: ",this.state.InstrumentLTP?this.state.InstrumentLTP.close:""," \xa0"),l.a.createElement(M.a,{item:!0,xs:10,sm:2},l.a.createElement(vt.a,{freeSolo:!0,id:"free-solo-2-demo",disableClearable:!0,style:{paddingLeft:"10px",paddingRight:"10px"},onChange:this.onSelectItemChart,value:this.state.seachSumbol,options:this.state.autoSearchList.length>0?this.state.autoSearchList.map(function(e){return e.symbol}):[],renderInput:function(t){return l.a.createElement(Y.a,Object.assign({onChange:e.onChange},t,{label:"Search",margin:"normal",variant:"standard",name:"seachSumbol",InputProps:Object(m.a)({},t.InputProps,{type:"search"})}))}})),l.a.createElement(M.a,{item:!0,xs:10,sm:1},l.a.createElement(kt.a,Object(y.a)({style:Vt.selectStyle},"style",{marginTop:"10px"}),l.a.createElement(A.a,{htmlFor:"gender"},"Time"),l.a.createElement(wt.a,{value:this.state.timeFrame,name:"timeFrame",onChange:this.onInputChange},l.a.createElement(Ct.a,{value:"ONE_MINUTE"},"1M"),l.a.createElement(Ct.a,{value:"FIVE_MINUTE"},"5M"),l.a.createElement(Ct.a,{value:"TEN_MINUTE"},"10M"),l.a.createElement(Ct.a,{value:"FIFTEEN_MINUTE"},"15M"),l.a.createElement(Ct.a,{value:"THIRTY_MINUTE"},"30M"),l.a.createElement(Ct.a,{value:"ONE_HOUR"},"1H"),l.a.createElement(Ct.a,{value:"ONE_DAY"},"1D")))),l.a.createElement(M.a,{item:!0,xs:12,sm:1},l.a.createElement(kt.a,Object(y.a)({style:Vt.selectStyle},"style",{marginTop:"3px"}),l.a.createElement(A.a,{htmlFor:"gender"},"Order Type"),l.a.createElement(wt.a,{value:this.state.producttype,name:"producttype",onChange:this.onChange},l.a.createElement(Ct.a,{value:"INTRADAY"},"Interaday"),l.a.createElement(Ct.a,{value:"DELIVERY"},"Del")))),l.a.createElement(M.a,{item:!0,xs:10,sm:1},l.a.createElement(Y.a,{id:"buyPrice",label:"Buy Price",value:this.state.buyPrice,name:"buyPrice",onChange:this.onChange})),l.a.createElement(M.a,{item:!0,xs:10,sm:1},l.a.createElement(Y.a,{id:"quantity",label:"Qty",value:this.state.quantity,name:"quantity",onChange:this.onChange})),l.a.createElement(M.a,{item:!0,xs:10,sm:1},l.a.createElement(Y.a,{id:"stoploss",label:"SL",value:this.state.stoploss,name:"stoploss",onChange:this.onChange})),l.a.createElement(M.a,{item:!0,xs:1,sm:2},l.a.createElement(B.a,{variant:"contained",color:"",style:{marginLeft:"20px"},onClick:function(){return e.placeOrder("BUY")}},"Buy"),l.a.createElement(B.a,{variant:"contained",color:"",style:{marginLeft:"20px"},onClick:function(){return e.placeOrder("SELL")}},"Sell")),l.a.createElement(M.a,{style:{display:"visible"},spacing:1,direction:"row",alignItems:"center",container:!0},l.a.createElement("br",null),this.state.InstrumentLTP?l.a.createElement(M.a,{item:!0,xs:12,sm:3,style:{background:"#00000014"}},l.a.createElement("div",{style:{background:"#bdbdbd"}},l.a.createElement("b",null,"  Daily: ",this.state.tradingsymbol)," ",l.a.createElement("br",null),l.a.createElement("span",{title:"20SMA",item:!0,xs:12,sm:12,style:{color:this.state.InstrumentLTP.ltp>this.state.DailyBulishStatus?"green":"red",fontWeight:"bold"}},"Daily Avg Price: ",this.state.DailyBulishStatus&&this.state.DailyBulishStatus.toFixed(0)," ",this.state.DailyBulishStatus?this.state.InstrumentLTP.ltp>this.state.DailyBulishStatus?"BUY":"SELL":""),l.a.createElement("br",null),l.a.createElement("span",{title:"averge of showed candle volume",item:!0,xs:12,sm:12},l.a.createElement("b",null,"Daily Avg Volume:"),"  ",(this.state.dailyAvgValume/1e5).toFixed(2),"L"),l.a.createElement("br",null),l.a.createElement("span",{title:"averge of showed candle volume",item:!0,xs:12,sm:12},this.state.todayCurrentVolume>this.state.dailyAvgValume?l.a.createElement("b",{title:"if cossed avg volume then its green",style:{color:"green"}},"Today Volume: ",(this.state.todayCurrentVolume/1e5).toFixed(2),"L "):"Today Volume:"+(this.state.todayCurrentVolume/1e5).toFixed(2)+"L")),l.a.createElement("br",null),l.a.createElement("b",null,"  Intraday: ",this.state.timeFrame," : ",this.state.tradingsymbol)," ",l.a.createElement("br",null),this.state.bblastValue?l.a.createElement("span",{item:!0,xs:12,sm:12},l.a.createElement("span",{title:"Green color mean price running above upper bb band",style:{color:this.state.InstrumentLTP.ltp>=this.state.bblastValue.upper?"green":"",fontWeight:"bold"}},"BB Upper: ",this.state.bblastValue.upper.toFixed(2)),l.a.createElement("br",null),"BB Middle(20 SMA): ",this.state.bblastValue.middle.toFixed(2),l.a.createElement("br",null),l.a.createElement("span",{title:"Green red mean price running below lower bb band",style:{color:this.state.InstrumentLTP.ltp<=this.state.bblastValue.lower?"red":"",fontWeight:"bold"}},"BB Lower: ",this.state.bblastValue.lower.toFixed(2)),l.a.createElement("br",null)):"",l.a.createElement("span",{item:!0,xs:12,sm:12,style:{color:this.state.InstrumentLTP.ltp>this.state.vwapvalue?"green":"red",fontWeight:"bold"}},"VWAP:  ",this.state.vwapvalue&&this.state.vwapvalue.toFixed(2)),l.a.createElement("br",null),l.a.createElement("b",null," RSI: "),this.state.rsiValues&&this.state.rsiValues.map(function(e,t){return e>=60?l.a.createElement("span",{style:{color:"green",fontWeight:"bold"}}," ",e," \xa0"):l.a.createElement("span",{style:{color:e<=40?"red":"",fontWeight:"bold"}}," ",e," \xa0")}),l.a.createElement("br",null),l.a.createElement("b",null,"Vol:")," ",this.state.valumeData&&this.state.valumeData.map(function(t,a){return l.a.createElement("span",{style:{color:t>e.state.dailyAvgValume?"green":"",fontWeight:t>e.state.dailyAvgValume?"bold":""}}," ",(t/1e5).toFixed(2),"L \xa0")}),l.a.createElement("br",null),"  ",l.a.createElement("br",null)):"",l.a.createElement(M.a,{item:!0,xs:12,sm:9},l.a.createElement("div",{id:"showChartTitle"}),l.a.createElement("div",{id:"tvchart"}))),l.a.createElement(M.a,{item:!0,xs:12,sm:12,style:{overflowY:"scroll",height:"50vh"}},l.a.createElement(Je.a,{size:"small","aria-label":"sticky table"},l.a.createElement(St.a,{style:{width:"",whiteSpace:"nowrap"},variant:"head"},l.a.createElement(_e.a,{variant:"head",style:{fontWeight:"bold"}},l.a.createElement(qe.a,{className:"TableHeadFormat",align:"center"},"Symbol"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"center"},"Timestamp"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"center"},"Chng% ",l.a.createElement("b",{style:{color:"#20d020"}}," UP(",this.state.upsideMoveCount,")")," | ",l.a.createElement("b",{style:{color:"red"}}," Down(",this.state.downMoveCount,")")," | Total:  ",l.a.createElement("b",{style:{color:this.state.totalPerchentageChange>0?"green":"red"}},"  ",this.state.totalPerchentageChange&&this.state.totalPerchentageChange.toFixed(2),"% ")," from ",this.state.startingFrom," "),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"center"},"Open"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"center"},"High"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"center"},"Low"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"center"},"Close "),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"center"},"Volume"))),l.a.createElement(ze.a,{style:{width:"",whiteSpace:"nowrap"}},this.state.InstrumentHistroy&&this.state.InstrumentHistroy?this.state.InstrumentHistroy.map(function(t,a){return l.a.createElement(_e.a,{key:a,style:{background:100*(t[4]-t[1])/t[1]>=.3?"#20d020":100*(t[4]-t[1])/t[1]<=-.3?"#e66e6e":"none"}},l.a.createElement(qe.a,{align:"center"},e.state.tradingsymbol),l.a.createElement(qe.a,{align:"center"},new Date(t[0]).toLocaleString()),l.a.createElement(qe.a,{align:"center"}," ",l.a.createElement("b",null,100*(t[4]-t[1])/t[1]&&(100*(t[4]-t[1])/t[1]).toFixed(2),"%")),l.a.createElement(qe.a,{align:"center"},t[1]),l.a.createElement(qe.a,{align:"center"},t[2]),l.a.createElement(qe.a,{align:"center"},t[3]),l.a.createElement(qe.a,{align:"center"},t[4]),l.a.createElement(qe.a,{align:"center"},t[5]))}):""))))),l.a.createElement("br",null),l.a.createElement(Et.a,{style:{padding:"10px"}},l.a.createElement(W.a,{style:{textAlign:"center",background:"lightgray"}},"Backtest"),l.a.createElement(M.a,{direction:"row",container:!0,spacing:2},l.a.createElement(M.a,{item:!0,xs:12,sm:2,style:{marginTop:"15px"}},l.a.createElement(kt.a,{style:Vt.selectStyle},l.a.createElement(A.a,{htmlFor:"Nationality"},"Pattern Type"),l.a.createElement(wt.a,{value:this.state.patternType,name:"patternType",onChange:this.onChangePattern},l.a.createElement(Ct.a,{value:"TweezerTop"},"Tweezer Top"),l.a.createElement(Ct.a,{value:"TweezerBottom"},"Tweezer Bottom"),l.a.createElement(Ct.a,{value:"NR4"},"Narrow Range 4"),l.a.createElement(Ct.a,{value:"NR4ForNextDay"},"NR4 For Next Day"),l.a.createElement(Ct.a,{value:"NR4_SameDay"},"NR4 ByDate"),l.a.createElement(Ct.a,{value:"NR4_Daywide_daterage"},"NR4 Daywise Range")))),l.a.createElement(M.a,{item:!0,xs:12,sm:4},l.a.createElement(bt,{callbackFromParent:t})),l.a.createElement(M.a,{item:!0,xs:12,sm:6,style:{marginTop:"28px"}},this.state.backTestFlag?l.a.createElement(B.a,{variant:"contained",onClick:function(){return e.backTestAnyPattern()}},"Search"):l.a.createElement(l.a.Fragment,null," ",l.a.createElement(B.a,null," ",l.a.createElement(ut.a,null)," \xa0 \xa0 Scaning: ",this.state.stockTesting,"  ",this.state.runningTest,"  "),"  ",l.a.createElement(B.a,{variant:"contained",onClick:function(){return e.stopBacktesting()}},"Stop")," "),"SearchFailed:",this.state.searchFailed),l.a.createElement(M.a,{item:!0,xs:12,sm:12},"NR4"==this.state.patternType||"TweezerTop"==this.state.patternType||"TweezerBottom"==this.state.patternType||"NR4_SameDay"==this.state.patternType?l.a.createElement(Je.a,{size:"small","aria-label":"sticky table"},l.a.createElement(St.a,{style:{width:"",whiteSpace:"nowrap"},variant:"head"},l.a.createElement(_e.a,{style:{background:"lightgray"}},l.a.createElement(qe.a,{style:{color:localStorage.getItem("sumPerChange")>0?"#20d020":"#e66e6e"},align:"center"},l.a.createElement("b",null,localStorage.getItem("sumPerChange"),"%")),l.a.createElement(qe.a,{style:{color:localStorage.getItem("sumPnlValue")>0?"#20d020":"#e66e6e"},align:"center"},l.a.createElement("b",null,localStorage.getItem("sumPnlValue"))),l.a.createElement(qe.a,{style:{color:localStorage.getItem("sumPerChangeHighLow")>0?"#20d020":"#e66e6e"},align:"center"},l.a.createElement("b",null,localStorage.getItem("sumPerChangeHighLow"),"%")),l.a.createElement(qe.a,{style:{color:localStorage.getItem("sumPnlValueOnHighLow")>0?"#20d020":"#e66e6e"},align:"center"},l.a.createElement("b",null,localStorage.getItem("sumPnlValueOnHighLow"))),l.a.createElement(qe.a,{align:"left"},"Total Trades: ",this.state.backTestResult&&this.state.backTestResult.length," Win: ",localStorage.getItem("totalWin")," Loss: ",localStorage.getItem("totalLoss")),l.a.createElement(qe.a,{align:"center"},"Long: ",localStorage.getItem("totalLongTrade")," Short:  ",this.state.backTestResult&&this.state.backTestResult.length-localStorage.getItem("totalLongTrade")),l.a.createElement(qe.a,{align:"left",colSpan:2}," Total Invested  ",localStorage.getItem("totalInvestedValue")),l.a.createElement(qe.a,{align:"center",colSpan:4}," Average gross/trade PnL:  ",l.a.createElement("b",{style:{color:localStorage.getItem("sumPerChange")/this.state.backTestResult.length>0?"#20d020":"#e66e6e"}},(localStorage.getItem("sumPerChange")/this.state.backTestResult.length).toFixed(2),"%"))),l.a.createElement(_e.a,{variant:"head",style:{fontWeight:"bold"}},l.a.createElement(qe.a,{className:"TableHeadFormat",align:"center"},"CPnl% "),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"center"},"CNetPnL "),l.a.createElement(qe.a,{className:"TableHeadFormat",title:"High on long side | Low in short side",align:"center"},"HLPnL% "),l.a.createElement(qe.a,{className:"TableHeadFormat",title:"High on long side | Low in short side",align:"center"},"HLNet PnL"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"Symbol"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"EntryTaken"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"center"},"SquiredOffAt"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"center"},"ExitStatus"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"center"},"Buy"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"center"},"Sell(Qty)"),l.a.createElement(qe.a,{className:"TableHeadFormat",title:"High on long side | Low in short side",align:"center"},"High/Low"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"center"},"StopLoss"))),l.a.createElement(ze.a,{style:{width:"",whiteSpace:"nowrap"}},this.state.backTestResult?this.state.backTestResult.map(function(t,m){return l.a.createElement(_e.a,{hover:!0,key:m},l.a.createElement(qe.a,Object.assign({style:{color:t.perChange>0?"#20d020":"#e66e6e"},align:"center"},a+=parseFloat(t.perChange||0)),t.perChange,"%"),l.a.createElement(qe.a,Object.assign({},c=t.sellEntyPrice*(t.perChange-t.brokerageCharges)/100*t.quantity,r+=c,g+=t.sellEntyPrice*(t.perChange-t.brokerageCharges)/100*t.quantity>0?1:0,u+=t.sellEntyPrice*(t.perChange-t.brokerageCharges)/100*t.quantity<0?1:0,{style:{color:c>0?"#20d020":"#e66e6e"},align:"center"})," ",c.toFixed(2)),l.a.createElement(qe.a,Object.assign({style:{color:t.perChngOnHighLow>0?"#20d020":"#e66e6e"},align:"center"},n+=parseFloat(t.perChngOnHighLow||0))," ",l.a.createElement("b",null,t.perChngOnHighLow,"%")),l.a.createElement(qe.a,Object.assign({},o+=t.sellEntyPrice*(t.perChngOnHighLow-t.brokerageCharges)/100*t.quantity,{style:{color:t.sellEntyPrice*(t.perChngOnHighLow-t.brokerageCharges)/100*t.quantity>0?"#20d020":"#e66e6e"},align:"center"}),(t.sellEntyPrice*(t.perChngOnHighLow-t.brokerageCharges)/100*t.quantity).toFixed(2)),l.a.createElement(qe.a,{align:"left"}," ",l.a.createElement(B.a,{variant:"contained",style:{marginLeft:"20px"},onClick:function(){return e.showCandleBothChart(t)}},t.symbol," ",l.a.createElement(nt.a,null)," ")),l.a.createElement(qe.a,Object.assign({align:"left",style:{color:t.foundAt&&0==t.foundAt.indexOf("Long")?"#20d020":"#e66e6e"}},s+=t.foundAt&&0==t.foundAt.indexOf("Long")?1:0),t.foundAt),l.a.createElement(qe.a,{align:"center"},t.squareOffAt),l.a.createElement(qe.a,{align:"center"},t.exitStatus),l.a.createElement(qe.a,{align:"center"},t.buyExitPrice),l.a.createElement(qe.a,Object.assign({align:"center"},i+=t.foundAt&&0==t.foundAt.indexOf("Long")?parseFloat(t.buyExitPrice*t.quantity):parseFloat(t.sellEntyPrice*t.quantity)),t.sellEntyPrice,"(",t.quantity,")"),l.a.createElement(qe.a,{title:"High on long side | Low in short side",align:"center"},t.highAndLow),l.a.createElement(qe.a,{align:"center"},t.stopLoss))}):"",l.a.createElement(_e.a,{style:{background:"lightgray"}},l.a.createElement(qe.a,{style:{color:a>0?"#20d020":"#e66e6e"},align:"center"},l.a.createElement("b",null,localStorage.setItem("sumPerChange",a.toFixed(2)),a.toFixed(2),"%")),l.a.createElement(qe.a,{style:{color:r>0?"#20d020":"#e66e6e"},align:"center"},l.a.createElement("b",null,r.toFixed(2)),localStorage.setItem("sumPnlValue",r.toFixed(2))),l.a.createElement(qe.a,{style:{color:n>0?"#20d020":"#e66e6e"},align:"center"},l.a.createElement("b",null,localStorage.setItem("sumPerChangeHighLow",n.toFixed(2)),n.toFixed(2),"%")),l.a.createElement(qe.a,{style:{color:o>0?"#20d020":"#e66e6e"},align:"center"},l.a.createElement("b",null,o.toFixed(2)),localStorage.setItem("sumPnlValueOnHighLow",o.toFixed(2))),l.a.createElement(qe.a,{align:"left"}," ",localStorage.setItem("totalLongTrade",s)," ",localStorage.setItem("totalInvestedValue",i.toFixed(2))," "),l.a.createElement(qe.a,{align:"left"},localStorage.setItem("sumPerChangeHighLow",n.toFixed(2))," ",localStorage.setItem("sumPnlValueOnHighLow",o.toFixed(2))),l.a.createElement(qe.a,{align:"left"},localStorage.setItem("totalWin",g),localStorage.setItem("totalLoss",u)),l.a.createElement(qe.a,{align:"left"}," "),l.a.createElement(qe.a,{align:"left"}," "),l.a.createElement(qe.a,{align:"left"}," "),l.a.createElement(qe.a,{align:"left"}," "),l.a.createElement(qe.a,{align:"left"}," ")))):"","NR4_Daywide_daterage"==this.state.patternType?l.a.createElement(l.a.Fragment,null,this.state.dateAndTypeKeys?this.state.dateAndTypeKeys.map(function(t){return l.a.createElement(Je.a,{size:"small","aria-label":"sticky table",style:{padding:"5px"}},l.a.createElement(St.a,{style:{width:"",whiteSpace:"nowrap"},variant:"head"},l.a.createElement(_e.a,{style:{background:"lightgray"},key:t},l.a.createElement(qe.a,{colSpan:11,className:"TableHeadFormat",align:"center"}," ",t,"  ",(a=0,0,0,n=0,r=0,o=0,i=0,s=0,0))),l.a.createElement(_e.a,{key:t+1,variant:"head",style:{fontWeight:"bold",background:"lightgray"}},l.a.createElement(qe.a,{className:"TableHeadFormat",align:"center"}," CPnL% "),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"center"},"CNetPnL "),l.a.createElement(qe.a,{className:"TableHeadFormat",title:"High on long side | Low in short side",align:"center"},"HLPnL% "),l.a.createElement(qe.a,{className:"TableHeadFormat",title:"High on long side | Low in short side",align:"center"},"HLNet PnL"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"Symbol"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"FoundAt"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"center"},"Buy"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"center"},"Sell(Qty)"),l.a.createElement(qe.a,{className:"TableHeadFormat",title:"High on long side | Low in short side",align:"center"},"High/Low"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"center"},"SquiredOffAt"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"center"},"StopLoss"))),l.a.createElement(ze.a,{style:{width:"",whiteSpace:"nowrap"}},e.state.backTestResultDateRange[t].map(function(t,c){return l.a.createElement(_e.a,{hover:!0,key:c},l.a.createElement(qe.a,Object.assign({style:{color:t.perChange>0?"#20d020":"#e66e6e"},align:"center"},a+=parseFloat(t.perChange||0)),t.perChange,"%"),l.a.createElement(qe.a,Object.assign({},r+=t.sellEntyPrice*(t.perChange-t.brokerageCharges)/100*t.quantity,{style:{color:t.sellEntyPrice*(t.perChange-t.brokerageCharges)/100*t.quantity>0?"#20d020":"#e66e6e"},align:"center"})," ",(t.sellEntyPrice*(t.perChange-t.brokerageCharges)/100*t.quantity).toFixed(2)),l.a.createElement(qe.a,Object.assign({style:{color:t.perChngOnHighLow>0?"#20d020":"#e66e6e"},align:"center"},n+=parseFloat(t.perChngOnHighLow||0))," ",l.a.createElement("b",null,t.perChngOnHighLow,"%")),l.a.createElement(qe.a,Object.assign({},o+=t.sellEntyPrice*(t.perChngOnHighLow-t.brokerageCharges)/100*t.quantity,{style:{color:t.sellEntyPrice*(t.perChngOnHighLow-t.brokerageCharges)/100*t.quantity>0?"#20d020":"#e66e6e"},align:"center"}),(t.sellEntyPrice*(t.perChngOnHighLow-t.brokerageCharges)/100*t.quantity).toFixed(2)),l.a.createElement(qe.a,{align:"left"}," ",l.a.createElement(B.a,{variant:"contained",style:{marginLeft:"20px"},onClick:function(){return e.showCandleChart(t.candleChartData,t.symbol)}},t.symbol," ",l.a.createElement(nt.a,null)," ")),l.a.createElement(qe.a,Object.assign({align:"left",style:{color:0==t.foundAt.indexOf("Long")?"#20d020":"#e66e6e"}},s+=0==t.foundAt.indexOf("Long")?1:0),t.foundAt),l.a.createElement(qe.a,{align:"center"},t.buyExitPrice),l.a.createElement(qe.a,Object.assign({align:"center"},i+=0==t.foundAt.indexOf("Long")?parseFloat(t.buyExitPrice*t.quantity):parseFloat(t.sellEntyPrice*t.quantity)),t.sellEntyPrice,"(",t.quantity,")"),l.a.createElement(qe.a,{title:"High on long side | Low in short side",align:"center"},t.highAndLow),l.a.createElement(qe.a,{align:"center"},t.squareOffAt),l.a.createElement(qe.a,{align:"center"},t.stopLoss))}),l.a.createElement(_e.a,{style:{background:"lightgray"}},l.a.createElement(qe.a,{style:{color:a>0?"#20d020":"#e66e6e"},align:"center"},l.a.createElement("b",null,localStorage.setItem("sumPerChange",a.toFixed(2)),a.toFixed(2),"%")),l.a.createElement(qe.a,{style:{color:r>0?"#20d020":"#e66e6e"},align:"center"},l.a.createElement("b",null,r.toFixed(2)),localStorage.setItem("sumPnlValue",r.toFixed(2))),l.a.createElement(qe.a,{style:{color:n>0?"#20d020":"#e66e6e"},align:"center"},l.a.createElement("b",null,localStorage.setItem("sumPerChangeHighLow",n.toFixed(2)),n.toFixed(2),"%")),l.a.createElement(qe.a,{style:{color:o>0?"#20d020":"#e66e6e"},align:"center"},l.a.createElement("b",null,o.toFixed(2)),localStorage.setItem("sumPnlValueOnHighLow",o.toFixed(2))),l.a.createElement(qe.a,{align:"left"}," ",localStorage.setItem("totalLongTrade",s)," ",localStorage.setItem("totalInvestedValue",i.toFixed(2))," "),l.a.createElement(qe.a,{align:"left"},localStorage.setItem("sumPerChangeHighLow",n.toFixed(2))," ",localStorage.setItem("sumPnlValueOnHighLow",o.toFixed(2))),l.a.createElement(qe.a,{align:"left"}),l.a.createElement(qe.a,{align:"left"}," "),l.a.createElement(qe.a,{align:"left"}," "),l.a.createElement(qe.a,{align:"left"}," "),l.a.createElement(qe.a,{align:"left"}," "))))}):""):"","NR4ForNextDay"==this.state.patternType?l.a.createElement(W.a,{component:"h3",variant:"h6",color:"primary",gutterBottom:!0},"NR4 For Next Day  (",this.state.FoundPatternList.length,")  at ",this.state.endDate&&this.state.endDate?this.state.endDate.toString().substr(0,16):(new Date).toString().substr(0,16)):"","NR4ForNextDay"==this.state.patternType?l.a.createElement(Je.a,{size:"small","aria-label":"sticky table"},l.a.createElement(St.a,{style:{width:"",whiteSpace:"nowrap"},variant:"head"},l.a.createElement(_e.a,{variant:"head",style:{fontWeight:"bold"}},l.a.createElement(qe.a,{className:"TableHeadFormat",align:"center"},"Sr "),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"Symbol "),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"FoundAt "),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"Past Performance "),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"BuyAt"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"SellAt"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"High"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"Low"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"Close"))),l.a.createElement(ze.a,{style:{width:"",whiteSpace:"nowrap"}},this.state.FoundPatternList?this.state.FoundPatternList.map(function(t,a){return l.a.createElement(_e.a,{hover:!0,key:a},l.a.createElement(qe.a,{align:"center"},a+1),l.a.createElement(qe.a,{align:"left"}," ",l.a.createElement(B.a,{variant:"contained",style:{marginLeft:"20px"},onClick:function(){return e.showCandleChart(t.candleChartData,t.symbol)}},t.symbol," ",l.a.createElement(nt.a,null)," ")),l.a.createElement(qe.a,{align:"left"},t.foundAt.substr(0,16)),l.a.createElement(qe.a,{align:"left",title:"based on last one 6 month"},l.a.createElement("span",{style:{background:t.pastPerferm.totalLongPer/t.pastPerferm.totalLongs>=1?"#92f192":""}},l.a.createElement("b",null,t.pastPerferm.totalLongs),"  Longs:  ",t.pastPerferm.totalLongPer,"% (",(t.pastPerferm.totalLongPer/t.pastPerferm.totalLongs).toFixed(2),"% per trade)  ")," ",l.a.createElement("br",null),"Longs on High%: ",t.pastPerferm.totalLongHighPer,"%  (",(t.pastPerferm.totalLongHighPer/t.pastPerferm.totalLongs).toFixed(2),"% per trade)",l.a.createElement("br",null),t.longCandles&&t.longCandles.map(function(a,n){return l.a.createElement(l.a.Fragment,null,l.a.createElement("a",{style:{textDecoration:"underline",background:"lightgray",cursor:"pointer"},onClick:function(){return e.showCandleChart(a.candleChartData,t.symbol,a)}}," ",a.foundAt.substr(7,10)," "),"  \xa0")}),l.a.createElement("br",null),l.a.createElement("span",{style:{background:t.pastPerferm.totalShortPer/t.pastPerferm.totalShort>=1?"#e87b7b":""}},l.a.createElement("b",null,t.pastPerferm.totalShort)," Short: ",t.pastPerferm.totalShortPer,"% (",(t.pastPerferm.totalShortPer/t.pastPerferm.totalShort).toFixed(2),"% per trade) ")," ",l.a.createElement("br",null),"Short on Low%: ",t.pastPerferm.totalShortLowPer,"% (",(t.pastPerferm.totalShortLowPer/t.pastPerferm.totalShort).toFixed(2),"% per trade)",l.a.createElement("br",null),t.shortCandles&&t.shortCandles.map(function(a,n){return l.a.createElement(l.a.Fragment,null,l.a.createElement("a",{style:{textDecoration:"underline",background:"lightgray",cursor:"pointer"},onClick:function(){return e.showCandleChart(a.candleChartData,t.symbol,a)}}," ",a.foundAt.substr(7,10),"  ")," \xa0")})),l.a.createElement(qe.a,{align:"left"},t.BuyAt),l.a.createElement(qe.a,{align:"left"},t.SellAt),l.a.createElement(qe.a,{align:"left"},t.high),l.a.createElement(qe.a,{align:"left"},t.low),l.a.createElement(qe.a,{align:"left"},t.close))}):"")):"")))),l.a.createElement(M.a,{item:!0,xs:12,sm:2},l.a.createElement(M.a,{style:{display:"visible"},spacing:1,direction:"row",alignItems:"center",container:!0},l.a.createElement(M.a,{item:!0,xs:12,sm:12},l.a.createElement(jt,{data:{list:this.state.oneHourBullBearCheckList,title:"Hourly Bullish/Bearish",LoadSymbolDetails:this.LoadSymbolDetails}})),l.a.createElement(M.a,{item:!0,xs:12,sm:12},l.a.createElement(jt,{data:{list:this.state.volumeBreakoutlast5CandleList,title:"Last 5 bar Volume breakout",LoadSymbolDetails:this.LoadSymbolDetails}})),l.a.createElement(M.a,{item:!0,xs:12,sm:12},l.a.createElement(jt,{data:{list:this.state.fastMovementList,title:"Fast Movement",LoadSymbolDetails:this.LoadSymbolDetails}})),l.a.createElement(M.a,{item:!0,xs:12,sm:12},l.a.createElement(Ht,{data:{list:this.state.volumeCrossedList,title:"Average Volume Crossed",LoadSymbolDetails:this.LoadSymbolDetails}})),l.a.createElement(M.a,{item:!0,xs:12,sm:12},l.a.createElement(Ht,{data:{list:this.state.openEqualLowList,title:"Open = Low : Buy",LoadSymbolDetails:this.LoadSymbolDetails}})),l.a.createElement(M.a,{item:!0,xs:12,sm:12},l.a.createElement(Ht,{data:{list:this.state.openEqualHighList,title:"Open = High : Sell",LoadSymbolDetails:this.LoadSymbolDetails}})),l.a.createElement(M.a,{item:!0,xs:12,sm:12},l.a.createElement(Ht,{data:{list:this.state.slowMotionStockList,title:"Last 5 days no Movement",LoadSymbolDetails:this.LoadSymbolDetails}}))))))}}]),t}(l.a.Component),Vt={formContainer:{display:"flex",flexFlow:"row wrap"},textStyle:{display:"flex",justifyContent:"center"},imgStyle:{display:"flex"},selectStyle:{minWidth:"100%",marginBottom:"10px"},MuiTextField:{overflowY:"scroll",fontSize:"12px",maxHeight:"50px"},footerButton:{position:"fixed",left:0,bottom:"20px",width:"100%",textAlign:"right"}},Wt=Rt,Ut=L.a.create({baseURL:""}),Jt=function(){return function(){var e=Object(ae.a)(ee.a.mark(function e(t){var a,n;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={allPacks:!0,portal:!0},e.next=3,Ut.post("getPrepaidPacks",a);case 3:n=e.sent,t({type:"SET PACK LOADED",payload:n});case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},_t=a(471),qt=(a(77),{PaperProps:{style:{maxHeight:224,width:250}}}),zt=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(S.a)(this,Object(v.a)(t).call(this,e))).onChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value)),a.filterOptionChain(e.target.name,e.target.value)},a.filterOptionChain=function(e,t){var n=[],l=a.state.optionChainData&&a.state.optionChainData.records&&a.state.optionChainData.records.data;if("expiry"===e&&"All"===t&&(n=l),"expiry"===e)for(var r=0;r<l.length;r++){var o=l[r];o.expiryDate===t&&n.push(o)}if("strike"===e)for(var i=0;i<l.length;i++){var s=l[i];s.strikePrice===t&&n.push(s)}a.setState({filtered:n,FilteredBY:e+" "+t})},a.getDataforStrike=function(e){for(var t=JSON.parse(localStorage.getItem("optionChainData")).records.data,a=0,n=0,l=0;l<t.length;l++){var r=t[l];e===r.strikePrice&&(r.CE&&r.CE.openInterest&&(a+=r.CE.openInterest),r.PE&&r.PE.openInterest&&(n+=r.PE.openInterest))}return{strikePrice:e,sumOfCEoi:a,sumOfPEoi:n}},a.findSupportResistence=function(e){for(var t=e&&e.records&&e.records.data,n=0,l=0,r=0,o=0,i=0;i<t.length;i++){var s=t[i];s&&s.PE&&(n+=s.PE.openInterest,r+=s.PE.changeinOpenInterest),s&&s.CE&&(l+=s.CE.openInterest,o+=s.CE.changeinOpenInterest)}e.records.expiryDates,e.records.strikePrices;var c=[],m=0,g=0;[14e3,14050,14100,14150,14200,14050,14300,14350,14400,14450,14500,14550,14600,14650,14700,14750,14800,14850,14900,14950,15e3,15050,15100,15150,15200,15250].forEach(function(e){var t=a.getDataforStrike(e);m+=t.sumOfPEoi,g+=t.sumOfCEoi,c.push(t)}),a.setState({AllspTotalOI:c,selectedSPpcr:(m/g).toFixed(3),totalspeoi:m,totalsceoi:g}),a.setState({CEoi:l,PEoi:n,allStrikediff:n-l,CEoiChange:o,PEoiChange:r,allStrikeChngeDiff:r-o})},a.state={products:[],stopnview:"",curnewdata:"",underlyingValue:"",timestamp:"",totalCOI:0,expiry:"",strike:"",FilteredBY:"",AllspTotalOI:[],PEoi:0,CEoi:0,pcrTable:JSON.parse(localStorage.getItem("pcrTable"))&&JSON.parse(localStorage.getItem("pcrTable")).data,optionChainData:JSON.parse(localStorage.getItem("optionChainData")),filtered:JSON.parse(localStorage.getItem("optionChainData"))&&JSON.parse(localStorage.getItem("optionChainData")).filtered&&JSON.parse(localStorage.getItem("optionChainData")).filtered.data},a.findSupportResistence=a.findSupportResistence.bind(Object(k.a)(a)),a}return Object(w.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.loadPackList(),JSON.parse(localStorage.getItem("cpdata"))?this.setState({products:JSON.parse(localStorage.getItem("cpdata")).data}):localStorage.setItem("cpdata",JSON.stringify({data:[]})),JSON.parse(localStorage.getItem("pcrTable"))?this.setState({pcrTable:JSON.parse(localStorage.getItem("pcrTable")).data}):localStorage.setItem("pcrTable",JSON.stringify({data:[]}));var t=new Date;t.getHours()>=9&&t.getHours()<16&&setInterval(function(){e.loadPackList()},120002),setInterval(function(){e.updatepcr()},120020)}},{key:"loadPackList",value:function(){var e=this;T.getBNcpdata("NIFTY").then(function(t){var a=t.data&&t.data;if(localStorage.setItem("optionChainData",JSON.stringify(a)),e.setState({filtered:a.filtered&&a.filtered.data,optionChainData:a}),a.filtered){var n=a.filtered.PE.totOI-a.filtered.CE.totOI,l={dateTime:e.dateFormat(new Date),totCEOI:a.filtered.CE.totOI,totCEVol:a.filtered.CE.totVol,totPEOI:a.filtered.PE.totOI,totPEVol:a.filtered.PE.totVol,diff:n,totChangeINOICall:parseInt(localStorage.getItem("totCEOIChange")),totChangeINOIPut:parseInt(localStorage.getItem("totPEOIChange")),totChangeINOIDiff:parseInt(localStorage.getItem("totPEOIChange"))-parseInt(localStorage.getItem("totCEOIChange"))};e.setState({curnewdata:l});if(n>0?"BUY":"SELL",document.getElementById("title").innerHTML=(n/1e5).toFixed(2)+"|"+((localStorage.getItem("totPEOIChange")-localStorage.getItem("totCEOIChange"))/1e5).toFixed(2)+"L NIFTY ",JSON.parse(localStorage.getItem("cpdata"))){var r=JSON.parse(localStorage.getItem("cpdata")),o=r&&r.data[0];o?(l.isDuplicate=l.diff==o.diff,l.totCEOIChange=(100*(l.totCEOI-o.totCEOI)/o.totCEOI).toFixed(3),l.totPEOIChange=(100*(l.totPEOI-o.totPEOI)/o.totPEOI).toFixed(3),l.totDiffChange=(100*(l.diff-o.diff)/o.diff).toFixed(3)):(l.isDuplicate=!1,l.totCEOIChange=0,l.totPEOIChange=0,l.totDiffChange=0),r.data.unshift(l),a.records&&(r.timestamp=a.records.timestamp,r.underlyingValue=a.records.underlyingValue),localStorage.setItem("cpdata",JSON.stringify(r)),e.setState({products:r.data,underlyingValue:a.records.underlyingValue,timestamp:a.records.timestamp})}}e.updatepcr(),e.setState({pcrTable:JSON.parse(localStorage.getItem("pcrTable"))&&JSON.parse(localStorage.getItem("pcrTable")).data})})}},{key:"updatepcr",value:function(){var e={allPCR:(this.state.PEoi/this.state.CEoi).toFixed(3),expiryPCR:localStorage.getItem("thisWeekPCR"),selectedSPpcr:this.state.selectedSPpcr};if(JSON.parse(localStorage.getItem("pcrTable"))){var t=JSON.parse(localStorage.getItem("pcrTable"));t.data.unshift(e),localStorage.setItem("pcrTable",JSON.stringify(t))}console.log(e),this.setState({pcrTable:t})}},{key:"dateFormat",value:function(e){return rt(e).format("DD-MM-YYYY h:mm:ss A")}},{key:"render",value:function(){var e,t,a,n=this,r=0,o=0,i=0,s=0;return l.a.createElement(l.a.Fragment,null,l.a.createElement(ht,null),l.a.createElement(M.a,{direction:"row",container:!0,className:"flexGrow",spacing:1,style:{paddingLeft:"5px",paddingRight:"5px"}},l.a.createElement(M.a,{item:!0,xs:7,sm:7},l.a.createElement(W.a,{component:"h3",variant:"h6",color:"primary"},"My View(",this.state.products&&this.state.products.length,") ",l.a.createElement("b",null," Nifty: ",this.state.underlyingValue)," at Time: ",this.state.timestamp)),l.a.createElement(M.a,{item:!0,xs:2,sm:2},l.a.createElement(kt.a,{style:Gt.selectStyle},l.a.createElement(A.a,{id:"expiry"},"Select Expiry Date"),l.a.createElement(wt.a,{id:"expiry",name:"expiry",value:this.state.expiry,onChange:this.onChange,input:l.a.createElement(_t.a,null),MenuProps:qt},l.a.createElement(Ct.a,{key:"All",value:"All"},"All"),this.state.optionChainData&&this.state.optionChainData.records&&this.state.optionChainData.records.expiryDates?this.state.optionChainData.records.expiryDates.map(function(e,t){return l.a.createElement(Ct.a,{key:e+"key"+t,value:e},e)}):""))),l.a.createElement(M.a,{item:!0,xs:2,sm:2},l.a.createElement(kt.a,{style:Gt.selectStyle},l.a.createElement(A.a,{id:"strike"},"Select Strick Price"),l.a.createElement(wt.a,{labelId:"strike",id:"strike","max-height":"100%",name:"strike",value:this.state.strike,onChange:this.onChange,input:l.a.createElement(_t.a,null),MenuProps:qt},this.state.optionChainData&&this.state.optionChainData.records&&this.state.optionChainData.records.strikePrices?this.state.optionChainData.records.strikePrices.map(function(e){return l.a.createElement(Ct.a,{key:e,value:e},e)}):""))),l.a.createElement(M.a,{item:!0,xs:1,sm:1,style:{paddingTop:"20px",paddingLeft:"20px"}},l.a.createElement(B.a,{variant:"contained",color:"primary",onClick:function(){return n.loadPackList()}},"Refesh"))),l.a.createElement(M.a,{item:!0,xs:12,sm:12},l.a.createElement(Et.a,{style:{padding:"10px",overflow:"auto"}},l.a.createElement(M.a,Object(y.a)({container:!0,spacing:3,direction:"row",alignItems:"center"},"container",!0),l.a.createElement(M.a,{item:!0,xs:3,sm:3},l.a.createElement("span",null,"All PUT OI: ",l.a.createElement("b",null,this.state.PEoi," (",(this.state.PEoi/1e5).toFixed(3),"L)")),l.a.createElement("br",null),l.a.createElement("span",null,"All CALL OI: ",l.a.createElement("b",null,this.state.CEoi," (",(this.state.CEoi/1e5).toFixed(3),"L)")),l.a.createElement("br",null),l.a.createElement("span",null,"All Put-Call Diff: ",this.state.allStrikediff>0?l.a.createElement("b",{style:{color:"green"}},this.state.allStrikediff," (",(this.state.allStrikediff/1e5).toFixed(3),"L)"):l.a.createElement("b",{style:{color:"red"}},this.state.allStrikediff," (",(this.state.allStrikediff/1e5).toFixed(3),"L)"))),l.a.createElement(M.a,{item:!0,xs:3,sm:3},l.a.createElement("span",null,"All PUT Chng in OI: ",l.a.createElement("b",null,this.state.PEoiChange," (",(this.state.PEoiChange/1e5).toFixed(3),"L)")),l.a.createElement("br",null),l.a.createElement("span",null,"All CALL Chng in  OI: ",l.a.createElement("b",null,this.state.CEoiChange," (",(this.state.CEoiChange/1e5).toFixed(3),"L)")),l.a.createElement("br",null),l.a.createElement("span",null,"All Put-Call Chng in Diff: ",this.state.allStrikeChngeDiff>0?l.a.createElement("b",{style:{color:"green"}},this.state.allStrikeChngeDiff," (",(this.state.allStrikeChngeDiff/1e5).toFixed(3),"L)"):l.a.createElement("b",{style:{color:"red"}},this.state.allStrikeChngeDiff," (",(this.state.allStrikeChngeDiff/1e5).toFixed(3),"L)"))),l.a.createElement(M.a,{item:!0,xs:2,sm:2},l.a.createElement(W.a,{component:"h3",variant:"body1",color:"primary"},l.a.createElement("span",null,"ALL PCR: ",l.a.createElement("b",null,(this.state.PEoi/this.state.CEoi).toFixed(3)," ")))),l.a.createElement(M.a,{item:!0,xs:2,sm:2},l.a.createElement(W.a,{component:"h3",variant:"body1",color:"primary"},l.a.createElement("span",null,"Expire Week PCR: ",l.a.createElement("b",null,localStorage.getItem("thisWeekPCR")," ")))),l.a.createElement(M.a,{item:!0,xs:2,sm:2},l.a.createElement(W.a,{component:"h3",variant:"body1",color:"primary",style:{justifyContent:"left"}},l.a.createElement("span",null,"14000 to 15250 PCR: ",l.a.createElement("b",null,this.state.selectedSPpcr," "))))))),l.a.createElement(M.a,{direction:"row",container:!0,className:"flexGrow",spacing:0,style:{paddingLeft:"5px",paddingRight:"5px"}},l.a.createElement(M.a,{item:!0,xs:7,sm:7,style:{padding:"2px",overflow:"auto",height:"250px"}},l.a.createElement(Je.a,(e={id:"tabledata",stickyHeader:!0,"aria-label":"sticky table"},Object(y.a)(e,"id","tabledata"),Object(y.a)(e,"size","small"),e),l.a.createElement(St.a,{style:{},variant:"head"},l.a.createElement(_e.a,{variant:"head"},l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"Time")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"VIEW")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"Put-Call(diff)")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"Chng in OI(diff)")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"PUT OI")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"Chng Put OI")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"Call OI")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"Chng Call OI")))),l.a.createElement(ze.a,{hover:!0,style:{width:"",whiteSpace:"nowrap"}},this.state.products?this.state.products.map(function(e){return l.a.createElement(_e.a,{key:e.dateTime,style:{background:e.isDuplicate?"lightgray":""}},l.a.createElement(qe.a,{align:"center"},e.dateTime.substring(19,11)),l.a.createElement(qe.a,{align:"center"},e.diff>0?l.a.createElement(W.a,{variant:"body2",style:{color:"green"}},"BUY"):l.a.createElement(W.a,{variant:"body2",style:{color:"red"}},"SELL")),l.a.createElement(qe.a,{align:"center"},e.diff," (",(e.diff/1e5).toFixed(2),"L)(",e.totDiffChange>0?l.a.createElement("span",{style:{color:"green",fontWeight:"bold"}},e.totDiffChange,"%"):"0.000"==e.totDiffChange?l.a.createElement("span",null,e.totDiffChange,"%"):l.a.createElement("span",{style:{color:"red",fontWeight:"bold"}},e.totDiffChange,"%"),") "),l.a.createElement(qe.a,{align:"center"},e.totChangeINOIDiff," (",(e.totChangeINOIDiff/1e5).toFixed(2),"L)"),l.a.createElement(qe.a,{align:"center"},e.totPEOI," (",e.totPEOIChange>0?l.a.createElement("span",{style:{color:"green",fontWeight:"bold"}},e.totPEOIChange,"%"):"0.000"==e.totPEOIChange?l.a.createElement("span",null,e.totPEOIChange,"%"):l.a.createElement("span",{style:{color:"red",fontWeight:"bold"}},e.totPEOIChange,"%"),")"),l.a.createElement(qe.a,{align:"center"},e.totChangeINOIPut," "),l.a.createElement(qe.a,{align:"center"},e.totCEOI," (",e.totCEOIChange>0?l.a.createElement("span",{style:{color:"green",fontWeight:"bold"}},e.totCEOIChange,"%"):"0.000"==e.totCEOIChange?l.a.createElement("span",null,e.totCEOIChange,"%"):l.a.createElement("span",{style:{color:"red",fontWeight:"bold"}},e.totCEOIChange,"%"),")"),l.a.createElement(qe.a,{align:"center"},e.totChangeINOICall))}):l.a.createElement(ut.a,null)))),l.a.createElement(M.a,{item:!0,xs:3,sm:3,style:{padding:"2px",overflow:"auto",height:"250px"}},l.a.createElement(Je.a,(t={style:{borderLeft:"dashed",borderRight:"dashed",fontWeight:"500"},id:"tabledata",stickyHeader:!0,"aria-label":"sticky table"},Object(y.a)(t,"id","tabledata"),Object(y.a)(t,"size","small"),t),l.a.createElement(St.a,{style:{},variant:"head"},l.a.createElement(_e.a,{variant:"head"},l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"Total CE OI ",l.a.createElement("br",null),(this.state.totalsceoi/1e5).toFixed(3),"L")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"Strike Price")," "),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"Total PE OI",l.a.createElement("br",null),(this.state.totalspeoi/1e5).toFixed(3),"L")))),l.a.createElement(ze.a,{style:{width:"",whiteSpace:"nowrap"}},this.state.AllspTotalOI?this.state.AllspTotalOI.map(function(e){return l.a.createElement(_e.a,{hover:!0,key:e.dateTime},l.a.createElement(qe.a,{align:"center",style:{backgroundColor:e.strikePrice<n.state.underlyingValue?"#ded6a269":""}},e.sumOfCEoi," (",(e.sumOfCEoi/1e5).toFixed(2),"L)"),l.a.createElement(qe.a,{align:"center"},e.strikePrice),l.a.createElement(qe.a,{align:"center",style:{backgroundColor:e.strikePrice>n.state.underlyingValue?"#ded6a269":""}},e.sumOfPEoi," (",(e.sumOfPEoi/1e5).toFixed(2),"L)"))}):l.a.createElement(ut.a,null)))),l.a.createElement(M.a,{item:!0,xs:2,sm:2,style:{padding:"2px",overflow:"auto",height:"250px"}},l.a.createElement(Je.a,(a={id:"tabledata",stickyHeader:!0,"aria-label":"sticky table"},Object(y.a)(a,"id","tabledata"),Object(y.a)(a,"size","small"),a),l.a.createElement(St.a,{variant:"head"},l.a.createElement(_e.a,{variant:"head"},l.a.createElement(qe.a,{align:"center"},"ALL Pcr"),l.a.createElement(qe.a,{align:"center"},"Expiry Pcr "),l.a.createElement(qe.a,{align:"center"},"Selected Pcr"))),l.a.createElement(ze.a,{style:{whiteSpace:"nowrap"}},this.state.pcrTable&&this.state.pcrTable.length>0&&this.state.pcrTable?this.state.pcrTable.map(function(e){return l.a.createElement(_e.a,{hover:!0,key:e.expiryPCR},l.a.createElement(qe.a,{align:"center"},e.allPCR," "),l.a.createElement(qe.a,{align:"center"},e.expiryPCR),l.a.createElement(qe.a,{align:"center"},e.selectedSPpcr," "))}):l.a.createElement(ut.a,null)))),l.a.createElement(M.a,{item:!0,xs:12,sm:12,style:{padding:"2px",overflow:"auto",height:"900px"}},l.a.createElement(Je.a,{stickyHeader:!0,"aria-label":"sticky table",id:"tabledata",size:"small"},l.a.createElement(St.a,{variant:"head"},l.a.createElement(_e.a,{variant:"head"},l.a.createElement(qe.a,{colSpan:6,align:"center"},l.a.createElement("b",null,"CALL")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null)),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null)),l.a.createElement(qe.a,{colSpan:6,align:"center"},l.a.createElement("b",null,"PUT"))),l.a.createElement(_e.a,{variant:"head"},l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"OI Total OI ",l.a.createElement("br",null),localStorage.getItem("totCEOI"),"(",(localStorage.getItem("totCEOI")/1e5).toFixed(3),"L) ")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"Chng in OI ",l.a.createElement("br",null),localStorage.getItem("totCEOIChange"),"(",(localStorage.getItem("totCEOIChange")/1e5).toFixed(3),"L)")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"IV")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"Delta")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"LTP")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"CHNG")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("span",{style:{color:"#3e85c5",fontWeight:"bold"}}," STRIKE PRICE")," "),l.a.createElement(qe.a,{align:"center"},l.a.createElement("span",{style:{color:"#3e85c5",fontWeight:"bold"}}," Expiry")," "),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"CHNG")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"LTP")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"IV")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"Delta")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"Chng in OI ",l.a.createElement("br",null),localStorage.getItem("totPEOIChange"),"(",(localStorage.getItem("totPEOIChange")/1e5).toFixed(3),"L)")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"OI ",l.a.createElement("br",null),localStorage.getItem("totPEOI"),"(",(localStorage.getItem("totPEOI")/1e5).toFixed(3),"L)")))),l.a.createElement(ze.a,null,this.state.filtered?this.state.filtered.map(function(e,t){return l.a.createElement(_e.a,{hover:!0,key:t,style:{background:e.isDuplicate?"lightgray":""}},e&&e.CE&&e.PE?l.a.createElement(l.a.Fragment,null,l.a.createElement(qe.a,Object.assign({},r+=e.CE.openInterest,{style:{backgroundColor:e.strikePrice<e.CE.underlyingValue?"#ded6a269":""},align:"center"}),e.CE.openInterest),l.a.createElement(qe.a,Object.assign({},o+=e.CE.changeinOpenInterest,{style:{backgroundColor:e.strikePrice<e.CE.underlyingValue?"#ded6a269":""},align:"center"}),e.CE.changeinOpenInterest),l.a.createElement(qe.a,{align:"center"},e.CE.impliedVolatility," "),l.a.createElement(qe.a,{align:"center"},(10*(e.CE.change/e.strikePrice-e.CE.underlyingValue)).toFixed(2)," "),l.a.createElement(qe.a,{style:{backgroundColor:e.strikePrice<e.CE.underlyingValue?"#ded6a269":""},align:"center"},l.a.createElement("span",{style:{color:"#3e85c5",fontWeight:"bold"}}," ",e.CE.lastPrice),"(",e.CE.pChange>0?l.a.createElement("span",{style:{color:"green",fontWeight:"bold"}},e.CE.pChange.toFixed(2),"%"):0==e.CE.pChange?l.a.createElement("span",null,e.CE.pChange.toFixed(2),"%"):l.a.createElement("span",{style:{color:"red",fontWeight:"bold"}},e.CE.pChange.toFixed(2),"%"),") "),l.a.createElement(qe.a,{style:{backgroundColor:e.strikePrice<e.CE.underlyingValue?"#ded6a269":""},align:"center"},e.CE.change.toFixed(2)," "),l.a.createElement(qe.a,{style:{borderLeft:"dashed",borderRight:"dashed",fontWeight:"500"},align:"center"},l.a.createElement("span",null," ",l.a.createElement("a",{href:"#",style:{textDecoration:"none"},onClick:function(){return n.filterOptionChain("strike",e.strikePrice)}}," ",e.strikePrice)," ")," "),l.a.createElement(qe.a,{style:{borderRight:"dashed",whiteSpace:"nowrap"},align:"center"},l.a.createElement("span",{style:{paddingLeft:"5px",paddingRight:"5px"}}," ",l.a.createElement("a",{href:"#",style:{textDecoration:"none"},onClick:function(){return n.filterOptionChain("expiry",e.expiryDate)}}," ",e.expiryDate))," "),l.a.createElement(qe.a,{style:{backgroundColor:e.strikePrice>e.CE.underlyingValue?"#ded6a269":""},align:"center"},e.PE.change.toFixed(2)," "),l.a.createElement(qe.a,{style:{backgroundColor:e.strikePrice>e.CE.underlyingValue?"#ded6a269":""},align:"center"},l.a.createElement("span",{style:{color:"#3e85c5",fontWeight:"bold"}}," ",e.PE.lastPrice),"(",e.PE.pChange>0?l.a.createElement("span",{style:{color:"green",fontWeight:"bold"}},e.PE.pChange.toFixed(2),"%"):0==e.PE.pChange?l.a.createElement("span",null,e.PE.pChange.toFixed(2),"%"):l.a.createElement("span",{style:{color:"red",fontWeight:"bold"}},e.PE.pChange.toFixed(2),"%"),")"),l.a.createElement(qe.a,{align:"center"},e.PE.impliedVolatility," "),l.a.createElement(qe.a,{align:"center"},(10*(e.PE.change/e.strikePrice-e.PE.underlyingValue)).toFixed(2)," "),l.a.createElement(qe.a,Object.assign({},s+=e.PE.changeinOpenInterest,{style:{backgroundColor:e.strikePrice>e.CE.underlyingValue?"#ded6a269":""},align:"center"}),e.PE.changeinOpenInterest),l.a.createElement(qe.a,Object.assign({},i+=e.PE.openInterest,{style:{backgroundColor:e.strikePrice>e.CE.underlyingValue?"#ded6a269":""},align:"center"}),e.PE.openInterest," ")):"")}):l.a.createElement(ut.a,null),l.a.createElement(_e.a,{variant:"head"},l.a.createElement(qe.a,Object.assign({align:"center"},localStorage.setItem("totCEOI",r)),l.a.createElement("b",null,r,l.a.createElement("br",null),"(",(r/1e5).toFixed(3),"L)")),l.a.createElement(qe.a,Object.assign({align:"center"},localStorage.setItem("totCEOIChange",o)),l.a.createElement("b",null,o,l.a.createElement("br",null),"(",(o/1e5).toFixed(3),"L)")," "),l.a.createElement(qe.a,Object.assign({align:"center"},localStorage.setItem("totCEVol",0)),l.a.createElement("b",null,0,l.a.createElement("br",null),"(",(0).toFixed(3),"L)")),l.a.createElement(qe.a,{colSpan:3,align:"center"}),l.a.createElement(qe.a,Object.assign({},localStorage.setItem("thisWeekPCR",(i/r).toFixed(3)),{align:"center",colSpan:2}),l.a.createElement("b",null," PCR : ",(i/r).toFixed(3))),l.a.createElement(qe.a,{colSpan:3,align:"center"}),l.a.createElement(qe.a,Object.assign({align:"center"},localStorage.setItem("totPEVol",0)),l.a.createElement("b",null,0,l.a.createElement("br",null),"(",(0).toFixed(3),"L)")),l.a.createElement(qe.a,Object.assign({align:"center"},localStorage.setItem("totPEOIChange",s)),l.a.createElement("b",null,s,l.a.createElement("br",null),"(",(s/1e5).toFixed(3),"L)")," "),l.a.createElement(qe.a,Object.assign({align:"center"},localStorage.setItem("totPEOI",i)),l.a.createElement("b",null,i,l.a.createElement("br",null),"(",(i/1e5).toFixed(3),"L)")," ")))))))}}]),t}(l.a.Component),Gt={tableStyle:{display:"flex",justifyContent:"center"},selectStyle:{marginBottom:"0px",minWidth:240,maxWidth:240}},Kt=Object(i.b)(function(e){return{packs:e.packs.packs.data}},{setPackLoaded:Jt})(zt);function Qt(e){var t=e.diffData&&e.diffData.data,a=[],n=[],r=[],o=[];t.reverse();for(var i=t.length-20;i<t.length;i++)t[i]&&(a.push(t[i].totPEOI),n.push(t[i].totCEOI),o.push(t[i].diff),r.push(t[i].dateTime.substring(19,11)));var s={labels:r,datasets:[{label:"Put",data:a,fill:!0,backgroundColor:"rgba(75,192,192,0.2)",borderColor:"green"},{label:"Call",data:n,fill:!0,backgroundColor:"rgba(75,192,192,0.1)",borderColor:"red"}]};return l.a.createElement("div",{className:"App"},l.a.createElement(Qe.a,{data:s,options:{maintainAspectRatio:!0}}))}var Xt={PaperProps:{style:{maxHeight:224,width:250}}},Zt=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(S.a)(this,Object(v.a)(t).call(this,e))).onChangeSelectSymbol=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value),function(){this.loadPackList()})},a.onChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value),function(){this.filterOptionChain(e.target.name,e.target.value)})},a.filterOptionChain=function(e,t){var n=[],l=a.state.optionChainDataBN&&a.state.optionChainDataBN.records&&a.state.optionChainDataBN.records.data;if("expiry"===e&&"All"===t&&(n=l),"expiry"===e)for(var r=0;r<l.length;r++){var o=l[r];o.expiryDate===t&&n.push(o)}if("strike"===e)for(var i=0;i<l.length;i++){var s=l[i];s.strikePrice===t&&n.push(s)}a.setState({filtered:n,FilteredBY:e+" "+t})},a.handleScroll=function(e){var t=a.state.scrollcount;a.setState({scrollcount:t+=1})},a.getDataforStrike=function(e){for(var t=JSON.parse(localStorage.getItem("optionChainDataBN")).records&&JSON.parse(localStorage.getItem("optionChainDataBN")).records.data,a=0,n=0,l=0;l<t.length;l++){var r=t[l];e===r.strikePrice&&(r.CE&&r.CE.openInterest&&(a+=r.CE.openInterest),r.PE&&r.PE.openInterest&&(n+=r.PE.openInterest))}return{strikePrice:e,sumOfCEoi:a,sumOfPEoi:n}},a.findSupportResistence=function(e){var t=e&&e.records&&e.records.data,n=0,l=0,r=0,o=0;if(t)for(var i=0;i<t.length;i++){var s=t[i];s&&s.PE&&(n+=s.PE.openInterest,r+=s.PE.changeinOpenInterest),s&&s.CE&&(l+=s.CE.openInterest,o+=s.CE.changeinOpenInterest)}var c=[],m=a.state.underlyingValue-a.state.showOptionDownside,g=Math.round(m)%100,u=Math.round(m)+100-g,d=a.state.underlyingValue+a.state.showOptionUpside,h=Math.round(d)%100,p=Math.round(d)+100-h;console.log(a.state.underlyingValue,"start from",u,"endto",p);for(var f=u;f<=p;f+=100)c.push(f);c=c.sort(function(e,t){return t-e});var y=[],b=0,E=0;c.forEach(function(e){var t=a.getDataforStrike(e);b+=t.sumOfPEoi,E+=t.sumOfCEoi,y.push(t),console.log(e,t)}),a.setState({AllspTotalOI:y,selectedSPpcr:(b/E).toFixed(3),totalspeoi:b,totalsceoi:E}),a.setState({CEoi:l,PEoi:n,allStrikediff:n-l,CEoiChange:o,PEoiChange:r,allStrikeChngeDiff:r-o})},a.state={products:[],stopnview:"",curnewdata:"",showOptionUpside:800,showOptionDownside:800,timestamp:"",totalCOI:0,expiry:"",strike:"",FilteredBY:"",AllspTotalOI:[],PEoi:0,CEoi:0,waitForChainFlag:!0,scrollcount:0,pcrTableBN:JSON.parse(localStorage.getItem("pcrTableBN"))&&JSON.parse(localStorage.getItem("pcrTableBN")).data,optionChainDataBN:JSON.parse(localStorage.getItem("optionChainDataBN")),filtered:JSON.parse(localStorage.getItem("optionChainDataBN"))&&JSON.parse(localStorage.getItem("optionChainDataBN")).filtered&&JSON.parse(localStorage.getItem("optionChainDataBN")).filtered.data,staticData:localStorage.getItem("staticData")&&JSON.parse(localStorage.getItem("staticData"))||{},selectedWatchlist:"Securities in F&O",selectOptionStock:"NIFTY",underlyingValue:JSON.parse(localStorage.getItem("optionChainDataBN"))&&JSON.parse(localStorage.getItem("optionChainDataBN")).records&&JSON.parse(localStorage.getItem("optionChainDataBN")).records.underlyingValue},a.findSupportResistence=a.findSupportResistence.bind(Object(k.a)(a)),a}return Object(w.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({SecuritiesInFO:this.state.staticData[this.state.selectedWatchlist]},function(){}),JSON.parse(localStorage.getItem("cpdataBN"))?this.setState({products:JSON.parse(localStorage.getItem("cpdataBN")).data}):localStorage.setItem("cpdataBN",JSON.stringify({data:[]})),JSON.parse(localStorage.getItem("pcrTableBN"))?this.setState({pcrTableBN:JSON.parse(localStorage.getItem("pcrTableBN")).data}):localStorage.setItem("pcrTableBN",JSON.stringify({data:[]}));var t=new Date;t.getHours()>=9&&t.getHours()<16&&setInterval(function(){e.loadPackList()},36e4),setInterval(function(){e.updatepcr()},36e4)}},{key:"loadPackList",value:function(){var e=this;this.setState({waitForChainFlag:!1}),T.getBNcpdata(this.state.selectOptionStock).then(function(t){var a=t.data&&t.data;if(localStorage.setItem("optionChainDataBN",JSON.stringify(a)),e.setState({filtered:a.filtered&&a.filtered.data,optionChainDataBN:a}),a.filtered){var n=a.filtered.PE.totOI-a.filtered.CE.totOI,l={dateTime:e.dateFormat(new Date),totCEOI:a.filtered.CE.totOI,totCEVol:a.filtered.CE.totVol,totPEOI:a.filtered.PE.totOI,totPEVol:a.filtered.PE.totVol,diff:n,totChangeINOICall:parseInt(localStorage.getItem("totCEOIChange")),totChangeINOIPut:parseInt(localStorage.getItem("totPEOIChange")),totChangeINOIDiff:parseInt(localStorage.getItem("totPEOIChange"))-parseInt(localStorage.getItem("totCEOIChange"))};if(e.setState({curnewdata:l}),document.getElementById("title").innerHTML=(n/1e5).toFixed(2)+"|"+((localStorage.getItem("totPEOIChange")-localStorage.getItem("totCEOIChange"))/1e5).toFixed(2)+"L "+e.state.selectOptionStock,JSON.parse(localStorage.getItem("cpdataBN"))){var r=JSON.parse(localStorage.getItem("cpdataBN")),o=r&&r.data[0];o?(l.isDuplicate=l.diff===o.diff,l.totCEOIChange=(100*(l.totCEOI-o.totCEOI)/o.totCEOI).toFixed(3),l.totPEOIChange=(100*(l.totPEOI-o.totPEOI)/o.totPEOI).toFixed(3),l.totDiffChange=(100*(l.diff-o.diff)/o.diff).toFixed(3)):(l.isDuplicate=!1,l.totCEOIChange=0,l.totPEOIChange=0,l.totDiffChange=0),r.data.unshift(l),a.records&&(r.timestamp=a.records.timestamp,r.underlyingValue=a.records.underlyingValue),r.data.reverse(),localStorage.setItem("cpdataBN",JSON.stringify(r)),e.setState({products:r.data,underlyingValue:a.records.underlyingValue,timestamp:a.records.timestamp}),e.setState({waitForChainFlag:!0})}}e.updatepcr(),e.setState({pcrTableBN:JSON.parse(localStorage.getItem("pcrTableBN"))&&JSON.parse(localStorage.getItem("pcrTableBN")).data})})}},{key:"updatepcr",value:function(){var e={allPCR:(this.state.PEoi/this.state.CEoi).toFixed(3),expiryPCR:localStorage.getItem("thisWeekPCR"),selectedSPpcr:this.state.selectedSPpcr};if(JSON.parse(localStorage.getItem("pcrTableBN"))){var t=JSON.parse(localStorage.getItem("pcrTableBN"));t.data.unshift(e),localStorage.setItem("pcrTableBN",JSON.stringify(t))}console.log(e),this.setState({pcrTableBN:t})}},{key:"dateFormat",value:function(e){return rt(e).format("DD-MM-YYYY h:mm:ss A")}},{key:"render",value:function(){var e,t,a=this,n=0,r=0,o=0,i=0;return l.a.createElement(l.a.Fragment,null,l.a.createElement(M.a,{direction:"row",container:!0,className:"flexGrow",spacing:1,style:{paddingLeft:"5px",paddingRight:"5px"}},l.a.createElement(M.a,{item:!0,xs:2,sm:2},l.a.createElement(kt.a,{style:$t.selectStyle},l.a.createElement(A.a,{id:"selectOptionStock"},"Select Symbol"),l.a.createElement(wt.a,{id:"selectOptionStock",name:"selectOptionStock",value:this.state.selectOptionStock,onChange:this.onChangeSelectSymbol,input:l.a.createElement(_t.a,null),MenuProps:Xt},l.a.createElement(Ct.a,{key:"NIFTY",value:"NIFTY"}," ","NIFTY"),l.a.createElement(Ct.a,{key:"BANKNIFTY",value:"BANKNIFTY"}," ","BANKNIFTY"),this.state.SecuritiesInFO&&this.state.SecuritiesInFO.length?this.state.SecuritiesInFO.map(function(e,t){return l.a.createElement(Ct.a,{key:e.name,value:e.name},e.name)}):""))),l.a.createElement(M.a,{item:!0,xs:2,sm:2},l.a.createElement(kt.a,{style:$t.selectStyle},l.a.createElement(A.a,{id:"expiry"},"Select Expiry Date"),l.a.createElement(wt.a,{id:"expiry",name:"expiry",value:this.state.expiry,onChange:this.onChange,input:l.a.createElement(_t.a,null),MenuProps:Xt},l.a.createElement(Ct.a,{key:"All",value:"All"},"All"),this.state.optionChainDataBN&&this.state.optionChainDataBN.records&&this.state.optionChainDataBN.records.expiryDates?this.state.optionChainDataBN.records.expiryDates.map(function(e,t){return l.a.createElement(Ct.a,{key:e+"key"+t,value:e},e)}):""))),l.a.createElement(M.a,{item:!0,xs:2,sm:2},l.a.createElement(kt.a,{style:$t.selectStyle},l.a.createElement(A.a,{id:"strike"},"Select Strick Price"),l.a.createElement(wt.a,{labelId:"strike",id:"strike","max-height":"100%",name:"strike",value:this.state.strike,onChange:this.onChange,input:l.a.createElement(_t.a,null),MenuProps:Xt},this.state.optionChainDataBN&&this.state.optionChainDataBN.records&&this.state.optionChainDataBN.records.strikePrices?this.state.optionChainDataBN.records.strikePrices.map(function(e){return l.a.createElement(Ct.a,{key:e,value:e},e)}):""))),l.a.createElement(M.a,{item:!0,xs:2,sm:2},this.state.waitForChainFlag?l.a.createElement(B.a,{variant:"contained",onClick:function(){return a.loadPackList()}},"Refesh"):l.a.createElement(ut.a,null)),l.a.createElement(M.a,{item:!0,xs:6,sm:4},l.a.createElement(W.a,{component:"h3",variant:"h6",color:"primary"},this.state.selectOptionStock," ",this.state.underlyingValue," ",this.state.timestamp))),l.a.createElement(M.a,{item:!0,xs:12,sm:12},l.a.createElement(Et.a,{style:{padding:"10px",overflow:"auto"}},l.a.createElement(M.a,Object(y.a)({container:!0,spacing:3,direction:"row",alignItems:"center"},"container",!0),l.a.createElement(M.a,{item:!0,xs:3,sm:3},l.a.createElement("span",null," ",l.a.createElement("b",null,"Total ")),l.a.createElement("span",null," PE OI: ",l.a.createElement("b",null," ",(this.state.PEoi/1e5).toFixed(3),"L")),l.a.createElement("span",null," CE OI: ",l.a.createElement("b",null,(this.state.CEoi/1e5).toFixed(3),"L")),l.a.createElement("span",null," PE-CE: ",this.state.allStrikediff>0?l.a.createElement("b",{style:{color:"green"}},(this.state.allStrikediff/1e5).toFixed(3),"L"):l.a.createElement("b",{style:{color:"red"}},(this.state.allStrikediff/1e5).toFixed(3),"L"))),l.a.createElement(M.a,{item:!0,xs:3,sm:5},l.a.createElement("span",null," ",l.a.createElement("b",null,"Total Chng ")),l.a.createElement("span",null," PE OI: ",l.a.createElement("b",null,(this.state.PEoiChange/1e5).toFixed(3),"L")),l.a.createElement("span",null," CE OI: ",l.a.createElement("b",null,(this.state.CEoiChange/1e5).toFixed(3),"L")),l.a.createElement("span",null," PE-CE: ",this.state.allStrikeChngeDiff>0?l.a.createElement("b",{style:{color:"green"}},(this.state.allStrikeChngeDiff/1e5).toFixed(3),"L"):l.a.createElement("b",{style:{color:"red"}}," ",(this.state.allStrikeChngeDiff/1e5).toFixed(3),"L"))),l.a.createElement(M.a,{item:!0,xs:2,sm:2},l.a.createElement("span",null,"ALL PCR: ",l.a.createElement("b",null,(this.state.PEoi/this.state.CEoi).toFixed(3)," "))),l.a.createElement(M.a,{item:!0,xs:2,sm:2},l.a.createElement("span",null,"Expire Week PCR: ",l.a.createElement("b",null,localStorage.getItem("thisWeekPCR")," ")))))),l.a.createElement(M.a,{direction:"row",container:!0,className:"flexGrow",spacing:0,style:{paddingLeft:"5px",paddingRight:"5px"}},l.a.createElement(M.a,{id:"tabledatachart",item:!0,xs:3,sm:3,style:{padding:"2px",overflow:"auto",height:"250px"}},l.a.createElement(Je.a,{id:"tabledata",stickyHeader:!0,"aria-label":"sticky table",size:"small"},l.a.createElement(St.a,{key:2222,variant:"head",style:{width:"",whiteSpace:"nowrap"}},l.a.createElement(_e.a,{variant:"head"},l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"Time")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"VIEW")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"Put-Call(diff)")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"Chng in OI(diff)")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"PUT OI")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"Chng Put OI")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"Call OI")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"Chng Call OI")))),l.a.createElement(ze.a,{hover:!0,style:{width:"",whiteSpace:"nowrap"}},this.state.products?this.state.products.map(function(e){return l.a.createElement(_e.a,{key:e.dateTime,style:{background:e.isDuplicate?"lightgray":""}},l.a.createElement(qe.a,{align:"center"},e.dateTime.substring(19,11)),l.a.createElement(qe.a,{align:"center"},e.diff>0?l.a.createElement(W.a,{variant:"body2",style:{color:"green"}},"BUY"):l.a.createElement(W.a,{variant:"body2",style:{color:"red"}},"SELL")),l.a.createElement(qe.a,{align:"center"},e.diff," (",(e.diff/1e5).toFixed(2),"L)(",e.totDiffChange>0?l.a.createElement("span",{style:{color:"green",fontWeight:"bold"}},e.totDiffChange,"%"):"0.000"==e.totDiffChange?l.a.createElement("span",null,e.totDiffChange,"%"):l.a.createElement("span",{style:{color:"red",fontWeight:"bold"}},e.totDiffChange,"%"),") "),l.a.createElement(qe.a,{align:"center"},e.totChangeINOIDiff," (",(e.totChangeINOIDiff/1e5).toFixed(2),"L)"),l.a.createElement(qe.a,{align:"center"},e.totPEOI," (",e.totPEOIChange>0?l.a.createElement("span",{style:{color:"green",fontWeight:"bold"}},e.totPEOIChange,"%"):"0.000"==e.totPEOIChange?l.a.createElement("span",null,e.totPEOIChange,"%"):l.a.createElement("span",{style:{color:"red",fontWeight:"bold"}},e.totPEOIChange,"%"),")"),l.a.createElement(qe.a,{align:"center"},e.totChangeINOIPut," "),l.a.createElement(qe.a,{align:"center"},e.totCEOI," (",e.totCEOIChange>0?l.a.createElement("span",{style:{color:"green",fontWeight:"bold"}},e.totCEOIChange,"%"):"0.000"==e.totCEOIChange?l.a.createElement("span",null,e.totCEOIChange,"%"):l.a.createElement("span",{style:{color:"red",fontWeight:"bold"}},e.totCEOIChange,"%"),")"),l.a.createElement(qe.a,{align:"center"},e.totChangeINOICall))}):l.a.createElement(ut.a,null)))),l.a.createElement(M.a,{item:!0,xs:4,sm:4,style:{padding:"2px",overflow:"auto",height:"300px"}},l.a.createElement(Qt,{diffData:{data:this.state.products,scrollcount:this.state.scrollcount}})),l.a.createElement(M.a,{item:!0,xs:3,sm:3,style:{padding:"2px",overflow:"auto",height:"250px"}},l.a.createElement(Je.a,(e={style:{borderLeft:"dashed",borderRight:"dashed",fontWeight:"500"},id:"tabledata",stickyHeader:!0,"aria-label":"sticky table"},Object(y.a)(e,"id","tabledata"),Object(y.a)(e,"size","small"),e),l.a.createElement(St.a,{style:{},variant:"head"},l.a.createElement(_e.a,{variant:"head"},l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"Total CE OI ",l.a.createElement("br",null),(this.state.totalsceoi/1e5).toFixed(3),"L")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"Strike Price",l.a.createElement("br",null),this.state.totalspeoi-this.state.totalsceoi,"(",((this.state.totalspeoi-this.state.totalsceoi)/1e5).toFixed(3),"L) ")," "),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"Total PE OI",l.a.createElement("br",null),(this.state.totalspeoi/1e5).toFixed(3),"L")))),l.a.createElement(ze.a,null,this.state.AllspTotalOI?this.state.AllspTotalOI.map(function(e){return l.a.createElement(_e.a,{hover:!0,key:e.dateTime},l.a.createElement(qe.a,{align:"center",style:{backgroundColor:e.strikePrice<a.state.underlyingValue?"#ded6a269":""}},e.sumOfCEoi," (",(e.sumOfCEoi/1e5).toFixed(2),"L)"),l.a.createElement(qe.a,{align:"center"},e.strikePrice),l.a.createElement(qe.a,{align:"center",style:{backgroundColor:e.strikePrice>a.state.underlyingValue?"#ded6a269":""}},e.sumOfPEoi," (",(e.sumOfPEoi/1e5).toFixed(2),"L)"))}):l.a.createElement(ut.a,null)))),l.a.createElement(M.a,{item:!0,xs:2,sm:2,style:{padding:"2px",overflow:"auto",height:"250px"}},l.a.createElement(Je.a,(t={id:"tabledata",stickyHeader:!0,"aria-label":"sticky table"},Object(y.a)(t,"id","tabledata"),Object(y.a)(t,"size","small"),t),l.a.createElement(St.a,{variant:"head"},l.a.createElement(_e.a,{variant:"head"},l.a.createElement(qe.a,{align:"center"},"ALL Pcr"),l.a.createElement(qe.a,{align:"center"},"Expiry Pcr "),l.a.createElement(qe.a,{align:"center"},"Selected Pcr"))),l.a.createElement(ze.a,{style:{whiteSpace:"nowrap"}},this.state.pcrTableBN&&this.state.pcrTableBN.length>0&&this.state.pcrTableBN?this.state.pcrTableBN.map(function(e){return l.a.createElement(_e.a,{hover:!0,key:e.expiryPCR},l.a.createElement(qe.a,{align:"center"},e.allPCR," "),l.a.createElement(qe.a,{align:"center"},e.expiryPCR),l.a.createElement(qe.a,{align:"center"},e.selectedSPpcr," "))}):""))),l.a.createElement(M.a,{item:!0,xs:12,sm:12,style:{padding:"2px",overflow:"auto",height:"900px"}},l.a.createElement(Je.a,{stickyHeader:!0,"aria-label":"sticky table",id:"tabledata",size:"small"},l.a.createElement(St.a,{variant:"head"},l.a.createElement(_e.a,{variant:"head"},l.a.createElement(qe.a,{colSpan:6,align:"center"},l.a.createElement("b",null,"CALL")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null)),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null)),l.a.createElement(qe.a,{colSpan:6,align:"center"},l.a.createElement("b",null,"PUT"))),l.a.createElement(_e.a,{variant:"head",style:{width:"",whiteSpace:"nowrap"}},l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"OI Total OI ",l.a.createElement("br",null),localStorage.getItem("totCEOI"),"(",(localStorage.getItem("totCEOI")/1e5).toFixed(3),"L) ")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"Chng in OI ",l.a.createElement("br",null),localStorage.getItem("totCEOIChange"),"(",(localStorage.getItem("totCEOIChange")/1e5).toFixed(3),"L)")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"IV")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"Delta")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"LTP")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"CHNG")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"Buy")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("span",{style:{color:"#3e85c5",fontWeight:"bold"}}," STRIKE PRICE")," "),l.a.createElement(qe.a,{align:"center"},l.a.createElement("span",{style:{color:"#3e85c5",fontWeight:"bold"}}," Expiry")," "),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"Buy")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"CHNG")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"LTP")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"IV")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"Delta")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"Chng in OI ",l.a.createElement("br",null),localStorage.getItem("totPEOIChange"),"(",(localStorage.getItem("totPEOIChange")/1e5).toFixed(3),"L)")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"OI ",l.a.createElement("br",null),localStorage.getItem("totPEOI"),"(",(localStorage.getItem("totPEOI")/1e5).toFixed(3),"L)")))),l.a.createElement(ze.a,null,this.state.filtered?this.state.filtered.map(function(e,t){return l.a.createElement(_e.a,{hover:!0,key:t,style:{background:e.isDuplicate?"lightgray":""}},e&&e.CE&&e.PE&&e.strikePrice>=e.CE.underlyingValue-a.state.showOptionUpside&&e.strikePrice<=e.CE.underlyingValue+a.state.showOptionDownside?l.a.createElement(l.a.Fragment,null,l.a.createElement(qe.a,Object.assign({},n+=e.CE.openInterest,{style:{backgroundColor:e.strikePrice<e.CE.underlyingValue?"#ded6a269":""},align:"center"}),e.CE.openInterest),l.a.createElement(qe.a,Object.assign({},r+=e.CE.changeinOpenInterest,{style:{backgroundColor:e.strikePrice<e.CE.underlyingValue?"#ded6a269":""},align:"center"}),e.CE.changeinOpenInterest),l.a.createElement(qe.a,{align:"center"},e.CE.impliedVolatility," "),l.a.createElement(qe.a,{align:"center"},(e.CE.change/(e.strikePrice-e.CE.underlyingValue)).toFixed(2)," "),l.a.createElement(qe.a,{style:{backgroundColor:e.strikePrice<e.CE.underlyingValue?"#ded6a269":""},align:"center"},l.a.createElement("span",{style:{color:"#3e85c5",fontWeight:"bold"}}," ",e.CE.lastPrice),"(",e.CE.pChange>0?l.a.createElement("span",{style:{color:"green",fontWeight:"bold"}},e.CE.pChange.toFixed(2),"%"):0==e.CE.pChange?l.a.createElement("span",null,e.CE.pChange.toFixed(2),"%"):l.a.createElement("span",{style:{color:"red",fontWeight:"bold"}},e.CE.pChange.toFixed(2),"%"),") "),l.a.createElement(qe.a,{style:{backgroundColor:e.strikePrice<e.CE.underlyingValue?"#ded6a269":""},align:"center"},e.CE.change.toFixed(2)," "),l.a.createElement(qe.a,{align:"center"},"  ",l.a.createElement(B.a,{size:"small",variant:"contained",onClick:function(){return a.props.buyOption("CE",a.state.selectOptionStock,e.strikePrice,e.expiryDate)}}," Call Buy ")," "),l.a.createElement(qe.a,{style:{borderLeft:"dashed",borderRight:"dashed",fontWeight:"500"},align:"center"},l.a.createElement("span",null," ",l.a.createElement("a",{href:"#",style:{textDecoration:"none"},onClick:function(){return a.filterOptionChain("strike",e.strikePrice)}}," ",e.strikePrice)," ")," "),l.a.createElement(qe.a,{style:{borderRight:"dashed",whiteSpace:"nowrap"},align:"center"},l.a.createElement("span",{style:{paddingLeft:"5px",paddingRight:"5px"}}," ",l.a.createElement("a",{href:"#",style:{textDecoration:"none"},onClick:function(){return a.filterOptionChain("expiry",e.expiryDate)}}," ",e.expiryDate))," "),l.a.createElement(qe.a,{align:"center"},"  ",l.a.createElement(B.a,{size:"small",variant:"contained",onClick:function(){return a.props.buyOption("PE",a.state.selectOptionStock,e.strikePrice,e.expiryDate)}},"Put Buy ")," "),l.a.createElement(qe.a,{style:{backgroundColor:e.strikePrice>e.CE.underlyingValue?"#ded6a269":""},align:"center"},e.PE.change.toFixed(2)," "),l.a.createElement(qe.a,{style:{backgroundColor:e.strikePrice>e.CE.underlyingValue?"#ded6a269":""},align:"center"},l.a.createElement("span",{style:{color:"#3e85c5",fontWeight:"bold"}}," ",e.PE.lastPrice),"(",e.PE.pChange>0?l.a.createElement("span",{style:{color:"green",fontWeight:"bold"}},e.PE.pChange.toFixed(2),"%"):0==e.PE.pChange?l.a.createElement("span",null,e.PE.pChange.toFixed(2),"%"):l.a.createElement("span",{style:{color:"red",fontWeight:"bold"}},e.PE.pChange.toFixed(2),"%"),")"),l.a.createElement(qe.a,{align:"center"},e.PE.impliedVolatility," "),l.a.createElement(qe.a,{align:"center"},(e.PE.change/(e.strikePrice-e.PE.underlyingValue)).toFixed(2)," "),l.a.createElement(qe.a,Object.assign({},i+=e.PE.changeinOpenInterest,{style:{backgroundColor:e.strikePrice>e.CE.underlyingValue?"#ded6a269":""},align:"center"}),e.PE.changeinOpenInterest),l.a.createElement(qe.a,Object.assign({},o+=e.PE.openInterest,{style:{backgroundColor:e.strikePrice>e.CE.underlyingValue?"#ded6a269":""},align:"center"}),e.PE.openInterest," ")):"")}):l.a.createElement(ut.a,null),l.a.createElement(_e.a,{variant:"head"},l.a.createElement(qe.a,Object.assign({align:"center"},localStorage.setItem("totCEOI",n)),l.a.createElement("b",null,n,l.a.createElement("br",null),"(",(n/1e5).toFixed(3),"L)")),l.a.createElement(qe.a,Object.assign({align:"center"},localStorage.setItem("totCEOIChange",r)),l.a.createElement("b",null,r,l.a.createElement("br",null),"(",(r/1e5).toFixed(3),"L)")," "),l.a.createElement(qe.a,Object.assign({align:"center"},localStorage.setItem("totCEVol",0)),l.a.createElement("b",null,0,l.a.createElement("br",null),"(",(0).toFixed(3),"L)")),l.a.createElement(qe.a,{colSpan:3,align:"center"}),l.a.createElement(qe.a,Object.assign({},localStorage.setItem("thisWeekPCR",(o/n).toFixed(3)),{align:"center",colSpan:2}),l.a.createElement("b",null," PCR : ",(o/n).toFixed(3))),l.a.createElement(qe.a,{colSpan:5,align:"center"}),l.a.createElement(qe.a,Object.assign({align:"center"},localStorage.setItem("totPEVol",0)),l.a.createElement("b",null,0,l.a.createElement("br",null),"(",(0).toFixed(3),"L)")),l.a.createElement(qe.a,Object.assign({align:"center"},localStorage.setItem("totPEOIChange",i)),l.a.createElement("b",null,i,l.a.createElement("br",null),"(",(i/1e5).toFixed(3),"L)")," "),l.a.createElement(qe.a,Object.assign({align:"center"},localStorage.setItem("totPEOI",o)),l.a.createElement("b",null,o,l.a.createElement("br",null),"(",(o/1e5).toFixed(3),"L)")," ")))))))}}]),t}(l.a.Component),$t={tableStyle:{display:"flex",justifyContent:"center"},selectStyle:{marginBottom:"0px",minWidth:240,maxWidth:240}},ea=Object(i.b)(function(e){return{packs:e.packs.packs.data}},{setPackLoaded:Jt})(Zt),ta=Object(He.a)(function(e){return{root:{margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}})(function(e){var t=e.children,a=e.classes,n=e.onClose,r=Object(Be.a)(e,["children","classes","onClose"]);return l.a.createElement(je.a,Object.assign({disableTypography:!0,className:a.root},r),l.a.createElement(W.a,{variant:"h6"},t),n?l.a.createElement(ce.a,{"aria-label":"close",className:a.closeButton,onClick:n},l.a.createElement(Ue.a,null)):null)}),aa=Object(He.a)(function(e){return{root:{padding:e.spacing(2)}}})(Re.a),na=Object(He.a)(function(e){return{root:{margin:0,padding:e.spacing(1)}}})(Ve.a);function la(e){var t=l.a.useState(!1),a=Object(ne.a)(t,2),n=a[0],r=a[1],o=function(){r(!1)};return l.a.createElement("div",null,l.a.createElement(B.a,{variant:"outlined",color:"primary",onClick:function(){r(!0)}},e.data.indexSymbol),l.a.createElement(Ye.a,{onClose:o,"aria-labelledby":"customized-dialog-title",open:n},l.a.createElement(ta,{id:"customized-dialog-title",onClose:o},e.data.indexSymbol,"  At ",e.data.timestamp),l.a.createElement(aa,{dividers:!0},l.a.createElement(Je.a,{stickyHeader:!0,"aria-label":"sticky table",id:"tabledata",size:"medium"},l.a.createElement(_e.a,{variant:"head"},l.a.createElement(qe.a,{align:"left"},l.a.createElement("b",null,"Sr.")),l.a.createElement(qe.a,{align:"left"},l.a.createElement("b",null,"Stock Name")),l.a.createElement(qe.a,{align:"left"},l.a.createElement("b",null,"Last Price")),l.a.createElement(qe.a,{align:"left"},l.a.createElement("b",null,"CHNG%")),l.a.createElement(qe.a,{align:"left"},l.a.createElement("b",null,"Change Points"))),l.a.createElement(ze.a,null,e.data.indexSymbolData?e.data.indexSymbolData.map(function(e,t){return l.a.createElement(_e.a,{hover:!0,key:t},0!==t?l.a.createElement(l.a.Fragment,null,l.a.createElement(qe.a,{align:"left"},t," "),l.a.createElement(qe.a,{align:"left"},e.symbol),l.a.createElement(qe.a,{align:"left"},e.lastPrice),l.a.createElement(qe.a,{align:"left"},e.pChange>0?l.a.createElement("span",{style:{color:"green",fontWeight:"bold"}},e.pChange,"%"):0===e.pChange?l.a.createElement("span",null,e.pChange,"%"):l.a.createElement("span",{style:{color:"red",fontWeight:"bold"}},e.pChange,"%")," "),l.a.createElement(qe.a,{align:"left"},e.change)):"")}):l.a.createElement(l.a.Fragment,null," ",l.a.createElement("br",null)," ",l.a.createElement(B.a,{variant:"outlined",size:"large",color:"primary"},"Refresh")," ")))),l.a.createElement(na,null,l.a.createElement(B.a,{autoFocus:!0,onClick:o,color:"primary"},"Close"))))}var ra=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(S.a)(this,Object(v.a)(t).call(this,e))).getIndicesStocks=function(e,t){T.getIndiceStock(e).then(function(n){console.log(n.data);var l=n.data;if(G.showSuccess("Success, Top is"+l.data[1].symbol),a.speckIt("1st top "+e+" stock is "+l.data[1].symbol.toLocaleLowerCase()+" high of "+l.data[1].pChange+"%"),a.speckIt("2nd top "+e+" stock is "+l.data[2].symbol.toLocaleLowerCase()+" high of "+l.data[2].pChange+"%"),a.speckIt("3rd top "+e+" stock is "+l.data[3].symbol.toLocaleLowerCase()+" high of "+l.data[3].pChange+"%"),l){localStorage.setItem(e,JSON.stringify(l)),document.getElementById("topDate_"+t)&&(document.getElementById("topDate_"+t).innerHTML=l.timestamp.substring(12,23));var r=0;document.getElementById("top1_"+t)&&(r=l.data[1].pChange>0?'<span style="color:green">'+l.data[1].pChange+"</span>":'<span style="color:red">'+l.data[1].pChange+"</span>",document.getElementById("top1_"+t).innerHTML=l.data[1].symbol+" "+l.data[1].lastPrice+"("+r+")"),document.getElementById("top2_"+t)&&(r=l.data[2].pChange>0?'<span style="color:green">'+l.data[2].pChange+"</span>":'<span style="color:red">'+l.data[2].pChange+"</span>",document.getElementById("top2_"+t).innerHTML=l.data[2].symbol+" "+l.data[2].lastPrice+"("+r+")"),document.getElementById("top3_"+t)&&(r=l.data[3].pChange>0?'<span style="color:green">'+l.data[3].pChange+"</span>":'<span style="color:red">'+l.data[3].pChange+"</span>",document.getElementById("top3_"+t).innerHTML=l.data[3].symbol+" "+l.data[3].lastPrice+"("+r+")"),document.getElementById("top4_"+t)&&(r=l.data[4].pChange>0?'<span style="color:green">'+l.data[4].pChange+"</span>":'<span style="color:red">'+l.data[4].pChange+"</span>",document.getElementById("top4_"+t).innerHTML=l.data[4].symbol+" "+l.data[4].lastPrice+"("+r+")"),document.getElementById("top5_"+t)&&(r=l.data[5].pChange>0?'<span style="color:green">'+l.data[5].pChange+"</span>":'<span style="color:red">'+l.data[5].pChange+"</span>",document.getElementById("top5_"+t).innerHTML=l.data[5].symbol+" "+l.data[5].lastPrice+"("+r+")")}}).catch(function(t){G.showError(e+" Failed"+l.a.createElement("br",null)+t),a.speckIt(e+" API Failed ")})},a.onChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.speckIt=function(e){(new SpeechSynthesisUtterance).text=e.toString()},a.state={stopnview:"",indexTimeStamp:"",products:JSON.parse(localStorage.getItem("sorteIndexList"))},a}return Object(w.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.loadPackList();var t=new Date;t.getHours()>=9&&t.getHours()<16&&setInterval(function(){e.loadPackList()},120002)}},{key:"loadPackList",value:function(){var e=this;T.getAllIndices().then(function(t){if(t.data){e.setState({indexTimeStamp:t.data.timestamp});var a=t.data.data.sort(function(e,t){return t.percentChange-e.percentChange});localStorage.setItem("sorteIndexList",JSON.stringify(a)),e.setState({products:a}),e.speckIt("1st sector is "+a[0].indexSymbol+" "+a[0].percentChange+"%"),e.speckIt("2nd sector is "+a[1].indexSymbol+" "+a[1].percentChange+"%"),e.speckIt("3rd sector is "+a[2].indexSymbol+" "+a[2].percentChange+"%"),e.getIndicesStocks(a[0].indexSymbol,0),e.getIndicesStocks(a[1].indexSymbol,1),e.getIndicesStocks(a[2].indexSymbol,2)}}).catch(function(t){G.showError("All Indices API Failed"+l.a.createElement("br",null)+t),e.speckIt("All Indices API Failed")})}},{key:"dateFormat",value:function(e){return rt(e).format("DD-MM-YYYY h:mm:ss A")}},{key:"timeFormat",value:function(e){return rt().calendar()}},{key:"render",value:function(){var e=this;return l.a.createElement(l.a.Fragment,null,l.a.createElement(ht,null),l.a.createElement(M.a,{direction:"row",container:!0,className:"flexGrow",spacing:1,style:{paddingLeft:"5px",paddingRight:"5px"}},l.a.createElement(M.a,{item:!0,xs:7,sm:7}),l.a.createElement(M.a,{item:!0,xs:12,sm:12,style:{padding:"20px",overflow:"auto",height:"900px"}},l.a.createElement(W.a,{component:"h3",variant:"h6",color:"primary"},"Market - Indices at ",this.state.indexTimeStamp),l.a.createElement(Je.a,{stickyHeader:!0,"aria-label":"sticky table",id:"tabledata",size:"small"},l.a.createElement(_e.a,{variant:"head"},l.a.createElement(qe.a,{align:"left"},l.a.createElement("b",null,"Sr.")),l.a.createElement(qe.a,{align:"left"},l.a.createElement("b",null,"Index Name")),l.a.createElement(qe.a,{align:"left"},l.a.createElement("b",null,"CHNG%")),l.a.createElement(qe.a,{align:"left",title:"Advances/Declines/Unchanged"},l.a.createElement("b",null,"A/D/Un")),l.a.createElement(qe.a,{align:"left"},l.a.createElement("b",null,"Refresh")),l.a.createElement(qe.a,{align:"left"},l.a.createElement("b",null,"TIME")),l.a.createElement(qe.a,{align:"left"},l.a.createElement("b",null,"Top1")),l.a.createElement(qe.a,{align:"left"},l.a.createElement("b",null,"Top2")),l.a.createElement(qe.a,{align:"left"},l.a.createElement("b",null,"Top3")),l.a.createElement(qe.a,{align:"left"},l.a.createElement("b",null,"Top4")),l.a.createElement(qe.a,{align:"left"},l.a.createElement("b",null,"Top5"))),l.a.createElement(ze.a,null,this.state.products?this.state.products.map(function(t,a){return l.a.createElement(_e.a,{hover:!0,key:a},"vijay"!==t.key?l.a.createElement(l.a.Fragment,null,l.a.createElement(qe.a,{align:"left"},a+1," "),l.a.createElement(qe.a,{align:"left"},l.a.createElement(la,{data:{indexSymbol:t.indexSymbol+" @ "+t.last,indexSymbolData:JSON.parse(localStorage.getItem(t.indexSymbol))&&JSON.parse(localStorage.getItem(t.indexSymbol)).data,timestamp:JSON.parse(localStorage.getItem(t.indexSymbol))&&JSON.parse(localStorage.getItem(t.indexSymbol)).timestamp}})),l.a.createElement(qe.a,{align:"left"},l.a.createElement("a",{href:"https://www.nseindia.com/api/equity-stockIndices?index="+encodeURIComponent(t.indexSymbol),target:"_blank",rel:"noopener noreferrer"},"  ",t.percentChange>0?l.a.createElement("span",{style:{color:"green",fontWeight:"bold"}},t.percentChange,"%"):0===t.percentChange?l.a.createElement("span",null,t.percentChange,"%"):l.a.createElement("span",{style:{color:"red",fontWeight:"bold"}},t.percentChange,"%")," ")),l.a.createElement(qe.a,{align:"left"},"  ",l.a.createElement("span",{style:{color:"green"}},t.advances)," / ",l.a.createElement("span",{style:{color:"red"}},t.declines)," / ",t.unchanged),l.a.createElement(qe.a,{align:"left"},l.a.createElement(B.a,{variant:"outlined",color:"primary",onClick:function(){return e.getIndicesStocks(t.indexSymbol,a)}},"Refresh")),l.a.createElement(qe.a,{align:"left",id:"topDate_"+a}),l.a.createElement(qe.a,{align:"left",id:"top1_"+a}),l.a.createElement(qe.a,{align:"left",id:"top2_"+a}),l.a.createElement(qe.a,{align:"left",id:"top3_"+a}),l.a.createElement(qe.a,{align:"left",id:"top4_"+a}),l.a.createElement(qe.a,{align:"left",id:"top5_"+a})):"")}):l.a.createElement(ut.a,null))))))}}]),t}(l.a.Component),oa=Object(i.b)(function(e){return{packs:e.packs.packs.data}},{setPackLoaded:Jt})(ra),ia=a(174),sa=a.n(ia);function ca(e){var t={series:[{data:[{x:new Date(15387786e5),y:[6629.81,6650.5,6623.04,6633.33]},{x:new Date(15387804e5),y:[6632.01,6643.59,6620,6630.11]},{x:new Date(15387822e5),y:[6630.71,6648.95,6623.34,6635.65]},{x:new Date(1538784e6),y:[6635.65,6651,6629.67,6638.24]},{x:new Date(15387858e5),y:[6638.24,6640,6620,6624.47]},{x:new Date(15387876e5),y:[6624.53,6636.03,6621.68,6624.31]},{x:new Date(15387894e5),y:[6624.61,6632.2,6617,6626.02]},{x:new Date(15387912e5),y:[6627,6627.62,6584.22,6603.02]},{x:new Date(1538793e6),y:[6605,6608.03,6598.95,6604.01]},{x:new Date(15387948e5),y:[6604.5,6614.4,6602.26,6608.02]},{x:new Date(15387966e5),y:[6608.02,6610.68,6601.99,6608.91]},{x:new Date(15387984e5),y:[6608.91,6618.99,6608.01,6612]},{x:new Date(15388002e5),y:[6612,6615.13,6605.09,6612]},{x:new Date(1538802e6),y:[6612,6624.12,6608.43,6622.95]},{x:new Date(15388038e5),y:[6623.91,6623.91,6615,6615.67]},{x:new Date(15388056e5),y:[6618.69,6618.74,6610,6610.4]},{x:new Date(15388074e5),y:[6611,6622.78,6610.4,6614.9]},{x:new Date(15388092e5),y:[6614.9,6626.2,6613.33,6623.45]},{x:new Date(1538811e6),y:[6623.48,6627,6618.38,6620.35]},{x:new Date(15388128e5),y:[6619.43,6620.35,6610.05,6615.53]},{x:new Date(15388146e5),y:[6615.53,6617.93,6610,6615.19]},{x:new Date(15388164e5),y:[6615.19,6621.6,6608.2,6620]},{x:new Date(15388182e5),y:[6619.54,6625.17,6614.15,6620]},{x:new Date(153882e7),y:[6620.33,6634.15,6617.24,6624.61]},{x:new Date(15388218e5),y:[6625.95,6626,6611.66,6617.58]},{x:new Date(15388236e5),y:[6619,6625.97,6595.27,6598.86]},{x:new Date(15388254e5),y:[6598.86,6598.88,6570,6587.16]},{x:new Date(15388272e5),y:[6588.86,6600,6580,6593.4]},{x:new Date(1538829e6),y:[6593.99,6598.89,6585,6587.81]},{x:new Date(15388308e5),y:[6587.81,6592.73,6567.14,6578]},{x:new Date(15388326e5),y:[6578.35,6581.72,6567.39,6579]},{x:new Date(15388344e5),y:[6579.38,6580.92,6566.77,6575.96]},{x:new Date(15388362e5),y:[6575.96,6589,6571.77,6588.92]},{x:new Date(1538838e6),y:[6588.92,6594,6577.55,6589.22]},{x:new Date(15388398e5),y:[6589.3,6598.89,6589.1,6596.08]},{x:new Date(15388416e5),y:[6597.5,6600,6588.39,6596.25]},{x:new Date(15388434e5),y:[6598.03,6600,6588.73,6595.97]},{x:new Date(15388452e5),y:[6595.97,6602.01,6588.17,6602]},{x:new Date(1538847e6),y:[6602,6607,6596.51,6599.95]},{x:new Date(15388488e5),y:[6600.63,6601.21,6590.39,6591.02]},{x:new Date(15388506e5),y:[6591.02,6603.08,6591,6591]},{x:new Date(15388524e5),y:[6591,6601.32,6585,6592]},{x:new Date(15388542e5),y:[6593.13,6596.01,6590,6593.34]},{x:new Date(1538856e6),y:[6593.34,6604.76,6582.63,6593.86]},{x:new Date(15388578e5),y:[6593.86,6604.28,6586.57,6600.01]},{x:new Date(15388596e5),y:[6601.81,6603.21,6592.78,6596.25]},{x:new Date(15388614e5),y:[6596.25,6604.2,6590,6602.99]},{x:new Date(15388632e5),y:[6602.99,6606,6584.99,6587.81]},{x:new Date(1538865e6),y:[6587.81,6595,6583.27,6591.96]},{x:new Date(15388668e5),y:[6591.97,6596.07,6585,6588.39]},{x:new Date(15388686e5),y:[6587.6,6598.21,6587.6,6594.27]},{x:new Date(15388704e5),y:[6596.44,6601,6590,6596.55]},{x:new Date(15388722e5),y:[6598.91,6605,6596.61,6600.02]},{x:new Date(1538874e6),y:[6600.55,6605,6589.14,6593.01]},{x:new Date(15388758e5),y:[6593.15,6605,6592,6603.06]},{x:new Date(15388776e5),y:[6603.07,6604.5,6599.09,6603.89]},{x:new Date(15388794e5),y:[6604.44,6604.44,6600,6603.5]},{x:new Date(15388812e5),y:[6603.5,6603.99,6597.5,6603.86]},{x:new Date(1538883e6),y:[6603.85,6605,6600,6604.07]},{x:new Date(15388848e5),y:[6604.98,6606,6604.07,6606]}]}],chart:{type:"candlestick",height:350},title:{text:"CandleStick Chart",align:"left"},colors:{upward:"darkmagenta",downward:"#00cbcb"},xaxis:{type:"datetime"},yaxis:{tooltip:{enabled:!0}}};return new sa.a(document.querySelector("#chart"),t).render(),""}var ma=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(S.a)(this,Object(v.a)(t).call(this,e))).onChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value)),a.filterOptionChain(e.target.name,e.target.value)},a.toFixedAmount=function(e){if(e)return parseFloat(e).toFixed(2)},a.state={products:[],stopnview:"",curnewdata:"",underlyingValue:"",timestamp:"",totalCOI:0,expiry:"",strike:"",FilteredBY:"",AllspTotalOI:[],PEoi:0,CEoi:0,scrollcount:0},a}return Object(w.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){var e=this;T.getFunds().then(function(t){var a=K(t);a.status&"SUCCESS"===a.message&&(e.setState({fundData:a.data}),localStorage.setItem("netCapital",a.data&&a.data.net))})}},{key:"render",value:function(){return l.a.createElement(l.a.Fragment,null,l.a.createElement(ht,null),l.a.createElement("br",null),l.a.createElement("br",null),l.a.createElement("br",null),l.a.createElement(M.a,{direction:"row",container:!0,className:"flexGrow",spacing:2,style:{paddingLeft:"5px",paddingRight:"5px",justifyContent:"center"}},l.a.createElement(M.a,{id:"tabledatachart",item:!0,xs:8,sm:8},l.a.createElement(Et.a,{style:{padding:"25px"}},l.a.createElement(W.a,{variant:"h6"},"Net:   ",this.state.fundData&&this.toFixedAmount(this.state.fundData.net)),l.a.createElement(W.a,{variant:"h6"},"Available Cash :   ",this.state.fundData&&this.toFixedAmount(this.state.fundData.availablecash)),l.a.createElement(W.a,{variant:"h6"},"Aailable Intraday payin :   ",this.state.fundData&&this.toFixedAmount(this.state.fundData.availableintradaypayin)),l.a.createElement(W.a,{variant:"h6"},"Available limit margin :   ",this.state.fundData&&this.toFixedAmount(this.state.fundData.availablelimitmargin)),l.a.createElement(W.a,{variant:"h6"},"Collateral :   ",this.state.fundData&&this.toFixedAmount(this.state.fundData.collateral)),l.a.createElement(W.a,{variant:"h6"},"Utilised debits :   ",this.state.fundData&&this.toFixedAmount(this.state.fundData.utiliseddebits)),l.a.createElement(W.a,{variant:"h6"},"Utilised exposure :   ",this.state.fundData&&this.toFixedAmount(this.state.fundData.utilisedexposure)),l.a.createElement(W.a,{variant:"h6"},"Utilised holding sales :   ",this.state.fundData&&this.toFixedAmount(this.state.fundData.utilisedholdingsales)),l.a.createElement(W.a,{variant:"h6"},"Utilised option premium :   ",this.state.fundData&&this.toFixedAmount(this.state.fundData.utilisedoptionpremium)),l.a.createElement(W.a,{variant:"h6"},"Utilised payout :   ",this.state.fundData&&this.toFixedAmount(this.state.fundData.utilisedpayout)),l.a.createElement(W.a,{variant:"h6"},"Utilised span :   ",this.state.fundData&&this.toFixedAmount(this.state.fundData.utilisedspan)),l.a.createElement(W.a,{variant:"h6"},"Utilised turnover :   ",this.state.fundData&&this.toFixedAmount(this.state.fundData.utilisedturnover)))),l.a.createElement(M.a,{id:"tabledatachart",item:!0,xs:4,sm:4},l.a.createElement(Et.a,{style:{padding:"25px"}},l.a.createElement(W.a,{variant:"h6"},"M2M Unrealized  :   ",this.state.fundData&&this.toFixedAmount(this.state.fundData.m2munrealized)),l.a.createElement(W.a,{variant:"h6"},"M2M Realized  :   ",this.state.fundData&&this.toFixedAmount(this.state.fundData.m2mrealized))))))}}]),t}(l.a.Component),ga=Object(i.b)(function(e){return{packs:e.packs.packs.data}},{setPackLoaded:Jt})(ma),ua=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(S.a)(this,Object(v.a)(t).call(this,e))).getTodayOrder=function(){T.retrieveOrderBook().then(function(e){var t=K(e,"noPop");if(t&&t.data){var n=t.data;n.sort(function(e,t){return new Date(t.updatetime)-new Date(e.updatetime)}),a.setState({oderbookData:n}),localStorage.setItem("oderbookData",JSON.stringify(n))}})},a.cancelOrderOfSame=function(e,t){var n={variety:t,orderid:e};T.cancelOrder(n).then(function(e){var t=K(e);t.status&&"SUCCESS"===t.message&&(console.log("cancel order",t),a.getTodayOrder())})},a.modifyOrder=function(e,t){console.log(a.state.triggerprice);var n={variety:e.variety,orderid:e.orderid,ordertype:0!==a.state.price?"STOPLOSS_LIMIT":"STOPLOSS_MARKET",producttype:e.producttype,duration:e.duration,price:a.state.price,triggerprice:t||a.state.triggerprice,quantity:e.lotsize,tradingsymbol:e.tradingsymbol,symboltoken:e.symboltoken,exchange:e.exchange};T.modifyOrder(n).then(function(e){var t=K(e);console.log(t),t.status&&"SUCCESS"===t.message&&(a.setState({triggerprice:0}),a.getTodayOrder())})},a.onChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value.trim()))},a.state={oderbookData:[],listofzones:[],selectedZone:[],zone:"",selectAllzone:"Select All",triggerprice:0,price:0,lotsize:0,firstTimeFlag:!0},a}return Object(w.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){var e=this;setInterval(function(){e.getTodayOrder()},1e4)}},{key:"render",value:function(){var e=this;return l.a.createElement(l.a.Fragment,null,"#/position"!==window.location.hash?l.a.createElement(ht,null):"",l.a.createElement(M.a,{spacing:1,direction:"row",alignItems:"center",container:!0},l.a.createElement(M.a,{item:!0,xs:12,sm:6},l.a.createElement(W.a,{component:"h2",variant:"h6",color:"primary",gutterBottom:!0},"Oders Placed (",this.state.oderbookData.length,")")),l.a.createElement(M.a,{item:!0,xs:12,sm:6},l.a.createElement(B.a,{id:"orderRefresh",type:"number",variant:"contained",style:{float:"right"},onClick:function(){return e.getTodayOrder()}},"Refresh"))),l.a.createElement(M.a,{direction:"row",alignItems:"center",container:!0},l.a.createElement(M.a,{item:!0,xs:12,sm:12},l.a.createElement(Et.a,{style:{padding:"10px"}},l.a.createElement(Je.a,{size:"small",style:{width:"100%"},"aria-label":"sticky table"},l.a.createElement(St.a,{style:{whiteSpace:"nowrap"},variant:"head"},l.a.createElement(_e.a,{variant:"head"},l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"Update time")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"Instrument")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"Order Type")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"Variety")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"CNC/Intraday")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"Qty ")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"AvgPrice")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"Price")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"TriggerPrice")),l.a.createElement(qe.a,{align:"center"},"Action"),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"Status")),l.a.createElement(qe.a,{align:"center"},l.a.createElement("b",null,"Details")))),l.a.createElement(ze.a,null,this.state.oderbookData&&this.state.oderbookData?this.state.oderbookData.map(function(t,a){return l.a.createElement(_e.a,{hover:!0,key:a},l.a.createElement(qe.a,{align:"center"},t.updatetime?new Date(t.updatetime).toString().substring(15,25):""),l.a.createElement(qe.a,{style:{width:"10%"},align:"center"},t.tradingsymbol),l.a.createElement(qe.a,{align:"center"},t.transactiontype),l.a.createElement(qe.a,{align:"center"},t.variety),l.a.createElement(qe.a,{align:"center"},t.producttype),l.a.createElement(qe.a,{align:"center"},t.quantity),l.a.createElement(qe.a,{align:"center"},t.averageprice),l.a.createElement(qe.a,{align:"center"},"trigger pending"===t.orderstatus?l.a.createElement(Y.a,{style:{textAlign:"center",width:"50px"},id:"price",value:0===e.state.price?t.price:e.state.price,name:"price",onChange:e.onChange}):t.price),l.a.createElement(qe.a,{align:"center"},"trigger pending"===t.orderstatus||"open"===t.orderstatus?l.a.createElement(Y.a,{type:"number",style:{textAlign:"center",width:"50px"},id:"triggerprice",value:0===e.state.triggerprice?t.triggerprice:e.state.triggerprice,name:"triggerprice",onChange:e.onChange}):t.triggerprice),l.a.createElement(qe.a,{align:"left"},"trigger pending"===t.orderstatus||"open"===t.orderstatus?l.a.createElement(l.a.Fragment,null,l.a.createElement(B.a,{size:"small",type:"number",variant:"contained",color:"primary",style:{marginLeft:"20px"},onClick:function(){return e.modifyOrder(t)}},"Update")):""),l.a.createElement(qe.a,{style:{fontSize:"11px",width:"10%"},align:"center"},t.orderstatus,l.a.createElement("br",null),"trigger pending"===t.orderstatus||"open"===t.orderstatus?l.a.createElement(l.a.Fragment,null,l.a.createElement(B.a,{size:"small",type:"number",variant:"contained",color:"",style:{marginLeft:"20px"},onClick:function(){return e.cancelOrderOfSame(t.orderid,t.variety)}},"Cancel")):""),l.a.createElement(qe.a,{style:{fontSize:"11px"},align:"center"},t.text))}):l.a.createElement(ut.a,null)))))))}}]),t}(l.a.Component),da=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(S.a)(this,Object(v.a)(t).call(this,e))).getTodayTrade=function(){T.retrieveTradeBook().then(function(e){var t=K(e);console.log("datamy",t),t&&t.data&&a.setState({oderbookData:t.data})})},a.zoneChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value)),e.target.value.includes("Select All")&&(a.setState({selectedZone:a.state.listofzones}),a.setState({selectAllzone:"Remove All"})),e.target.value.includes("Remove All")&&(a.setState({selectedZone:[]}),a.setState({selectAllzone:"Select All"}))},a.addProduct=function(e){console.log(a.props),a.props.history.push("/banner-add")},a.addProduct=a.addProduct.bind(Object(k.a)(a)),a.editProduct=a.editProduct.bind(Object(k.a)(a)),a.convertBool=a.convertBool.bind(Object(k.a)(a)),a.state={oderbookData:[],listofzones:[],selectedZone:[],zone:"",selectAllzone:"Select All"},a}return Object(w.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){this.getTodayTrade()}},{key:"editProduct",value:function(e){window.localStorage.removeItem("selectedBannerId"),window.localStorage.setItem("selectedBannerId",e),this.props.history.push("/banner-edit")}},{key:"convertBool",value:function(e){return e?"Yes":"No"}},{key:"dateFormat",value:function(e){var t=new Date(e);return t.toLocaleDateString()+" "+t.toTimeString().substring(0,t.toTimeString().indexOf("GMT"))}},{key:"render",value:function(){var e=this;return l.a.createElement(l.a.Fragment,null,l.a.createElement(ht,null),l.a.createElement(Et.a,{style:{padding:"10px",overflow:"auto"}},l.a.createElement(M.a,{spacing:1,direction:"row",alignItems:"center",container:!0},l.a.createElement(M.a,{item:!0,xs:12,sm:6},l.a.createElement(W.a,{component:"h2",variant:"h6",color:"primary",gutterBottom:!0},"Today Trades (",this.state.oderbookData.length,")")),l.a.createElement(M.a,{item:!0,xs:12,sm:6},l.a.createElement(B.a,{type:"number",variant:"contained",style:{float:"right"},onClick:function(){return e.getTodayTrade()}},"Refresh"))),l.a.createElement(Je.a,{size:"small","aria-label":"sticky table"},l.a.createElement(St.a,{style:{width:"",whiteSpace:"nowrap"},variant:"head"},l.a.createElement(_e.a,{variant:"head",style:{fontWeight:"bold"}},l.a.createElement(qe.a,{className:"TableHeadFormat",align:"center"},"Orderid"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"center"},"Product Type"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"center"},"Type"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"center"},"Instrument"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"center"},"Qty "),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"center"},"Price"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"center"},"Trade value"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"center"},"Update time"))),l.a.createElement(ze.a,{style:{width:"",whiteSpace:"nowrap"}},this.state.oderbookData&&this.state.oderbookData?this.state.oderbookData.map(function(e){return l.a.createElement(_e.a,{key:e.productId},l.a.createElement(qe.a,{align:"center"},e.orderid),l.a.createElement(qe.a,{align:"center"},e.tradingsymbol),l.a.createElement(qe.a,{align:"center"},e.transactiontype),l.a.createElement(qe.a,{align:"center"},e.producttype),l.a.createElement(qe.a,{align:"center"},e.fillsize),l.a.createElement(qe.a,{align:"center"},e.fillprice),l.a.createElement(qe.a,{align:"center"},e.tradevalue),l.a.createElement(qe.a,{align:"center"},e.filltime))}):l.a.createElement(ut.a,null)))))}}]),t}(l.a.Component),ha=new xt.w3cwebsocket("wss://smartapisocket.angelbroking.com/websocket"),pa=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(S.a)(this,Object(v.a)(t).call(this,e))).onChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value));var t=e.target.value;T.autoCompleteSearch(t).then(function(e){var t=e.data;console.log(t),localStorage.setItem("autoSearchTemp",JSON.stringify(t)),a.setState({autoSearchList:t})})},a.myCallback=function(e,t){"START_DATE"===t?a.setState({startDate:e}):"END_DATE"===t&&a.setState({endDate:e})},a.getLTP=function(){var e={exchange:"NSE",tradingsymbol:a.state.tradingsymbol,symboltoken:a.state.symboltoken};T.getLTP(e).then(function(e){var t=K(e,"noPop"),n=t&&t.data;a.setState({InstrumentLTP:n})})},a.decodeWebsocketData=function(e){console.log("atoms");var t=[];try{for(var a=0;a<e.length;a++)t.push(String.fromCharCode(e[a]))}catch(n){}return t.join("")},a.makeConnection=function(e,t){var n={actiontype:"subscribe",feedtype:"order_feed",jwttoken:a.state.jwtToken,clientcode:a.state.clientcode,apikey:I};console.log("1st Request :- "+JSON.stringify(n)),ha.send(JSON.stringify(n))},a.updateSocketWatch=function(e,t){var n=a.state.symbolList.map(function(e){return"nse_cm|"+e.token}),l={task:"mw",channel:n=n.join("&"),token:a.state.feedToken,user:a.state.clientcode,acctid:a.state.clientcode};ha.send(JSON.stringify(l))},a.placeOrder=function(e){var t={variety:"NORMAL",tradingsymbol:a.state.tradingsymbol,symboltoken:a.state.symboltoken,transactiontype:e,exchange:"NSE",ordertype:0===a.state.buyPrice?"MARKET":"LIMIT",producttype:a.state.producttype,duration:"DAY",price:a.state.buyPrice,squareoff:"0",stoploss:"0",quantity:a.state.quantity};T.placeOrder(t).then(function(e){var t=K(e);console.log(t),t.status&&"SUCCESS"===t.message&&(localStorage.setItem("ifNotBought","false"),a.setState({orderid:t.data&&t.data.orderid}),a.state.stoploss&&a.placeSLMOrder(a.state.stoploss))})},a.LoadSymbolDetails=function(e){for(var t="",n=0;n<a.state.symbolList.length;n++)if(a.state.symbolList[n].symbol===e){t=a.state.symbolList[n].token,a.setState({tradingsymbol:e,symboltoken:a.state.symbolList[n].token});break}a.getHistory(t)},a.placeSLMOrder=function(){var e={tradingsymbol:a.state.tradingsymbol,symboltoken:a.state.symboltoken,transactiontype:"SELL",exchange:"NSE",ordertype:"STOPLOSS_MARKET",producttype:a.state.producttype,duration:"DAY",price:0,squareoff:"0",stoploss:"0",quantity:a.state.quantity,triggerprice:a.state.stoploss,variety:"STOPLOSS"};T.placeOrder(e).then(function(e){var t=K(e);console.log(t),t.status&&"SUCCESS"===t.message&&(localStorage.setItem("ifNotBought","false"),a.setState({orderid:t.data&&t.data.orderid}))})},a.getHistory=function(e){var t=rt.duration("00:50:00"),n=rt(new Date).subtract(t),l={exchange:"NSE",symboltoken:e,interval:"FIFTEEN_MINUTE",fromdate:rt(n).format("YYYY-MM-DD HH:mm"),todate:rt(new Date).format("YYYY-MM-DD HH:mm")};T.getHistoryData(l).then(function(e){var t=K(e,"noPop");if(console.log(t),t&&t.data){var n=t.data;n&&n.sort(function(e,t){return new Date(t[0])-new Date(e[0])}),n.length>0&&(localStorage.setItem("InstrumentHistroy",JSON.stringify(n)),a.setState({InstrumentHistroy:n,buyPrice:n[0][2]})),a.getLTP()}})},a.onSelectItem=function(e,t){var n=JSON.parse(localStorage.getItem("autoSearchTemp"));if(console.log("values",t),console.log("autoSearchTemp",n),n.length>0){for(var l="",r=0;r<n.length;r++)if(console.log("fdata",n[r].symbol),n[r].symbol===t){l=n[r];break}var o=localStorage.getItem("watchList");if(o){0===(o=JSON.parse(localStorage.getItem("watchList"))).filter(function(e){return e.symbol===t}).length&&(o.push(l),localStorage.setItem("watchList",JSON.stringify(o)))}else{var i=[];i.push(l),localStorage.setItem("watchList",JSON.stringify(i))}a.setState({symbolList:JSON.parse(localStorage.getItem("watchList")),search:""}),setTimeout(function(){a.updateSocketWatch()},100)}},a.deleteItemWatchlist=function(e){var t=JSON.parse(localStorage.getItem("watchList")),n=t.findIndex(function(t){return t.symbol===e});t.splice(n,1),localStorage.setItem("watchList",JSON.stringify(t)),a.setState({symbolList:t})},a.getAveragePrice=function(e){for(var t=localStorage.getItem("oderbookData"),n=0,l=0;l<t.length;l++)if("orderId"===t[l].orderid){n=t[l].averageprice,a.setState({averageprice:n});break}return n},a.state={positionList:[],userName:"",password:"",autoSearchList:[],isDasable:!1,isError:!1,InstrumentLTP:{},ifNotBought:!0,autoSearchTemp:[],symboltoken:"",tradingsymbol:"",buyPrice:0,quantity:1,producttype:"INTRADAY",symbolList:JSON.parse(localStorage.getItem("watchList"))},a.myCallback=a.myCallback.bind(Object(k.a)(a)),a}return Object(w.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=JSON.parse(localStorage.getItem("userTokens")),a=t&&t.feedToken,n=t&&t.jwtToken,l=JSON.parse(localStorage.getItem("userProfile")),r=l&&l.clientcode;this.setState({feedToken:a,clientcode:r,jwtToken:n}),ha.onopen=function(t){var n={jwttoken:e.state.jwtToken,clientcode:e.state.clientcode,apikey:I};console.log("1st Request :- "+JSON.stringify(n)),ha.send(n),setTimeout(function(){this.makeConnection(a,r)},1e3)},ha.onmessage=function(t){var a=window.atob(t.data),n=e.decodeWebsocketData(Tt.a.inflate(a));e.setState({positionList:JSON.parse(n)})},ha.onerror=function(e){console.log("socket error",e)},setInterval(function(){var t={actiontype:"heartbeat",feedtype:"order_feed",jwttoken:e.state.feedToken,clientcode:e.state.clientcode,apikey:I};console.log("heartbeatReq : "+t),ha.send(t)},59e3),localStorage.getItem("watchList")||localStorage.setItem("watchList",[])}},{key:"render",value:function(){return l.a.createElement(l.a.Fragment,null,l.a.createElement(ht,null),l.a.createElement(M.a,{spacing:1,direction:"row",alignItems:"center",container:!0},l.a.createElement(M.a,{item:!0,xs:10,sm:12},l.a.createElement(Et.a,{style:{padding:"10px",overflow:"auto"}},l.a.createElement(Je.a,{size:"small","aria-label":"sticky table"},l.a.createElement(St.a,{style:{width:"",whiteSpace:"nowrap"},variant:"head"},l.a.createElement(_e.a,{variant:"head",style:{fontWeight:"bold"}},l.a.createElement(qe.a,{className:"TableHeadFormat",align:"center"},"Trading symbol"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"center"},"Order Type"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"center"},"Product type"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"center"},"Transaction type"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"center"},"Quantity"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"center"},"Average Price"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"center"},"Status "),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"center"},"Order Status"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"center"},"Exec Time"))),l.a.createElement(ze.a,{style:{width:"",whiteSpace:"nowrap"}},this.state.positionList?this.state.positionList.map(function(e,t){return l.a.createElement(_e.a,{key:t},l.a.createElement(qe.a,{align:"center"},e.tradingsymbol),l.a.createElement(qe.a,{align:"center"},e.ordertype),l.a.createElement(qe.a,{align:"center"},e.producttype),l.a.createElement(qe.a,{align:"center"},e.transactiontype),l.a.createElement(qe.a,{align:"center"},e.quantity),l.a.createElement(qe.a,{align:"center"},e.averageprice),l.a.createElement(qe.a,{align:"center"},e.status),l.a.createElement(qe.a,{align:"center"},e.orderstatus),l.a.createElement(qe.a,{align:"center"},e.exchtime))}):""))))))}}]),t}(l.a.Component),fa=a(175),ya=a.n(fa),ba=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(S.a)(this,Object(v.a)(t).call(this,e))).searchSymbolPendingOrder=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value)),T.autoCompleteSearch(e.target.value).then(function(t){var n=t.data;if(e.target.value){var l=e.target.value.toUpperCase()+"-EQ",r=n.filter(function(e){return"NSE"===e.exch_seg&&"1"===e.lotsize&&e.symbol===l});r.length&&a.setState({searchSymbolPending:r[0].symbol,searchTokenPending:r[0].token,exch_seg:r[0].exch_seg})}})},a.updateInput=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.addInOrderPenidngList=Object(ae.a)(ee.a.mark(function e(){var t;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(a.state.searchSymbolPending,a.state.searchTokenPending,a.state.buyAtPending,a.state.sellAtPending),!(parseFloat(a.state.sellAtPending)>a.state.lastTradedData.low)){e.next=4;break}if(window.confirm("Be carefull Selling at high price "+a.state.sellAtPending+", today "+a.state.searchSymbolPending+" low is "+a.state.lastTradedData.low)){e.next=4;break}return e.abrupt("return");case 4:if(!(parseFloat(a.state.buyAtPending)<a.state.lastTradedData.high)){e.next=7;break}if(window.confirm("Be carefull Buying at low price "+a.state.buyAtPending+", today "+a.state.searchSymbolPending+" high is "+a.state.lastTradedData.high)){e.next=7;break}return e.abrupt("return");case 7:(a.state.searchSymbolPending&&a.state.buyAtPending||a.state.sellAtPending)&&(t={createdAt:(new Date).toLocaleTimeString(),token:a.state.searchTokenPending,symbol:a.state.searchSymbolPending,buyAt:a.state.buyAtPending,sellAt:a.state.sellAtPending,pattenName:a.state.pattenNamePending,exch_seg:a.state.exch_seg},a.setState({orderPenidngList:[].concat(Object(te.a)(a.state.orderPenidngList),[t])},function(){this.setState({searchSymbolPending:"",searchTokenPending:"",buyAtPending:"",sellAtPending:"",pattenNamePending:""}),localStorage.setItem("orderPenidngList",JSON.stringify(this.state.orderPenidngList)),localStorage.setItem("orderTagToPosition",JSON.stringify(this.state.orderPenidngList))}));case 8:case"end":return e.stop()}},e)})),a.deleteInOrderPenidngList=function(e){console.log("callback",e);for(var t="",n=localStorage.getItem("orderPenidngList")&&JSON.parse(localStorage.getItem("orderPenidngList")),l=0;l<a.state.orderPenidngList.length;l++){var r=n[l];if(e.token==r.token){t=n.splice(l,1);localStorage.setItem("orderPenidngList",JSON.stringify(n)),a.setState({orderPenidngList:n});break}}return t[0].token==e.token},a.callBackUpdate=function(e){console.log("call back called")},a.updateLTP=Object(ae.a)(ee.a.mark(function e(){var t,n,l;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=ee.a.mark(function e(t){var n;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.state.orderPenidngList[t],l={exchange:n.exch_seg,tradingsymbol:n.symbol,symboltoken:n.token},T.getLTP(l).then(function(e){var t=K(e,"noPop"),l=t&&t.data;if(l&&l.ltp)if(n.ltp=l.ltp,n.perChange=(100*(l.ltp-l.close)/l.close).toFixed(2),localStorage.setItem("orderPenidngList",JSON.stringify(a.state.orderPenidngList)),a.setState({orderPenidngList:a.state.orderPenidngList}),console.log("ltp update",n.symbol,n),n.buyAt&&l.ltp>=parseFloat(n.buyAt))a.deleteInOrderPenidngList(n)&&mt.historyWiseOrderPlace(n,"BUY","isAutomatic",a.callBackUpdate);else if(n.sellAt&&l.ltp<=parseFloat(n.sellAt)){a.deleteInOrderPenidngList(n)&&mt.historyWiseOrderPlace(n,"SELL","isAutomatic",a.callBackUpdate)}}),e.next=5,new Promise(function(e){return setTimeout(e,100)});case 5:case"end":return e.stop()}},e)}),n=0;case 2:if(!(n<a.state.orderPenidngList.length)){e.next=7;break}return e.delegateYield(t(n),"t0",4);case 4:n++,e.next=2;break;case 7:case"end":return e.stop()}},e)})),a.getTradePrice=function(){var e={exchange:a.state.exch_seg,tradingsymbol:a.state.searchSymbolPending,symboltoken:a.state.searchTokenPending};T.getLTP(e).then(function(e){var t=K(e,"noPop"),n=t&&t.data;if(n&&n.ltp){var l={symbol:n.tradingsymbol,ltp:n.ltp,perChange:(100*(n.ltp-n.close)/n.close).toFixed(2),open:n.open,high:n.high,close:n.close,low:n.low};a.setState({lastTradedData:l})}})},a.refreshCandleChartManually=function(){var e=Object(ae.a)(ee.a.mark(function e(t){var n,l,r;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=rt("9:15am","h:mma"),l=rt.duration("12:00:00"),rt(new Date).subtract(l),r={exchange:"NSE",symboltoken:t.token,interval:"FIVE_MINUTE",fromdate:rt(n).format("YYYY-MM-DD HH:mm"),todate:rt(new Date).format("YYYY-MM-DD HH:mm")},T.getHistoryData(r).then(function(e){var a=K(e,"noPop");if(a&&a.data&&a.data.length){var n=[];a.data.forEach(function(e){n.push([e[0],e[1],e[2],e[3],e[4]])}),localStorage.setItem("candleChangeShow",t.perChange),localStorage.setItem("candleChartData",JSON.stringify(n)),localStorage.setItem("cadleChartSymbol",t.symbol),document.getElementById("showCandleChart").click()}else console.log(t.symboltoken,"  emply candle found")}).catch(function(e){a.setState({failedCount:a.state.failedCount+1}),G.showError(t.symboltoken+" candle failed!")});case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.onChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value.trim()))},a.onChange2=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value));var t=e.target.value;a.setState({lastTradedData:{},buyAtPending:"",sellAtPending:"",pattenNamePending:"",searchSymbolPending:""}),T.autoCompleteSearch(t).then(function(e){var t=e.data;console.log(t),localStorage.setItem("autoSearchTemp",JSON.stringify(t)),a.setState({autoSearchList:t})})},a.openNewPage=function(e){window.open("/mtrade/#/order-watchlist"),localStorage.setItem("isOpenInNewPage","yes")},a.backToPositionPage=function(e){window.location.replace("/mtrade/#/position"),localStorage.setItem("isOpenInNewPage","no")},a.onSelectItem=function(e,t){var n=JSON.parse(localStorage.getItem("autoSearchTemp"));if(n.length>0){for(var l="",r=0;r<n.length;r++)if(n[r].symbol===t){l=n[r];break}a.setState({searchSymbolPending:l.symbol,searchTokenPending:l.token,exch_seg:l.exch_seg},function(){this.getTradePrice()})}},a.buyOption=function(e,t,a,n){console.log(e,t,a,n);var l=n.toUpperCase().split("-"),r=t+(l=l[0]+l[1]+l[2]%1e3)+a+e;console.log(r),T.autoCompleteSearch(r).then(function(e){var t=e.data,a=t&&t[0];if(console.log("optionData",a),a&&a.symbol&&a.symbol==r){var n={exchange:a.exch_seg,tradingsymbol:a.symbol,symboltoken:a.token};T.getLTP(n).then(function(e){var t=K(e,"noPop"),n=t&&t.data;if(n&&n.ltp){console.log("option ltp",n);var l=1*a.lotsize,r=n.ltp-10*n.ltp/100,o=(r=mt.getMinPriceAllowTick(r))-1*r/100;o=mt.getMinPriceAllowTick(o);var i={tradingsymbol:a.symbol,symboltoken:a.token,transactiontype:"BUY",ordertype:"LIMIT",buyPrice:n.ltp,producttype:"CARRYFORWARD",exchange:a.exch_seg,stopLossTriggerPrice:r,stopLossPrice:o,quantity:l};console.log("option buy element",i),mt.placeOptionOrder(i)}})}else G.showError(r+" not found")})},a.state={orderPenidngList:localStorage.getItem("orderPenidngList")&&JSON.parse(localStorage.getItem("orderPenidngList"))||[],buyAtPending:"",sellAtPending:"",pattenNamePending:"",searchSymbolPending:"",autoSearchList:[],lastTradedData:{}},a}return Object(w.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.updateLTP();var t=rt("9:15am","h:mma"),a=rt("3:30pm","h:mma"),n=rt(new Date,"h:mma");if(rt().isoWeekday()<=5&&n.isBetween(t,a)){var l=2e3;this.state.orderPenidngList.length>10&&(l=110*this.state.orderPenidngList.length),this.setState({findlast5minMovementInterval:setInterval(function(){e.updateLTP()},l)})}}},{key:"render",value:function(){var e=this;return l.a.createElement(l.a.Fragment,null,"#/order-watchlist"==window.location.hash?l.a.createElement(ht,null):"",l.a.createElement(Et.a,{style:{overflow:"auto",padding:"5px",background:"#f500570a"}},l.a.createElement(M.a,{justify:"space-between",container:!0},l.a.createElement(M.a,{item:!0},l.a.createElement(W.a,{component:"h2",variant:"h6",color:"primary",gutterBottom:!0},"Orders Watchlist (",this.state.orderPenidngList&&this.state.orderPenidngList.length,")","#/order-watchlist"!=window.location.hash?l.a.createElement(B.a,{onClick:function(){return e.openNewPage()}}," New Page ",l.a.createElement(Pe.a,null)," "):"","#/position"!=window.location.hash?l.a.createElement(B.a,{onClick:function(){return e.backToPositionPage()}}," Back to Position "):"")),l.a.createElement(M.a,{item:!0},l.a.createElement(M.a,{container:!0,spacing:2},l.a.createElement(M.a,{item:!0},l.a.createElement(vt.a,{freeSolo:!0,id:"free-solo-2-demo",disableClearable:!0,onChange:this.onSelectItem,value:this.state.searchSymbolPending,options:this.state.autoSearchList.length>0?this.state.autoSearchList.map(function(e){return e.symbol}):[],renderInput:function(t){return l.a.createElement(Y.a,Object.assign({onChange:e.onChange2},t,{label:"Search Symbol",margin:"normal",style:{width:"500px",marginTop:"inherit"},name:"searchSymbolPending",variant:"standard",InputProps:Object(m.a)({},t.InputProps,{type:"search"})}))}}),this.state.lastTradedData.symbol,"  Ltp: ",l.a.createElement("b",{style:{color:0==this.state.lastTradedData.perChange?"none":this.state.lastTradedData.perChange>0?"green":"red"}}," ",this.state.lastTradedData.ltp," ",this.state.lastTradedData.ltp?"("+this.state.lastTradedData.perChange+"%)":"")),l.a.createElement(M.a,{item:!0},l.a.createElement(Y.a,{label:"BuyAt(limit)",type:"number",name:"buyAtPending",value:this.state.buyAtPending,onChange:this.updateInput}),l.a.createElement("br",null)," High: ",this.state.lastTradedData.high),l.a.createElement(M.a,{item:!0},l.a.createElement(Y.a,{label:"SellAt(limit)",type:"number",name:"sellAtPending",value:this.state.sellAtPending,onChange:this.updateInput}),l.a.createElement("br",null)," Low: ",this.state.lastTradedData.low),l.a.createElement(M.a,{item:!0},l.a.createElement(Y.a,{label:"Which Pattern",name:"pattenNamePending",value:this.state.pattenNamePending,onChange:this.updateInput}),l.a.createElement("br",null)," Open: ",this.state.lastTradedData.open),l.a.createElement(M.a,{item:!0},l.a.createElement(B.a,{variant:"contained",style:{marginLeft:"20px",marginTop:"10px"},onClick:function(){return e.addInOrderPenidngList()}}," Add "),l.a.createElement("br",null)," P.Close: ",this.state.lastTradedData.close))),l.a.createElement(Je.a,{size:"small","aria-label":"sticky table"},l.a.createElement(St.a,{style:{whiteSpace:"nowrap"},variant:"head"},l.a.createElement(_e.a,{key:"1",variant:"head",style:{fontWeight:"bold"}},l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"Symbol"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"CreatetAt"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"Exch_seg"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"Token"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"Patten Name"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"BuyAt"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"SellAt"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"LTP"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"Delete"))),l.a.createElement(ze.a,{id:"tableAdd",style:{width:"",whiteSpace:"nowrap"}},this.state.orderPenidngList?this.state.orderPenidngList.map(function(t){return l.a.createElement(_e.a,{hover:!0},l.a.createElement(qe.a,{align:"left"},l.a.createElement(B.a,{style:{color:t.perChange>0?"green":"red"},size:"small",variant:"contained",title:"Candle refresh",onClick:function(){return e.refreshCandleChartManually(t)}},t.symbol," ",t.ltp," (",t.perChange,") ",l.a.createElement(xe.a,null))),l.a.createElement(qe.a,{align:"left"},t.createdAt),l.a.createElement(qe.a,{align:"left"},t.exch_seg),l.a.createElement(qe.a,{align:"left"},t.token),l.a.createElement(qe.a,{align:"left"},t.pattenName),l.a.createElement(qe.a,{align:"left"},t.buyAt),l.a.createElement(qe.a,{align:"left"},t.sellAt),l.a.createElement(qe.a,{align:"left",style:{color:0==t.perChange?"none":t.perChange>0?"green":"red"}},l.a.createElement("b",null,t.ltp," (",t.perChange,"%) ")),l.a.createElement(qe.a,{align:"left"},l.a.createElement(ya.a,{style:{cursor:"pointer"},onClick:function(){return e.deleteInOrderPenidngList(t)}})))}):"")))),l.a.createElement("br",null),l.a.createElement(Et.a,{style:{overflow:"auto",padding:"5px"}},l.a.createElement(M.a,{item:!0},l.a.createElement(W.a,{component:"h2",variant:"h6",color:"primary",gutterBottom:!0},"Option Chain (Equity Derivatives)")),l.a.createElement(ea,{buyOption:this.buyOption})))}}]),t}(l.a.Component),Ea=Object(He.a)(function(e){return{root:{margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}})(function(e){var t=e.children,a=e.classes,n=e.onClose,r=Object(Be.a)(e,["children","classes","onClose"]);return l.a.createElement(je.a,Object.assign({disableTypography:!0,className:a.root},r),l.a.createElement(W.a,{variant:"h6"},t),n?l.a.createElement(ce.a,{"aria-label":"close",className:a.closeButton,onClick:n},l.a.createElement(Ue.a,null)):null)}),Sa=Object(He.a)(function(e){return{root:{padding:e.spacing(2)}}})(Re.a),va=Object(He.a)(function(e){return{root:{margin:0,padding:e.spacing(1)}}})(Ve.a);function ka(e){var t=l.a.useState(!1),a=Object(ne.a)(t,2),n=a[0],r=a[1],o=l.a.useState({data:[],candledata:{}}),i=Object(ne.a)(o,2),s=(i[0],i[1],function(){r(!1)}),c=localStorage.getItem("multipleChartData")&&JSON.parse(localStorage.getItem("multipleChartData")),m=c&&c.longCandles,g=c&&c.shortCandles;return l.a.createElement("div",null,l.a.createElement(B.a,{variant:"outlined",id:"showMultipleChart",color:"primary",style:{display:"none"},onClick:function(){r(!0)}},"Chart"),l.a.createElement(Ye.a,{maxWidth:"lg",onClose:s,"aria-labelledby":"customized-dialog-title",open:n},l.a.createElement(Ea,{id:"customized-dialog-title",onClose:s},c&&c.symbol),l.a.createElement(Sa,{dividers:!0},l.a.createElement(W.a,{component:"h3",variant:"h6",color:"primary",gutterBottom:!0},"Longs (",m&&m.length,")"),l.a.createElement(M.a,{justify:"space-between",container:!0,direction:"row"},m?m.map(function(e,t){return l.a.createElement(M.a,{item:!0},l.a.createElement(Ke.a,{options:{chart:{type:"candlestick",height:250},title:{text:e.foundAt.substr(6,10),align:"left"},xaxis:{type:"datetime"},yaxis:{tooltip:{enabled:!0}}},series:[{data:e.candleChartData.reverse()}],type:"candlestick",width:250,height:250}))}):""),l.a.createElement(W.a,{component:"h3",variant:"h6",color:"primary",gutterBottom:!0},"Shorts (",g&&g.length,")"),l.a.createElement(M.a,{justify:"space-between",container:!0,direction:"row"},g?g.map(function(e,t){return l.a.createElement(M.a,{item:!0},l.a.createElement(Ke.a,{options:{chart:{type:"candlestick",height:250},title:{text:e.foundAt.substr(6,10),align:"left"},xaxis:{type:"datetime"},yaxis:{tooltip:{enabled:!0}}},series:[{data:e.candleChartData.reverse()}],type:"candlestick",width:250,height:250}))}):"")),l.a.createElement(va,null,l.a.createElement(B.a,{autoFocus:!0,onClick:s,color:"primary"},"Close"))))}var wa=a(135),Ca=a.n(wa),La=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(S.a)(this,Object(v.a)(t).call(this,e))).getCandleHistoryAndStore=Object(ae.a)(ee.a.mark(function e(){var t,n,l,r,o,i,s;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("getCandleHistoryAndStore called",(new Date).toLocaleTimeString()),(new Date).toLocaleTimeString()>"15:00:00"?clearInterval(a.state.candleHistoryInterval):"",t=localStorage.getItem("watchList")&&JSON.parse(localStorage.getItem("watchList")),n=rt().isoWeekday(),l="",l=(new Date).toLocaleTimeString()>"10:05:00"?rt.duration("00:50:00"):1===n&&(new Date).toLocaleTimeString()<"10:05:00"?rt.duration("66:00:00"):rt.duration("19:00:00"),l=rt.duration("21:00:00"),"YYYY-MM-DD HH:mm",r=rt(new Date).subtract(l),o=ee.a.mark(function e(n){var l;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l=t[n],s={exchange:"NSE",symboltoken:l.token,interval:"FIFTEEN_MINUTE",fromdate:rt(r).format("YYYY-MM-DD HH:mm"),todate:rt(new Date).format("YYYY-MM-DD HH:mm")},T.getHistoryData(s).then(function(e){var t=K(e,"noPop");if(t&&t.data&&t.data.length){var r=t.data;if(r.reverse(),r&&r.length>=10){var o=r.slice(0,10);console.log("",n+1,l.symbol,"Time",(new Date).toLocaleTimeString()),a.findTweezerTopPatternLive(o,l.symbol),a.findTweezerBottomPatternLive(o,l.symbol)}}else console.log(" candle data emply")}),e.next=5,new Promise(function(e){return setTimeout(e,350)});case 5:case"end":return e.stop()}},e)}),i=0;case 11:if(!(i<t.length)){e.next=16;break}return e.delegateYield(o(i),"t0",13);case 13:i++,e.next=11;break;case 16:case"end":return e.stop()}},e)})),a.findTweezerTopPatternLive=function(e,t){if(e&&e.length>0){for(var n=e[2]&&e[2][2],l=e[2]&&e[2][3],r=3;r<e.length;r++)n<e[r][2]&&(n=e[r][2]),e[r][3]<l&&(l=e[r][3]);var o=e[9][3],i=e[2][2],s={time:e[0]&&e[0][0],open:e[0]&&e[0][1],high:e[0]&&e[0][2],low:e[0]&&e[0][3],close:e[0]&&e[0][4]},c={time:e[1]&&e[1][0],open:e[1]&&e[1][1],high:e[1]&&e[1][2],low:e[1]&&e[1][3],close:e[1]&&e[1][4]},m=100*(i-o)/o;if(m>=1.5&&n<(c.high<s.high?c.high:s.high)&&l<(c.low<s.low?c.low:s.low)&&c.open<c.close&&s.open>s.close&&(Math.round(c.close)==Math.round(s.open)||Math.round(c.open)==Math.round(s.close))){console.log("%c"+t+" perfect twisser top  upside movement"+m+new Date(e[0][0]).toLocaleTimeString(),"background: red; color: #bada55");var g=[];e.forEach(function(e){g.push([e[0],e[1],e[2],e[3],e[4]])});var u={symbol:t,pattenName:"Twisser Top",time:new Date(e[0][0]).toLocaleString(),candleChartData:g},d=localStorage.getItem("foundPatternList")?JSON.parse(localStorage.getItem("foundPatternList")):[];d.push(u),localStorage.setItem("foundPatternList",JSON.stringify(d)),a.setState({foundPatternList:[].concat(Object(te.a)(a.state.foundPatternList),[u])}),console.log(t,"last10Candle",e);var h=new SpeechSynthesisUtterance;h.text="twisser top in "+t.toLowerCase(),window.speechSynthesis.speak(h)}}},a.findTweezerBottomPatternLive=function(e,t){if(e&&e.length>0){for(var n=e[2]&&e[2][2],l=e[2]&&e[2][3],r=3;r<e.length;r++)n<e[r][2]&&(n=e[r][2]),e[r][3]<l&&(l=e[r][3]);var o=e[9][2],i=e[2][3],s={time:e[0]&&e[0][0],open:e[0]&&e[0][1],high:e[0]&&e[0][2],low:e[0]&&e[0][3],close:e[0]&&e[0][4]},c={time:e[1]&&e[1][0],open:e[1]&&e[1][1],high:e[1]&&e[1][2],low:e[1]&&e[1][3],close:e[1]&&e[1][4]},m=(100*(i-o)/o).toFixed(2);if(m<=-1.5&&(c.high<s.high?c.high:s.high)<n&&(c.low<s.low?c.low:s.low)<l&&c.open>c.close&&s.close>s.open&&(Math.round(c.close)==Math.round(s.open)||Math.round(c.open)==Math.round(s.close))){var g=[];e.forEach(function(e){g.push([e[0],e[1],e[2],e[3],e[4]])}),console.log("%c"+t+" perfect twisser bottom downside movement diff "+m+"% "+new Date(e[0][0]).toLocaleTimeString(),"background: #222; color: #bada55");var u={symbol:t,pattenName:"Twisser bottom",time:new Date(e[0][0]).toLocaleString(),candleChartData:g};a.setState({foundPatternList:[].concat(Object(te.a)(a.state.foundPatternList),[u])});var d=localStorage.getItem("foundPatternList")?JSON.parse(localStorage.getItem("foundPatternList")):[];d.push(u),localStorage.setItem("foundPatternList",JSON.stringify(d)),console.log(t,"last10Candle",e);var h=new SpeechSynthesisUtterance;h.text="twisser bottom in "+t.toLowerCase(),window.speechSynthesis.speak(h)}}},a.findNR4PatternLive=Object(ae.a)(ee.a.mark(function e(){var t,n,r,o,i,s,c,m;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("nr4 scaning starting"),a.setState({backTestResult:[],backTestFlag:!1}),t=localStorage.getItem("watchList")&&JSON.parse(localStorage.getItem("watchList"))||[],1,n=0,r=ee.a.mark(function e(n){var r;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t[n],"",s=rt.duration("240:00:00"),i=rt(new Date).subtract(s),c=rt.duration("24:00:00"),rt(new Date).subtract(c),m={exchange:"NSE",symboltoken:r.token,interval:"ONE_DAY",fromdate:rt(i).format("YYYY-MM-DD HH:mm"),todate:rt(new Date).format("YYYY-MM-DD HH:mm")},T.getHistoryData(m).then(function(e){var t=K(e,"noPop");if(t&&t.data&&t.data.length){var o=t.data,i=0;o.reverse();var s=o.slice(1,5),c=o.slice(0,5);if(s.length>=4){var m=[],g=[];s.forEach(function(e){m.push(e[2]-e[3])}),c.forEach(function(e){g.push([e[0],e[1],e[2],e[3],e[4]])});var u=m[0];if(m.forEach(function(e){u<=e&&(u=e,i+=1)}),console.log(n+1,r.symbol,i),4==i){console.log(n+1,r.symbol,s,m,i);var d=s[0],h=(d[2]+d[2]/100/10).toFixed(2),p=(d[3]-d[3]/100/10).toFixed(2),f={exchange:"NSE",tradingsymbol:r.symbol,symboltoken:r.token};console.log("nr4 ltp",f),T.getLTP(f).then(function(e){var t=K(e,"noPop"),n=t&&t.data;if(console.log(n,t),n&&n.ltp){var o,i=l.a.createElement("span",null," ",n.ltp," "),s=0,c=0,m=0;if(n.ltp>h){i=l.a.createElement("span",{style:{color:"green"}}," Long: ",n.ltp," (",(100*(n.ltp-h)/h).toFixed(2),"%) "),a.setState({nr4TotalPer:a.state.nr4TotalPer+100*(n.ltp-h)/h}),a.setState({totelActivatedCount:a.state.totelActivatedCount+1});var u=lt.totalCapital*lt.perTradeExposurePer/100;s=Math.floor(u/h),o=100*(n.ltp-h)/h,c=((n.ltp-h)*s).toFixed(2),m=(h*(o-.06)/100*s).toFixed(2)}if(n.ltp<p){i=l.a.createElement("span",{style:{color:"red"}}," Short: ",n.ltp," (",(100*(n.ltp-p)/p).toFixed(2),"%)"),a.setState({nr4TotalPer:a.state.nr4TotalPer+100*(p-n.ltp)/p}),a.setState({totelActivatedCount:a.state.totelActivatedCount+1});var f=lt.totalCapital*lt.perTradeExposurePer/100;s=Math.floor(f/p),c=((p-n.ltp)*s).toFixed(2),o=100*(p-n.ltp)/p,m=(p*(o-.06)/100*s).toFixed(2)}var y={symbol:r.symbol,token:r.token,pattenName:"NR4",time:new Date(d[0]).toLocaleString(),BuyAt:h,SellAt:p,orderActivated:i,candleChartData:g,quantity:s,brokerageCharges:.06,pnlAmount:c,netPnLAmount:m,perChange:o};console.log("nr4 scaned",y),a.setState({foundPatternList:[].concat(Object(te.a)(a.state.foundPatternList),[y])});var b=localStorage.getItem("foundPatternList")?JSON.parse(localStorage.getItem("foundPatternList")):[];b.push(y),localStorage.setItem("foundPatternList",JSON.stringify(b))}})}}}else console.log(r.symbol," candle data emply")}),e.next=10,new Promise(function(e){return setTimeout(e,300)});case 10:case"end":return e.stop()}},e)}),o=0;case 6:if(!(o<t.length)){e.next=11;break}return e.delegateYield(r(o),"t0",8);case 8:o++,e.next=6;break;case 11:a.setState({backTestFlag:!0}),console.log("sumPercentage",n);case 13:case"end":return e.stop()}},e)})),a.findNR7PatternLive=Object(ae.a)(ee.a.mark(function e(){var t,n,r,o,i,s,c,m,g;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("nr7 scaning starting"),a.setState({backTestResult:[],backTestFlag:!1}),t=localStorage.getItem("watchList")&&JSON.parse(localStorage.getItem("watchList"))||[],1,n=0,r=ee.a.mark(function e(n){var r;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t[n],"",s=rt.duration("288:00:00"),i=rt(new Date).subtract(s),c=rt.duration("24:00:00"),rt(new Date).subtract(c),m={exchange:"NSE",symboltoken:r.token,interval:"ONE_DAY",fromdate:rt(i).format("YYYY-MM-DD HH:mm"),todate:rt(new Date).format("YYYY-MM-DD HH:mm")},T.getHistoryData(m).then(function(e){var t=K(e,"noPop");if(t&&t.data&&t.data.length){var n=t.data;n.reverse();var o=n.slice(1,8),i=n.slice(0,9);if(o.length>=7){var s=[],c=[];o.forEach(function(e){s.push(e[2]-e[3])}),i.forEach(function(e){c.push([e[0],e[1],e[2],e[3],e[4]])});var m=s[0],g=0;if(s.forEach(function(e){m<=e&&(m=e,g+=1)}),console.log(r.symbol,o,s,g),7==g){var u=o[0],d=(u[2]+u[2]/100/10).toFixed(2),h=(u[3]-u[3]/100/10).toFixed(2),p={exchange:"NSE",tradingsymbol:r.symbol,symboltoken:r.token};console.log("nr4 ltp",p),T.getLTP(p).then(function(e){var t=K(e,"noPop"),n=t&&t.data;if(console.log(n,t),n&&n.ltp){var o,i=l.a.createElement("span",null," ",n.ltp," "),s=0,m=0,g=0;if(n.ltp>d){i=l.a.createElement("span",{style:{color:"green"}}," Long: ",n.ltp," (",(100*(n.ltp-d)/d).toFixed(2),"%) "),a.setState({nr4TotalPer:a.state.nr4TotalPer+100*(n.ltp-d)/d}),a.setState({totelActivatedCount:a.state.totelActivatedCount+1});var p=lt.totalCapital*lt.perTradeExposurePer/100;s=Math.floor(p/d),o=100*(n.ltp-d)/d,m=((n.ltp-d)*s).toFixed(2),g=(d*(o-.06)/100*s).toFixed(2)}if(n.ltp<h){i=l.a.createElement("span",{style:{color:"red"}}," Short: ",n.ltp," (",(100*(n.ltp-h)/h).toFixed(2),"%)"),a.setState({nr4TotalPer:a.state.nr4TotalPer+100*(h-n.ltp)/h}),a.setState({totelActivatedCount:a.state.totelActivatedCount+1});var f=lt.totalCapital*lt.perTradeExposurePer/100;s=Math.floor(f/h),m=((h-n.ltp)*s).toFixed(2),o=100*(h-n.ltp)/h,g=(h*(o-.06)/100*s).toFixed(2)}var y={symbol:r.symbol,token:r.token,pattenName:"NR7",time:new Date(u[0]).toLocaleString(),BuyAt:d,SellAt:h,orderActivated:i,candleChartData:c,quantity:s,brokerageCharges:.06,pnlAmount:m,netPnLAmount:g,perChange:o};console.log("nr7 scaned",y),a.setState({foundPatternList:[].concat(Object(te.a)(a.state.foundPatternList),[y])});var b=localStorage.getItem("foundPatternList")?JSON.parse(localStorage.getItem("foundPatternList")):[];b.push(y),localStorage.setItem("foundPatternList",JSON.stringify(b))}})}}}else console.log(r.symbol," candle data emply")}),g=n+1+". "+r.symbol,a.setState({stockTesting:g}),e.next=12,new Promise(function(e){return setTimeout(e,300)});case 12:case"end":return e.stop()}},e)}),o=0;case 6:if(!(o<t.length)){e.next=11;break}return e.delegateYield(r(o),"t0",8);case 8:o++,e.next=6;break;case 11:a.setState({backTestFlag:!0}),console.log("sumPercentage",n);case 13:case"end":return e.stop()}},e)})),a.refreshCandleChartManually=function(){var e=Object(ae.a)(ee.a.mark(function e(t){var n,l,r;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=rt("9:15am","h:mma"),l=rt.duration("12:00:00"),rt(new Date).subtract(l),r={exchange:"NSE",symboltoken:t.symboltoken,interval:"FIFTEEN_MINUTE",fromdate:rt(n).format("YYYY-MM-DD HH:mm"),todate:rt(new Date).format("YYYY-MM-DD HH:mm")},T.getHistoryData(r).then(function(e){var a=K(e,"noPop");if(a&&a.data&&a.data.length){var n=[];a.data.forEach(function(e){n.push([e[0],e[1],e[2],e[3],e[4]])}),localStorage.setItem("candleChangeShow",(100*(t.ltp-t.close)/t.close).toFixed(2)),localStorage.setItem("candleChartData",JSON.stringify(n)),localStorage.setItem("cadleChartSymbol",t.symbolname),document.getElementById("showCandleChart").click()}else console.log(t.symboltoken,"  emply candle found")}).catch(function(e){a.setState({failedCount:a.state.failedCount+1}),G.showError(t.symboltoken+" candle failed!")});case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.showCandleChart=function(e,t){e=e&&e.reverse(),localStorage.setItem("candleChartData",JSON.stringify(e)),localStorage.setItem("cadleChartSymbol",t),document.getElementById("showCandleChart").click()},a.showMultipleCandleChart=function(e){localStorage.setItem("multipleChartData",JSON.stringify(e)),document.getElementById("showMultipleChart").click()},a.refreshLtpOnFoundPattern=Object(ae.a)(ee.a.mark(function e(){var t,n,r,o,i;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({nr4TotalPer:0,totalBrokerChargesNR4:0,totalNetProfit:0,totelActivatedCount:0,pnlAmountTotal:0,perHighLowTotal:0,netPnLAmountOnHighlowTotal:0}),t=a.state.foundPatternList,a.setState({foundPatternList:[]}),n=localStorage.getItem("FoundPatternList")?JSON.parse(localStorage.getItem("FoundPatternList")):[],r=ee.a.mark(function e(n){var r;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=t[n])&&"NR4"==r.pattenName&&(i={exchange:"NSE",tradingsymbol:r.symbol,symboltoken:r.token},T.getLTP(i).then(function(e){var t=K(e,"noPop"),n=t&&t.data,o=0,i=0,s=0,c=.06,m=0,g=0,u=0;if(n&&n.ltp){var d=l.a.createElement("span",null," ",n.ltp," ");if(n.ltp>r.BuyAt)m=100*(n.ltp-r.BuyAt)/r.BuyAt,d=l.a.createElement("span",{style:{color:"green"}}," Long: ",m.toFixed(2),"% "),o=Math.floor(1e4/r.BuyAt),s=(i=(n.ltp-r.BuyAt)*o)-(c=r.BuyAt*o*c/100*2),a.setState({nr4TotalPer:a.state.nr4TotalPer+m}),a.setState({totalBrokerChargesNR4:a.state.totalBrokerChargesNR4+c,totalNetProfit:a.state.totalNetProfit+s}),a.setState({totelActivatedCount:a.state.totelActivatedCount+1,pnlAmountTotal:a.state.pnlAmountTotal+i}),g=100*(n.high-r.BuyAt)/r.BuyAt,u=(n.high-r.BuyAt)*o-c,a.setState({perHighLowTotal:a.state.perHighLowTotal+g,netPnLAmountOnHighlowTotal:a.state.netPnLAmountOnHighlowTotal+u});if(n.ltp<r.SellAt)m=100*(r.SellAt-n.ltp)/r.SellAt,d=l.a.createElement("span",{style:{color:"red"}}," Short: ",m.toFixed(2),"%"),o=Math.floor(1e4/r.SellAt),s=(i=(r.SellAt-n.ltp)*o)-(c=r.SellAt*o*c/100*2),a.setState({nr4TotalPer:a.state.nr4TotalPer+m}),a.setState({totelActivatedCount:a.state.totelActivatedCount+1,pnlAmountTotal:a.state.pnlAmountTotal+i}),a.setState({totalBrokerChargesNR4:a.state.totalBrokerChargesNR4+c,totalNetProfit:a.state.totalNetProfit+s}),g=100*(r.SellAt-n.low)/r.SellAt,u=(r.SellAt-n.low)*o-c,a.setState({perHighLowTotal:a.state.perHighLowTotal+g,netPnLAmountOnHighlowTotal:a.state.netPnLAmountOnHighlowTotal+u});var h=100*(n.ltp-n.close)/n.close,p=[new Date,n.open,n.high,n.low,n.ltp];r.candleChartData.push(p);var f={symbol:r.symbol,symbolUpdated:n.ltp+"("+h.toFixed(2)+"%)",token:r.token,pattenName:"NR4",OnHighLowActivated:o?g.toFixed(2)+"% | "+u.toFixed(2):"",time:(new Date).toLocaleTimeString(),BuyAt:r.BuyAt,SellAt:r.SellAt,foundAt:r.foundAt,orderActivated:d,candleChartData:r.candleChartData,quantity:o||"",brokerageCharges:o?c.toFixed(2):"",pnlAmount:i?i.toFixed(2):"",netPnLAmount:s?s.toFixed(2):"",perChange:m,todayChange:h,pastPerferm:r.pastPerferm};console.log("nr4 updated",f),a.setState({foundPatternList:[].concat(Object(te.a)(a.state.foundPatternList),[f])});var y=a.state.foundPatternList;y.sort(function(e,t){return t.perChange-e.perChange}),a.setState({foundPatternList:y});var b=localStorage.getItem("foundPatternList")?JSON.parse(localStorage.getItem("foundPatternList")):[];b.push(f),localStorage.setItem("foundPatternList",JSON.stringify(b))}}).catch(function(e){G.showError(r.symbol+" ltd data not found!")})),e.next=4,new Promise(function(e){return setTimeout(e,101)});case 4:case"end":return e.stop()}},e)}),o=0;case 6:if(!(o<n.length)){e.next=11;break}return e.delegateYield(r(o),"t0",8);case 8:o++,e.next=6;break;case 11:case"end":return e.stop()}},e)})),a.getStoplossFromOrderbook=function(e){var t=localStorage.getItem("oderbookData");t=JSON.parse(t);for(var a={},n=0;n<t.length;n++){var l=t[n];if("trigger pending"===l.status&&l.symboltoken===e.symboltoken){e.netqty>0?(a.stopLoss=l.triggerprice+"("+(100*(l.triggerprice-e.buyavgprice)/e.buyavgprice).toFixed(2)+"%)",a.maxLossAmount=((l.triggerprice-e.buyavgprice)*parseInt(e.netqty)).toFixed(2)):e.netqty<0&&(console.log(e.tradingsymbol,"sellage",e.sellavgprice,"trigger",l.triggerprice),a.stopLoss=l.triggerprice+"("+(100*(l.triggerprice-e.sellavgprice)/e.sellavgprice).toFixed(2)+"%)",a.maxLossAmount=((l.triggerprice-e.sellavgprice)*parseInt(e.netqty)).toFixed(2));break}}return a},a.getStoplossForSELLFromOrderbook=function(e){var t=localStorage.getItem("oderbookData");t=JSON.parse(t);var a={};return t.forEach(function(t){"trigger pending"===t.status&&t.symboltoken===e.symboltoken&&(a.stopLoss=t.triggerprice+"("+(100*(e.buyavgprice-t.triggerprice)/e.buyavgprice).toFixed(2)+"%)",a.maxLossAmount=((t.triggerprice-e.buyavgprice)*parseInt(e.netqty)).toFixed(2))}),a},a.getHighLowPercentage=Object(ae.a)(ee.a.mark(function e(){var t,n,l,r;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({showHighLowWisePer:!0}),a.state.positionList.length||G.showError("First Refresh Position"),t=ee.a.mark(function e(t){var n;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("DELIVERY"!=(n=a.state.positionList[t]).producttype){e.next=3;break}return e.abrupt("return",{v:""});case 3:return l={exchange:"NSE",tradingsymbol:n.tradingsymbol,symboltoken:n.symboltoken},T.getLTP(l).then(function(e){var n=K(e,"noPop"),l=n&&n.data;l&&l.ltp&&(a.state.positionList[t].high=l.high,a.state.positionList[t].low=l.low)}),e.next=7,new Promise(function(e){return setTimeout(e,125)});case 7:a.setState({positionList:a.state.positionList});case 8:case"end":return e.stop()}},e)}),n=0;case 4:if(!(n<a.state.positionList.length)){e.next=12;break}return e.delegateYield(t(n),"t0",6);case 6:if("object"!==typeof(r=e.t0)){e.next=9;break}return e.abrupt("return",r.v);case 9:n++,e.next=4;break;case 12:case"end":return e.stop()}},e)})),a.tagPatternWhichTaken=function(e){for(var t=localStorage.getItem("orderTagToPosition")&&JSON.parse(localStorage.getItem("orderTagToPosition"))||[],a="",n=0;n<t.length;n++){var l=t[n];if(e==l.token){a=l.pattenName;break}}return a},a.calculateTradeExpence=function(e){var t=0===parseFloat(e.totalbuyvalue)?parseFloat(e.totalsellvalue):parseFloat(e.totalbuyvalue),a=.25*parseFloat(t)/100;(a>20||"CE"==e.optiontype||"PE"==e.optiontype)&&(a=20);var n=0===parseFloat(e.totalsellvalue)?parseFloat(e.totalbuyvalue):parseFloat(e.totalsellvalue),l=.25*parseFloat(n)/100;(l>20||"CE"==e.optiontype||"PE"==e.optiontype)&&(l=20);var r=t+n,o=a+l,i=.025;"CE"!=e.optiontype&&"PE"!=e.optiontype||(i=.05);var s=n*i/100,c=.00335*r/100,m=.003*t/100,g=10*r/1e7,u=18*(o+c+g)/100,d=o+s+c+m+g+u;return{tradeExpence:d,expenceInfo:"Brokerage: "+o.toFixed(2)+" \nSTT: "+s.toFixed(2)+" \nTransaction: "+c.toFixed(2)+" \nStamp Duty: "+m.toFixed(2)+" \nSebi: "+g.toFixed(2)+" \nGST: "+u.toFixed(2)+" \n\nTotal: "+d.toFixed(2)}},a.getPositionData=Object(ae.a)(ee.a.mark(function e(){var t;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:0,t=0,T.getPosition().then(function(e){var n=K(e,"noPop"),l=n&&n.data;if(l&&l.length>0){var r=0,o=0,i=0,s=0,c=0,m=0,g=0,u=0;l.forEach(function(e){if("DELIVERY"==e.producttype)return"";if(r+=parseFloat(e.pnl),o+=parseFloat(e.totalbuyvalue),i+=0===parseFloat(e.totalsellvalue)?parseFloat(e.totalbuyvalue):parseFloat(e.totalsellvalue),s+=parseInt(e.buyqty),c+=parseFloat(e.buyavgprice),m+=parseFloat(e.sellavgprice),0==e.netqty){var n=100*(parseFloat(e.sellavgprice)-parseFloat(e.buyavgprice))/parseFloat(e.buyavgprice);e.percentPnL=n.toFixed(2)+"%",g+=parseFloat(n),localStorage.removeItem("firstTimeModify"+e.tradingsymbol),localStorage.removeItem("lastTriggerprice_"+e.tradingsymbol)}e.pattenName=a.tagPatternWhichTaken(e.symboltoken);var l=a.calculateTradeExpence(e);e.tradeExpence=l.tradeExpence.toFixed(2),e.expenceInfo=l.expenceInfo,u+=l.tradeExpence;var d=a.getStoplossFromOrderbook(e);d&&(e.stopLoss=d.stopLoss,e.stopLossAmount=d.maxLossAmount,t+=parseFloat(d.maxLossAmount)?parseFloat(d.maxLossAmount):0)}),a.setState({todayProfitPnL:r.toFixed(2),totalbuyvalue:o.toFixed(2),totalsellvalue:i.toFixed(2),totalQtyTraded:s}),a.setState({allbuyavgprice:(c/l.length).toFixed(2),allsellavgprice:(m/l.length).toFixed(2),totalPercentage:g});a.setState({totalExpence:u.toFixed(2)}),a.setState({totalTornOver:(o+i).toFixed(2),totalMaxPnL:t.toFixed(2)}),l.sort(function(e,t){return t.netqty-e.netqty}),a.setState({positionList:l})}});case 2:case"end":return e.stop()}},e)})),a.checkAndPlaceSingleOrder=function(e){T.autoCompleteSearch(e).then(function(e){var t=e.data.filter(function(e){return"NSE"===e.exch_seg&&"1"===e.lotsize});console.log("stockfound",t),t&&t.length&&a.orderWithFlatstoploss(t[0].token,t[0].symbol)})},a.orderWithFlatstoploss=function(e,t){var n={exchange:"NSE",tradingsymbol:t,symboltoken:e};T.getLTP(n).then(function(n){var l=K(n,"noPop"),r=(l&&l.data).ltp;if(r){var o=r-r*lt.perTradeStopLossPer/100;o=a.getMinPriceAllowTick(o);var i=lt.totalCapital*lt.perTradeExposurePer/100,s=Math.floor(i/r);console.log(t+"ltp "+r,"quantity",s,"stopLossPrice",o,"perTradeExposureAmt",i);var c={transactiontype:"BUY",tradingsymbol:t,symboltoken:e,buyPrice:0,quantity:s,stopLossPrice:o};s&&o&&a.placeOrderMethod(c)}}).catch(function(e){console.log(t,"not found","error",e)})},a.onChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value));var t=e.target.value;T.autoCompleteSearch(t).then(function(e){var t=e.data;localStorage.setItem("autoSearchTemp",JSON.stringify(t)),a.setState({autoSearchList:t})})},a.getNiftyLTP=function(){T.getLTP({exchange:"NSE",tradingsymbol:"NIFTY",symboltoken:"26000"}).then(function(e){var t=K(e,"noPop"),a=t&&t.data;if(a&&a.ltp){var n=100*(a.ltp-a.close)/a.close;document.getElementById("niftySpid").innerHTML=n>0?"<span style='color:green'> Nifty "+a.ltp+" ("+n.toFixed(2)+"%)</span>":"<span style='color:red'> Nifty "+a.ltp+" ("+n.toFixed(2)+"%)</span>"}})},a.getBankNiftyLTP=function(){T.getLTP({exchange:"NSE",tradingsymbol:"BANKNIFTY",symboltoken:"26009"}).then(function(e){var t=K(e,"noPop"),a=t&&t.data;if(a&&a.ltp){var n=100*(a.ltp-a.close)/a.close;document.getElementById("bankniftySpid").innerHTML=n>0?"<span style='color:green'> Bank Nifty "+a.ltp+" ("+n.toFixed(2)+"%)</span>":"<span style='color:red'> Bank Nifty "+a.ltp+" ("+n.toFixed(2)+"%)</span>"}})},a.getStopLossPrice=function(){var e=Object(ae.a)(ee.a.mark(function e(t,n){var l;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l={exchange:"NSE",tradingsymbol:n,symboltoken:t},e.next=3,T.getLTP(l).then(function(e){var t=K(e,"noPop"),n=t&&t.data;if(n&&n.ltp){var l=parseFloat(n.ltp);l-=.7*l/100;var r=a.getMinPriceAllowTick(l);return a.setState({stoploss:r}),r}});case 3:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.placeOrderMethod=function(e){var t={transactiontype:e.transactiontype,tradingsymbol:e.tradingsymbol,symboltoken:e.symboltoken,quantity:e.quantity,ordertype:0===e.buyPrice?"MARKET":"LIMIT",price:e.buyPrice,producttype:"DELIVERY",duration:"DAY",squareoff:"0",stoploss:"0",exchange:"NSE",variety:"NORMAL"};console.log("place order option",t),T.placeOrder(t).then(function(t){var n=K(t);n.status&&"SUCCESS"===n.message&&(a.setState({orderid:n.data&&n.data.orderid}),e.stopLossPrice&&a.placeSLMOrder(e))})},a.historyWiseOrderPlace=function(e,t,n){var l={exchange:"NSE",tradingsymbol:t,symboltoken:e};T.getLTP(l).then(function(l){var r=K(l,"noPop"),o=r&&r.data;console.log(t," ltd data ",o);var i=0;if(o&&o.ltp){var s=lt.totalCapital*lt.perTradeExposurePer/100;i=Math.floor(s/o.ltp)}if(i=i>0?1:0,console.log(t,"  quantity can be order ",i),i){var c="YYYY-MM-DD HH:mm",m=rt("9:15am","h:mma").format(c);console.log("beginningTime",m);var g=rt.duration("21:10:00"),u=rt(new Date).subtract(g),d={exchange:"NSE",symboltoken:e,interval:"FIVE_MINUTE",fromdate:rt(u).format(c),todate:rt(new Date).format(c)};T.getHistoryData(d).then(function(l){var r=K(l,"noPop");if(r&&r.data&&r.data.length){var s=r.data,c=0,m=0,g=0,u=0;if(s.reverse(),u=s[0][3],g=s[0][2],s&&s.length>0){for(var d=0;d<20;d++)s[d]&&(c+=s[d][4],m+=s[d][3],s[d][2]>g&&(console.log(d,g,s[d][2]),g=s[d][2]),s[d][3]<=u&&(u=s[d][3]));var h=s.length>20?20:s.length,p=c/h,f=m/h,y=f-3*(g-u)/100,b=100*(g-(y=a.getMinPriceAllowTick(y)))/g;console.log(t," LTP ",o.ltp),console.log(t+"highestHigh:",g,"lowestLow",u,"stoploss after tick:",y,"stoploss%",b),console.log(t+"  close avg middle ",p,"lowerest avg",f);var E={transactiontype:"BUY",tradingsymbol:t,symboltoken:e,buyPrice:0,quantity:i,stopLossPrice:y};o&&o.ltp>g&&b<=1.5?a.placeOrderMethod(E):(localStorage.setItem("NseStock_"+n,""),console.log(t+" its not fullfilled"))}}else console.log(t+" candle data emply")})}})},a.cancelOrderOfSame=function(e){var t=a.getOpenPeningOrderId(e.symboltoken),n={variety:t.variety,orderid:t.orderId};T.cancelOrder(n).then(function(e){var t=K(e);t.status&&"SUCCESS"===t.message&&console.log("cancel order",t)})},a.squareOff=function(e){var t={variety:"NORMAL",tradingsymbol:e.tradingsymbol,symboltoken:e.symboltoken,transactiontype:e.netqty>0?"SELL":"BUY",exchange:e.exchange,ordertype:"MARKET",producttype:e.producttype,duration:"DAY",price:0,squareoff:"0",stoploss:"0",quantity:Math.abs(e.netqty)};T.placeOrder(t).then(function(t){var n=K(t);console.log("squireoff",n),n.status&&"SUCCESS"===n.message&&(a.setState({orderid:n.data&&n.data.orderid}),a.cancelOrderOfSame(e),document.getElementById("orderRefresh")&&document.getElementById("orderRefresh").click())})},a.updateOrderList=function(){T.retrieveOrderBook().then(function(e){var t=K(e);if(t&&t.data){var a=t.data;a.sort(function(e,t){return new Date(t.updatetime)-new Date(e.updatetime)}),localStorage.setItem("oderbookData",JSON.stringify(a))}})},a.placeSLMOrder=function(e){var t={triggerprice:e.stopLossPrice,tradingsymbol:e.tradingsymbol,symboltoken:e.symboltoken,quantity:e.quantity,transactiontype:"BUY"===e.transactiontype?"SELL":"BUY",exchange:"NSE",producttype:"DELIVERY",duration:"DAY",price:0,squareoff:"0",stoploss:"0",ordertype:"STOPLOSS_MARKET",variety:"STOPLOSS"};console.log("SLM option data",t),T.placeOrder(t).then(function(t){var n=K(t);if(n.status&&"SUCCESS"===n.message){a.setState({orderid:n.data&&n.data.orderid});var l=new SpeechSynthesisUtterance;l.text="hey Vijay, "+e.tradingsymbol,window.speechSynthesis.speak(l),document.getElementById("orderRefresh")&&document.getElementById("orderRefresh").click()}})},a.getOpenPeningOrderId=function(e){for(var t=localStorage.getItem("oderbookData")&&JSON.parse(localStorage.getItem("oderbookData")),a={},n=0;n<t.length;n++)if(t[n].symboltoken===e&&"STOPLOSS"===t[n].variety){a.orderId=t[n].orderid,a.variety=t[n].variety;break}return a},a.modifyOrderMethod=function(e,t,n){var l=a.getOpenPeningOrderId(e.symboltoken),r={variety:l.variety,orderid:l.orderId,ordertype:"STOPLOSS_MARKET",producttype:e.producttype,duration:"DAY",price:n?parseFloat(n):0,triggerprice:parseFloat(t),quantity:Math.abs(e.netqty),tradingsymbol:e.tradingsymbol,symboltoken:e.symboltoken,exchange:e.exchange};T.modifyOrder(r).then(function(a){var n=K(a,"noPop"),l=new SpeechSynthesisUtterance;n.status&&"SUCCESS"===n.message&&(l.text=e.symbolname+" modified "+n.message,window.speechSynthesis.speak(l),localStorage.setItem("firstTimeModify"+e.tradingsymbol,"No"),localStorage.setItem("lastTriggerprice_"+e.tradingsymbol,parseFloat(t)),document.getElementById("orderRefresh")&&document.getElementById("orderRefresh").click())})},a.getMinPriceAllowTick=function(e){e=e.toFixed(2);var t=parseInt(e.split(".")[0]),a=parseFloat(e.split(".")[1]);return e=parseFloat(t+"."+(a-a%5))},a.get2DecimalNumber=function(e){return(e=parseFloat(e))?e.toFixed(2):e},a.getSLAndTriggerPrice=function(e){var t=a.getMinPriceAllowTick(e),n=t-1*t/100;return{minTriggerPrice:t,minSLPrice:n=a.getMinPriceAllowTick(n)}},a.getOptionPercentage=function(e){console.log("option per calling");var t=0,n=0;if(e.buyavgprice=parseFloat(e.buyavgprice),t=100*(e.ltp-e.buyavgprice)/e.buyavgprice,!localStorage.getItem("firstTimeModify"+e.tradingsymbol)&&t>=5){var l=e.buyavgprice+1*e.buyavgprice/100,r=a.getSLAndTriggerPrice(l);localStorage.getItem("lastTriggerprice_"+e.tradingsymbol)!=r.minTriggerPrice&&a.modifyOrderMethod(e,r.minTriggerPrice,r.minSLPrice)}else{var o=parseFloat(localStorage.getItem("lastTriggerprice_"+e.tradingsymbol)),i=100*(e.ltp-o)/o;if(n=i,i>=5){l=o+1*o/100;var s=a.getSLAndTriggerPrice(l);localStorage.getItem("lastTriggerprice_"+e.tradingsymbol)!=s.minTriggerPrice&&a.modifyOrderMethod(e,s.minTriggerPrice,s.minSLPrice)}}return n?t.toFixed(2)+"% | Trailing "+n.toFixed(2)+"%":t.toFixed(2)+"%"},a.getPercentage=function(e){var t=0,n=0;if(e.netqty>0)if(e.buyavgprice=parseFloat(e.buyavgprice),t=100*(e.ltp-e.buyavgprice)/e.buyavgprice,!localStorage.getItem("firstTimeModify"+e.tradingsymbol)&&t>=.3){var l=e.buyavgprice+.15*e.buyavgprice/100;l=a.getMinPriceAllowTick(l),localStorage.getItem("lastTriggerprice_"+e.tradingsymbol)!=l&&a.modifyOrderMethod(e,l)}else{var r=parseFloat(localStorage.getItem("lastTriggerprice_"+e.tradingsymbol));n=o=100*(e.ltp-r)/r,o>=.3&&(l=r+.1*r/100,l=a.getMinPriceAllowTick(l),localStorage.getItem("lastTriggerprice_"+e.tradingsymbol)!=l&&a.modifyOrderMethod(e,l))}if(e.netqty<0)if(e.sellavgprice=parseFloat(e.sellavgprice),t=100*(e.ltp-e.sellavgprice)/e.sellavgprice,!localStorage.getItem("firstTimeModify"+e.tradingsymbol)&&t<=-.3){l=e.sellavgprice-.15*e.sellavgprice/100;l=a.getMinPriceAllowTick(l),localStorage.getItem("lastTriggerprice_"+e.tradingsymbol)!=l&&a.modifyOrderMethod(e,l,.25*e.sellavgprice/100)}else{var o;r=parseFloat(localStorage.getItem("lastTriggerprice_"+e.tradingsymbol));n=o=100*(e.ltp-r)/r,console.log("perchngfromTriggerPrice",o),o<=-.5&&(l=r-.15*r/100,l=a.getMinPriceAllowTick(l),localStorage.getItem("lastTriggerprice_"+e.tradingsymbol)!=l&&a.modifyOrderMethod(e,l))}return n?t.toFixed(2)+"% | Trailing "+n.toFixed(2)+"%":t.toFixed(2)+"%"},a.state={positionList:[],autoSearchList:[],InstrumentLTP:{},autoSearchTemp:[],foundPatternList:[],symboltoken:"",tradingsymbol:"",buyPrice:0,quantity:1,producttype:"DELIVERY",nr4TotalPer:0,pnlAmountTotal:0,totalNetProfit:0,totelActivatedCount:0,totalBrokerChargesNR4:0,stockTesting:"",perHighLowTotal:0,netPnLAmountOnHighlowTotal:0,staticData:localStorage.getItem("staticData")&&JSON.parse(localStorage.getItem("staticData"))||{}},a}return Object(w.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=rt("9:15am","h:mma"),a=rt("3:30pm","h:mma"),n=rt(new Date,"h:mma"),l=rt().isoWeekday();if(l<=5&&n.isBetween(t,a)){this.setState({positionInterval:setInterval(function(){e.getPositionData()},1e3)}),this.setState({bankNiftyInterval:setInterval(function(){e.getNiftyLTP(),e.getBankNiftyLTP()},3e4)});var r=setInterval(function(){console.log("squireoff",(new Date).toLocaleString());var t=rt("3:14pm","h:mma"),a=rt("3:15pm","h:mma");rt(new Date,"h:mma").isBetween(t,a)&&e.state.positionList.forEach(function(t,a){(t.netqty>0||t.netqty<0)&&e.squareOff(t),e.state.positionList.length==a+1&&(clearInterval(r),console.log("squireInterval ended"))})},5e3)}else clearInterval(this.state.positionInterval),clearInterval(this.state.scaninterval),clearInterval(this.state.bankNiftyInterval);var o=rt("3:30pm","h:mma");if(l<=5&&n.isBetween(t,o)){var i=localStorage.getItem("FoundPatternList")?JSON.parse(localStorage.getItem("FoundPatternList")):[];setInterval(function(){e.refreshLtpOnFoundPattern()},100*i.length+3e5)}var s=localStorage.getItem("FoundPatternList")?JSON.parse(localStorage.getItem("FoundPatternList")):[];this.setState({foundPatternList:s})}},{key:"componentWillUnmount",value:function(){}},{key:"getNSETopStock",value:function(){var e=this,t=((new Date).toLocaleTimeString()>"15:00:00"&&clearInterval(this.state.scaninterval),lt.totalCapital*lt.dailyLossPer/100);t=-Math.abs(t),this.state.todayProfitPnL<t?(console.log("daily loss crossed",t),clearInterval(this.state.scaninterval)):T.getNSETopStock().then(function(t){var a=K(t,"noPop");if(a.status&&"SUCCESS"===a.message)for(var n=a.result,l=function(t){o=!1;for(var a=0;a<e.state.positionList.length;a++)e.state.positionList[a].symbolname===n[t].symbolName&&(o=!0);o||localStorage.getItem("NseStock_"+n[t].symbolName)||T.autoCompleteSearch(n[t].symbolName).then(function(a){var l=a.data.filter(function(e){return"NSE"===e.exch_seg&&"1"===e.lotsize&&e.name===n[t].symbolName});l.length&&(console.log(l[0].symbol,"found",l),localStorage.setItem("NseStock_"+n[t].symbolName,"orderdone"),e.historyWiseOrderPlace(l[0].token,l[0].symbol,n[t].symbolName))})},r=0;r<n.length;r++){var o;l(r)}})}},{key:"getMySelectedStock",value:function(){var e=this,t=((new Date).toLocaleTimeString()>"15:00:00"&&clearInterval(this.state.selectedStockInteval),lt.totalCapital*lt.dailyLossPer/100);t=-Math.abs(t),this.state.todayProfitPnL<t?(console.log("daily loss crossed",t),clearInterval(this.state.scaninterval)):T.getSelectedStockFromDb().then(function(t){var a=K(t,"noPop");if(a.status&&"SUCCESS"===a.message)for(var n=a.result,l=function(t){o=!1;for(var a=0;a<e.state.positionList.length;a++)e.state.positionList[a].symbolname===n[t].symbol&&(o=!0);o||localStorage.getItem("NseStock_"+n[t].symbolName)||T.autoCompleteSearch(n[t].symbolName).then(function(e){var a=e.data.filter(function(e){return"NSE"===e.exch_seg&&"1"===e.lotsize&&e.name===n[t].symbolName});if(a.length){var l=localStorage.getItem("selectedStockwatchList")?JSON.parse(localStorage.getItem("selectedStockwatchList")):[];l.push(a[0]),localStorage.setItem("selectedStockwatchList",JSON.stringify(l))}})},r=0;r<n.length;r++){var o;l(r)}})}},{key:"getStockOnebyOne",value:function(){var e=this,t=lt.totalCapital*lt.dailyLossPer/100;t=-Math.abs(t),this.state.todayProfitPnL<t?(console.log("daily loss crossed",t),clearInterval(this.state.scaninterval)):(console.log("still ok"),T.getAutoScanStock().then(function(t){var a=K(t,"noPop");if(a.status&&"SUCCESS"===a.message){var n=a.result;if(n&&n.length>0){var l=n[n.length-1].symbolName;localStorage.setItem("scannedStocks",JSON.stringify(n));for(var r=!1,o=0;o<e.state.positionList.length;o++)e.state.positionList[o].symbolname===l&&(r=!0);if(!r&&!localStorage.getItem("scannedstock_"+l)){console.log("found new",l);var i=new SpeechSynthesisUtterance;i.text="hey Vijay, "+l,window.speechSynthesis.speak(i),localStorage.setItem("scannedstock_"+l,"orderdone"),e.checkAndPlaceSingleOrder(l)}}}}))}},{key:"render",value:function(){var e=this;return l.a.createElement(l.a.Fragment,null,l.a.createElement(ht,null),l.a.createElement("br",null),l.a.createElement(tt,null)," ",l.a.createElement(ka,null),l.a.createElement(M.a,{style:{padding:"5px"},justify:"space-between",direction:"row",container:!0},l.a.createElement(M.a,{item:!0},l.a.createElement(W.a,{component:"h3",variant:"h6",color:"primary",gutterBottom:!0},"Positions (",this.state.positionList&&this.state.positionList.length,")")),l.a.createElement(M.a,{item:!0,xs:12,sm:3},l.a.createElement(W.a,{component:"h3"},l.a.createElement("b",null,"Date:: ",(new Date).toLocaleString()," "))),l.a.createElement(M.a,{item:!0},l.a.createElement(W.a,{component:"h3"},l.a.createElement("b",null,"Net Capital  ",this.get2DecimalNumber(localStorage.getItem("netCapital")),"  "))),l.a.createElement(M.a,{item:!0},l.a.createElement(W.a,{component:"h3"},l.a.createElement("b",null," Net Cap P/L ")," ",l.a.createElement("b",{style:{color:100*(this.state.todayProfitPnL-this.state.totalExpence)/localStorage.getItem("netCapital")>0?"green":"red"}},(100*(this.state.todayProfitPnL-this.state.totalExpence)/localStorage.getItem("netCapital")).toFixed(2),"% "))),l.a.createElement(M.a,{item:!0},l.a.createElement(W.a,{component:"h3"},l.a.createElement("b",null,"Turnover ",this.state.totalTornOver," "))),l.a.createElement(M.a,{item:!0},l.a.createElement(W.a,{component:"h3"},l.a.createElement("b",{style:{color:"red"}},"Expenses: ",this.state.totalExpence," "))),l.a.createElement(M.a,{item:!0},l.a.createElement(W.a,{component:"h3"},l.a.createElement("b",null,"  P/L ")," ",l.a.createElement("b",{style:{color:this.state.todayProfitPnL>0?"green":"red"}},this.state.todayProfitPnL," "))),l.a.createElement(M.a,{item:!0},l.a.createElement(W.a,Object.assign({component:"h3"},window.document.title="PnL:"+(this.state.todayProfitPnL-this.state.totalExpence).toFixed(2)),l.a.createElement("b",null," Net P/L ")," ",l.a.createElement("b",{style:{color:this.state.todayProfitPnL-this.state.totalExpence>0?"green":"red"}},this.state.totalExpence?(this.state.todayProfitPnL-this.state.totalExpence).toFixed(2):""," "))),l.a.createElement(M.a,{item:!0},l.a.createElement(B.a,{type:"number",variant:"contained",style:{float:"right"},onClick:function(){return e.getPositionData()}},"Refresh")),l.a.createElement(M.a,{item:!0},l.a.createElement(B.a,{type:"number",variant:"contained",style:{float:"right"},onClick:function(){return e.getHighLowPercentage()}},l.a.createElement(Ca.a,null)," H/L"))),l.a.createElement(M.a,{style:{padding:"5px"},spacing:1,direction:"row",alignItems:"center",container:!0},l.a.createElement(M.a,{item:!0,xs:12,sm:12},l.a.createElement(Et.a,{style:{overflow:"auto",padding:"5px"}},l.a.createElement(Je.a,{size:"small","aria-label":"sticky table"},l.a.createElement(St.a,{style:{whiteSpace:"nowrap",backgroundColor:""},variant:"head"},l.a.createElement(_e.a,{key:"1",variant:"head",style:{fontWeight:"bold"}},l.a.createElement(qe.a,{style:{paddingLeft:"3px"},className:"TableHeadFormat",align:"left"},"\xa0Symbol"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"Pattern Name"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"Avg Buy"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"Avg Sell "),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"Qty Taken"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"Net Qty"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"Expense"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"Trailing SL"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"Max P/L"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"P/L "),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"Chng % "),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"LTP"),this.state.showHighLowWisePer?l.a.createElement(l.a.Fragment,null,l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"High"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"Low")):"",l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"Action"))),l.a.createElement(ze.a,{style:{width:"",whiteSpace:"nowrap"}},this.state.positionList?this.state.positionList.map(function(t){return"DELIVERY1"!==t.producttype?l.a.createElement(_e.a,{hover:!0,key:t.symboltoken,style:{background:"0"!==t.netqty?"lightgray":""}},l.a.createElement(qe.a,{align:"left"},l.a.createElement(B.a,{style:{color:100*(t.ltp-t.close)/t.close>0?"green":"red"},size:"small",variant:"contained",title:"Candle refresh",onClick:function(){return e.refreshCandleChartManually(t)}},t.tradingsymbol," ",t.ltp," (",(100*(t.ltp-t.close)/t.close).toFixed(2),"%) ",l.a.createElement(xe.a,null))),l.a.createElement(qe.a,{align:"left"},t.pattenName),l.a.createElement(qe.a,{align:"left"},t.totalbuyavgprice),l.a.createElement(qe.a,{align:"left"},t.totalsellavgprice),l.a.createElement(qe.a,{align:"left"},t.buyqty||t.sellqty),l.a.createElement(qe.a,{align:"left"},t.netqty),l.a.createElement(qe.a,{style:{cursor:"help"},title:t.expenceInfo,align:"left"},t.tradeExpence),l.a.createElement(qe.a,{align:"left"}," ",t.stopLoss),l.a.createElement(qe.a,{align:"left"}," ",t.stopLossAmount),l.a.createElement(qe.a,{align:"left",style:{color:parseFloat(t.pnl)>0?"green":"red"}},l.a.createElement("b",null,t.pnl)),l.a.createElement(qe.a,{align:"left"},"0"!==t.netqty&&""==t.optiontype?e.getPercentage(t):"",("CE"==t.optiontype||"PE"==t.optiontype)&&t.netqty>0?e.getOptionPercentage(t):"",t.percentPnL),l.a.createElement(qe.a,{align:"left"},t.ltp),e.state.showHighLowWisePer?l.a.createElement(l.a.Fragment,null,l.a.createElement(qe.a,{align:"left"},t.high),l.a.createElement(qe.a,{align:"left"},t.low)):"",l.a.createElement(qe.a,{align:"left"},"0"!==t.netqty?l.a.createElement(B.a,{size:"small",type:"number",variant:"contained",color:"Secondary",onClick:function(){return e.squareOff(t)}},"Square Off"):"")):""}):"",l.a.createElement(_e.a,{variant:"head",style:{fontWeight:"bold",backgroundColor:""}},l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"\xa0Total"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"}),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},this.state.allbuyavgprice),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},this.state.allsellavgprice),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},this.state.totalQtyTraded),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"}),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"}),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"}),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},this.state.totalMaxPnL),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left",style:{color:parseFloat(this.state.todayProfitPnL)>0?"green":"red"}},this.state.todayProfitPnL," "),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},this.state.totalPercentage&&this.state.totalPercentage.toFixed(2)+"%"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"}),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"}),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"}),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"})))))),l.a.createElement(M.a,{item:!0,xs:12,sm:12,style:{height:"250px",overflow:"auto"}},l.a.createElement(ua,null)),l.a.createElement(M.a,{item:!0,xs:12,sm:12,style:{height:"100%",overflow:"auto"}},"no"==localStorage.getItem("isOpenInNewPage")?l.a.createElement(ba,null):""),this.state.foundPatternList&&this.state.foundPatternList.length?l.a.createElement(M.a,{item:!0,xs:12,sm:12},l.a.createElement(Et.a,{style:{overflow:"auto",padding:"5px"}},l.a.createElement(M.a,{justify:"space-between",container:!0},l.a.createElement(M.a,{item:!0},l.a.createElement(W.a,{component:"h2",variant:"h6",color:"primary",gutterBottom:!0},"Patterns Founds (",this.state.foundPatternList&&this.state.foundPatternList.length,")",l.a.createElement("span",{id:"stockTesting",style:{fontSize:"18px",color:"gray"}}," ",this.state.stockTesting," "))),l.a.createElement(M.a,{item:!0},l.a.createElement(B.a,{variant:"contained",style:{marginLeft:"20px"},onClick:function(){return e.refreshLtpOnFoundPattern()}},"Live Refresh"))),l.a.createElement(Je.a,{size:"small","aria-label":"sticky table"},l.a.createElement(St.a,{style:{whiteSpace:"nowrap"},variant:"head"},l.a.createElement(_e.a,{key:"1",variant:"head",style:{fontWeight:"bold"}},l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"Symbol | Activated(",this.state.totelActivatedCount,")"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"Performance 6M"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"OnLtp (",this.state.nr4TotalPer.toFixed(2),")%  "),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"Qty"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"PnL(",this.state.pnlAmountTotal.toFixed(2),")"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"Fee(",this.state.totalBrokerChargesNR4.toFixed(2),")"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"NetPnL(",this.state.totalNetProfit.toFixed(2),")"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"OnH/L(",this.state.perHighLowTotal.toFixed(2),"% | ",this.state.netPnLAmountOnHighlowTotal.toFixed(2),")  "),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"Patten"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"FoundAt"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"BuyAt"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"SellAt"),l.a.createElement(qe.a,{className:"TableHeadFormat",align:"left"},"UpdatedAt"))),l.a.createElement(ze.a,{style:{width:"",whiteSpace:"nowrap"}},this.state.foundPatternList?this.state.foundPatternList.map(function(t){return l.a.createElement(_e.a,{hover:!0,key:t.symboltoken},l.a.createElement(qe.a,{align:"left"}," ",l.a.createElement(B.a,{variant:"contained",style:{color:t.todayChange?t.todayChange>0?"green":"red":""},onClick:function(){return e.showCandleChart(t.candleChartData,t.symbol)}},t.symbol," ",t.symbolUpdated," ",l.a.createElement(nt.a,null)," ")),l.a.createElement(qe.a,{title:t.symbol+" : Open all chart",align:"left",style:{fontSize:"9px",cursor:"pointer"},onClick:function(){return e.showMultipleCandleChart(t)}},t.pastPerferm?l.a.createElement(l.a.Fragment,null,l.a.createElement("span",{style:{background:t.pastPerferm.totalLongPer/t.pastPerferm.totalLongs>=1?"#92f192":""}},t.pastPerferm.totalLongs,"L(",t.pastPerferm.totalLongPer,"%) | Avg:",(t.pastPerferm.totalLongPer/t.pastPerferm.totalLongs).toFixed(2),"%")," ",l.a.createElement("br",null),l.a.createElement("span",null,t.pastPerferm.totalLongs,"LH(",t.pastPerferm.totalLongHighPer,"%) | Avg: ",(t.pastPerferm.totalLongHighPer/t.pastPerferm.totalLongs).toFixed(2),"%")," ",l.a.createElement("br",null),l.a.createElement("span",{style:{background:t.pastPerferm.totalShortPer/t.pastPerferm.totalShort>=1?"#e87b7b":""}},t.pastPerferm.totalShort,"S:",t.pastPerferm.totalShortPer,"% | Avg:",(t.pastPerferm.totalShortPer/t.pastPerferm.totalShort).toFixed(2),"%")," ",l.a.createElement("br",null),l.a.createElement("span",null,t.pastPerferm.totalShort,"SL:",t.pastPerferm.totalShortLowPer,"% | Avg:",(t.pastPerferm.totalShortLowPer/t.pastPerferm.totalShort).toFixed(2),"%")," ",l.a.createElement("br",null)):""),l.a.createElement(qe.a,{align:"left"},l.a.createElement("b",null,t.orderActivated," ")),l.a.createElement(qe.a,{align:"left"},t.quantity),l.a.createElement(qe.a,{align:"left"},t.pnlAmount),l.a.createElement(qe.a,{align:"left"},t.brokerageCharges),l.a.createElement(qe.a,{align:"left"},l.a.createElement("b",null,t.netPnLAmount," ")),l.a.createElement(qe.a,{align:"left"},l.a.createElement("b",null,t.OnHighLowActivated," ")),l.a.createElement(qe.a,{align:"left"},t.pattenName),l.a.createElement(qe.a,{align:"left"},t.foundAt&&t.foundAt.substr(0,15)),l.a.createElement(qe.a,{align:"left"},t.BuyAt),l.a.createElement(qe.a,{align:"left"},t.SellAt),l.a.createElement(qe.a,{align:"left"},t.time))}):"")))):""))}}]),t}(l.a.Component),xa=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(S.a)(this,Object(v.a)(t).call(this,e))).state={cursor:0,areaData:[{time:"2018-10-19",value:54.9},{time:"2018-10-22",value:54.98},{time:"2018-10-23",value:57.21},{time:"2018-10-24",value:57.42},{time:"2018-10-25",value:56.43},{time:"2018-10-26",value:55.51},{time:"2018-10-29",value:56.48},{time:"2018-10-30",value:58.18},{time:"2018-10-31",value:57.09},{time:"2018-11-01",value:56.05},{time:"2018-11-02",value:56.63},{time:"2018-11-05",value:57.21},{time:"2018-11-06",value:57.21},{time:"2018-11-07",value:57.65},{time:"2018-11-08",value:58.27},{time:"2018-11-09",value:58.46},{time:"2018-11-12",value:58.72},{time:"2018-11-13",value:58.66},{time:"2018-11-14",value:58.94},{time:"2018-11-15",value:59.08},{time:"2018-11-16",value:60.21},{time:"2018-11-19",value:60.62},{time:"2018-11-20",value:59.46},{time:"2018-11-21",value:59.16},{time:"2018-11-23",value:58.64},{time:"2018-11-26",value:59.17},{time:"2018-11-27",value:60.65},{time:"2018-11-28",value:60.06},{time:"2018-11-29",value:59.45},{time:"2018-11-30",value:60.3},{time:"2018-12-03",value:58.16},{time:"2018-12-04",value:58.09},{time:"2018-12-06",value:58.08},{time:"2018-12-07",value:57.68},{time:"2018-12-10",value:58.27},{time:"2018-12-11",value:58.85},{time:"2018-12-12",value:57.25},{time:"2018-12-13",value:57.09},{time:"2018-12-14",value:57.08},{time:"2018-12-17",value:55.95},{time:"2018-12-18",value:55.65},{time:"2018-12-19",value:55.86},{time:"2018-12-20",value:55.07},{time:"2018-12-21",value:54.92},{time:"2018-12-24",value:53.05},{time:"2018-12-26",value:54.44},{time:"2018-12-27",value:55.15},{time:"2018-12-28",value:55.27},{time:"2018-12-31",value:56.22},{time:"2019-01-02",value:56.02},{time:"2019-01-03",value:56.22},{time:"2019-01-04",value:56.36},{time:"2019-01-07",value:56.72},{time:"2019-01-08",value:58.38},{time:"2019-01-09",value:57.05},{time:"2019-01-10",value:57.6},{time:"2019-01-11",value:58.02},{time:"2019-01-14",value:58.03},{time:"2019-01-15",value:58.1},{time:"2019-01-16",value:57.08},{time:"2019-01-17",value:56.83},{time:"2019-01-18",value:57.09},{time:"2019-01-22",value:56.99},{time:"2019-01-23",value:57.76},{time:"2019-01-24",value:57.07},{time:"2019-01-25",value:56.4},{time:"2019-01-28",value:55.07},{time:"2019-01-29",value:53.28},{time:"2019-01-30",value:54},{time:"2019-01-31",value:55.06},{time:"2019-02-01",value:54.55},{time:"2019-02-04",value:54.04},{time:"2019-02-05",value:54.14},{time:"2019-02-06",value:53.79},{time:"2019-02-07",value:53.57},{time:"2019-02-08",value:53.95},{time:"2019-02-11",value:54.05},{time:"2019-02-12",value:54.42},{time:"2019-02-13",value:54.48},{time:"2019-02-14",value:54.03},{time:"2019-02-15",value:55.16},{time:"2019-02-19",value:55.44},{time:"2019-02-20",value:55.76},{time:"2019-02-21",value:56.15},{time:"2019-02-22",value:56.92},{time:"2019-02-25",value:56.78},{time:"2019-02-26",value:56.64},{time:"2019-02-27",value:56.72},{time:"2019-02-28",value:56.92},{time:"2019-03-01",value:56.96},{time:"2019-03-04",value:56.24},{time:"2019-03-05",value:56.08},{time:"2019-03-06",value:55.68},{time:"2019-03-07",value:56.3},{time:"2019-03-08",value:56.53},{time:"2019-03-11",value:57.58},{time:"2019-03-12",value:57.43},{time:"2019-03-13",value:57.66},{time:"2019-03-14",value:57.95},{time:"2019-03-15",value:58.39},{time:"2019-03-18",value:58.07},{time:"2019-03-19",value:57.5},{time:"2019-03-20",value:57.67},{time:"2019-03-21",value:58.29},{time:"2019-03-22",value:59.76},{time:"2019-03-25",value:60.08},{time:"2019-03-26",value:60.63},{time:"2019-03-27",value:60.88},{time:"2019-03-28",value:59.08},{time:"2019-03-29",value:59.13},{time:"2019-04-01",value:59.09},{time:"2019-04-02",value:58.53},{time:"2019-04-03",value:58.87},{time:"2019-04-04",value:58.99},{time:"2019-04-05",value:59.09},{time:"2019-04-08",value:59.13},{time:"2019-04-09",value:58.4},{time:"2019-04-10",value:58.61},{time:"2019-04-11",value:58.56},{time:"2019-04-12",value:58.74},{time:"2019-04-15",value:58.71},{time:"2019-04-16",value:58.79},{time:"2019-04-17",value:57.78},{time:"2019-04-18",value:58.04},{time:"2019-04-22",value:58.37},{time:"2019-04-23",value:57.15},{time:"2019-04-24",value:57.08},{time:"2019-04-25",value:55.85},{time:"2019-04-26",value:56.58},{time:"2019-04-29",value:56.84},{time:"2019-04-30",value:57.19},{time:"2019-05-01",value:56.52},{time:"2019-05-02",value:56.99},{time:"2019-05-03",value:57.24},{time:"2019-05-06",value:56.91},{time:"2019-05-07",value:56.63},{time:"2019-05-08",value:56.38},{time:"2019-05-09",value:56.48},{time:"2019-05-10",value:56.91},{time:"2019-05-13",value:56.75},{time:"2019-05-14",value:56.55},{time:"2019-05-15",value:56.81},{time:"2019-05-16",value:57.38},{time:"2019-05-17",value:58.09},{time:"2019-05-20",value:59.01},{time:"2019-05-21",value:59.5},{time:"2019-05-22",value:59.25},{time:"2019-05-23",value:58.87},{time:"2019-05-24",value:59.32},{time:"2019-05-28",value:59.57}],volumeData:[{time:"2018-10-19",value:19103293,color:"rgba(0, 150, 136, 0.8)"},{time:"2018-10-22",value:21737523,color:"rgba(0, 150, 136, 0.8)"},{time:"2018-10-23",value:29328713,color:"rgba(0, 150, 136, 0.8)"},{time:"2018-10-24",value:37435638,color:"rgba(0, 150, 136, 0.8)"},{time:"2018-10-25",value:25269995,color:"rgba(255,82,82, 0.8)"},{time:"2018-10-26",value:24973311,color:"rgba(255,82,82, 0.8)"},{time:"2018-10-29",value:22103692,color:"rgba(0, 150, 136, 0.8)"},{time:"2018-10-30",value:25231199,color:"rgba(0, 150, 136, 0.8)"},{time:"2018-10-31",value:24214427,color:"rgba(255,82,82, 0.8)"},{time:"2018-11-01",value:22533201,color:"rgba(255,82,82, 0.8)"},{time:"2018-11-02",value:14734412,color:"rgba(0, 150, 136, 0.8)"},{time:"2018-11-05",value:12733842,color:"rgba(0, 150, 136, 0.8)"},{time:"2018-11-06",value:12371207,color:"rgba(0, 150, 136, 0.8)"},{time:"2018-11-07",value:14891287,color:"rgba(0, 150, 136, 0.8)"},{time:"2018-11-08",value:12482392,color:"rgba(0, 150, 136, 0.8)"},{time:"2018-11-09",value:17365762,color:"rgba(0, 150, 136, 0.8)"},{time:"2018-11-12",value:13236769,color:"rgba(0, 150, 136, 0.8)"},{time:"2018-11-13",value:13047907,color:"rgba(255,82,82, 0.8)"},{time:"2018-11-14",value:18288710,color:"rgba(0, 150, 136, 0.8)"},{time:"2018-11-15",value:17147123,color:"rgba(0, 150, 136, 0.8)"},{time:"2018-11-16",value:19470986,color:"rgba(0, 150, 136, 0.8)"},{time:"2018-11-19",value:18405731,color:"rgba(0, 150, 136, 0.8)"},{time:"2018-11-20",value:22028957,color:"rgba(255,82,82, 0.8)"},{time:"2018-11-21",value:18482233,color:"rgba(255,82,82, 0.8)"},{time:"2018-11-23",value:7009050,color:"rgba(255,82,82, 0.8)"},{time:"2018-11-26",value:12308876,color:"rgba(0, 150, 136, 0.8)"},{time:"2018-11-27",value:14118867,color:"rgba(0, 150, 136, 0.8)"},{time:"2018-11-28",value:18662989,color:"rgba(255,82,82, 0.8)"},{time:"2018-11-29",value:14763658,color:"rgba(255,82,82, 0.8)"},{time:"2018-11-30",value:31142818,color:"rgba(0, 150, 136, 0.8)"},{time:"2018-12-03",value:27795428,color:"rgba(255,82,82, 0.8)"},{time:"2018-12-04",value:21727411,color:"rgba(255,82,82, 0.8)"},{time:"2018-12-06",value:26880429,color:"rgba(255,82,82, 0.8)"},{time:"2018-12-07",value:16948126,color:"rgba(255,82,82, 0.8)"},{time:"2018-12-10",value:16603356,color:"rgba(0, 150, 136, 0.8)"},{time:"2018-12-11",value:14991438,color:"rgba(0, 150, 136, 0.8)"},{time:"2018-12-12",value:18892182,color:"rgba(255,82,82, 0.8)"},{time:"2018-12-13",value:15454706,color:"rgba(255,82,82, 0.8)"},{time:"2018-12-14",value:13960870,color:"rgba(255,82,82, 0.8)"},{time:"2018-12-17",value:18902523,color:"rgba(255,82,82, 0.8)"},{time:"2018-12-18",value:18895777,color:"rgba(255,82,82, 0.8)"},{time:"2018-12-19",value:20968473,color:"rgba(0, 150, 136, 0.8)"},{time:"2018-12-20",value:26897008,color:"rgba(255,82,82, 0.8)"},{time:"2018-12-21",value:55413082,color:"rgba(255,82,82, 0.8)"},{time:"2018-12-24",value:15077207,color:"rgba(255,82,82, 0.8)"},{time:"2018-12-26",value:17970539,color:"rgba(0, 150, 136, 0.8)"},{time:"2018-12-27",value:17530977,color:"rgba(0, 150, 136, 0.8)"},{time:"2018-12-28",value:14771641,color:"rgba(0, 150, 136, 0.8)"},{time:"2018-12-31",value:15331758,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-01-02",value:13969691,color:"rgba(255,82,82, 0.8)"},{time:"2019-01-03",value:19245411,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-01-04",value:17035848,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-01-07",value:16348982,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-01-08",value:21425008,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-01-09",value:18136e3,color:"rgba(255,82,82, 0.8)"},{time:"2019-01-10",value:14259910,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-01-11",value:15801548,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-01-14",value:11342293,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-01-15",value:10074386,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-01-16",value:13411691,color:"rgba(255,82,82, 0.8)"},{time:"2019-01-17",value:15223854,color:"rgba(255,82,82, 0.8)"},{time:"2019-01-18",value:16802516,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-01-22",value:18284771,color:"rgba(255,82,82, 0.8)"},{time:"2019-01-23",value:15109007,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-01-24",value:12494109,color:"rgba(255,82,82, 0.8)"},{time:"2019-01-25",value:17806822,color:"rgba(255,82,82, 0.8)"},{time:"2019-01-28",value:25955718,color:"rgba(255,82,82, 0.8)"},{time:"2019-01-29",value:33789235,color:"rgba(255,82,82, 0.8)"},{time:"2019-01-30",value:27260036,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-01-31",value:28585447,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-02-01",value:13778392,color:"rgba(255,82,82, 0.8)"},{time:"2019-02-04",value:15818901,color:"rgba(255,82,82, 0.8)"},{time:"2019-02-05",value:14124794,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-02-06",value:11391442,color:"rgba(255,82,82, 0.8)"},{time:"2019-02-07",value:12436168,color:"rgba(255,82,82, 0.8)"},{time:"2019-02-08",value:12011657,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-02-11",value:9802798,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-02-12",value:11227550,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-02-13",value:11884803,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-02-14",value:11190094,color:"rgba(255,82,82, 0.8)"},{time:"2019-02-15",value:15719416,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-02-19",value:12272877,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-02-20",value:11379006,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-02-21",value:14680547,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-02-22",value:12534431,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-02-25",value:15051182,color:"rgba(255,82,82, 0.8)"},{time:"2019-02-26",value:12005571,color:"rgba(255,82,82, 0.8)"},{time:"2019-02-27",value:8962776,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-02-28",value:15742971,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-03-01",value:10942737,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-03-04",value:13674737,color:"rgba(255,82,82, 0.8)"},{time:"2019-03-05",value:15749545,color:"rgba(255,82,82, 0.8)"},{time:"2019-03-06",value:13935530,color:"rgba(255,82,82, 0.8)"},{time:"2019-03-07",value:12644171,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-03-08",value:10646710,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-03-11",value:13627431,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-03-12",value:12812980,color:"rgba(255,82,82, 0.8)"},{time:"2019-03-13",value:14168350,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-03-14",value:12148349,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-03-15",value:23715337,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-03-18",value:12168133,color:"rgba(255,82,82, 0.8)"},{time:"2019-03-19",value:13462686,color:"rgba(255,82,82, 0.8)"},{time:"2019-03-20",value:11903104,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-03-21",value:10920129,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-03-22",value:25125385,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-03-25",value:15463411,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-03-26",value:12316901,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-03-27",value:13290298,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-03-28",value:20547060,color:"rgba(255,82,82, 0.8)"},{time:"2019-03-29",value:17283871,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-04-01",value:16331140,color:"rgba(255,82,82, 0.8)"},{time:"2019-04-02",value:11408146,color:"rgba(255,82,82, 0.8)"},{time:"2019-04-03",value:15491724,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-04-04",value:8776028,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-04-05",value:11497780,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-04-08",value:11680538,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-04-09",value:10414416,color:"rgba(255,82,82, 0.8)"},{time:"2019-04-10",value:8782061,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-04-11",value:9219930,color:"rgba(255,82,82, 0.8)"},{time:"2019-04-12",value:10847504,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-04-15",value:7741472,color:"rgba(255,82,82, 0.8)"},{time:"2019-04-16",value:10239261,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-04-17",value:15498037,color:"rgba(255,82,82, 0.8)"},{time:"2019-04-18",value:13189013,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-04-22",value:11950365,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-04-23",value:23488682,color:"rgba(255,82,82, 0.8)"},{time:"2019-04-24",value:13227084,color:"rgba(255,82,82, 0.8)"},{time:"2019-04-25",value:17425466,color:"rgba(255,82,82, 0.8)"},{time:"2019-04-26",value:16329727,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-04-29",value:13984965,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-04-30",value:15469002,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-05-01",value:11627436,color:"rgba(255,82,82, 0.8)"},{time:"2019-05-02",value:14435436,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-05-03",value:9388228,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-05-06",value:10066145,color:"rgba(255,82,82, 0.8)"},{time:"2019-05-07",value:12963827,color:"rgba(255,82,82, 0.8)"},{time:"2019-05-08",value:12086743,color:"rgba(255,82,82, 0.8)"},{time:"2019-05-09",value:14835326,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-05-10",value:10707335,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-05-13",value:13759350,color:"rgba(255,82,82, 0.8)"},{time:"2019-05-14",value:12776175,color:"rgba(255,82,82, 0.8)"},{time:"2019-05-15",value:10806379,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-05-16",value:11695064,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-05-17",value:14436662,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-05-20",value:20910590,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-05-21",value:14016315,color:"rgba(0, 150, 136, 0.8)"},{time:"2019-05-22",value:11487448,color:"rgba(255,82,82, 0.8)"},{time:"2019-05-23",value:11707083,color:"rgba(255,82,82, 0.8)"},{time:"2019-05-24",value:8755506,color:"rgba(0, 150, 136, 0.8)"}]},a}return Object(w.a)(t,e),Object(E.a)(t,[{key:"render",value:function(){this.state.cursor;return l.a.createElement(J.a,null,l.a.createElement(Pt,{ChartData:{areaSeries:this.state.areaData,volumeData:this.state.volumeData}}))}}]),t}(l.a.Component),Ia=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(S.a)(this,Object(v.a)(t).call(this,e))).onChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.readCsv=Object(ae.a)(ee.a.mark(function e(){var t,n,l,r,o,i;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=a.state.addtowatchlist,n=JSON.parse(t),console.log(n.length),l=[],r=ee.a.mark(function e(t){var r;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n[t],console.log(r),T.autoCompleteSearch(r.SYMBOL).then(function(e){var n=e.data.filter(function(e){return"NSE"===e.exch_seg&&"1"===e.lotsize&&e.name===r.SYMBOL});if(n.length){l.push(n[0]);var o=localStorage.getItem("watchList")?JSON.parse(localStorage.getItem("watchList")):[];o.filter(function(e){return e&&e.token===n[0]&&n[0].token}).length?(a.setState({watchlistCount:o.length}),a.setState({resMessage:[].concat(Object(te.a)(a.state.resMessage),[t+". Already in List:  "+r.SYMBOL])})):(a.setState({resMessage:[].concat(Object(te.a)(a.state.resMessage),[t+". ======================> New Symbol:  "+r.SYMBOL])}),a.setState({watchlistCount:o.length,counter:a.state.counter+1}),o.push(n[0]),localStorage.setItem("watchList",JSON.stringify(o)),console.log("fdaata"))}a.state.resMessage&&a.state.resMessage.length&&a.setState({resMessage:Object(te.a)(a.state.resMessage.reverse())})}),e.next=5,new Promise(function(e){return setTimeout(e,500)});case 5:case"end":return e.stop()}},e)}),o=0;case 6:if(!(o<n.length)){e.next=11;break}return e.delegateYield(r(o),"t0",8);case 8:o++,e.next=6;break;case 11:i={listName:n[0].SYMBOL,listItem:l},console.log("newjosnlist:",i),T.addIntoStaticData(i).then(function(e){var t=K(e,"noPop");a.setState({listName:t.listName,listCount:t.count})});case 14:case"end":return e.stop()}},e)})),a.resetCsv=function(){a.setState({addtowatchlist:"",resMessage:""})},a.state={products:[],stopnview:"",curnewdata:"",underlyingValue:"",timestamp:"",totalCOI:0,expiry:"",strike:"",FilteredBY:"",AllspTotalOI:[],PEoi:0,CEoi:0,scrollcount:0,resMessage:[],counter:0,listCount:0},a}return Object(w.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){var e=this;T.getStaticData().then(function(t){var a=t.data;localStorage.setItem("staticData",JSON.stringify(a));var n=Object.keys(a);e.setState({totalWatchlist:n}),localStorage.setItem("totalWatchlist",JSON.stringify(n)),e.setState({staticData:a});var l=[];n.forEach(function(e){a[e].forEach(function(e){l.filter(function(t){return t.token===e.token}).length||l.push(e)})}),localStorage.setItem("watchList",JSON.stringify(l))});var t=localStorage.getItem("watchList")?JSON.parse(localStorage.getItem("watchList")):[];this.setState({watchlistCount:t.length})}},{key:"render",value:function(){var e=this;return l.a.createElement(l.a.Fragment,null,l.a.createElement(ht,null),l.a.createElement(Et.a,{style:{padding:"25px"}},l.a.createElement(M.a,{direction:"row",container:!0,className:"flexGrow",spacing:2,style:{paddingLeft:"5px",paddingRight:"5px",justifyContent:"center"}},l.a.createElement(M.a,{item:!0,xs:12,sm:8},l.a.createElement(W.a,{variant:"h6"},"Current Watchlist Count   ",this.state.watchlistCount,"\xa0 \xa0   \xa0 \xa0   \xa0 \xa0",l.a.createElement(B.a,{onClick:function(){localStorage.setItem("watchList",[]),window.location.reload()}},"Delete All"),l.a.createElement("br",null)),l.a.createElement(Y.a,{variant:"outlined",multiline:!0,rows:10,fullwidth:!0,style:{width:"90%",height:"50%"},label:"Paste only JSON to add into watchlist",value:this.state.addtowatchlist,name:"addtowatchlist",onChange:this.onChange})),l.a.createElement(M.a,{item:!0,xs:8,sm:8},l.a.createElement(B.a,{variant:"contained",color:"primary",onClick:function(){return e.readCsv()}}," Add to Watchlist"),"    \xa0 \xa0",l.a.createElement(B.a,{variant:"contained",color:"secondary",onClick:function(){return e.resetCsv()}},"Reset"),"\xa0 \xa0   ",l.a.createElement("b",null,"Total Added to Watchlist : ",this.state.counter),"\xa0 \xa0   ",l.a.createElement("b",null," Static Data Update: ",this.state.listName,"(",this.state.listCount,")")),l.a.createElement(M.a,{item:!0,xs:8,sm:8},this.state.resMessage?this.state.resMessage.map(function(e){return l.a.createElement(l.a.Fragment,null,"  ",l.a.createElement("span",null," ",e," "),"  ",l.a.createElement("br",null)," ")}):""))))}}]),t}(l.a.Component),Ta=Object(i.b)(function(e){return{packs:e.packs.packs.data}},{setPackLoaded:Jt})(Ia),Da=a(495),Pa=new xt.w3cwebsocket("wss://omnefeeds.angelbroking.com/NestHtml5Mobile/socket/stream"),Oa=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(S.a)(this,Object(v.a)(t).call(this,e))).getTodayOrder=function(){T.retrieveOrderBook().then(function(e){var t=K(e,"noPop");if(t&&t.data){var a=t.data;a.sort(function(e,t){return new Date(t.updatetime)-new Date(e.updatetime)}),localStorage.setItem("oderbookData",JSON.stringify(a))}})},a.placeSLMOrder=function(e){var t={triggerprice:e.stopLossPrice,tradingsymbol:e.tradingsymbol,symboltoken:e.symboltoken,quantity:e.quantity,transactiontype:"BUY"===e.transactiontype?"SELL":"BUY",exchange:"NSE",producttype:"INTRADAY",duration:"DAY",price:0,squareoff:"0",stoploss:"0",ordertype:"STOPLOSS_MARKET",variety:"STOPLOSS"};console.log("SLM option data",t),T.placeOrder(t).then(function(t){var n=K(t);n.status&&"SUCCESS"===n.message&&(a.setState({orderid:n.data&&n.data.orderid}),a.speckIt("hey Vijay, "+e.tradingsymbol+" buy order placed"),a.getTodayOrder(),document.getElementById("orderRefresh")&&document.getElementById("orderRefresh").click())})},a.placeOrderMethod=function(e){var t={transactiontype:e.transactiontype,tradingsymbol:e.tradingsymbol,symboltoken:e.symboltoken,quantity:e.quantity,ordertype:0===e.buyPrice?"MARKET":"LIMIT",price:e.buyPrice,producttype:"INTRADAY",duration:"DAY",squareoff:"0",stoploss:"0",exchange:"NSE",variety:"NORMAL"};console.log("place order option",t),T.placeOrder(t).then(function(t){var n=K(t);n.status&&"SUCCESS"===n.message&&(a.speckIt(e.tradingsymbol+" Added"),a.setState({orderid:n.data&&n.data.orderid}),e.stopLossPrice&&a.placeSLMOrder(e))})},a.getMinPriceAllowTick=function(e){e=e.toFixed(2);var t=parseInt(e.split(".")[0]),a=parseFloat(e.split(".")[1]);return e=parseFloat(t+"."+(a-a%5))},a.historyWiseOrderPlace=function(e,t,n,l){a.setState(Object(y.a)({},l,!0));var r=e.token,o=e.symbol;if("Automatic"==n||window.confirm(t+" "+o+" Are you sure ? ")){var i={exchange:"NSE",tradingsymbol:o,symboltoken:r};T.getLTP(i).then(function(e){var n=K(e,"noPop"),i=n&&n.data;console.log(o," ltd data ",i);var s=0;if(i&&i.ltp){var c=lt.totalCapital*lt.perTradeExposurePer/100;s=Math.floor(c/i.ltp)}if(s=s>0?1:0,console.log(o,"  quantity can be order ",s),s){var m="YYYY-MM-DD HH:mm",g=rt("9:15am","h:mma").format(m);console.log("beginningTime",g);var u=rt.duration("54:10:00"),d=rt(new Date).subtract(u),h={exchange:"NSE",symboltoken:r,interval:"FIVE_MINUTE",fromdate:rt(d).format(m),todate:rt(new Date).format(m)};T.getHistoryData(h).then(function(e){var n=K(e,"noPop");if(n&&n.data&&n.data.length){var c=n.data,m=0,g=0,u=0,d=0,h=0;if(c.reverse(),d=c[0][3],u=c[0][2],c&&c.length>0){for(var p=0;p<20;p++)c[p]&&(m+=c[p][4],g+=c[p][3],h+=c[p][2],c[p][2]>u&&(console.log(p,u,c[p][2]),u=c[p][2]),c[p][3]<=d&&(d=c[p][3]));var f=c.length>20?20:c.length,b=m/f,E=g/f,S=h/f,v=0,k=0;"BUY"==t&&(v=E-3*(u-d)/100,v=a.getMinPriceAllowTick(v),k=100*(i.ltp-v)/i.ltp,console.log(o,t," LTP ",i.ltp),console.log(o+"highestHigh:",u,"lowestLow",d,"stoploss after tick:",v,"stoploss%",k),console.log(o+"  close avg middle ",b,"lowerest avg",E,"bbhigerValue",S)),"SELL"==t&&(v=S+3*(u-d)/100,k=100*((v=a.getMinPriceAllowTick(v))-i.ltp)/i.ltp,console.log(o,t," LTP ",i.ltp),console.log(o+"highestHigh:",u,"lowestLow",d,"stoploss after tick:",v,"stoploss%",k),console.log(o+"  close avg middle ",b,"lowerest avg",E,"bbhigerValue",S));var w={transactiontype:t,tradingsymbol:o,symboltoken:r,buyPrice:0,quantity:s,stopLossPrice:v};s?(a.placeOrderMethod(w),a.setState(Object(y.a)({},l,!1))):(G.showError(o+" stoploss is > 1.5% Rejected"),console.log(o+" its not fullfilled"))}}else G.showError(o+" candle data emply"),console.log(o+" candle data emply"),a.setState(Object(y.a)({},l,!0))})}else G.showError(s+"  quantity |  "+o+" "+t+" Rejected"),a.setState(Object(y.a)({},l,!1))}).catch(function(e){this.setState(Object(y.a)({},l,!0))})}},a.updateLTPMannually=function(e){var t=a.state.staticData[e];a.refreshSectorLtp(t,e)},a.refreshSectorLtp=function(){var e=Object(ae.a)(ee.a.mark(function e(t,n){var l,r,o,i;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({stockUpdate:n}),a.setState({refreshFlag:!1,failedCount:0}),l=[],a.state.sectorStockList,r=ee.a.mark(function e(n){return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i={exchange:"NSE",tradingsymbol:t[n].symbol,symboltoken:t[n].token},T.getLTP(i).then(function(e){var a=K(e,"noPop"),r=a&&a.data;if(r.symboltoken==t[n].token){var o=100*(r.ltp-r.close)/r.close,i=t[n];i.ltp=r.ltp,i.nc=o,i.cng=r.ltp-r.close,i.ltt=(new Date).toLocaleString(),l.push(i)}}).catch(function(e){a.setState({failedCount:a.state.failedCount+1}),console.log(t[n].symbol,e)}),e.next=4,new Promise(function(e){return setTimeout(e,101)});case 4:case"end":return e.stop()}},e)}),o=0;case 6:if(!(o<t.length)){e.next=11;break}return e.delegateYield(r(o),"t0",8);case 8:o++,e.next=6;break;case 11:n&&a.state.sectorList.forEach(function(e,t){if(e.index==n)return a.state.sectorList[t].stockList=l,a.state.sectorList[t].isStocksLtpUpdted=!0,void a.setState({sectorList:a.state.sectorList})}),a.setState({refreshFlag:!0});case 13:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.checkLast5MinMovement=function(){var e=Object(ae.a)(ee.a.mark(function e(t){var n,l,r,o,i,s;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=a.state.staticData[t],a.setState({refreshFlagCandle:!1}),console.log("sectorStockList",t),l=ee.a.mark(function e(t){return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return rt("9:15am","h:mma"),o=rt.duration("00:06:00"),i=rt(new Date).subtract(o),s={exchange:"NSE",symboltoken:n[t].token,interval:"ONE_MINUTE",fromdate:rt(i).format("YYYY-MM-DD HH:mm"),todate:rt(new Date).format("YYYY-MM-DD HH:mm")},a.setState({stockCandleUpdate:t+1+". "+n&&n[t].symbol}),T.getHistoryData(s).then(function(e){var a=K(e,"noPop");if(a&&a.data&&a.data.length){console.log(n[t].symbol,"candle history",a.data);var l=a.data,r=[],o=[],i=[],s=[],c=[],m=[],g=[];l.forEach(function(e,t){r.push([e[0],e[1],e[2],e[3],e[4]]),o.push([e[5],(e[2]+e[3]+e[4])/3]),i.push(e[4]),s.push(e[2]),c.push(e[3]),m.push(e[3]),g.push(e[5])}),console.log(n[t].symbol,n[t])}else console.log(n[t].symbol,"  emply candle found")}).catch(function(e){a.setState({failedCount:a.state.failedCount+1}),G.showError(n[t].symbol+" candle failed!")}),e.next=8,new Promise(function(e){return setTimeout(e,350)});case 8:case"end":return e.stop()}},e)}),r=0;case 5:if(!(r<n.length)){e.next=10;break}return e.delegateYield(l(r),"t0",7);case 7:r++,e.next=5;break;case 10:t&&a.state.sectorList.forEach(function(e,l){if(e.index==t)return a.state.sectorList[l].stockList=n,void a.setState({sectorList:a.state.sectorList})}),a.setState({refreshFlagCandle:!0}),console.log("sectorStockswithcandle",n);case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.refreshSectorCandleManually=function(){var e=Object(ae.a)(ee.a.mark(function e(t){var n,l,r,o,i,s;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=a.state.staticData[t],a.setState({refreshFlagCandle:!1}),console.log("sectorStockList",t),l=ee.a.mark(function e(t){return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return rt("9:15am","h:mma"),o=rt.duration("22:00:00"),i=rt(new Date).subtract(o),s={exchange:"NSE",symboltoken:n[t].token,interval:"FIFTEEN_MINUTE",fromdate:rt(i).format("YYYY-MM-DD HH:mm"),todate:rt(new Date).format("YYYY-MM-DD HH:mm")},a.setState({stockCandleUpdate:t+1+". "+n&&n[t].symbol}),T.getHistoryData(s).then(function(e){var a=K(e,"noPop");if(a&&a.data&&a.data.length){var l=a.data,r=[],o=[],i=[],s=[],c=[],m=[],g=[],u=[];l.forEach(function(e,t){r.push([e[0],e[1],e[2],e[3],e[4]]),o.push([e[5],(e[2]+e[3]+e[4])/3]),i.push(e[4]),s.push(e[2]),c.push(e[3]),m.push(e[3]),g.push(e[5]),u.push((e[2]+e[3]+e[4])/3)});var d={values:i,period:14},h=ot.a.calculate(d);console.log(n[t].symbol,"lastRsiValue",h[h.length-1]);var p={open:m,high:s,low:c,close:i,volume:g},f={period:20,values:u,stdDev:2},y=it.a.calculate(f);console.log(n[t].symbol,"BB",f,y),l.length>0&&(n[t].candleChartData=r,n[t].vwapValue=ct()(o),n[t].vwapDataChart=Da.a.calculate(p),n[t].lastRsiValue=h[h.length-1]),console.log(n[t].symbol,n[t])}else console.log(n[t].symbol,"  emply candle found")}).catch(function(e){a.setState({failedCount:a.state.failedCount+1}),G.showError(n[t].symbol+" candle failed!")}),e.next=8,new Promise(function(e){return setTimeout(e,350)});case 8:case"end":return e.stop()}},e)}),r=0;case 5:if(!(r<n.length)){e.next=10;break}return e.delegateYield(l(r),"t0",7);case 7:r++,e.next=5;break;case 10:t&&a.state.sectorList.forEach(function(e,l){if(e.index==t)return a.state.sectorList[l].stockList=n,void a.setState({sectorList:a.state.sectorList})}),a.setState({refreshFlagCandle:!0}),console.log("sectorStockswithcandle",n);case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.refreshSectorCandle=Object(ae.a)(ee.a.mark(function e(){var t,n,l,r,o,i;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({refreshFlagCandle:!1}),t=a.state.sectorStockList,console.log("sectorStockList",a.state.sectorStockList.length),n=ee.a.mark(function e(n){return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=rt("9:15am","h:mma"),o=rt.duration("61:00:00"),rt(new Date).subtract(o),i={exchange:"NSE",symboltoken:a.state.sectorStockList[n].token,interval:"FIVE_MINUTE",fromdate:rt(r).format("YYYY-MM-DD HH:mm"),todate:rt(new Date).format("YYYY-MM-DD HH:mm")},a.setState({stockCandleUpdate:n+1+". "+a.state.sectorStockList&&a.state.sectorStockList[n].symbol}),T.getHistoryData(i).then(function(e){var l=K(e,"noPop");if(l&&l.data&&l.data.length){var r=l.data,o=[];if(r.forEach(function(e){o.push([e[0],e[1],e[2],e[3],e[4]])}),r.length>0){t[n].candleChartData=o;var i=a.state.sectorList;a.state.sectorList&&a.state.sectorList.forEach(function(e,a){e.stockList&&e.stockList.forEach(function(e,n){var l=t.filter(function(t){return t.token==e.token});l.length&&(i[a].stockList[n].candleChartData=l[0].candleChartData)})}),a.setState({sectorList:i}),localStorage.setItem("sectorList",JSON.stringify(i))}}else console.log(a.state.sectorStockList[n].symbol,"  emply candle found")}).catch(function(e){a.setState({failedCount:a.state.failedCount+1}),G.showError(a.state.sectorStockList[n].symbol+" candle failed!")}),e.next=8,new Promise(function(e){return setTimeout(e,350)});case 8:case"end":return e.stop()}},e)}),l=0;case 5:if(!(l<a.state.sectorStockList.length)){e.next=10;break}return e.delegateYield(n(l),"t0",7);case 7:l++,e.next=5;break;case 10:a.setState({refreshFlagCandle:!0});case 11:case"end":return e.stop()}},e)})),a.decodeWebsocketData=function(e){var t=[];try{for(var a=0;a<e.length;a++)t.push(String.fromCharCode(e[a]))}catch(n){}return t.join("")},a.makeConnection=function(){var e='{"task":"cn","channel":"NONLM","token":"'+a.state.feedToken+'","user": "'+a.state.clientcode+'","acctid":"'+a.state.clientcode+'"}';console.log("Connection sectior top firstTime_req :- "+e),Pa&&(Pa.send(e),a.updateSocketWatch())},a.showCandleChart=function(e,t,a,n,l){localStorage.setItem("candleChartData",JSON.stringify(e)),localStorage.setItem("cadleChartSymbol",t),localStorage.setItem("candlePriceShow",a),localStorage.setItem("candleChangeShow",n),localStorage.setItem("vwapDataChart",l),e&&e.length>0&&document.getElementById("showCandleChart").click()},a.updateSocketWatch=function(){var e=[];if(a.state.sectorList.forEach(function(t){t.percentChange>=.75&&t.stockList&&t.stockList.forEach(function(t){e.push("nse_cm|"+t.token)})}),e&&e.length){var t={task:"mw",channel:e.join("&"),token:a.state.feedToken,user:a.state.clientcode,acctid:a.state.clientcode};console.log("update watch channel",t),Pa.send(JSON.stringify(t))}},a.onChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.speckIt=function(e){var t=new SpeechSynthesisUtterance;t.text=e.toString(),window.speechSynthesis.speak(t)},a.getPercentageColor=function(e){return"rgb("+((e*=100)<50?255:Math.floor(255-255*(2*e-100)/100))+","+(e>50?255:Math.floor(2*e*255/100))+",0)"},a.get2DecimalNumber=function(e){return e?e.toFixed(2):e},a.state={stopnview:"",indexTimeStamp:"",refreshFlag:!0,topGLCount:0,refreshFlagCandle:!0,sectorStockList:localStorage.getItem("sectorStockList")&&JSON.parse(localStorage.getItem("sectorStockList"))||[],sectorList:localStorage.getItem("sectorList")&&JSON.parse(localStorage.getItem("sectorList"))||[],watchList:localStorage.getItem("watchList")&&JSON.parse(localStorage.getItem("watchList"))||[],staticData:localStorage.getItem("staticData")&&JSON.parse(localStorage.getItem("staticData"))||{}},a.refreshSectorCandle=a.refreshSectorCandle.bind(Object(k.a)(a)),a}return Object(w.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=JSON.parse(localStorage.getItem("userTokens")),a=t&&t.feedToken,n=JSON.parse(localStorage.getItem("userProfile")),l=n&&n.clientcode;this.setState({feedToken:a,clientcode:l});var r=rt("9:15am","h:mma"),o=rt("3:30pm","h:mma"),i=rt(new Date,"h:mma");rt().isoWeekday()<=5&&i.isBetween(r,o)&&(Pa.onopen=function(e){},Pa.onmessage=function(t){var a=window.atob(t.data),n=e.decodeWebsocketData(Tt.a.inflate(a)),l=JSON.parse(n);window.document.title="Sector Live WS: "+l.length,e.state.sectorList&&e.state.sectorList.forEach(function(t,a){t.stockList&&t.stockList.forEach(function(t,n){var r=l.filter(function(e){return e.tk==t.token});r.length>0&&r[0].ltp&&r[0].nc&&(e.state.sectorList[a].stockList[n].ltp=r[0].ltp,e.state.sectorList[a].stockList[n].nc=r[0].nc,e.state.sectorList[a].stockList[n].cng=r[0].cng,e.state.sectorList[a].stockList[n].ltt=r[0].ltt,e.state.sectorList[a].isStocksLtpUpdted=!0)})}),e.setState({sectorList:e.state.sectorList})},Pa.onerror=function(e){console.log("socket error",e),window.location.reload()},setInterval(function(){e.loadIndexesList()},12e4))}},{key:"loadIndexesList",value:function(){var e=this;this.setState({indexTimeStamp:"",refreshFlag:!1,failedCount:0,topGLCount:0}),T.allIndicesDirectJSON().then(function(t){if(t.data){var a=function(e){return new Promise(function(t){return setTimeout(t,e)})},n=(t.data&&t.data.data).sort(function(e,t){return t.percChange-e.percChange});console.log(n),e.setState({sectorList:[]}),function(){var t=Object(ae.a)(ee.a.mark(function t(n,l){var r,o,i,s;return ee.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r=[],o=0;case 2:if(!(o<l.length)){t.next=13;break}return i=1,s=e.state.staticData[l[o].indexName],e.setState({stockUpdate:o+1+". "+l[o].indexName}),console.log(l[o].index,l[o].percChange,l[o]),l[o].percChange>=.75||l[o].percChange<=-.75?s&&s.length&&(l[o].stockList=s,i=s.length,s&&s.length&&n.refreshSectorLtp(s,l[o].indexName),e.setState({sectorList:[].concat(Object(te.a)(e.state.sectorList),[l[o]]),topGLCount:e.state.topGLCount+1})):s&&s.length>=1&&(l[o].stockList=s,r.push(l[o])),t.next=10,a(i/10*150);case 10:o++,t.next=2;break;case 13:r.forEach(function(t){e.setState({sectorList:[].concat(Object(te.a)(e.state.sectorList),[t])})});case 14:case"end":return t.stop()}},t)}));return function(e,a){return t.apply(this,arguments)}}()(e,n)}}).catch(function(e){}),this.setState({refreshFlag:!0})}},{key:"render",value:function(){var e=this;this.state.sectorList&&this.state.sectorList.forEach(function(e,t){e.stockList&&e.stockList.sort(function(e,t){return t.nc-e.nc})});var t=rt("9:15am","h:mma"),a=rt("03:30pm","h:mma");return rt(new Date,"h:mma").isBetween(t,a)&&this.state.sectorList&&this.state.sectorList.forEach(function(t,a){t.percentChange>.75&&t.isStocksLtpUpdted&&t.stockList&&t.stockList.forEach(function(t,a){if(a<2){var n=localStorage.getItem("autoTradeTopList")&&JSON.parse(localStorage.getItem("autoTradeTopList"))||[];n.filter(function(e){return e.token===t.token}).length||(t.foundAt=(new Date).toLocaleString(),n.push(t),localStorage.setItem("autoTradeTopList",JSON.stringify(n)),console.log(t.name+" is on top  "+(a+1)+(new Date).toLocaleString()),e.speckIt(t.name+" is on top  "+(a+1)))}})}),l.a.createElement(l.a.Fragment,null,l.a.createElement(ht,null),l.a.createElement(tt,null),l.a.createElement(M.a,{direction:"row",container:!0,className:"flexGrow",spacing:1,style:{paddingLeft:"5px",paddingRight:"5px"}},l.a.createElement(M.a,{item:!0,xs:12,sm:12},l.a.createElement(W.a,{component:"h3",variant:"h6",color:"primary"},"Top Gainer/Looser Sectors(",this.state.topGLCount,") at ",this.state.indexTimeStamp,this.state.refreshFlag?l.a.createElement(B.a,{variant:"contained",onClick:function(){return e.loadIndexesList()}},"Live Ltp"):l.a.createElement(l.a.Fragment,null," ",l.a.createElement(B.a,null," ",l.a.createElement(ut.a,null)," \xa0 ",this.state.stockUpdate,"  ")," "),this.state.failedCount?this.state.failedCount+"Failed":"","\xa0")),this.state.sectorList?this.state.sectorList.map(function(t,a){return l.a.createElement(M.a,{item:!0,xs:12,sm:e.state.topGLCount<=2?6:3==e.state.topGLCount?4:3},l.a.createElement(Et.a,{style:{padding:"10px",background:"lightgray",textAlign:"center"}},l.a.createElement(B.a,{size:"small",variant:"contained",title:"update ltp",onClick:function(){return e.updateLTPMannually(t.index)}},l.a.createElement("b",null," ",a+1,". ",t.index||t.indexName+" "+t.last,"(",t.percentChange||t.percChange,"%) ")),"\xa0",l.a.createElement(B.a,{size:"small",variant:"contained",title:"Candle refresh",onClick:function(){return e.refreshSectorCandleManually(t.index)}},l.a.createElement(xe.a,null)),l.a.createElement(M.a,{direction:"row",container:!0,className:"flexGrow",spacing:1},t.stockList&&t.stockList.map(function(a,n){return l.a.createElement(M.a,{item:!0,xs:12,sm:6},l.a.createElement(Et.a,{style:{textAlign:"center"}},l.a.createElement(W.a,{style:{background:e.getPercentageColor(a.cng),fontSize:"14px"}},n+1,". ",a.name," ",a.ltp," (",e.get2DecimalNumber(a.nc),"%)"),a.candleChartData?l.a.createElement("span",{style:{cursor:"pointer"},onClick:function(){return e.showCandleChart(a.candleChartData,a.name,a.ltp,a.nc,a.vwapDataChart)}},l.a.createElement(Xe,{candleChartData:a.candleChartData,percentChange:a.nc,vwapDataChart:a.vwapDataChart})):"",a.vwapValue?l.a.createElement(W.a,null,a.vwapValue?l.a.createElement("span",{style:{background:a.ltp>a.vwapValue?"#00ff00":"red",fontSize:"14px"}},"VWAP:",l.a.createElement("b",null,a.vwapValue&&a.vwapValue.toFixed(2))," "):"","\xa0",a.lastRsiValue?l.a.createElement("span",{title:"OB means 'Overbought'",style:{background:a.lastRsiValue>=60?"#00ff00":a.lastRsiValue>=40&&a.lastRsiValue<60?"lightgray":"red",fontSize:"14px"}},"RSI:",l.a.createElement("b",null,a.lastRsiValue)," ",a.lastRsiValue>80?"OB":a.lastRsiValue>=60&&a.lastRsiValue<=80?"Buy":a.lastRsiValue>=40&&a.lastRsiValue<60?"NoTrade":"Sell"," "):""):"",l.a.createElement(M.a,{direction:"row",style:{padding:"5px"},container:!0,className:"flexGrow",justify:"space-between"},l.a.createElement(M.a,{item:!0},e.state["buyButtonClicked"+t.index+n]?l.a.createElement(ut.a,null):l.a.createElement(B.a,{size:"small",variant:"contained",color:"primary",onClick:function(){return e.historyWiseOrderPlace(a,"BUY","","buyButtonClicked"+t.index+n)}},"Buy")),l.a.createElement(M.a,{item:!0},a.ltt&&new Date(a.ltt).toLocaleTimeString()),l.a.createElement(M.a,{item:!0},e.state["sellButtonClicked"+t.index+n]?l.a.createElement(ut.a,null):l.a.createElement(B.a,{size:"small",variant:"contained",color:"secondary",onClick:function(){return e.historyWiseOrderPlace(a,"SELL","","sellButtonClicked"+t.index+n)}},"Sell")))))}))))}):l.a.createElement(ut.a,null)))}}]),t}(l.a.Component),Na=Object(i.b)(function(e){return{packs:e.packs.packs.data}},{setPackLoaded:Jt})(Oa),Fa=Object(He.a)(function(e){return{root:{margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}})(function(e){var t=e.children,a=e.classes,n=e.onClose,r=Object(Be.a)(e,["children","classes","onClose"]);return l.a.createElement(je.a,Object.assign({disableTypography:!0,className:a.root},r),l.a.createElement(W.a,{variant:"h6"},t),n?l.a.createElement(ce.a,{"aria-label":"close",className:a.closeButton,onClick:n},l.a.createElement(Ue.a,null)):null)}),Ma=Object(He.a)(function(e){return{root:{padding:e.spacing(2)}}})(Re.a),Aa=Object(He.a)(function(e){return{root:{margin:0,padding:e.spacing(1)}}})(Ve.a);function Ba(e){var t=l.a.useState(!1),a=Object(ne.a)(t,2),n=a[0],r=a[1],o=l.a.useState({data:[],candledata:{}}),i=Object(ne.a)(o,2),s=(i[0],i[1],function(){r(!1)});return l.a.createElement("div",null,l.a.createElement(B.a,{variant:"outlined",id:"showLightCandleChart",color:"primary",style:{display:"none"},onClick:function(){r(!0)}},"Chart"),l.a.createElement(Ye.a,{maxWidth:"lg",onClose:s,"aria-labelledby":"customized-dialog-title",open:n},l.a.createElement(Fa,{id:"customized-dialog-title",onClose:s,style:{color:e.LightChartData.InstrumentLTP&&e.LightChartData.InstrumentLTP.change>0?"green":"red"}},e.LightChartData.selectedSymbol,"  ",e.LightChartData.InstrumentLTP&&e.LightChartData.InstrumentLTP.ltp,"    (",e.LightChartData.InstrumentLTP&&e.LightChartData.InstrumentLTP.change.toFixed(2),"%)",l.a.createElement("br",null)),l.a.createElement(Ma,{dividers:!0,id:"chart"},l.a.createElement(M.a,{style:{display:"visible"},spacing:1,direction:"row",alignItems:"center",container:!0},l.a.createElement("br",null),e.LightChartData&&e.LightChartData.InstrumentLTP?l.a.createElement(M.a,{item:!0,xs:12,sm:3,style:{background:"#00000014"}},l.a.createElement("div",{style:{background:"#bdbdbd"}},l.a.createElement("b",null,"  Daily: ",e.LightChartData.selectedSymbol)," ",l.a.createElement("br",null),l.a.createElement("span",{title:"20SMA",item:!0,xs:12,sm:12,style:{color:e.LightChartData.InstrumentLTP.ltp>e.LightChartData.DailyBulishStatus?"green":"red",fontWeight:"bold"}},"Daily Avg Price: ",e.LightChartData.DailyBulishStatus&&e.LightChartData.DailyBulishStatus.toFixed(0)," ",e.LightChartData.DailyBulishStatus?e.LightChartData.InstrumentLTP.ltp>e.LightChartData.DailyBulishStatus?"BUY":"SELL":""),l.a.createElement("br",null),l.a.createElement("span",{title:"averge of showed candle volume",item:!0,xs:12,sm:12},l.a.createElement("b",null,"Daily Avg Volume:"),"  ",(e.LightChartData.dailyAvgValume/1e5).toFixed(2),"L"),l.a.createElement("br",null),l.a.createElement("span",{title:"averge of showed candle volume",item:!0,xs:12,sm:12},e.LightChartData.todayCurrentVolume>e.LightChartData.dailyAvgValume?l.a.createElement("b",{title:"if cossed avg volume then its green",style:{color:"green"}},"Today Volume: ",(e.LightChartData.todayCurrentVolume/1e5).toFixed(2),"L "):"Today Volume:"+(e.LightChartData.todayCurrentVolume/1e5).toFixed(2)+"L")),l.a.createElement("br",null),l.a.createElement("b",null,"  Intraday: ",e.LightChartData.timeFrame," : ",e.LightChartData.tradingsymbol)," ",l.a.createElement("br",null),e.LightChartData.bblastValue?l.a.createElement("span",{item:!0,xs:12,sm:12},l.a.createElement("span",{title:"Green color mean price running above upper bb band",style:{color:e.LightChartData.InstrumentLTP.ltp>=e.LightChartData.bblastValue.upper?"green":"",fontWeight:"bold"}},"BB Upper: ",e.LightChartData.bblastValue.upper.toFixed(2)),l.a.createElement("br",null),"BB Middle(20 SMA): ",e.LightChartData.bblastValue.middle.toFixed(2),l.a.createElement("br",null),l.a.createElement("span",{title:"Green red mean price running below lower bb band",style:{color:e.LightChartData.InstrumentLTP.ltp<=e.LightChartData.bblastValue.lower?"red":"",fontWeight:"bold"}},"BB Lower: ",e.LightChartData.bblastValue.lower.toFixed(2)),l.a.createElement("br",null)):"",l.a.createElement("span",{item:!0,xs:12,sm:12,style:{color:e.LightChartData.InstrumentLTP.ltp>e.LightChartData.vwapvalue?"green":"red",fontWeight:"bold"}},"VWAP:  ",e.LightChartData.vwapvalue&&e.LightChartData.vwapvalue.toFixed(2)),l.a.createElement("br",null),l.a.createElement("b",null," RSI: "),e.LightChartData.rsiValues&&e.LightChartData.rsiValues.map(function(e,t){return e>=60?l.a.createElement("span",{style:{color:"green",fontWeight:"bold"}}," ",e," \xa0"):l.a.createElement("span",{style:{color:e<=40?"red":"",fontWeight:"bold"}}," ",e," \xa0")}),l.a.createElement("br",null),l.a.createElement("b",null,"Vol:")," ",e.LightChartData.valumeData&&e.LightChartData.valumeData.map(function(t,a){return l.a.createElement("span",{style:{color:t>e.LightChartData.dailyAvgValume?"green":"",fontWeight:t>e.LightChartData.dailyAvgValume?"bold":""}}," ",(t/1e5).toFixed(2),"L \xa0")}),l.a.createElement("br",null),"  ",l.a.createElement("br",null)):"",l.a.createElement(M.a,{item:!0,xs:12,sm:9},localStorage.getItem("candleChartData")?l.a.createElement(Ke.a,{options:{chart:{type:"candlestick",height:350},title:{text:"",align:"left"},xaxis:{type:"datetime"},yaxis:{tooltip:{enabled:!0}}},series:[{data:e.LightChartData.chartStaticData}],type:"candlestick",width:500,height:350}):""))),l.a.createElement(Aa,null,l.a.createElement(B.a,{autoFocus:!0,onClick:s,color:"primary"},"Close"))))}var Ha=new xt.w3cwebsocket("wss://omnefeeds.angelbroking.com/NestHtml5Mobile/socket/stream"),Ya=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(S.a)(this,Object(v.a)(t).call(this,e))).getTodayOrder=function(){T.retrieveOrderBook().then(function(e){var t=K(e,"noPop");if(t&&t.data){var a=t.data;a.sort(function(e,t){return new Date(t.updatetime)-new Date(e.updatetime)}),localStorage.setItem("oderbookData",JSON.stringify(a))}})},a.updateLTPMannually=function(e){var t=a.state.staticData[e];a.refreshSectorLtp(t,e)},a.refreshSectorLtp=function(){var e=Object(ae.a)(ee.a.mark(function e(t,n){var l,r,o,i;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({stockUpdate:n}),a.setState({refreshFlag:!1,failedCount:0}),l=[],a.state.sectorStockList,r=ee.a.mark(function e(n){return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i={exchange:"NSE",tradingsymbol:t[n].symbol,symboltoken:t[n].token},T.getLTP(i).then(function(e){var a=K(e,"noPop"),r=a&&a.data;if(r.symboltoken==t[n].token){var o=100*(r.ltp-r.close)/r.close,i=t[n];i.ltp=r.ltp,i.nc=o,i.cng=r.ltp-r.close,i.ltt=(new Date).toLocaleString(),l.push(i)}}).catch(function(e){a.setState({failedCount:a.state.failedCount+1}),console.log(t[n].symbol,e)}),e.next=4,new Promise(function(e){return setTimeout(e,101)});case 4:case"end":return e.stop()}},e)}),o=0;case 6:if(!(o<t.length)){e.next=11;break}return e.delegateYield(r(o),"t0",8);case 8:o++,e.next=6;break;case 11:n&&a.state.sectorList.forEach(function(e,t){if(e.index==n)return a.state.sectorList[t].stockList=l,a.state.sectorList[t].isStocksLtpUpdted=!0,void a.setState({sectorList:a.state.sectorList})}),a.setState({refreshFlag:!0});case 13:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.checkLast5MinMovement=function(){var e=Object(ae.a)(ee.a.mark(function e(t){var n,l,r,o,i,s;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=a.state.staticData[t],a.setState({refreshFlagCandle:!1}),console.log("sectorStockList",t),l=ee.a.mark(function e(t){return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return rt("9:15am","h:mma"),o=rt.duration("00:06:00"),i=rt(new Date).subtract(o),s={exchange:"NSE",symboltoken:n[t].token,interval:"ONE_MINUTE",fromdate:rt(i).format("YYYY-MM-DD HH:mm"),todate:rt(new Date).format("YYYY-MM-DD HH:mm")},a.setState({stockCandleUpdate:t+1+". "+n&&n[t].symbol}),T.getHistoryData(s).then(function(e){var a=K(e,"noPop");if(a&&a.data&&a.data.length){console.log(n[t].symbol,"candle history",a.data);var l=a.data,r=[],o=[],i=[],s=[],c=[],m=[],g=[];l.forEach(function(e,t){r.push([e[0],e[1],e[2],e[3],e[4]]),o.push([e[5],(e[2]+e[3]+e[4])/3]),i.push(e[4]),s.push(e[2]),c.push(e[3]),m.push(e[3]),g.push(e[5])}),console.log(n[t].symbol,n[t])}else console.log(n[t].symbol,"  emply candle found")}).catch(function(e){a.setState({failedCount:a.state.failedCount+1}),G.showError(n[t].symbol+" candle failed!")}),e.next=8,new Promise(function(e){return setTimeout(e,350)});case 8:case"end":return e.stop()}},e)}),r=0;case 5:if(!(r<n.length)){e.next=10;break}return e.delegateYield(l(r),"t0",7);case 7:r++,e.next=5;break;case 10:t&&a.state.sectorList.forEach(function(e,l){if(e.index==t)return a.state.sectorList[l].stockList=n,void a.setState({sectorList:a.state.sectorList})}),a.setState({refreshFlagCandle:!0}),console.log("sectorStockswithcandle",n);case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.refreshSectorCandleManually=function(){var e=Object(ae.a)(ee.a.mark(function e(t){var n,l,r,o,i,s;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=a.state.staticData[t],a.setState({refreshFlagCandle:!1}),console.log("sectorStockList",t),l=ee.a.mark(function e(t){return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return rt("9:15am","h:mma"),o=rt.duration("22:00:00"),i=rt(new Date).subtract(o),s={exchange:"NSE",symboltoken:n[t].token,interval:"FIFTEEN_MINUTE",fromdate:rt(i).format("YYYY-MM-DD HH:mm"),todate:rt(new Date).format("YYYY-MM-DD HH:mm")},a.setState({stockCandleUpdate:t+1+". "+n&&n[t].symbol}),T.getHistoryData(s).then(function(e){var a=K(e,"noPop");if(a&&a.data&&a.data.length){var l=a.data,r=[],o=[],i=[],s=[],c=[],m=[],g=[],u=[];l.forEach(function(e,t){r.push([e[0],e[1],e[2],e[3],e[4]]),o.push([e[5],(e[2]+e[3]+e[4])/3]),i.push(e[4]),s.push(e[2]),c.push(e[3]),m.push(e[3]),g.push(e[5]),u.push((e[2]+e[3]+e[4])/3)});var d={values:i,period:14},h=ot.a.calculate(d);console.log(n[t].symbol,"lastRsiValue",h[h.length-1]);var p={open:m,high:s,low:c,close:i,volume:g},f={period:20,values:u,stdDev:2},y=it.a.calculate(f);console.log(n[t].symbol,"BB",f,y),l.length>0&&(n[t].candleChartData=r,n[t].vwapValue=ct()(o),n[t].vwapDataChart=Da.a.calculate(p),n[t].lastRsiValue=h[h.length-1]),console.log(n[t].symbol,n[t])}else console.log(n[t].symbol,"  emply candle found")}).catch(function(e){a.setState({failedCount:a.state.failedCount+1}),G.showError(n[t].symbol+" candle failed!")}),e.next=8,new Promise(function(e){return setTimeout(e,350)});case 8:case"end":return e.stop()}},e)}),r=0;case 5:if(!(r<n.length)){e.next=10;break}return e.delegateYield(l(r),"t0",7);case 7:r++,e.next=5;break;case 10:t&&a.state.sectorList.forEach(function(e,l){if(e.index==t)return a.state.sectorList[l].stockList=n,void a.setState({sectorList:a.state.sectorList})}),a.setState({refreshFlagCandle:!0}),console.log("sectorStockswithcandle",n);case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.refreshSectorCandle=Object(ae.a)(ee.a.mark(function e(){var t,n,l,r,o,i;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({refreshFlagCandle:!1}),t=a.state.sectorStockList,console.log("sectorStockList",a.state.sectorStockList.length),n=ee.a.mark(function e(n){return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=rt("9:15am","h:mma"),o=rt.duration("61:00:00"),rt(new Date).subtract(o),i={exchange:"NSE",symboltoken:a.state.sectorStockList[n].token,interval:"FIVE_MINUTE",fromdate:rt(r).format("YYYY-MM-DD HH:mm"),todate:rt(new Date).format("YYYY-MM-DD HH:mm")},a.setState({stockCandleUpdate:n+1+". "+a.state.sectorStockList&&a.state.sectorStockList[n].symbol}),T.getHistoryData(i).then(function(e){var l=K(e,"noPop");if(l&&l.data&&l.data.length){var r=l.data,o=[];if(r.forEach(function(e){o.push([e[0],e[1],e[2],e[3],e[4]])}),r.length>0){t[n].candleChartData=o;var i=a.state.sectorList;a.state.sectorList&&a.state.sectorList.forEach(function(e,a){e.stockList&&e.stockList.forEach(function(e,n){var l=t.filter(function(t){return t.token==e.token});l.length&&(i[a].stockList[n].candleChartData=l[0].candleChartData)})}),a.setState({sectorList:i}),localStorage.setItem("sectorList",JSON.stringify(i))}}else console.log(a.state.sectorStockList[n].symbol,"  emply candle found")}).catch(function(e){a.setState({failedCount:a.state.failedCount+1}),G.showError(a.state.sectorStockList[n].symbol+" candle failed!")}),e.next=8,new Promise(function(e){return setTimeout(e,350)});case 8:case"end":return e.stop()}},e)}),l=0;case 5:if(!(l<a.state.sectorStockList.length)){e.next=10;break}return e.delegateYield(n(l),"t0",7);case 7:l++,e.next=5;break;case 10:a.setState({refreshFlagCandle:!0});case 11:case"end":return e.stop()}},e)})),a.decodeWebsocketData=function(e){var t=[];try{for(var a=0;a<e.length;a++)t.push(String.fromCharCode(e[a]))}catch(n){}return t.join("")},a.showCandleChart=function(e,t,a,n,l){localStorage.setItem("candleChartData",JSON.stringify(e)),localStorage.setItem("cadleChartSymbol",t),localStorage.setItem("candlePriceShow",a),localStorage.setItem("candleChangeShow",n),localStorage.setItem("vwapDataChart",l),e&&e.length>0&&document.getElementById("showCandleChart").click()},a.getTimeFrameValue=function(e){switch(e){case"ONE_MINUTE":return(new Date).toLocaleTimeString()<"10:05:00"?"19:00:00":"01:00:00";case"FIVE_MINUTE":return(new Date).toLocaleTimeString()<"11:00:00"?"23:00:00":"03:00:00";case"TEN_MINUTE":return(new Date).toLocaleTimeString()<"12:35:00"?"24:21:00":"07:00:00";case"FIFTEEN_MINUTE":return(new Date).toLocaleTimeString()<"14:15:00"?"28:01:00":"10:01:00";case"THIRTY_MINUTE":return"100:01:00";case"ONE_HOUR":return"200:01:00";case"ONE_DAY":return"1000:01:00"}},a.dailyBasisInfoCheck=function(e,t){var n=a.getTimeFrameValue("ONE_DAY"),l=rt.duration(n),r=rt(new Date).subtract(l),o={exchange:"NSE",symboltoken:e,interval:"ONE_DAY",fromdate:rt(r).format("YYYY-MM-DD HH:mm"),todate:rt(new Date).format("YYYY-MM-DD HH:mm")};T.getHistoryData(o).then(function(n){var l=K(n,"noPop"),r="";if(l&&l.data&&l.data.length){for(var o=l.data,i=[],s=0,c=o.length-20;c<o.length;c++){var m=o[c];m&&(i.push(m[4]),s+=m[5])}r=Dt.a.calculate({period:20,values:i}),a.setState({dailyAvgValume:s/20});var g=r&&r[r.length-1];console.log(e,"DSMA",g),g&&a.setState({DailyBulishStatus:g,todayCurrentVolume:o[o.length-1][5]}),o[o.length-1][5]>s/20&&console.log("crosssed voliue",t)}})},a.showCandleChartPopUp=function(e){var t=(localStorage.getItem("watchList")&&JSON.parse(localStorage.getItem("watchList"))||[]).filter(function(t){return t.name===e});if(t&&t.length){var n=t[0];a.dailyBasisInfoCheck(n.token);var l=rt("9:15am","h:mma"),r=(rt.duration("22:00:00"),{exchange:"NSE",symboltoken:n.token,interval:"FIVE_MINUTE",fromdate:rt(l).format("YYYY-MM-DD HH:mm"),todate:rt(new Date).format("YYYY-MM-DD HH:mm")});T.getHistoryData(r).then(function(e){var t=K(e,"noPop");if(console.log("candledata",t),t&&t.data){(y=t.data).map(function(e){return{time:new Date(e[0]).getTime(),open:parseFloat(e[1]),high:parseFloat(e[2]),low:parseFloat(e[3]),close:parseFloat(e[4])}});var l=[],r=[],o=[],i=[],s=[],c=[],m=[],g=[],u=[];y.forEach(function(e,t){l.push([e[0],e[1],e[2],e[3],e[4]]),r.push([e[5],(e[2]+e[3]+e[4])/3]),o.push(e[4]),i.push(e[2]),s.push(e[3]),c.push(e[3]),m.push(e[5]),g.push((e[2]+e[3]+e[4])/3),u.push({time:new Date(e[0]).getTime(),value:e[5],color:"rgba(211, 211, 211, 1)"})});var d={period:20,values:g,stdDev:2},h=it.a.calculate(d);console.log(n.symbol,"Bolinger band",d,h);h=it.a.calculate(d);console.log(n.symbol,"Bolinger band",d,h);var p={values:o,period:14},f=ot.a.calculate(p);console.log(n.symbol,"Rsi",p,f),console.log(n.symbol,"vwap",r,ct()(r));var y={exchange:n.exch_seg,tradingsymbol:n.symbol,symboltoken:n.token};T.getLTP(y).then(function(e){var t=K(e,"noPop"),r=t&&t.data;r.change=100*(r.ltp-r.close)/r.close,a.showCandleChart(l,n.symbol,r.ltp,r.change)})}})}},a.updateSocketWatch=function(){var e=[];if(a.state.sectorList.forEach(function(t){t.percentChange>=.75&&t.stockList&&t.stockList.forEach(function(t){e.push("nse_cm|"+t.token)})}),e&&e.length){var t={task:"mw",channel:e.join("&"),token:a.state.feedToken,user:a.state.clientcode,acctid:a.state.clientcode};console.log("update watch channel",t),Ha.send(JSON.stringify(t))}},a.onChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.speckIt=function(e){var t=new SpeechSynthesisUtterance;t.text=e.toString(),window.speechSynthesis.speak(t)},a.getPercentageColor=function(e){return"rgb("+((e*=100)<50?255:Math.floor(255-255*(2*e-100)/100))+","+(e>50?255:Math.floor(2*e*255/100))+",0)"},a.get2DecimalNumber=function(e){return e?e.toFixed(2):e},a.switchToListView=function(){a.setState({switchToListViewFlag:!a.state.switchToListViewFlag})},a.get5DaysMoveCount=function(e){var t=a.state.slowMotionStockList.filter(function(t){return t.name===e});return t.length?"SM: "+t[0].bigCandleCount:""},a.getDeliveryInfo=function(e){T.getDeliveryData(e).then(function(e){if(e&&e.data&&e.data.length)return"D2T%: "+e.data[0].deliveryToTradedQuantity})},a.state={sluglist:{"NIFTY 50":"nifty","NIFTY AUTO":"cnxAuto","NIFTY BANK":"bankNifty","NIFTY ENERGY":"cnxEnergy","NIFTY FIN SERVICE":"cnxFinance","NIFTY FMCG":"cnxFMCG","NIFTY IT":"cnxit","NIFTY MEDIA":"cnxMedia","NIFTY METAL":"cnxMetal","NIFTY PHARMA":"cnxPharma","NIFTY PSU BANK":"cnxPSU","NIFTY REALTY":"cnxRealty","NIFTY PVT BANK":"niftyPvtBank","NIFTY CONSUMPTION":"cnxConsumption","NIFTY CPSE":"cpse","NIFTY INFRA":"cnxInfra","NIFTY MNC":"cnxMNC","NIFTY PSE":"cnxPSE"},stopnview:"",indexTimeStamp:"",refreshFlag:!0,topGLCount:0,refreshFlagCandle:!0,switchToListViewFlag:!0,slowMotionStockList:localStorage.getItem("slowMotionStockList")&&JSON.parse(localStorage.getItem("slowMotionStockList"))||[],sectorStockList:localStorage.getItem("sectorStockList")&&JSON.parse(localStorage.getItem("sectorStockList"))||[],sectorList:localStorage.getItem("sectorList")&&JSON.parse(localStorage.getItem("sectorList"))||[],watchList:localStorage.getItem("watchList")&&JSON.parse(localStorage.getItem("watchList"))||[],staticData:localStorage.getItem("staticData")&&JSON.parse(localStorage.getItem("staticData"))||{}},a.refreshSectorCandle=a.refreshSectorCandle.bind(Object(k.a)(a)),a}return Object(w.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){var e=this;window.document.title="Hit Map2",this.loadIndexesList();var t=JSON.parse(localStorage.getItem("userTokens")),a=t&&t.feedToken,n=JSON.parse(localStorage.getItem("userProfile")),l=n&&n.clientcode;this.setState({feedToken:a,clientcode:l});var r=rt("9:15am","h:mma"),o=rt("3:30pm","h:mma"),i=rt(new Date,"h:mma");rt().isoWeekday()<=5&&i.isBetween(r,o)&&(Ha.onopen=function(e){},Ha.onmessage=function(t){var a=window.atob(t.data),n=e.decodeWebsocketData(Tt.a.inflate(a)),l=JSON.parse(n);window.document.title="Sector Live WS: "+l.length,e.state.sectorList&&e.state.sectorList.forEach(function(t,a){t.stockList&&t.stockList.forEach(function(t,n){var r=l.filter(function(e){return e.tk==t.token});r.length>0&&r[0].ltp&&r[0].nc&&(e.state.sectorList[a].stockList[n].ltp=r[0].ltp,e.state.sectorList[a].stockList[n].nc=r[0].nc,e.state.sectorList[a].stockList[n].cng=r[0].cng,e.state.sectorList[a].stockList[n].ltt=r[0].ltt,e.state.sectorList[a].isStocksLtpUpdted=!0)})}),e.setState({sectorList:e.state.sectorList})},Ha.onerror=function(e){console.log("socket error",e),window.location.reload()},setInterval(function(){e.loadIndexesList()},12e4))}},{key:"loadIndexesList",value:function(){var e=this;this.setState({indexTimeStamp:"",refreshFlag:!1,failedCount:0,topGLCount:0}),T.allIndicesDirectJSON().then(function(t){if(t.data){var a=t.data&&t.data.data;a.sort(function(e,t){return t.percChange-e.percChange}),e.setState({indexTimeStamp:a[0].timeVal});for(var n=function(t){var n=a[t];(r=e.state.sluglist[n.indexName])&&(console.log("secName",n.indexName,r),T.checkSectorApiOther(r).then(function(l){console.log(n.indexName,l.data.data),a[t].stockList=l.data&&l.data.data,a[t].time=l.data&&l.data.time,e.setState({sectorList:a})}).catch(function(e){console.log("list fetch error",e)}))},l=0;l<a.length;l++){var r;n(l)}}}).catch(function(e){}),this.setState({refreshFlag:!0})}},{key:"render",value:function(){var e=this,t=rt("9:15am","h:mma"),a=rt("03:30pm","h:mma");return rt(new Date,"h:mma").isBetween(t,a)&&this.state.sectorList&&this.state.sectorList.forEach(function(t,a){t.percentChange>.75&&t.isStocksLtpUpdted&&t.stockList&&t.stockList.forEach(function(t,a){if(a<2){var n=localStorage.getItem("autoTradeTopList")&&JSON.parse(localStorage.getItem("autoTradeTopList"))||[];n.filter(function(e){return e.token===t.token}).length||(t.foundAt=(new Date).toLocaleString(),n.push(t),localStorage.setItem("autoTradeTopList",JSON.stringify(n)),console.log(t.name+" is on top  "+(a+1)+(new Date).toLocaleString()),e.speckIt(t.name+" is on top  "+(a+1)))}})}),l.a.createElement(l.a.Fragment,null,l.a.createElement(ht,null),l.a.createElement(tt,null),l.a.createElement(Ba,{LightChartData:{InstrumentLTP:this.state.InstrumentLTP,DailyBulishStatus:this.state.DailyBulishStatus,todayCurrentVolume:this.state.todayCurrentVolume,selectedSymbol:this.state.selectedSymbol,chartStaticData:this.state.chartStaticData,bblastValue:this.state.bblastValue,vwapvalue:this.state.vwapvalue,rsiValues:this.state.rsiValues,valumeData:this.state.valumeData}}),l.a.createElement(M.a,{direction:"row",container:!0,className:"flexGrow",spacing:1,style:{paddingLeft:"5px",paddingRight:"5px"}},l.a.createElement(M.a,{item:!0,xs:12,sm:12},l.a.createElement(W.a,{component:"h3",variant:"h6",color:"primary"},"Sectors HitMap (",Object.keys(this.state.sluglist).length,") at ",this.state.indexTimeStamp,"\xa0",l.a.createElement(B.a,{variant:"contained",onClick:function(){return e.loadIndexesList()}},"Refresh"),"\xa0",l.a.createElement(B.a,{onClick:function(){return e.switchToListView()}},"switch to list view"))),!this.state.switchToListViewFlag&&this.state.sectorList?this.state.sectorList.map(function(t,a){return t.stockList?l.a.createElement(M.a,{item:!0,xs:12,sm:3},l.a.createElement(Et.a,{style:{padding:"10px",background:"lightgray",textAlign:"center"}},l.a.createElement(W.a,{variant:"body1"},l.a.createElement("b",null," ",a+1,". ",t.index||t.indexName+" "+t.last,"(",t.percentChange||t.percChange,"%)")," \xa0 ",t.time.substr(13,8)),l.a.createElement(M.a,{direction:"row",container:!0,className:"flexGrow",spacing:1},t.stockList&&t.stockList.map(function(t,a){return l.a.createElement(M.a,{item:!0,xs:12,sm:6},l.a.createElement(Et.a,{style:{textAlign:"center"}},l.a.createElement(W.a,{style:{background:e.getPercentageColor(t.iislPercChange),fontSize:"14px"}},a+1,". ",t.symbol," ",t.ltP," (",t.iislPercChange,"%)"),t.candleChartData?l.a.createElement("span",{style:{cursor:"pointer"},onClick:function(){return e.showCandleChart(t.candleChartData,t.name,t.ltp,t.nc,t.vwapDataChart)}},l.a.createElement(Xe,{candleChartData:t.candleChartData,percentChange:t.nc,vwapDataChart:t.vwapDataChart})):"",t.vwapValue?l.a.createElement(W.a,null,t.vwapValue?l.a.createElement("span",{style:{background:t.ltp>t.vwapValue?"#00ff00":"red",fontSize:"14px"}},"VWAP:",l.a.createElement("b",null,t.vwapValue&&t.vwapValue.toFixed(2))," "):"","\xa0",t.lastRsiValue?l.a.createElement("span",{title:"OB means 'Overbought'",style:{background:t.lastRsiValue>=60?"#00ff00":t.lastRsiValue>=40&&t.lastRsiValue<60?"lightgray":"red",fontSize:"14px"}},"RSI:",l.a.createElement("b",null,t.lastRsiValue)," ",t.lastRsiValue>80?"OB":t.lastRsiValue>=60&&t.lastRsiValue<=80?"Buy":t.lastRsiValue>=40&&t.lastRsiValue<60?"NoTrade":"Sell"," "):""):""))})))):""}):"",l.a.createElement(Je.a,{id:"tabledata","aria-label":"a dense table",stickyHeader:!0,size:"small"},l.a.createElement(ze.a,{hover:!0,style:{whiteSpace:"nowrap"}},this.state.switchToListViewFlag&&this.state.sectorList?this.state.sectorList.map(function(t,a){return t.stockList?l.a.createElement(_e.a,{hover:!0,key:a},l.a.createElement(qe.a,null,l.a.createElement(W.a,{variant:"body1"},t.index||t.indexName+" "+t.last,"(",t.percentChange||t.percChange,"%)")),t.stockList&&t.stockList.map(function(t,a){return l.a.createElement(qe.a,{style:{textAlign:"left"}},l.a.createElement("div",{style:{padding:"5px"}},l.a.createElement(B.a,{size:"small",onClick:function(){return e.showCandleChartPopUp(t.symbol)}},l.a.createElement("span",{style:{background:e.getPercentageColor(t.iislPercChange)}},"  ",l.a.createElement("b",null,a+1,".")," ",t.symbol," ",t.ltP," (",t.iislPercChange,"%) "),l.a.createElement("span",{title:"last 5 days 5min big movement  maximum count"},"\xa0",e.get5DaysMoveCount(t.symbol),"  "))))})):""}):""))))}}]),t}(l.a.Component),ja=Object(i.b)(function(e){return{packs:e.packs.packs.data}},{setPackLoaded:Jt})(Ya);a(222);var Ra=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(S.a)(this,Object(v.a)(t).call(this,e))).stopSearching=function(){console.log("stop the search"),clearInterval(a.state.findlast5minMovementInterval),clearInterval(a.state.stop10bbSearch)},a.onChangeQty=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.showCandleChart=function(e,t,a,n){localStorage.setItem("candleChartData",JSON.stringify(e)),localStorage.setItem("cadleChartSymbol",t),localStorage.setItem("candlePriceShow",a),localStorage.setItem("candleChangeShow",n.toFixed(2)),document.getElementById("showCandleChart").click()},a.speckIt=function(e){var t=new SpeechSynthesisUtterance;t.text=e.toString(),window.speechSynthesis.speak(t)},a.onChangeWatchlist=function(e){clearInterval(a.state.findlast5minMovementInterval),a.setState(Object(y.a)({},e.target.name,e.target.value),function(){this.find10MinBBBlast()})},a.startSearching=function(){console.log("Starting the search");var e=rt("9:15am","h:mma"),t=rt("3:30pm","h:mma"),n=rt(new Date,"h:mma");if(rt().isoWeekday()<=5&&n.isBetween(e,t)){var l=6e4;a.state.totalStockToWatch>180&&(l=333*a.state.totalStockToWatch),a.setState({findlast5minMovementInterval:setInterval(function(){a.findlast5minMovement()},l)})}},a.getTimeFrameValue=function(e){switch(e){case"ONE_MINUTE":return(new Date).toLocaleTimeString()<"10:05:00"?"18:21:00":"00:21:00";case"FIVE_MINUTE":return(new Date).toLocaleTimeString()<"11:00:00"?"19:41:00":"01:41:00";case"TEN_MINUTE":return(new Date).toLocaleTimeString()<"12:35:00"?"21:21:00":"03:21:00";case"FIFTEEN_MINUTE":return(new Date).toLocaleTimeString()<"14:15:00"?"23:01:00":"05:01:00";case"THIRTY_MINUTE":return"84:01:00";case"ONE_HOUR":return"168:01:00";case"ONE_DAY":return"744:01:00"}},a.updateToLocalStorage=function(e){var t=new Date(e.foundAt).toLocaleString(),n=a.state.fastMovementList.filter(function(a){return a.token==e.token&&a.foundAt==t});if(console.log("isfound",n),!n.length){var l={token:e.token,foundAt:t,ltp:e.ltp,symbol:e.symbol,nc:e.perChange.toFixed(2),orderType:e.orderType};a.state.fastMovementList.push(l),localStorage.setItem("fastMovementList",JSON.stringify(a.state.fastMovementList))}},a.find10MinBBBlast=Object(ae.a)(ee.a.mark(function e(){var t,n,l,r,o,i,s;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({findlast5minMovementUpdate:"",findlast5minMovement:[]}),t=a.state.staticData[a.state.selectedWatchlist],"selectall"==a.state.selectedWatchlist&&(t=localStorage.getItem("watchList")&&JSON.parse(localStorage.getItem("watchList"))),a.setState({totalStockToWatch:t.length}),n=[],l=ee.a.mark(function e(l){var r;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({findlast5minMovementUpdate:l+1+". "+t[l].symbol+" At "+(new Date).toLocaleTimeString()}),r="YYYY-MM-DD HH:mm",rt("9:15am","h:mma").format(r),a.getTimeFrameValue(a.state.timeFrame),o=rt.duration("100:00:00"),i=rt(new Date).subtract(o),s={exchange:t[l].exch_seg,symboltoken:t[l].token,interval:a.state.timeFrame,fromdate:rt(i).format(r),todate:rt(new Date).format(r)},T.getHistoryData(s).then(function(e){var o=K(e,"noPop");if(o&&o.data&&o.data.length){var i=o.data,s=[],c=[],m=[],g=[],u=[],d=[],h=[],p=[],f=[];i.forEach(function(e,t){s.push([e[0],e[1],e[2],e[3],e[4]]);new Date(e[0]).getFullYear(),new Date(e[0]).getMonth(),new Date(e[0]).getDate();c.push({x:new Date(e[0]).getTime(),y:(e[2]+e[3]+e[4])/3}),m.push([e[5],(e[2]+e[3]+e[4])/3]),g.push(e[4]),u.push(e[2]),d.push(e[3]),h.push(e[3]),p.push(e[5]),f.push((e[2]+e[3]+e[4])/3)});var y=Dt.a.calculate({period:20,values:g});console.log(t[l].symbol,"SMA",y);var b={values:g,period:14},E=ot.a.calculate(b);console.log(t[l].symbol,"Rsi",b,E),console.log(t[l].symbol,"vwap",m,ct()(m));var S={period:20,values:f,stdDev:2},v=it.a.calculate(S);console.log(t[l].symbol,"Bolinger band",S,v);var k=v[v.length-1];k&&(k.upper=k.upper.toFixed(2),k.middle=k.middle.toFixed(2),k.lower=k.lower.toFixed(2));var w={exchange:"NSE",tradingsymbol:t[l].symbol,symboltoken:t[l].token};T.getLTP(w).then(function(e){var o=K(e,"noPop"),g=o&&o.data;if(g&&g.ltp){E=E.slice(E.length-6,E.length);var u=0,d=0,h=E[2],f=E[2];E.forEach(function(e,t){t>2&&e>=55&&e<=65&&h<=e&&(h=e,u+=1),t>2&&e>=35&&e<=45&&e<=f&&(f=e,d+=1)});var y=p[2];if(p.forEach(function(e,t){t>2&&y<e&&(y=e,1)}),console.log(t[l].symbol,"valumeData",p),console.log(t[l].symbol,"last continue rsi",u),a.setState({findlast5minMovementUpdate:l+1+". "+t[l].symbol+" At "+(new Date).toLocaleTimeString()+" RSI rising :"+u}),u>=2||d>=2)if("BBBlastOnly"==a.state.BBBlastType){if(k&&g.ltp>=k.upper){var b=100*(g.ltp-g.close)/g.close,S={symbol:t[l].symbol,token:t[l].token,ltp:g.ltp,perChange:b,RSIValue:E[E.length-1],RSI:E,VWAP:ct()(m),BB:k,candleChartData:s,lightcandleChartData:c,foundAt:i&&i[i.length-1][0],orderType:"BUY",name:t[l].name};n.push(S),a.setState({findlast5minMovement:n}),a.updateToLocalStorage(S),a.speckIt(t[l].symbol+" BB  buy"),window.document.title="FM: Buy "+t[l].symbol}if(k&&g.ltp<=k.lower){b=100*(g.ltp-g.close)/g.close;var v={symbol:t[l].symbol,token:t[l].token,ltp:g.ltp,perChange:b,RSIValue:E[E.length-1],RSI:E,VWAP:ct()(m),BB:k,candleChartData:s,lightcandleChartData:c,foundAt:i&&i[i.length-1][0],orderType:"SELL",name:t[l].name};n.push(v),a.setState({findlast5minMovement:n}),a.updateToLocalStorage(v),a.speckIt(t[l].symbol+" BB sell"),window.document.title="FM: Sell "+t[l].symbol}}else{var w=a.getTimeFrameValue("ONE_DAY"),C=rt.duration(w),L=rt(new Date).subtract(C),x={exchange:t[l].exch_seg,symboltoken:t[l].token,interval:"ONE_DAY",fromdate:rt(L).format(r),todate:rt(new Date).format(r)};T.getHistoryData(x).then(function(e){var r=K(e,"noPop"),o="";if(r&&r.data&&r.data.length){var u=r.data,d=[];u.forEach(function(e,t){d.push(e[4])});var h=(o=Dt.a.calculate({period:20,values:d}))&&o[o.length-1];if(console.log(t[l].symbol,"DSMA",h),g.ltp>h&&k&&g.ltp>=k.upper){var p=100*(g.ltp-g.close)/g.close,f={symbol:t[l].symbol,token:t[l].token,ltp:g.ltp,perChange:p,RSIValue:E[E.length-1],RSI:E,VWAP:ct()(m),BB:k,DSMALastValue:h,candleChartData:s,lightcandleChartData:c,foundAt:i&&i[i.length-1][0],orderType:"BUY",name:t[l].name};n.push(f),a.setState({findlast5minMovement:n}),a.updateToLocalStorage(f),a.speckIt(t[l].symbol+" BB  buy"),window.document.title="FM: Buy "+t[l].symbol}if(g.ltp<h&&k&&g.ltp<=k.lower){p=100*(g.ltp-g.close)/g.close;var y={symbol:t[l].symbol,token:t[l].token,ltp:g.ltp,perChange:p,RSIValue:E[E.length-1],RSI:E,VWAP:ct()(m),BB:k,DSMALastValue:h,candleChartData:s,lightcandleChartData:c,foundAt:i&&i[i.length-1][0],orderType:"SELL",name:t[l].name};n.push(y),a.setState({findlast5minMovement:n}),a.updateToLocalStorage(y),a.speckIt(t[l].symbol+" BB sell"),window.document.title="FM: Sell "+t[l].symbol}}})}}})}else console.log(t[l].symbol,"  emply candle found")}),e.next=10,new Promise(function(e){return setTimeout(e,600)});case 10:case"end":return e.stop()}},e)}),r=0;case 7:if(!(r<t.length)){e.next=12;break}return e.delegateYield(l(r),"t0",9);case 9:r++,e.next=7;break;case 12:case"end":return e.stop()}},e)})),a.findlast5minMovement=Object(ae.a)(ee.a.mark(function e(){var t,n,l,r,o,i,s,c;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.setState({findlast5minMovementUpdate:""}),t=rt.duration("00:05:00"),"YYYY-MM-DD HH:mm",n=rt(new Date).subtract(t),l=a.state.staticData[a.state.selectedWatchlist],"selectall"==a.state.selectedWatchlist&&(l=localStorage.getItem("watchList")&&JSON.parse(localStorage.getItem("watchList"))),console.log("watchList",a.state.selectedWatchlist,l),a.setState({totalStockToWatch:l.length}),r=[],!l||!l.length){e.next=17;break}o=ee.a.mark(function e(t){var o;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=l[t],s={exchange:"NSE",symboltoken:o.token,interval:"ONE_MINUTE",fromdate:rt(n).format("YYYY-MM-DD HH:mm"),todate:rt(new Date).format("YYYY-MM-DD HH:mm")},c=t+1+". "+o.symbol,a.setState({findlast5minMovementUpdate:c}),window.document.title="FM: "+c,T.getHistoryData(s).then(function(e){var n=K(e,"noPop");if(n&&n.data&&n.data.length){var o=[];n.data.forEach(function(e){var t=100*(e[4]-e[1])/e[1];t>=.3&&(1,o.push("<span style='color:green'>"+t.toFixed(2)+"% At "+new Date(e[0]).toLocaleTimeString().substr(0,5)+"</span>")),t<=-.3&&(1,o.push("<span style='color:red'>"+t.toFixed(2)+"% At "+new Date(e[0]).toLocaleTimeString().substr(0,5)+"</span>"))});var i=[];if(n.data.forEach(function(e){i.push([e[0],e[1],e[2],e[3],e[4]])}),o.length){var s={exchange:"NSE",tradingsymbol:l[t].symbol,symboltoken:l[t].token};T.getLTP(s).then(function(e){var n=K(e,"noPop"),s=n&&n.data;if(s&&s.ltp){var c=100*(s.ltp-s.close)/s.close;r.push({symbol:l[t].symbol,ltp:s.ltp,perChange:c,percentChangeList:o.join(" | "),candleChartData:i}),console.log("foundData",r),a.setState({findlast5minMovement:r})}})}}else console.log(" candle data emply")}),e.next=8,new Promise(function(e){return setTimeout(e,333)});case 8:case"end":return e.stop()}},e)}),i=0;case 12:if(!(i<l.length)){e.next=17;break}return e.delegateYield(o(i),"t0",14);case 14:i++,e.next=12;break;case 17:case"end":return e.stop()}},e)})),a.callbackAfterOrderDone=function(e){console.log("order executed",e)},a.handleClick=function(e,t,n){if(console.log(e),e.token&&e.symbol){if("BUY"==t){a.setState(Object(y.a)({},n,!0));var l={token:e.token,symbol:e.symbol,qtyToTake:a.state.qtyToTake};mt.historyWiseOrderPlace(l,"BUY","no",a.callbackAfterOrderDone),a.setState(Object(y.a)({},n,!1))}if("SELL"==t){a.setState(Object(y.a)({},n,!0));l={token:e.token,symbol:e.symbol,qtyToTake:a.state.qtyToTake};mt.historyWiseOrderPlace(l,"SELL","no",a.callbackAfterOrderDone),a.setState(Object(y.a)({},n,!1))}}else G.showError(" Symbol Not found!!!")},a.state={staticData:localStorage.getItem("staticData")&&JSON.parse(localStorage.getItem("staticData"))||{},totalWatchlist:localStorage.getItem("totalWatchlist")&&JSON.parse(localStorage.getItem("totalWatchlist"))||[],selectedWatchlist:"NIFTY 50",totalStockToWatch:0,timeFrame:"TEN_MINUTE",chartStaticData:[],qtyToTake:"",BBBlastType:"BBBlastOnly",fastMovementList:localStorage.getItem("fastMovementList")&&JSON.parse(localStorage.getItem("fastMovementList"))||[]},a.findlast5minMovement=a.findlast5minMovement.bind(Object(k.a)(a)),a.startSearching=a.startSearching.bind(Object(k.a)(a)),a}return Object(w.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){var e=this;window.document.title="Fast Movement";var t=this.state.staticData[this.state.selectedWatchlist];this.setState({totalStockToWatch:t.length});var a=rt("9:15am","h:mma"),n=rt("3:30pm","h:mma"),l=rt(new Date,"h:mma"),r=rt().isoWeekday(),o=setInterval(function(){var t=new Date;console.log("set interval 1sec min/10==0 ",t.toLocaleTimeString()),t.getMinutes()%5===0&&(console.log("search method call in with setTimeout 70sec",t.toLocaleTimeString()),setTimeout(function(){e.find10MinBBBlast()},7e4),e.setState({stop10bbSearch:setInterval(function(){console.log("search method call in with setInterval in 10min",t.toLocaleTimeString()),r<=5&&l.isBetween(a,n)&&e.find10MinBBBlast()},37e4)}),clearInterval(o))},1e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.state.findlast5minMovementInterval),clearInterval(this.state.stop10bbSearch)}},{key:"render",value:function(){var e=this;return l.a.createElement(l.a.Fragment,null,l.a.createElement(ht,null),l.a.createElement("br",null),l.a.createElement(tt,null)," ",l.a.createElement(ka,null),l.a.createElement(M.a,{justify:"space-between",container:!0,spacing:1},l.a.createElement(M.a,{item:!0,xs:12,sm:4},l.a.createElement(W.a,{component:"h2",variant:"h6",color:"primary",gutterBottom:!0},"\xa0BB Blast (",this.state.findlast5minMovement&&this.state.findlast5minMovement.length,")",l.a.createElement("span",{id:"stockTesting",style:{fontSize:"18px",color:"gray"}}," ",this.state.findlast5minMovementUpdate," "))),l.a.createElement(M.a,{item:!0,xs:12,sm:2},l.a.createElement(kt.a,{style:Va.selectStyle},l.a.createElement(A.a,{htmlFor:"gender"},"Select Watchlist"),l.a.createElement(wt.a,{value:this.state.selectedWatchlist,name:"selectedWatchlist",onChange:this.onChangeWatchlist},l.a.createElement(Ct.a,{value:"selectall"},"Select All"),this.state.totalWatchlist&&this.state.totalWatchlist.map(function(e){return l.a.createElement(Ct.a,{value:e},e)})))),l.a.createElement(M.a,{item:!0,xs:12,sm:1},l.a.createElement(kt.a,{style:Va.selectStyle},l.a.createElement(A.a,{htmlFor:"gender"},"Select Time"),l.a.createElement(wt.a,{value:this.state.timeFrame,name:"timeFrame",onChange:this.onChangeWatchlist},l.a.createElement(Ct.a,{value:"ONE_MINUTE"},"1 Min"),l.a.createElement(Ct.a,{value:"FIVE_MINUTE"},"5 Min"),l.a.createElement(Ct.a,{value:"TEN_MINUTE"},"10 Min"),l.a.createElement(Ct.a,{value:"FIFTEEN_MINUTE"},"15 Min"),l.a.createElement(Ct.a,{value:"THIRTY_MINUTE"},"30 Min"),l.a.createElement(Ct.a,{value:"ONE_HOUR"},"1 Hour"),l.a.createElement(Ct.a,{value:"ONE_DAY"},"1 Day")))),l.a.createElement(M.a,{item:!0,xs:12,sm:1},l.a.createElement(kt.a,{style:Va.selectStyle},l.a.createElement(A.a,{htmlFor:"gender"},"Select Time"),l.a.createElement(wt.a,{value:this.state.BBBlastType,name:"BBBlastType",onChange:this.onChangeWatchlist},l.a.createElement(Ct.a,{value:"BBBlastOnly"},"BB Blast"),l.a.createElement(Ct.a,{value:"BBBlastDaily"},"BB Blast Daily")))),l.a.createElement(M.a,{item:!0,xs:12,sm:4},l.a.createElement(B.a,{variant:"contained",style:{marginRight:"20px"},onClick:function(){return e.find10MinBBBlast()}},"Start"),l.a.createElement(B.a,{variant:"contained",style:{marginRight:"20px"},onClick:function(){return e.stopSearching()}},"Stop"))),l.a.createElement(M.a,{container:!0,spacing:2},this.state.findlast5minMovement?this.state.findlast5minMovement.map(function(t,a){return l.a.createElement(M.a,{item:!0,xs:12,sm:3},l.a.createElement(Et.a,{style:{overflow:"auto",padding:"10px"}},l.a.createElement(W.a,{style:{color:t.perChange>0?"green":"red"}}," ",t.symbol," ",t.ltp," ",l.a.createElement("b",null,"(",t.perChange.toFixed(2),"%) ")),t.candleChartData.length>0?l.a.createElement(Ke.a,{options:{chart:{type:"candlestick",height:250},title:{text:"",align:"left"},xaxis:{type:"datetime"},yaxis:{tooltip:{enabled:!0}}},series:[{data:t.candleChartData.slice(Math.max(t.candleChartData.length-10,1))}],type:"candlestick",width:350,height:250}):"",l.a.createElement(M.a,{direction:"row",style:{padding:"5px"},container:!0,className:"flexGrow",justify:"space-between"},t.DSMALastValue?l.a.createElement(M.a,{item:!0,xs:12,sm:12,style:{color:t.ltp>t.DSMALastValue?"green":"red",fontWeight:"bold"}},"Daily SMA: ",t.DSMALastValue," ",t.ltp>t.DSMALastValue?"BUY":"SELL"):"",l.a.createElement(M.a,{item:!0,xs:12,sm:12,style:{color:t.ltp>t.VWAP?"green":"red",fontWeight:"bold"}},"VWAP:  ",t.VWAP),l.a.createElement(M.a,{item:!0,xs:12,sm:12},"RSI: ",t.RSI.map(function(e,t){return e>=60?l.a.createElement("span",{style:{color:"green",fontWeight:"bold"}}," ",e," \xa0"):l.a.createElement("span",{style:{color:e<=40?"red":"",fontWeight:"bold"}}," ",e," \xa0")})),l.a.createElement(M.a,{item:!0,xs:12,sm:12},"BB \xa0 ",l.a.createElement("span",{style:{color:t.ltp>=t.BB.upper?"green":"",fontWeight:"bold"}},"Upper: ",t.BB.upper),"\xa0 Middle: ",t.BB.middle,"\xa0 ",l.a.createElement("span",{style:{color:t.ltp<=t.BB.lower?"red":"",fontWeight:"bold"}}," Lower: ",t.BB.lower))),l.a.createElement(M.a,{direction:"row",style:{padding:"5px"},container:!0,className:"flexGrow",justify:"space-between"},l.a.createElement(M.a,{item:!0},e.state["buyButtonClicked"+t.symbol+a]?l.a.createElement(ut.a,null):l.a.createElement(B.a,{size:"small",variant:"contained",color:"primary",onClick:function(){return e.handleClick(t,"BUY","buyButtonClicked"+t.symbol+a)}},"BUY")),l.a.createElement(M.a,{item:!0},l.a.createElement(Y.a,{label:"Qty",type:"number",name:"qtyToTake",value:e.state.qtyToTake,onChange:e.onChangeQty})),l.a.createElement(M.a,{item:!0},e.state["sellButtonClicked"+t.symbol+a]?l.a.createElement(ut.a,null):l.a.createElement(B.a,{size:"small",variant:"contained",color:"Secondary",onClick:function(){return e.handleClick(t,"SELL","sellButtonClicked"+t.symbol+a)}},"SELL")))))}):""))}}]),t}(l.a.Component),Va={formContainer:{display:"flex",flexFlow:"row wrap"},textStyle:{display:"flex",justifyContent:"center"},imgStyle:{display:"flex"},selectStyle:{minWidth:"100%",marginBottom:"10px"},MuiTextField:{overflowY:"scroll",fontSize:"12px",maxHeight:"50px"},footerButton:{position:"fixed",left:0,bottom:"20px",width:"100%",textAlign:"right"}},Wa=Ra,Ua=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(S.a)(this,Object(v.a)(t).call(this,e))).stopSearching=function(){console.log("stop the search"),clearInterval(a.state.findlast5minMovementInterval),clearInterval(a.state.stop10bbSearch)},a.showCandleChart=function(e,t,a,n){localStorage.setItem("candleChartData",JSON.stringify(e)),localStorage.setItem("cadleChartSymbol",t),localStorage.setItem("candlePriceShow",a),localStorage.setItem("candleChangeShow",n.toFixed(2)),document.getElementById("showCandleChart").click()},a.speckIt=function(e){var t=new SpeechSynthesisUtterance;t.text=e.toString(),window.speechSynthesis.speak(t)},a.onChangeWatchlist=function(e){clearInterval(a.state.findlast5minMovementInterval),a.setState(Object(y.a)({},e.target.name,e.target.value),function(){this.find10MinBBBlast()})},a.onChangeQty=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.startSearching=function(){console.log("Starting the search");var e=rt("9:15am","h:mma"),t=rt("3:30pm","h:mma"),n=rt(new Date,"h:mma");if(rt().isoWeekday()<=5&&n.isBetween(e,t)){var l=6e4;a.state.totalStockToWatch>180&&(l=333*a.state.totalStockToWatch),a.setState({findlast5minMovementInterval:setInterval(function(){a.findlast5minMovement()},l)})}},a.getTimeFrameValue=function(e){switch(e){case"ONE_MINUTE":return(new Date).toLocaleTimeString()<"10:05:00"?"18:21:00":"00:21:00";case"FIVE_MINUTE":return(new Date).toLocaleTimeString()<"11:00:00"?"19:41:00":"01:41:00";case"TEN_MINUTE":return(new Date).toLocaleTimeString()<"12:35:00"?"21:21:00":"03:21:00";case"FIFTEEN_MINUTE":return(new Date).toLocaleTimeString()<"14:15:00"?"23:01:00":"05:01:00";case"THIRTY_MINUTE":return"84:01:00";case"ONE_HOUR":return"168:01:00";case"ONE_DAY":return"744:01:00"}},a.updateToLocalStorage=function(e){var t=new Date(e.foundAt).toLocaleString(),n=a.state.fastMovementList.filter(function(a){return a.token==e.token&&a.foundAt==t});if(console.log("isfound",n),n.length)return!1;var l={token:e.token,foundAt:t,ltp:e.ltp,symbol:e.symbol,nc:e.perChange.toFixed(2),orderType:e.orderType};return a.state.fastMovementList.push(l),localStorage.setItem("fastMovementList",JSON.stringify(a.state.fastMovementList)),!0},a.find10MinBBBlast=Object(ae.a)(ee.a.mark(function e(){var t,n,l,r,o,i,s;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({findlast5minMovementUpdate:"",findlast5minMovement:[]}),t=a.state.staticData[a.state.selectedWatchlist],"selectall"==a.state.selectedWatchlist&&(t=localStorage.getItem("watchList")&&JSON.parse(localStorage.getItem("watchList"))),a.setState({totalStockToWatch:t.length}),n=[],l=ee.a.mark(function e(l){var r;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({findlast5minMovementUpdate:l+1+". "+t[l].symbol+" At "+(new Date).toLocaleTimeString()+" Scaning"}),r="YYYY-MM-DD HH:mm",rt("9:15am","h:mma").format(r),a.getTimeFrameValue(a.state.timeFrame),o=rt.duration("100:00:00"),i=rt(new Date).subtract(o),s={exchange:t[l].exch_seg,symboltoken:t[l].token,interval:a.state.timeFrame,fromdate:rt(i).format(r),todate:rt(new Date).format(r)},T.getHistoryData(s).then(function(e){var r=K(e,"noPop");if(r&&r.data&&r.data.length){var o=r.data,i=[],s=[],c=[],m=[],g=[],u=[],d=[],h=[],p=[];o.forEach(function(e,t){i.push([e[0],e[1],e[2],e[3],e[4]]);new Date(e[0]).getFullYear(),new Date(e[0]).getMonth(),new Date(e[0]).getDate();s.push({x:new Date(e[0]).getTime(),y:(e[2]+e[3]+e[4])/3}),c.push([e[5],(e[2]+e[3]+e[4])/3]),m.push(e[4]),g.push(e[2]),u.push(e[3]),d.push(e[3]),h.push(e[5]),p.push((e[2]+e[3]+e[4])/3)});Dt.a.calculate({period:20,values:m});var f={values:m,period:14},y=ot.a.calculate(f),b={period:20,values:p,stdDev:2},E=it.a.calculate(b),S=E[E.length-1];S&&(S.upper=S.upper.toFixed(2),S.middle=S.middle.toFixed(2),S.lower=S.lower.toFixed(2));var v={exchange:"NSE",tradingsymbol:t[l].symbol,symboltoken:t[l].token};T.getLTP(v).then(function(e){var r=K(e,"noPop"),m=r&&r.data;if(m&&m.ltp){y=y.slice(y.length-6,y.length),a.setState({findlast5minMovementUpdate:l+1+". "+t[l].symbol+" At "+(new Date).toLocaleTimeString()+" Searching"});if("BBStrongBreakout"==a.state.BBBlastType)if(S&&m.ltp>=S.upper&&o[o.length-1][2]==o[o.length-1][4]){var g=100*(m.ltp-m.close)/m.close,u={symbol:t[l].symbol,token:t[l].token,ltp:m.ltp,perChange:g,RSIValue:y[y.length-1],RSI:y,VWAP:ct()(c),BB:S,candleChartData:i,lightcandleChartData:s,foundAt:o&&o[o.length-1][0],orderType:"BUY",name:t[l].name};a.updateToLocalStorage(u)&&(n.push(u),a.setState({findlast5minMovement:n}),a.speckIt(t[l].symbol+" BB  buy"),window.document.title="FM2: Buy "+t[l].symbol,a.setState({findlast5minMovementUpdate:l+1+". "+t[l].symbol+" At "+(new Date).toLocaleTimeString()+" BUY Eligible"}))}else if(S&&m.ltp<=S.lower&&o[o.length-1][3]==o[o.length-1][4]){g=100*(m.ltp-m.close)/m.close;var d={symbol:t[l].symbol,token:t[l].token,ltp:m.ltp,perChange:g,RSIValue:y[y.length-1],RSI:y,VWAP:ct()(c),BB:S,candleChartData:i,lightcandleChartData:s,foundAt:o&&o[o.length-1][0],orderType:"SELL",name:t[l].name};a.updateToLocalStorage(d)&&(n.push(d),a.setState({findlast5minMovement:n}),a.speckIt(t[l].symbol+" BB sell"),window.document.title="FM2: Sell "+t[l].symbol,a.setState({findlast5minMovementUpdate:l+1+". "+t[l].symbol+" At "+(new Date).toLocaleTimeString()+" SELL Eligible"}))}else a.setState({findlast5minMovementUpdate:l+1+". "+t[l].symbol+" At "+(new Date).toLocaleTimeString()+" Not Eligible"})}})}else console.log(t[l].symbol,"  emply candle found")}),e.next=10,new Promise(function(e){return setTimeout(e,600)});case 10:case"end":return e.stop()}},e)}),r=0;case 7:if(!(r<t.length)){e.next=12;break}return e.delegateYield(l(r),"t0",9);case 9:r++,e.next=7;break;case 12:case"end":return e.stop()}},e)})),a.findlast5minMovement=Object(ae.a)(ee.a.mark(function e(){var t,n,l,r,o,i,s,c;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.setState({findlast5minMovementUpdate:""}),t=rt.duration("00:05:00"),"YYYY-MM-DD HH:mm",n=rt(new Date).subtract(t),l=a.state.staticData[a.state.selectedWatchlist],"selectall"==a.state.selectedWatchlist&&(l=localStorage.getItem("watchList")&&JSON.parse(localStorage.getItem("watchList"))),console.log("watchList",a.state.selectedWatchlist,l),a.setState({totalStockToWatch:l.length}),r=[],!l||!l.length){e.next=17;break}o=ee.a.mark(function e(t){var o;return ee.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=l[t],s={exchange:"NSE",symboltoken:o.token,interval:"ONE_MINUTE",fromdate:rt(n).format("YYYY-MM-DD HH:mm"),todate:rt(new Date).format("YYYY-MM-DD HH:mm")},c=t+1+". "+o.symbol,a.setState({findlast5minMovementUpdate:c}),window.document.title="FM: "+c,T.getHistoryData(s).then(function(e){var n=K(e,"noPop");if(n&&n.data&&n.data.length){var o=[];n.data.forEach(function(e){var t=100*(e[4]-e[1])/e[1];t>=.3&&(1,o.push("<span style='color:green'>"+t.toFixed(2)+"% At "+new Date(e[0]).toLocaleTimeString().substr(0,5)+"</span>")),t<=-.3&&(1,o.push("<span style='color:red'>"+t.toFixed(2)+"% At "+new Date(e[0]).toLocaleTimeString().substr(0,5)+"</span>"))});var i=[];if(n.data.forEach(function(e){i.push([e[0],e[1],e[2],e[3],e[4]])}),o.length){var s={exchange:"NSE",tradingsymbol:l[t].symbol,symboltoken:l[t].token};T.getLTP(s).then(function(e){var n=K(e,"noPop"),s=n&&n.data;if(s&&s.ltp){var c=100*(s.ltp-s.close)/s.close;r.push({symbol:l[t].symbol,ltp:s.ltp,perChange:c,percentChangeList:o.join(" | "),candleChartData:i}),console.log("foundData",r),a.setState({findlast5minMovement:r})}})}}else console.log(" candle data emply")}),e.next=8,new Promise(function(e){return setTimeout(e,333)});case 8:case"end":return e.stop()}},e)}),i=0;case 12:if(!(i<l.length)){e.next=17;break}return e.delegateYield(o(i),"t0",14);case 14:i++,e.next=12;break;case 17:case"end":return e.stop()}},e)})),a.callbackAfterOrderDone=function(e){console.log("order executed",e)},a.handleClick=function(e,t,n){if(console.log(e),e.token&&e.symbol){if("BUY"==t){a.setState(Object(y.a)({},n,!0));var l={token:e.token,symbol:e.symbol,qtyToTake:a.state.qtyToTake};console.log(l),mt.historyWiseOrderPlace(l,"BUY","no",a.callbackAfterOrderDone),a.setState(Object(y.a)({},n,!1))}if("SELL"==t){a.setState(Object(y.a)({},n,!0));l={token:e.token,symbol:e.symbol,qtyToTake:a.state.qtyToTake};console.log(l),mt.historyWiseOrderPlace(l,"SELL","no",a.callbackAfterOrderDone),a.setState(Object(y.a)({},n,!1))}}else G.showError(" Symbol Not found!!!")},a.state={staticData:localStorage.getItem("staticData")&&JSON.parse(localStorage.getItem("staticData"))||{},totalWatchlist:localStorage.getItem("totalWatchlist")&&JSON.parse(localStorage.getItem("totalWatchlist"))||[],selectedWatchlist:"NIFTY 50",totalStockToWatch:0,timeFrame:"FIFTEEN_MINUTE",chartStaticData:[],BBBlastType:"BBStrongBreakout",qtyToTake:"",fastMovementList:localStorage.getItem("fastMovementList")&&JSON.parse(localStorage.getItem("fastMovementList"))||[]},a.findlast5minMovement=a.findlast5minMovement.bind(Object(k.a)(a)),a.startSearching=a.startSearching.bind(Object(k.a)(a)),a}return Object(w.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){var e=this;window.document.title="FM2";var t=this.state.staticData[this.state.selectedWatchlist];this.setState({totalStockToWatch:t.length});var a=rt("9:15am","h:mma"),n=rt("3:30pm","h:mma"),l=rt(new Date,"h:mma"),r=rt().isoWeekday(),o=setInterval(function(){var t=new Date;console.log("set interval 1sec min/10==0 ",t.toLocaleTimeString()),t.getMinutes()%2===0&&(console.log("search method call in with setTimeout 70sec",t.toLocaleTimeString()),setTimeout(function(){e.find10MinBBBlast()},7e4),e.setState({stop10bbSearch:setInterval(function(){console.log("search method call in with setInterval in 10min",t.toLocaleTimeString()),r<=5&&l.isBetween(a,n)&&e.find10MinBBBlast()},19e4)}),clearInterval(o))},1e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.state.findlast5minMovementInterval),clearInterval(this.state.stop10bbSearch)}},{key:"render",value:function(){var e=this;return l.a.createElement(l.a.Fragment,null,l.a.createElement(ht,null),l.a.createElement("br",null),l.a.createElement(tt,null)," ",l.a.createElement(ka,null),l.a.createElement(M.a,{justify:"space-between",container:!0,spacing:1},l.a.createElement(M.a,{item:!0,xs:12,sm:4},l.a.createElement(W.a,{component:"h2",variant:"h6",color:"primary",gutterBottom:!0},"\xa0BB Blast (",this.state.findlast5minMovement&&this.state.findlast5minMovement.length,")",l.a.createElement("span",{id:"stockTesting",style:{fontSize:"18px",color:"gray"}}," ",this.state.findlast5minMovementUpdate," "))),l.a.createElement(M.a,{item:!0,xs:12,sm:2},l.a.createElement(kt.a,{style:Ja.selectStyle},l.a.createElement(A.a,{htmlFor:"gender"},"Select Watchlist"),l.a.createElement(wt.a,{value:this.state.selectedWatchlist,name:"selectedWatchlist",onChange:this.onChangeWatchlist},l.a.createElement(Ct.a,{value:"selectall"},"Select All"),this.state.totalWatchlist&&this.state.totalWatchlist.map(function(e){return l.a.createElement(Ct.a,{value:e},e)})))),l.a.createElement(M.a,{item:!0,xs:12,sm:1},l.a.createElement(kt.a,{style:Ja.selectStyle},l.a.createElement(A.a,{htmlFor:"gender"},"Select Time"),l.a.createElement(wt.a,{value:this.state.timeFrame,name:"timeFrame",onChange:this.onChangeWatchlist},l.a.createElement(Ct.a,{value:"ONE_MINUTE"},"1 Min"),l.a.createElement(Ct.a,{value:"FIVE_MINUTE"},"5 Min"),l.a.createElement(Ct.a,{value:"TEN_MINUTE"},"10 Min"),l.a.createElement(Ct.a,{value:"FIFTEEN_MINUTE"},"15 Min"),l.a.createElement(Ct.a,{value:"THIRTY_MINUTE"},"30 Min"),l.a.createElement(Ct.a,{value:"ONE_HOUR"},"1 Hour"),l.a.createElement(Ct.a,{value:"ONE_DAY"},"1 Day")))),l.a.createElement(M.a,{item:!0,xs:12,sm:1},l.a.createElement(kt.a,{style:Ja.selectStyle},l.a.createElement(A.a,{htmlFor:"gender"},"Select Time"),l.a.createElement(wt.a,{value:this.state.BBBlastType,name:"BBBlastType",onChange:this.onChangeWatchlist},l.a.createElement(Ct.a,{value:"BBStrongBreakout"},"BB Strong Breakout")))),l.a.createElement(M.a,{item:!0,xs:12,sm:4},l.a.createElement(B.a,{variant:"contained",style:{marginRight:"20px"},onClick:function(){return e.find10MinBBBlast()}},"Start"),l.a.createElement(B.a,{variant:"contained",style:{marginRight:"20px"},onClick:function(){return e.stopSearching()}},"Stop"))),l.a.createElement(M.a,{container:!0,spacing:2},this.state.findlast5minMovement?this.state.findlast5minMovement.map(function(t,a){return l.a.createElement(M.a,{item:!0,xs:12,sm:3},l.a.createElement(Et.a,{style:{overflow:"auto",padding:"10px"}},l.a.createElement(W.a,{style:{color:t.perChange>0?"green":"red"}}," ",t.symbol," ",t.ltp," ",l.a.createElement("b",null,"(",t.perChange.toFixed(2),"%) ")),t.candleChartData.length>0?l.a.createElement(Ke.a,{options:{chart:{type:"candlestick",height:250},title:{text:"",align:"left"},xaxis:{type:"datetime"},yaxis:{tooltip:{enabled:!0}}},series:[{data:t.candleChartData.slice(Math.max(t.candleChartData.length-10,1))}],type:"candlestick",width:350,height:250}):"",l.a.createElement(M.a,{direction:"row",style:{padding:"5px"},container:!0,className:"flexGrow",justify:"space-between"},t.DSMALastValue?l.a.createElement(M.a,{item:!0,xs:12,sm:12,style:{color:t.ltp>t.DSMALastValue?"green":"red",fontWeight:"bold"}},"Daily SMA: ",t.DSMALastValue," ",t.ltp>t.DSMALastValue?"BUY":"SELL"):"",l.a.createElement(M.a,{item:!0,xs:12,sm:12,style:{color:t.ltp>t.VWAP?"green":"red",fontWeight:"bold"}},"VWAP:  ",t.VWAP),l.a.createElement(M.a,{item:!0,xs:12,sm:12},"RSI: ",t.RSI.map(function(e,t){return e>=60?l.a.createElement("span",{style:{color:"green",fontWeight:"bold"}}," ",e," \xa0"):l.a.createElement("span",{style:{color:e<=40?"red":"",fontWeight:"bold"}}," ",e," \xa0")})),l.a.createElement(M.a,{item:!0,xs:12,sm:12},"BB \xa0 ",l.a.createElement("span",{style:{color:t.ltp>=t.BB.upper?"green":"",fontWeight:"bold"}},"Upper: ",t.BB.upper),"\xa0 Middle: ",t.BB.middle,"\xa0 ",l.a.createElement("span",{style:{color:t.ltp<=t.BB.lower?"red":"",fontWeight:"bold"}}," Lower: ",t.BB.lower))),l.a.createElement(M.a,{direction:"row",style:{padding:"5px"},container:!0,className:"flexGrow",justify:"space-between"},l.a.createElement(M.a,{item:!0},e.state["buyButtonClicked"+t.symbol+a]?l.a.createElement(ut.a,null):l.a.createElement(B.a,{size:"small",variant:"contained",color:"primary",onClick:function(){return e.handleClick(t,"BUY","buyButtonClicked"+t.symbol+a)}},"BUY")),l.a.createElement(M.a,{item:!0},l.a.createElement(Y.a,{label:"Qty",type:"number",name:"qtyToTake",value:e.state.qtyToTake,onChange:e.onChangeQty})),l.a.createElement(M.a,{item:!0},e.state["sellButtonClicked"+t.symbol+a]?l.a.createElement(ut.a,null):l.a.createElement(B.a,{size:"small",variant:"contained",color:"Secondary",onClick:function(){return e.handleClick(t,"SELL","sellButtonClicked"+t.symbol+a)}},"SELL")))))}):""))}}]),t}(l.a.Component),Ja={formContainer:{display:"flex",flexFlow:"row wrap"},textStyle:{display:"flex",justifyContent:"center"},imgStyle:{display:"flex"},selectStyle:{minWidth:"100%",marginBottom:"10px"},MuiTextField:{overflowY:"scroll",fontSize:"12px",maxHeight:"50px"},footerButton:{position:"fixed",left:0,bottom:"20px",width:"100%",textAlign:"right"}},_a=Ua,qa=function(){return l.a.createElement(l.a.Fragment,null,l.a.createElement(p.a,null,l.a.createElement(f.c,null,l.a.createElement(f.a,{path:"/",exact:!0,component:Z}),l.a.createElement(f.a,{path:"/login",component:Z}),l.a.createElement(f.a,{path:"/nifty-view",component:Kt}),l.a.createElement(f.a,{path:"/bn-view",component:ea}),l.a.createElement(f.a,{path:"/sector",component:oa}),l.a.createElement(f.a,{path:"/chart",component:Qt}),l.a.createElement(f.a,{path:"/candle-chart",component:ca}),l.a.createElement(f.a,{path:"/home",component:Wt}),l.a.createElement(f.a,{path:"/funds",component:ga}),l.a.createElement(f.a,{path:"/order",component:ua}),l.a.createElement(f.a,{path:"/trade",component:da}),l.a.createElement(f.a,{path:"/order-status-live",component:pa}),l.a.createElement(f.a,{path:"/position",component:La}),l.a.createElement(f.a,{path:"/addtowatchlist",component:Ta}),l.a.createElement(f.a,{path:"/sector-heat-map",component:Na}),l.a.createElement(f.a,{path:"/sector-heat-map2",component:ja}),l.a.createElement(f.a,{path:"/find-fast-movement",component:Wa}),l.a.createElement(f.a,{path:"/find-fast-movement2",component:_a}),l.a.createElement(f.a,{path:"/order-watchlist",component:ba}),l.a.createElement(f.a,{path:"/test",component:xa}),l.a.createElement(f.a,{path:"*",component:Z}))))};a(420);var za=function(){return l.a.createElement(l.a.Fragment,null,l.a.createElement(qa,null),l.a.createElement(z.a,null))};o.a.render(l.a.createElement(i.a,{store:h},l.a.createElement(za,null)),document.querySelector("#root"))},77:function(e,t,a){}},[[260,1,2]]]);
//# sourceMappingURL=main.a081fde0.chunk.js.map