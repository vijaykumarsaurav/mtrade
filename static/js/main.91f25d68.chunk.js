(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{112:function(e,t,a){},123:function(e,t,a){e.exports=a.p+"static/media/mylogo.92bbdbd4.png"},256:function(e,t,a){e.exports=a(423)},261:function(e,t,a){},265:function(e,t,a){},31:function(e){e.exports={monthlyTargetPer:5,dailyLossPer:1,totalCapital:1e5,perTradeExposurePer:10,perTradeStopLossPer:1}},423:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(23),l=a.n(o),s=(a(261),a(74)),i=a(93),c=a(215),m=a(49),g={packs:[],pack:[],updatedPack:null},d=Object(i.b)({packs:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET PACK LOADED":return Object(m.a)({},e,{packs:t.payload});case"EDIT PACK INFO":return Object(m.a)({},e,{updatedPack:t.payload});case"GET_PACK_INFO_BY_ID":return Object(m.a)({},e,{pack:t.payload});default:return e}}}),u=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||i.c,h=Object(i.d)(d,u(Object(i.a)(c.a))),p=(a(265),a(138)),f=a(27),y=a(15),b=a(9),E=a(7),S=a(13),v=a(11),k=a(28),w=a(14),x=a(25),L=a.n(x),T=new(function(){function e(){Object(b.a)(this,e)}return Object(E.a)(e,[{key:"getLoggedInUserInfo",value:function(){localStorage.getItem("UserInfo")}},{key:"getHeader",value:function(){var e=JSON.parse(localStorage.getItem("userTokens"));return{headers:{Authorization:"Bearer "+(e&&e.jwtToken),"Content-Type":"application/json",Accept:"application/json","X-UserType":"USER","X-SourceID":"WEB","X-ClientLocalIP":"192.168.1.128","X-ClientPublicIP":"91.0.4472.114","X-MACAddress":"f0:18:98:26:c4:cc","X-PrivateKey":"I4O6PJAn"}}}},{key:"loginHeader",value:function(){return{headers:{"Content-Type":"application/json",Accept:"application/json","X-UserType":"USER","X-SourceID":"WEB","X-ClientLocalIP":"192.168.1.128","X-ClientPublicIP":"91.0.4472.114","X-MACAddress":"f0:18:98:26:c4:cc","X-PrivateKey":"I4O6PJAn"}}}},{key:"getImageHeader",value:function(){return{headers:{token:localStorage.getItem("token")}}}},{key:"getScannerHeader",value:function(){return{headers:{"Content-Type":"application/json",Accept:"application/json"}}}}]),e}()),P="I4O6PJAn",C=new(function(){function e(){Object(b.a)(this,e)}return Object(E.a)(e,[{key:"login",value:function(e){return L.a.post("https://apiconnect.angelbroking.com/rest/auth/angelbroking/user/v1/loginByPassword",e,T.loginHeader())}},{key:"logout",value:function(e){return L.a.post("https://apiconnect.angelbroking.com/rest/secure/angelbroking/user/v1/logout",e,T.getHeader())}},{key:"getUserData",value:function(e){return L.a.get("https://apiconnect.angelbroking.com/rest/secure/angelbroking/user/v1/getProfile",T.getHeader())}},{key:"getFunds",value:function(e){return L.a.get("https://apiconnect.angelbroking.com/rest/secure/angelbroking/user/v1/getRMS",T.getHeader())}},{key:"retrieveOrderBook",value:function(e){return L.a.get("https://apiconnect.angelbroking.com/rest/secure/angelbroking/order/v1/getOrderBook",T.getHeader())}},{key:"retrieveTradeBook",value:function(e){return L.a.get("https://apiconnect.angelbroking.com/rest/secure/angelbroking/order/v1/getTradeBook",T.getHeader())}},{key:"retrieveallTradableInstruments",value:function(e){return L.a.get("https://margincalculator.angelbroking.com/OpenAPI_File/files/OpenAPIScripMaster.json","")}},{key:"placeOrder",value:function(e){return L.a.post("https://apiconnect.angelbroking.com/rest/secure/angelbroking/order/v1/placeOrder",e,T.getHeader())}},{key:"modifyOrder",value:function(e){return L.a.post("https://apiconnect.angelbroking.com/rest/secure/angelbroking/order/v1/modifyOrder",e,T.getHeader())}},{key:"cancelOrder",value:function(e){return L.a.post("https://apiconnect.angelbroking.com/rest/secure/angelbroking/order/v1/cancelOrder",e,T.getHeader())}},{key:"getLTP",value:function(e){return L.a.post("https://apiconnect.angelbroking.com/rest/secure/angelbroking/order/v1/getLtpData",e,T.getHeader())}},{key:"getHistoryData",value:function(e){return L.a.post("https://apiconnect.angelbroking.com/rest/secure/angelbroking/historical/v1/getCandleData",e,T.getHeader())}},{key:"scanStocks",value:function(e){return L.a.post("https://chartink.com/screener/process",e,T.getScannerHeader())}},{key:"autoCompleteSearch",value:function(e){return L.a.get("http://localhost:8081/search/"+e,"")}},{key:"saveWatchList",value:function(e){return L.a.get("http://localhost:8081/saveWatchList/"+e,"")}},{key:"addIntoStaticData",value:function(e){return L.a.post("http://localhost:8081/addIntoStaticData",e,"")}},{key:"saveWatchListJSON",value:function(e){return L.a.post("http://localhost:8081/saveWatchListJSON",e,"")}},{key:"getWatchListJSON",value:function(){return L.a.get("/myJsonWatchList.json","")}},{key:"getStaticData",value:function(){return"vijaykumarsaurav.github.io"==window.location.hostname?L.a.get("/mtrade/staticData.json",""):L.a.get("/staticData.json","")}},{key:"saveCandleHistory",value:function(e){return L.a.post("http://localhost:8081/saveCandleHistory",e,"")}},{key:"getPosition",value:function(e){return L.a.get("https://apiconnect.angelbroking.com/rest/secure/angelbroking/order/v1/getPosition",T.getHeader())}},{key:"getAutoScanStock",value:function(){return L.a.get("http://localhost:8081/getScannedStocks","")}},{key:"getNSETopStock",value:function(){return L.a.get("http://localhost:8081/getNseTopStocks","")}},{key:"getSelectedStockFromDb",value:function(){return L.a.get("http://localhost:8081/getSelectedStock","")}}]),e}()),D=a(462),O=a(465),I=a(123),N=a.n(I),F=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(D.a,{position:"static"},r.a.createElement(O.a,null,r.a.createElement("img",{alt:"logo",style:{width:"190px"},src:N.a}))))},A=a(475),H=a(500),M=a(474),j=a(468),Y=a(499),R=a(216),B=a.n(R),q=a(501),J=a(94),_=a(466),z=a(467),W=Object(_.a)(function(e){return{"@global":{body:{backgroundColor:e.palette.common.white}},paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:"#df0915"},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}});function U(e){var t=W(),a=function(t){e.loginProps.onChange(t)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(z.a,{component:"main",maxWidth:"xs"},r.a.createElement(j.a,null),r.a.createElement("div",{className:t.paper},r.a.createElement(q.a,{className:t.avatar},r.a.createElement(B.a,null)),r.a.createElement(J.a,{component:"h1",variant:"h5"},"Sign in"),r.a.createElement("form",{className:t.form,noValidate:!0},r.a.createElement(Y.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"email",label:"User Id",name:"userName",autoComplete:"email",autoFocus:!0,onChange:a,value:e.loginProps.userName}),r.a.createElement(Y.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",autoComplete:"current-password",onChange:a,value:e.loginProps.password}),r.a.createElement(M.a,{type:"button",fullWidth:!0,variant:"contained",color:"primary",className:t.submit,onClick:e.loginProps.login},"Sign In")))))}var V=a(85),K=new(function(){function e(){Object(b.a)(this,e)}return Object(E.a)(e,[{key:"showError",value:function(e){V.b.error(e,this.options())}},{key:"showSuccess",value:function(e){V.b.success(e,this.options())}},{key:"showWarning",value:function(e){V.b.warn(e,this.options())}},{key:"options",value:function(){return{position:V.b.POSITION.BOTTOM_RIGHT,autoClose:2e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!0}}}]),e}());function X(e,t){var a={};if(200===e.status)return(a=e.data).status?(a.message&&"noPop"!==t&&K.showSuccess(a.message),a):(K.showError(a.message),"Invalid Token"===a.message&&(window.location.replace("#/login"),localStorage.setItem("userTokens",""),localStorage.setItem("userProfile","")),Promise.reject(a.message));e&&!e.status&&K.showError(a.message)}var G=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(S.a)(this,Object(v.a)(t).call(this,e))).onChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value.trim()))},a.login=function(e){if(a.setState({isError:""}),e.preventDefault(),a.state.userName||a.state.password)if(a.state.userName)if(a.state.password){a.setState({isDasable:!0});var t={clientcode:a.state.userName,password:a.state.password};C.login(t).then(function(e){X(e);(e=e&&e.data).status&&"SUCCESS"!==e.message&&a.setState({isError:e.message}),a.setState({isDasable:!1}),e.data&&(window.localStorage.setItem("userTokens",JSON.stringify(e.data)),C.getUserData().then(function(e){X(e);(e=e&&e.data).status&"SUCCESS"===e.message&&(window.localStorage.setItem("userProfile",JSON.stringify(e.data)),window.location.replace("#/home"))}))})}else a.setState({isError:"Password is required."});else a.setState({isError:"Olms Id is required."});else a.setState({isError:"Olms Id and Password are required."})},a.state={userName:"V193588",password:"",isDasable:!1,isError:!1},a.login=a.login.bind(Object(k.a)(a)),a}return Object(w.a)(t,e),Object(E.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(F,null),r.a.createElement(U,{loginProps:{onChange:this.onChange,login:this.login,userName:this.state.userName,password:this.state.password}}),r.a.createElement(A.a,{container:!0,justify:"space-around"},r.a.createElement(A.a,{justify:"center",container:!0,xs:12,sm:10},this.state.isDasable?r.a.createElement(H.a,{variant:"subtitle1",style:Q.waitMessage}," Please wait..."):"",this.state.isError?r.a.createElement(H.a,{variant:"subtitle1",style:Q.errorMessage}," ",this.state.isError," "):"")))}},{key:"componentDidMount",value:function(){window.localStorage.getItem("userTokens")&&this.props.history.push("home")}}]),t}(r.a.Component),Q={formStyle:{display:"flex",flexFlow:"row wrap"},label:{display:"flex",justifyContent:"center"},errorMessage:{color:"red",marginTop:"11px"},waitMessage:{color:"gray",marginTop:"11px"}},Z=G,$=a(21),ee=a(12),te=a.n(ee),ae=a(30),ne=a(22),re=a(2),oe=a(36),le=a(502),se=a(473),ie=a(489),ce=a(480),me=a(222),ge=a.n(me),de=a(223),ue=a.n(de),he=a(224),pe=a.n(he),fe=a(424),ye=a(476),be=a(477),Ee=a(221),Se=a.n(Ee),ve=a(140),ke=a.n(ve),we=a(79),xe=a.n(we),Le=r.a.createElement("div",null,r.a.createElement(fe.a,{button:!0,component:"a",href:"/mtrade/#/livefeed"},r.a.createElement(ye.a,null,r.a.createElement(ke.a,null)),r.a.createElement(be.a,{primary:"Live Feed"})),r.a.createElement(fe.a,{button:!0,component:"a",href:"/mtrade/#/position"},r.a.createElement(ye.a,null,r.a.createElement(ke.a,null)),r.a.createElement(be.a,{primary:"Positions"})),r.a.createElement(fe.a,{button:!0,component:"a",href:"/mtrade/#/funds"},r.a.createElement(ye.a,null,r.a.createElement(xe.a,null)),r.a.createElement(be.a,{primary:"Funds"})),r.a.createElement(fe.a,{button:!0,component:"a",href:"/mtrade/#/order"},r.a.createElement(ye.a,null,r.a.createElement(xe.a,null)),r.a.createElement(be.a,{primary:"Order Book"})),r.a.createElement(fe.a,{button:!0,component:"a",href:"/mtrade/#/trade"},r.a.createElement(ye.a,null,r.a.createElement(xe.a,null)),r.a.createElement(be.a,{primary:"Trade Book"})),r.a.createElement(fe.a,{button:!0,component:"a",href:"/mtrade/#/bn-view"},r.a.createElement(ye.a,null,r.a.createElement(ke.a,null)),r.a.createElement(be.a,{primary:"NiftyBank View"})),r.a.createElement(fe.a,{button:!0,component:"a",href:"/mtrade/#/nifty-view"},r.a.createElement(ye.a,null,r.a.createElement(xe.a,null)),r.a.createElement(be.a,{primary:"Nifty View"})),r.a.createElement(fe.a,{button:!0,component:"a",href:"/mtrade/#/sector"},r.a.createElement(ye.a,null,r.a.createElement(xe.a,null)),r.a.createElement(be.a,{primary:"Sector Top"})),r.a.createElement(fe.a,{button:!0,component:"a",href:"/mtrade/#/test"},r.a.createElement(ye.a,null,r.a.createElement(xe.a,null)),r.a.createElement(be.a,{primary:"Exprement - Research"})),r.a.createElement(fe.a,{button:!0,component:"a",href:"/mtrade/#/addtowatchlist"},r.a.createElement(ye.a,null,r.a.createElement(xe.a,null)),r.a.createElement(be.a,{primary:"Watchlist ("+(localStorage.getItem("watchList")&&JSON.parse(localStorage.getItem("watchList")).length)+")"})));var Te=r.a.createElement("div",null,r.a.createElement(p.b,{to:"",style:{textDecoration:"none"},onClick:function(){if(window.confirm("Are you sure to logout?")){var e=localStorage.getItem("userProfile"),t={clientcode:(e=e&&JSON.parse(e))&&e.clientcode};C.logout(t).then(function(e){localStorage.clear(),function(){for(var e=document.cookie.split(";"),t=0;t<e.length;t++){var a=e[t],n=a.indexOf("="),r=n>-1?a.substr(0,n):a;document.cookie=r+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT"}}(),window.location.replace("#/login")})}}},r.a.createElement(fe.a,{button:!0},r.a.createElement(ye.a,null,r.a.createElement(Se.a,null)),r.a.createElement(be.a,{primary:"Logout"})))),Pe=a(504),Ce=a(479),De=a(478),Oe=Object(_.a)(function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}});function Ie(){var e=Oe(),t=r.a.useState(!0),a=Object(ne.a)(t,2),n=a[0],o=a[1];return r.a.createElement("div",{className:e.root},r.a.createElement(De.a,null,r.a.createElement(Ce.a,{control:r.a.createElement(Pe.a,{checked:n,onChange:function(e){localStorage.setItem("invertColorFlag",e.target.checked),o(e.target.checked)},"aria-label":"login switch"}),label:n?"Black & White":"Colorfull"})))}var Ne=a(18),Fe=a(6),Ae=a(484),He=a(481),Me=a(482),je=a(483),Ye=a(72),Re=a.n(Ye),Be=a(485),qe=a(486),Je=a(487),_e=a(488),ze=a(92),We=a.n(ze),Ue=(a(186),Object(Fe.a)(function(e){return{root:{margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}})(function(e){var t=e.children,a=e.classes,n=e.onClose,o=Object(Ne.a)(e,["children","classes","onClose"]);return r.a.createElement(He.a,Object.assign({disableTypography:!0,className:a.root},o),r.a.createElement(J.a,{variant:"h6"},t),n?r.a.createElement(ce.a,{"aria-label":"close",className:a.closeButton,onClick:n},r.a.createElement(Re.a,null)):null)})),Ve=Object(Fe.a)(function(e){return{root:{padding:e.spacing(2)}}})(Me.a),Ke=Object(Fe.a)(function(e){return{root:{margin:0,padding:e.spacing(1)}}})(je.a);function Xe(e){var t=r.a.useState(!1),a=Object(ne.a)(t,2),n=a[0],o=a[1],l=r.a.useState({data:[],candledata:{}}),s=Object(ne.a)(l,2),i=(s[0],s[1],function(){o(!1)});return r.a.createElement("div",null,r.a.createElement(M.a,{variant:"outlined",id:"showCandleChart",color:"primary",style:{display:"none"},onClick:function(){o(!0)}},"Chart"),r.a.createElement(Ae.a,{onClose:i,"aria-labelledby":"customized-dialog-title",open:n},r.a.createElement(Ue,{id:"customized-dialog-title",onClose:i},localStorage.getItem("cadleChartSymbol"),r.a.createElement("br",null),r.a.createElement("span",{style:{fontSize:"12px"}},r.a.createElement("b",null,"FoundAt:"),"  ",localStorage.getItem("chartInfoDetails")&&JSON.parse(localStorage.getItem("chartInfoDetails")).foundAt.substr(0,16)," \xa0\xa0",r.a.createElement("b",null,"Buy: "),localStorage.getItem("chartInfoDetails")&&JSON.parse(localStorage.getItem("chartInfoDetails")).buyExitPrice," \xa0\xa0",r.a.createElement("b",null,"Sell: "),localStorage.getItem("chartInfoDetails")&&JSON.parse(localStorage.getItem("chartInfoDetails")).sellEntyPrice," \xa0\xa0",r.a.createElement("b",null,"Change %: "),"  ",localStorage.getItem("chartInfoDetails")&&JSON.parse(localStorage.getItem("chartInfoDetails")).perChange," \xa0\xa0    ",r.a.createElement("br",null),r.a.createElement("b",null,"Change on High/Low %: "),localStorage.getItem("chartInfoDetails")&&JSON.parse(localStorage.getItem("chartInfoDetails")).perChange," \xa0\xa0",r.a.createElement("b",null,"SquareOffAt:"),localStorage.getItem("chartInfoDetails")&&JSON.parse(localStorage.getItem("chartInfoDetails")).squareOffAt)),r.a.createElement(Ve,{dividers:!0,id:"chart"},r.a.createElement(We.a,{options:{chart:{type:"candlestick",height:350},title:{text:"",align:"left"},xaxis:{type:"datetime"},yaxis:{tooltip:{enabled:!0}}},series:[{data:JSON.parse(localStorage.getItem("candleChartData"))}],type:"candlestick",width:500,height:350}),r.a.createElement(We.a,{options:{chart:{type:"candlestick",height:350},title:{text:"",align:"left"},xaxis:{type:"datetime"},yaxis:{tooltip:{enabled:!0}}},series:[{data:JSON.parse(localStorage.getItem("candleChartDataInside"))}],type:"candlestick",width:500,height:350})),r.a.createElement(Ke,null,r.a.createElement(M.a,{autoFocus:!0,onClick:i,color:"primary"},"Close"))))}var Ge=a(78),Qe=a.n(Ge),Ze=Object(Fe.a)(function(e){return{root:{margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}})(function(e){var t=e.children,a=e.classes,n=e.onClose,o=Object(Ne.a)(e,["children","classes","onClose"]);return r.a.createElement(He.a,Object.assign({disableTypography:!0,className:a.root},o),r.a.createElement(J.a,{variant:"h6"},t),n?r.a.createElement(ce.a,{"aria-label":"close",className:a.closeButton,onClick:n},r.a.createElement(Re.a,null)):null)}),$e=Object(Fe.a)(function(e){return{root:{padding:e.spacing(2)}}})(Me.a),et=Object(Fe.a)(function(e){return{root:{margin:0,padding:e.spacing(1)}}})(je.a);function tt(e){var t=r.a.useState(!1),a=Object(ne.a)(t,2),n=a[0],o=a[1],l=localStorage.getItem("foundPatternList")&&JSON.parse(localStorage.getItem("foundPatternList")).reverse(),s=function(){o(!1)};return r.a.createElement("div",null,r.a.createElement(M.a,{variant:"outlined",color:"primary",onClick:function(){o(!0)}},"Patterns (",l&&l.length,")"),r.a.createElement(Xe,null),r.a.createElement(Ae.a,{onClose:s,"aria-labelledby":"customized-dialog-title",open:n},r.a.createElement(Ze,{id:"customized-dialog-title",onClose:s},"Found Patterns"),r.a.createElement($e,{dividers:!0},r.a.createElement(Be.a,{stickyHeader:!0,"aria-label":"sticky table",id:"tabledata",size:"medium"},r.a.createElement(qe.a,{variant:"head"},r.a.createElement(Je.a,{align:"left"},r.a.createElement("b",null,"Sr.")),r.a.createElement(Je.a,{align:"left"},r.a.createElement("b",null,"Stock Name")),r.a.createElement(Je.a,{align:"left"},r.a.createElement("b",null,"Pattern Name")),r.a.createElement(Je.a,{align:"left"},r.a.createElement("b",null,"Time")),r.a.createElement(Je.a,{align:"left"},r.a.createElement("b",null,"BuyAt")),r.a.createElement(Je.a,{align:"left"},r.a.createElement("b",null,"SellAt"))),r.a.createElement(_e.a,null,l?l.map(function(e,t){return r.a.createElement(qe.a,{hover:!0,key:t},r.a.createElement(Je.a,{align:"left"},t," "),r.a.createElement(Je.a,{align:"left"}," ",r.a.createElement(M.a,{variant:"contained",style:{marginLeft:"20px"},onClick:function(){return t=e.candleChartData,a=e.symbol,t=t&&t.reverse(),localStorage.setItem("candleChartData",JSON.stringify(t)),localStorage.setItem("cadleChartSymbol",a),void document.getElementById("showCandleChart").click();var t,a}},e.symbol," ",r.a.createElement(Qe.a,null)," ")),r.a.createElement(Je.a,{align:"left"},e.pattenName),r.a.createElement(Je.a,{align:"left"},e.time),r.a.createElement(Je.a,{align:"left"},e.BuyAt," "),r.a.createElement(Je.a,{align:"left"},e.SellAt))}):""))),r.a.createElement(et,null,r.a.createElement(M.a,{autoFocus:!0,onClick:s,color:"primary"},"Close"))))}var at=Object(_.a)(function(e){return{root:{display:"flex"},endMenu:{display:"flex",flexDirection:"row reverse"},appBar:{transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{width:"calc(100% - ".concat(240,"px)"),marginLeft:240,transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen})},menuButton:{marginRight:e.spacing(2)},hide:{display:"none"},drawer:{width:240,flexShrink:0},drawerPaper:{width:240},drawerHeader:Object(m.a)({display:"flex",alignItems:"center",padding:"0 8px"},e.mixins.toolbar,{justifyContent:"flex-end"}),content:{flexGrow:1,padding:e.spacing(3),transition:e.transitions.create("margin",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),marginLeft:-240},contentShift:{transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginLeft:0}}});function nt(e){var t=r.a.useState({acquisitionCount:"",resubmitCount:""}),a=(Object(ne.a)(t,1)[0],at()),n=Object(oe.a)(),o=r.a.useState(!1),l=Object(ne.a)(o,2),s=l[0],i=l[1];var c=localStorage.getItem("userProfile");return c=c&&JSON.parse(c),r.a.createElement("div",{className:a.root},r.a.createElement(j.a,null),r.a.createElement(D.a,{position:"fixed",className:Object(re.a)(a.appBar,Object(y.a)({},a.appBarShift,s))},r.a.createElement(O.a,null,r.a.createElement(ce.a,{"aria-label":"open drawer",onClick:function(){i(!0)},edge:"start",className:Object(re.a)(a.menuButton,s&&a.hide)},r.a.createElement(ge.a,null)),r.a.createElement(A.a,{justify:"space-between",container:!0},r.a.createElement(A.a,{item:!0},r.a.createElement("img",{alt:"logo",style:{width:"125px"},src:N.a})),r.a.createElement(A.a,{item:!0},r.a.createElement(J.a,{variant:"h6",noWrap:!0},localStorage.getItem("BankLtpltp"))),r.a.createElement(A.a,{item:!0},r.a.createElement(A.a,{container:!0,spacing:1,direction:"row",style:{color:"white"}},r.a.createElement(A.a,{item:!0},r.a.createElement(tt,null)),r.a.createElement(A.a,{item:!0},r.a.createElement(M.a,{variant:"contained",autoFocus:!0,href:"/mtrade/#/home",color:"primary"},"Home")),r.a.createElement(A.a,{item:!0},r.a.createElement(M.a,{variant:"contained",autoFocus:!0,href:"/mtrade/#/position",color:"primary"},"Position"))))))),r.a.createElement(le.a,{className:a.drawer,variant:"persistent",anchor:"left",open:s,classes:{paper:a.drawerPaper}},r.a.createElement("div",{className:a.drawerHeader},r.a.createElement(Ie,null),c&&c.name?c.name.split(" ")[0]:null,r.a.createElement(ce.a,{onClick:function(){i(!1)}},"ltr"===n.direction?r.a.createElement(ue.a,{style:{color:"gray"}}):r.a.createElement(pe.a,{style:{color:"gray"}}))),r.a.createElement(ie.a,null),r.a.createElement(se.a,null,Le),r.a.createElement(ie.a,null),r.a.createElement(se.a,null,Te)),r.a.createElement("main",{className:Object(re.a)(a.content,Object(y.a)({},a.contentShift,s))},r.a.createElement("div",{className:a.drawerHeader})))}var rt=a(230),ot=a(225),lt=a(493);var st=function(e){var t=new Date;t.setHours(9,0,0,0),t.setMinutes(15,0,0,0);var a=r.a.useState(t),n=Object(ne.a)(a,2),o=n[0],l=n[1],s=new Date;s.setHours(15,0,0,0),s.setMinutes(30,0,0,0);var i=r.a.useState(s),c=Object(ne.a)(i,2),m=c[0],g=c[1];return r.a.createElement(ot.b,{utils:rt.a},r.a.createElement(A.a,{containers:!0},r.a.createElement(lt.a,{margin:"normal",style:{width:"140px"},id:"date-picker-dialog",label:"Start Date",format:"dd-MM-yyyy",value:o,onChange:function(t){l(t),e.callbackFromParent.myCallback(t,"START_DATE")},KeyboardButtonProps:{"aria-label":"change date"}}),r.a.createElement(lt.a,{style:{width:"140px"},margin:"normal",id:"date-picker-dialog",label:"End Date",format:"dd-MM-yyyy",value:m,onChange:function(t){g(t),e.callbackFromParent.myCallback(t,"END_DATE")},KeyboardButtonProps:{"aria-label":"change date"}})))},it=a(491),ct=a(8),mt=a(494),gt=a(471),dt=a(496),ut=a(492),ht=a(66),pt=a.n(ht),ft=a(133),yt=a(134),bt=a.n(yt),Et=a(135),St=a.n(Et),vt=a(232),kt=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(S.a)(this,Object(v.a)(t).call(this,e))).getTodayOrder=function(){C.retrieveOrderBook().then(function(e){var t=X(e,"noPop");if(t&&t.data){var n=t.data;n.sort(function(e,t){return new Date(t.updatetime)-new Date(e.updatetime)}),a.setState({oderbookData:n}),localStorage.setItem("oderbookData",JSON.stringify(n))}})},a.modifyOrder=function(e,t){console.log(a.state.triggerprice);var n={variety:e.variety,orderid:e.orderid,ordertype:0!==a.state.price?"STOPLOSS_LIMIT":"STOPLOSS_MARKET",producttype:e.producttype,duration:e.duration,price:a.state.price,triggerprice:t||a.state.triggerprice,quantity:e.lotsize,tradingsymbol:e.tradingsymbol,symboltoken:e.symboltoken,exchange:e.exchange};C.modifyOrder(n).then(function(e){var t=X(e);console.log(t),t.status&&t.message})},a.onChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value.trim()))},a.state={oderbookData:[],listofzones:[],selectedZone:[],zone:"",selectAllzone:"Select All",triggerprice:0,price:0,lotsize:0,firstTimeFlag:!0},a}return Object(w.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){this.getTodayOrder()}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,"#/position"!==window.location.hash?r.a.createElement(nt,null):"",r.a.createElement(vt.a,{style:{padding:"10px"}},r.a.createElement(A.a,{spacing:1,direction:"row",alignItems:"center",container:!0},r.a.createElement(A.a,{item:!0,xs:12,sm:6},r.a.createElement(J.a,{component:"h2",variant:"h6",color:"primary",gutterBottom:!0},"Oders Details (",this.state.oderbookData.length,")")),r.a.createElement(A.a,{item:!0,xs:12,sm:6},r.a.createElement(M.a,{id:"orderRefresh",type:"number",variant:"contained",style:{float:"right"},onClick:function(){return e.getTodayOrder()}},"Refresh"))),r.a.createElement(A.a,{direction:"row",alignItems:"center",container:!0},r.a.createElement(A.a,{item:!0,xs:12,sm:12},r.a.createElement(Be.a,{size:"small",style:{width:"100%"},"aria-label":"sticky table"},r.a.createElement(it.a,{style:{whiteSpace:"nowrap"},variant:"head"},r.a.createElement(qe.a,{variant:"head"},r.a.createElement(Je.a,{align:"center"},r.a.createElement("b",null,"Update time")),r.a.createElement(Je.a,{align:"center"},r.a.createElement("b",null,"Instrument")),r.a.createElement(Je.a,{align:"center"},r.a.createElement("b",null,"Order Type")),r.a.createElement(Je.a,{align:"center"},r.a.createElement("b",null,"CNC/Intraday")),r.a.createElement(Je.a,{align:"center"},r.a.createElement("b",null,"Qty ")),r.a.createElement(Je.a,{align:"center"},r.a.createElement("b",null,"Average Price")),r.a.createElement(Je.a,{align:"center"},r.a.createElement("b",null,"Price")),r.a.createElement(Je.a,{align:"center"},r.a.createElement("b",null,"Trigger Price")),r.a.createElement(Je.a,{align:"center"},"Action"),r.a.createElement(Je.a,{align:"center"},r.a.createElement("b",null,"Status")),r.a.createElement(Je.a,{align:"center"},r.a.createElement("b",null,"Details")))),r.a.createElement(_e.a,null,this.state.oderbookData&&this.state.oderbookData?this.state.oderbookData.map(function(t,a){return r.a.createElement(qe.a,{hover:!0,key:a},r.a.createElement(Je.a,{align:"center"},t.updatetime?new Date(t.updatetime).toString().substring(15,25):""),r.a.createElement(Je.a,{style:{width:"10%"},align:"center"},t.tradingsymbol),r.a.createElement(Je.a,{align:"center"},t.transactiontype),r.a.createElement(Je.a,{align:"center"},t.producttype),r.a.createElement(Je.a,{align:"center"},"trigger pending"===t.orderstatus?r.a.createElement(Y.a,{type:"number",style:{textAlign:"center",width:"50px"},id:"lotsize",value:t.quantity,name:"lotsize",onChange:e.onChange}):t.quantity),r.a.createElement(Je.a,{align:"center"},t.averageprice),r.a.createElement(Je.a,{align:"center"},"trigger pending"===t.orderstatus?r.a.createElement(Y.a,{style:{textAlign:"center",width:"50px"},id:"price",value:0===e.state.price?t.price:e.state.price,name:"price",onChange:e.onChange}):t.price),r.a.createElement(Je.a,{align:"center"},"trigger pending"===t.orderstatus||"open"===t.orderstatus?r.a.createElement(Y.a,{type:"number",style:{textAlign:"center",width:"50px"},id:"triggerprice",value:0===e.state.triggerprice?t.triggerprice:e.state.triggerprice,name:"triggerprice",onChange:e.onChange}):t.triggerprice),r.a.createElement(Je.a,{align:"left"},"trigger pending"===t.orderstatus||"open"===t.orderstatus?r.a.createElement(M.a,{size:"small",type:"number",variant:"contained",color:"primary",style:{marginLeft:"20px"},onClick:function(){return e.modifyOrder(t)}},"Update"):""),r.a.createElement(Je.a,{style:{fontSize:"11px",width:"10%"},align:"center"},t.orderstatus),r.a.createElement(Je.a,{style:{fontSize:"11px"},align:"center"},t.text))}):r.a.createElement(pt.a,null)))))))}}]),t}(r.a.Component),wt=a(31),xt=Object(Fe.a)(function(e){return{root:{margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}})(function(e){var t=e.children,a=e.classes,n=e.onClose,o=Object(Ne.a)(e,["children","classes","onClose"]);return r.a.createElement(He.a,Object.assign({disableTypography:!0,className:a.root},o),r.a.createElement(J.a,{variant:"h6"},t),n?r.a.createElement(ce.a,{"aria-label":"close",className:a.closeButton,onClick:n},r.a.createElement(Re.a,null)):null)}),Lt=Object(Fe.a)(function(e){return{root:{padding:e.spacing(2)}}})(Me.a),Tt=Object(Fe.a)(function(e){return{root:{margin:0,padding:e.spacing(1)}}})(je.a);function Pt(e){var t=r.a.useState(!1),a=Object(ne.a)(t,2),n=a[0],o=a[1],l=r.a.useState({data:[],candledata:{}}),s=Object(ne.a)(l,2),i=(s[0],s[1],function(){o(!1)}),c=localStorage.getItem("multipleChartData")&&JSON.parse(localStorage.getItem("multipleChartData")),m=c&&c.longCandles,g=c&&c.shortCandles;return r.a.createElement("div",null,r.a.createElement(M.a,{variant:"outlined",id:"showMultipleChart",color:"primary",style:{display:"none"},onClick:function(){o(!0)}},"Chart"),r.a.createElement(Ae.a,{maxWidth:"lg",onClose:i,"aria-labelledby":"customized-dialog-title",open:n},r.a.createElement(xt,{id:"customized-dialog-title",onClose:i},c&&c.symbol),r.a.createElement(Lt,{dividers:!0},r.a.createElement(J.a,{component:"h3",variant:"h6",color:"primary",gutterBottom:!0},"Longs (",m&&m.length,")"),r.a.createElement(A.a,{justify:"space-between",container:!0,direction:"row"},m?m.map(function(e,t){return r.a.createElement(A.a,{item:!0},r.a.createElement(We.a,{options:{chart:{type:"candlestick",height:250},title:{text:e.foundAt.substr(6,10),align:"left"},xaxis:{type:"datetime"},yaxis:{tooltip:{enabled:!0}}},series:[{data:e.candleChartData.reverse()}],type:"candlestick",width:250,height:250}))}):""),r.a.createElement(J.a,{component:"h3",variant:"h6",color:"primary",gutterBottom:!0},"Shorts (",g&&g.length,")"),r.a.createElement(A.a,{justify:"space-between",container:!0,direction:"row"},g?g.map(function(e,t){return r.a.createElement(A.a,{item:!0},r.a.createElement(We.a,{options:{chart:{type:"candlestick",height:250},title:{text:e.foundAt.substr(6,10),align:"left"},xaxis:{type:"datetime"},yaxis:{tooltip:{enabled:!0}}},series:[{data:e.candleChartData.reverse()}],type:"candlestick",width:250,height:250}))}):"")),r.a.createElement(Tt,null,r.a.createElement(M.a,{autoFocus:!0,onClick:i,color:"primary"},"Close"))))}var Ct=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(S.a)(this,Object(v.a)(t).call(this,e))).getCandleHistoryAndStore=Object(ae.a)(te.a.mark(function e(){var t,n,r,o,l,s,i;return te.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("getCandleHistoryAndStore called",(new Date).toLocaleTimeString()),(new Date).toLocaleTimeString()>"15:00:00"?clearInterval(a.state.candleHistoryInterval):"",t=localStorage.getItem("watchList")&&JSON.parse(localStorage.getItem("watchList")),n=ct().isoWeekday(),r="",r=(new Date).toLocaleTimeString()>"10:05:00"?ct.duration("00:50:00"):1===n&&(new Date).toLocaleTimeString()<"10:05:00"?ct.duration("66:00:00"):ct.duration("19:00:00"),r=ct.duration("21:00:00"),"YYYY-MM-DD HH:mm",o=ct(new Date).subtract(r),l=te.a.mark(function e(n){var r;return te.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t[n],i={exchange:"NSE",symboltoken:r.token,interval:"FIFTEEN_MINUTE",fromdate:ct(o).format("YYYY-MM-DD HH:mm"),todate:ct(new Date).format("YYYY-MM-DD HH:mm")},C.getHistoryData(i).then(function(e){var t=X(e,"noPop");if(t&&t.data&&t.data.length){var o=t.data;if(o.reverse(),o&&o.length>=10){var l=o.slice(0,10);console.log("",n+1,r.symbol,"Time",(new Date).toLocaleTimeString()),a.findTweezerTopPatternLive(l,r.symbol),a.findTweezerBottomPatternLive(l,r.symbol)}}else console.log(" candle data emply")}),e.next=5,new Promise(function(e){return setTimeout(e,350)});case 5:case"end":return e.stop()}},e)}),s=0;case 11:if(!(s<t.length)){e.next=16;break}return e.delegateYield(l(s),"t0",13);case 13:s++,e.next=11;break;case 16:case"end":return e.stop()}},e)})),a.findTweezerTopPatternLive=function(e,t){if(e&&e.length>0){for(var n=e[2]&&e[2][2],r=e[2]&&e[2][3],o=3;o<e.length;o++)n<e[o][2]&&(n=e[o][2]),e[o][3]<r&&(r=e[o][3]);var l=e[9][3],s=e[2][2],i={time:e[0]&&e[0][0],open:e[0]&&e[0][1],high:e[0]&&e[0][2],low:e[0]&&e[0][3],close:e[0]&&e[0][4]},c={time:e[1]&&e[1][0],open:e[1]&&e[1][1],high:e[1]&&e[1][2],low:e[1]&&e[1][3],close:e[1]&&e[1][4]},m=100*(s-l)/l;if(m>=1.5&&n<(c.high<i.high?c.high:i.high)&&r<(c.low<i.low?c.low:i.low)&&c.open<c.close&&i.open>i.close&&(Math.round(c.close)==Math.round(i.open)||Math.round(c.open)==Math.round(i.close))){console.log("%c"+t+" perfect twisser top  upside movement"+m+new Date(e[0][0]).toLocaleTimeString(),"background: red; color: #bada55");var g=[];e.forEach(function(e){g.push([e[0],e[1],e[2],e[3],e[4]])});var d={symbol:t,pattenName:"Twisser Top",time:new Date(e[0][0]).toLocaleString(),candleChartData:g},u=localStorage.getItem("foundPatternList")?JSON.parse(localStorage.getItem("foundPatternList")):[];u.push(d),localStorage.setItem("foundPatternList",JSON.stringify(u)),a.setState({foundPatternList:[].concat(Object($.a)(a.state.foundPatternList),[d])}),console.log(t,"last10Candle",e);var h=new SpeechSynthesisUtterance;h.text="twisser top in "+t.toLowerCase(),window.speechSynthesis.speak(h)}}},a.findTweezerBottomPatternLive=function(e,t){if(e&&e.length>0){for(var n=e[2]&&e[2][2],r=e[2]&&e[2][3],o=3;o<e.length;o++)n<e[o][2]&&(n=e[o][2]),e[o][3]<r&&(r=e[o][3]);var l=e[9][2],s=e[2][3],i={time:e[0]&&e[0][0],open:e[0]&&e[0][1],high:e[0]&&e[0][2],low:e[0]&&e[0][3],close:e[0]&&e[0][4]},c={time:e[1]&&e[1][0],open:e[1]&&e[1][1],high:e[1]&&e[1][2],low:e[1]&&e[1][3],close:e[1]&&e[1][4]},m=(100*(s-l)/l).toFixed(2);if(m<=-1.5&&(c.high<i.high?c.high:i.high)<n&&(c.low<i.low?c.low:i.low)<r&&c.open>c.close&&i.close>i.open&&(Math.round(c.close)==Math.round(i.open)||Math.round(c.open)==Math.round(i.close))){var g=[];e.forEach(function(e){g.push([e[0],e[1],e[2],e[3],e[4]])}),console.log("%c"+t+" perfect twisser bottom downside movement diff "+m+"% "+new Date(e[0][0]).toLocaleTimeString(),"background: #222; color: #bada55");var d={symbol:t,pattenName:"Twisser bottom",time:new Date(e[0][0]).toLocaleString(),candleChartData:g};a.setState({foundPatternList:[].concat(Object($.a)(a.state.foundPatternList),[d])});var u=localStorage.getItem("foundPatternList")?JSON.parse(localStorage.getItem("foundPatternList")):[];u.push(d),localStorage.setItem("foundPatternList",JSON.stringify(u)),console.log(t,"last10Candle",e);var h=new SpeechSynthesisUtterance;h.text="twisser bottom in "+t.toLowerCase(),window.speechSynthesis.speak(h)}}},a.findNR4PatternLive=Object(ae.a)(te.a.mark(function e(){var t,n,o,l,s,i,c,m;return te.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("nr4 scaning starting"),a.setState({backTestResult:[],backTestFlag:!1}),t=localStorage.getItem("watchList")&&JSON.parse(localStorage.getItem("watchList"))||[],1,n=0,o=te.a.mark(function e(n){var o;return te.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=t[n],"",i=ct.duration("240:00:00"),s=ct(new Date).subtract(i),c=ct.duration("24:00:00"),ct(new Date).subtract(c),m={exchange:"NSE",symboltoken:o.token,interval:"ONE_DAY",fromdate:ct(s).format("YYYY-MM-DD HH:mm"),todate:ct(new Date).format("YYYY-MM-DD HH:mm")},C.getHistoryData(m).then(function(e){var t=X(e,"noPop");if(t&&t.data&&t.data.length){var l=t.data,s=0;l.reverse();var i=l.slice(1,5),c=l.slice(0,5);if(i.length>=4){var m=[],g=[];i.forEach(function(e){m.push(e[2]-e[3])}),c.forEach(function(e){g.push([e[0],e[1],e[2],e[3],e[4]])});var d=m[0];if(m.forEach(function(e){d<=e&&(d=e,s+=1)}),console.log(n+1,o.symbol,s),4==s){console.log(n+1,o.symbol,i,m,s);var u=i[0],h=(u[2]+u[2]/100/10).toFixed(2),p=(u[3]-u[3]/100/10).toFixed(2),f={exchange:"NSE",tradingsymbol:o.symbol,symboltoken:o.token};console.log("nr4 ltp",f),C.getLTP(f).then(function(e){var t=X(e,"noPop"),n=t&&t.data;if(console.log(n,t),n&&n.ltp){var l,s=r.a.createElement("span",null," ",n.ltp," "),i=0,c=0,m=0;if(n.ltp>h){s=r.a.createElement("span",{style:{color:"green"}}," Long: ",n.ltp," (",(100*(n.ltp-h)/h).toFixed(2),"%) "),a.setState({nr4TotalPer:a.state.nr4TotalPer+100*(n.ltp-h)/h}),a.setState({totelActivatedCount:a.state.totelActivatedCount+1});var d=wt.totalCapital*wt.perTradeExposurePer/100;i=Math.floor(d/h),l=100*(n.ltp-h)/h,c=((n.ltp-h)*i).toFixed(2),m=(h*(l-.06)/100*i).toFixed(2)}if(n.ltp<p){s=r.a.createElement("span",{style:{color:"red"}}," Short: ",n.ltp," (",(100*(n.ltp-p)/p).toFixed(2),"%)"),a.setState({nr4TotalPer:a.state.nr4TotalPer+100*(p-n.ltp)/p}),a.setState({totelActivatedCount:a.state.totelActivatedCount+1});var f=wt.totalCapital*wt.perTradeExposurePer/100;i=Math.floor(f/p),c=((p-n.ltp)*i).toFixed(2),l=100*(p-n.ltp)/p,m=(p*(l-.06)/100*i).toFixed(2)}var y={symbol:o.symbol,token:o.token,pattenName:"NR4",time:new Date(u[0]).toLocaleString(),BuyAt:h,SellAt:p,orderActivated:s,candleChartData:g,quantity:i,brokerageCharges:.06,pnlAmount:c,netPnLAmount:m,perChange:l};console.log("nr4 scaned",y),a.setState({foundPatternList:[].concat(Object($.a)(a.state.foundPatternList),[y])});var b=localStorage.getItem("foundPatternList")?JSON.parse(localStorage.getItem("foundPatternList")):[];b.push(y),localStorage.setItem("foundPatternList",JSON.stringify(b))}})}}}else console.log(o.symbol," candle data emply")}),e.next=10,new Promise(function(e){return setTimeout(e,300)});case 10:case"end":return e.stop()}},e)}),l=0;case 6:if(!(l<t.length)){e.next=11;break}return e.delegateYield(o(l),"t0",8);case 8:l++,e.next=6;break;case 11:a.setState({backTestFlag:!0}),console.log("sumPercentage",n);case 13:case"end":return e.stop()}},e)})),a.findNR7PatternLive=Object(ae.a)(te.a.mark(function e(){var t,n,o,l,s,i,c,m,g;return te.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("nr7 scaning starting"),a.setState({backTestResult:[],backTestFlag:!1}),t=localStorage.getItem("watchList")&&JSON.parse(localStorage.getItem("watchList"))||[],1,n=0,o=te.a.mark(function e(n){var o;return te.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=t[n],"",i=ct.duration("288:00:00"),s=ct(new Date).subtract(i),c=ct.duration("24:00:00"),ct(new Date).subtract(c),m={exchange:"NSE",symboltoken:o.token,interval:"ONE_DAY",fromdate:ct(s).format("YYYY-MM-DD HH:mm"),todate:ct(new Date).format("YYYY-MM-DD HH:mm")},C.getHistoryData(m).then(function(e){var t=X(e,"noPop");if(t&&t.data&&t.data.length){var n=t.data;n.reverse();var l=n.slice(1,8),s=n.slice(0,9);if(l.length>=7){var i=[],c=[];l.forEach(function(e){i.push(e[2]-e[3])}),s.forEach(function(e){c.push([e[0],e[1],e[2],e[3],e[4]])});var m=i[0],g=0;if(i.forEach(function(e){m<=e&&(m=e,g+=1)}),console.log(o.symbol,l,i,g),7==g){var d=l[0],u=(d[2]+d[2]/100/10).toFixed(2),h=(d[3]-d[3]/100/10).toFixed(2),p={exchange:"NSE",tradingsymbol:o.symbol,symboltoken:o.token};console.log("nr4 ltp",p),C.getLTP(p).then(function(e){var t=X(e,"noPop"),n=t&&t.data;if(console.log(n,t),n&&n.ltp){var l,s=r.a.createElement("span",null," ",n.ltp," "),i=0,m=0,g=0;if(n.ltp>u){s=r.a.createElement("span",{style:{color:"green"}}," Long: ",n.ltp," (",(100*(n.ltp-u)/u).toFixed(2),"%) "),a.setState({nr4TotalPer:a.state.nr4TotalPer+100*(n.ltp-u)/u}),a.setState({totelActivatedCount:a.state.totelActivatedCount+1});var p=wt.totalCapital*wt.perTradeExposurePer/100;i=Math.floor(p/u),l=100*(n.ltp-u)/u,m=((n.ltp-u)*i).toFixed(2),g=(u*(l-.06)/100*i).toFixed(2)}if(n.ltp<h){s=r.a.createElement("span",{style:{color:"red"}}," Short: ",n.ltp," (",(100*(n.ltp-h)/h).toFixed(2),"%)"),a.setState({nr4TotalPer:a.state.nr4TotalPer+100*(h-n.ltp)/h}),a.setState({totelActivatedCount:a.state.totelActivatedCount+1});var f=wt.totalCapital*wt.perTradeExposurePer/100;i=Math.floor(f/h),m=((h-n.ltp)*i).toFixed(2),l=100*(h-n.ltp)/h,g=(h*(l-.06)/100*i).toFixed(2)}var y={symbol:o.symbol,token:o.token,pattenName:"NR7",time:new Date(d[0]).toLocaleString(),BuyAt:u,SellAt:h,orderActivated:s,candleChartData:c,quantity:i,brokerageCharges:.06,pnlAmount:m,netPnLAmount:g,perChange:l};console.log("nr7 scaned",y),a.setState({foundPatternList:[].concat(Object($.a)(a.state.foundPatternList),[y])});var b=localStorage.getItem("foundPatternList")?JSON.parse(localStorage.getItem("foundPatternList")):[];b.push(y),localStorage.setItem("foundPatternList",JSON.stringify(b))}})}}}else console.log(o.symbol," candle data emply")}),g=n+1+". "+o.symbol,a.setState({stockTesting:g}),e.next=12,new Promise(function(e){return setTimeout(e,300)});case 12:case"end":return e.stop()}},e)}),l=0;case 6:if(!(l<t.length)){e.next=11;break}return e.delegateYield(o(l),"t0",8);case 8:l++,e.next=6;break;case 11:a.setState({backTestFlag:!0}),console.log("sumPercentage",n);case 13:case"end":return e.stop()}},e)})),a.showCandleChart=function(e,t){e=e&&e.reverse(),localStorage.setItem("candleChartData",JSON.stringify(e)),localStorage.setItem("cadleChartSymbol",t),document.getElementById("showCandleChart").click()},a.showMultipleCandleChart=function(e){localStorage.setItem("multipleChartData",JSON.stringify(e)),document.getElementById("showMultipleChart").click()},a.refreshLtpOnFoundPattern=Object(ae.a)(te.a.mark(function e(){var t,n,o,l,s;return te.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({nr4TotalPer:0,totalBrokerChargesNR4:0,totalNetProfit:0,totelActivatedCount:0,pnlAmountTotal:0,perHighLowTotal:0,netPnLAmountOnHighlowTotal:0}),t=a.state.foundPatternList,a.setState({foundPatternList:[]}),n=localStorage.getItem("FoundPatternList")?JSON.parse(localStorage.getItem("FoundPatternList")):[],o=te.a.mark(function e(n){var o;return te.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(o=t[n])&&"NR4"==o.pattenName&&(s={exchange:"NSE",tradingsymbol:o.symbol,symboltoken:o.token},C.getLTP(s).then(function(e){var t=X(e,"noPop"),n=t&&t.data,l=0,s=0,i=0,c=.06,m=0,g=0,d=0;if(n&&n.ltp){var u=r.a.createElement("span",null," ",n.ltp," ");if(n.ltp>o.BuyAt)m=100*(n.ltp-o.BuyAt)/o.BuyAt,u=r.a.createElement("span",{style:{color:"green"}}," Long: ",m.toFixed(2),"% "),l=Math.floor(1e4/o.BuyAt),i=(s=(n.ltp-o.BuyAt)*l)-(c=o.BuyAt*l*c/100*2),a.setState({nr4TotalPer:a.state.nr4TotalPer+m}),a.setState({totalBrokerChargesNR4:a.state.totalBrokerChargesNR4+c,totalNetProfit:a.state.totalNetProfit+i}),a.setState({totelActivatedCount:a.state.totelActivatedCount+1,pnlAmountTotal:a.state.pnlAmountTotal+s}),g=100*(n.high-o.BuyAt)/o.BuyAt,d=(n.high-o.BuyAt)*l-c,a.setState({perHighLowTotal:a.state.perHighLowTotal+g,netPnLAmountOnHighlowTotal:a.state.netPnLAmountOnHighlowTotal+d});if(n.ltp<o.SellAt)m=100*(o.SellAt-n.ltp)/o.SellAt,u=r.a.createElement("span",{style:{color:"red"}}," Short: ",m.toFixed(2),"%"),l=Math.floor(1e4/o.SellAt),i=(s=(o.SellAt-n.ltp)*l)-(c=o.SellAt*l*c/100*2),a.setState({nr4TotalPer:a.state.nr4TotalPer+m}),a.setState({totelActivatedCount:a.state.totelActivatedCount+1,pnlAmountTotal:a.state.pnlAmountTotal+s}),a.setState({totalBrokerChargesNR4:a.state.totalBrokerChargesNR4+c,totalNetProfit:a.state.totalNetProfit+i}),g=100*(o.SellAt-n.low)/o.SellAt,d=(o.SellAt-n.low)*l-c,a.setState({perHighLowTotal:a.state.perHighLowTotal+g,netPnLAmountOnHighlowTotal:a.state.netPnLAmountOnHighlowTotal+d});var h=100*(n.ltp-n.close)/n.close,p=[new Date,n.open,n.high,n.low,n.ltp];o.candleChartData.push(p);var f={symbol:o.symbol,symbolUpdated:n.ltp+"("+h.toFixed(2)+"%)",token:o.token,pattenName:"NR4",OnHighLowActivated:l?g.toFixed(2)+"% | "+d.toFixed(2):"",time:(new Date).toLocaleTimeString(),BuyAt:o.BuyAt,SellAt:o.SellAt,foundAt:o.foundAt,orderActivated:u,candleChartData:o.candleChartData,quantity:l||"",brokerageCharges:l?c.toFixed(2):"",pnlAmount:s?s.toFixed(2):"",netPnLAmount:i?i.toFixed(2):"",perChange:m,todayChange:h,pastPerferm:o.pastPerferm};console.log("nr4 updated",f),a.setState({foundPatternList:[].concat(Object($.a)(a.state.foundPatternList),[f])});var y=a.state.foundPatternList;y.sort(function(e,t){return t.perChange-e.perChange}),a.setState({foundPatternList:y});var b=localStorage.getItem("foundPatternList")?JSON.parse(localStorage.getItem("foundPatternList")):[];b.push(f),localStorage.setItem("foundPatternList",JSON.stringify(b))}}).catch(function(e){K.showError(o.symbol+" ltd data not found!")})),e.next=4,new Promise(function(e){return setTimeout(e,101)});case 4:case"end":return e.stop()}},e)}),l=0;case 6:if(!(l<n.length)){e.next=11;break}return e.delegateYield(o(l),"t0",8);case 8:l++,e.next=6;break;case 11:case"end":return e.stop()}},e)})),a.getStoplossFromOrderbook=function(e){var t=localStorage.getItem("oderbookData");t=JSON.parse(t);var a={};return t.forEach(function(t){"trigger pending"===t.status&&t.symboltoken===e.symboltoken&&(a.stopLoss=t.triggerprice+"("+(100*(t.triggerprice-e.buyavgprice)/e.buyavgprice).toFixed(2)+"%)",a.maxLossAmount=((t.triggerprice-e.buyavgprice)*parseInt(e.netqty)).toFixed(2))}),a},a.getPositionData=Object(ae.a)(te.a.mark(function e(){var t;return te.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:0,t=0,C.getPosition().then(function(e){var n=X(e,"noPop"),r=n&&n.data;if(r&&r.length>0){a.setState({positionList:r});var o=0,l=0,s=0,i=0,c=0,m=0,g=0;r.forEach(function(e){var n=(100*(parseFloat(e.sellavgprice)-parseFloat(e.buyavgprice))/parseFloat(e.buyavgprice)).toFixed(2);o+=parseFloat(e.pnl),l+=parseFloat(e.totalbuyvalue),s+=0===parseFloat(e.totalsellvalue)?parseFloat(e.totalbuyvalue):parseFloat(e.totalsellvalue),i+=parseInt(e.buyqty),c+=parseFloat(e.buyavgprice),m+=parseFloat(e.sellavgprice),e.percentPnL=n,g+=parseFloat(n);var r=a.getStoplossFromOrderbook(e);e.stopLoss="0.00"===e.totalsellavgprice?r.stopLoss:e.totalsellavgprice+"("+(100*(e.totalsellavgprice-e.totalbuyavgprice)/e.totalbuyavgprice).toFixed(2)+"%)",e.stopLossAmount=r.maxLossAmount,t+=parseFloat(r.maxLossAmount)?parseFloat(r.maxLossAmount):0}),a.setState({todayProfitPnL:o.toFixed(2),totalbuyvalue:l.toFixed(2),totalsellvalue:s.toFixed(2),totalQtyTraded:i}),a.setState({allbuyavgprice:(c/r.length).toFixed(2),allsellavgprice:(m/r.length).toFixed(2),totalPercentage:g}),a.setState({totalBrokerCharges:(.25*(l+s)/100).toFixed(2)}),a.setState({totalTornOver:(l+s).toFixed(2),totalMaxPnL:t.toFixed(2)})}});case 2:case"end":return e.stop()}},e)})),a.checkAndPlaceSingleOrder=function(e){C.autoCompleteSearch(e).then(function(e){var t=e.data.filter(function(e){return"NSE"===e.exch_seg&&"1"===e.lotsize});console.log("stockfound",t),t&&t.length&&a.orderWithFlatstoploss(t[0].token,t[0].symbol)})},a.orderWithFlatstoploss=function(e,t){var n={exchange:"NSE",tradingsymbol:t,symboltoken:e};C.getLTP(n).then(function(n){var r=X(n,"noPop"),o=(r&&r.data).ltp;if(o){var l=o-o*wt.perTradeStopLossPer/100;l=a.getMinPriceAllowTick(l);var s=wt.totalCapital*wt.perTradeExposurePer/100,i=Math.floor(s/o);console.log(t+"ltp "+o,"quantity",i,"stopLossPrice",l,"perTradeExposureAmt",s);var c={transactiontype:"BUY",tradingsymbol:t,symboltoken:e,buyPrice:0,quantity:i,stopLossPrice:l};i&&l&&a.placeOrderMethod(c)}}).catch(function(e){console.log(t,"not found","error",e)})},a.onChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value));var t=e.target.value;C.autoCompleteSearch(t).then(function(e){var t=e.data;localStorage.setItem("autoSearchTemp",JSON.stringify(t)),a.setState({autoSearchList:t})})},a.getLTP=function(){C.getLTP({exchange:"NSE",tradingsymbol:"BANKNIFTY",symboltoken:"26009"}).then(function(e){var t=X(e,"noPop"),a=t&&t.data;a&&a.ltp&&localStorage.setItem({BankLtpltp:a.ltp+"  "+(100*(a.ltp-a.close)/a.close).toFixed(2)+"%"})})},a.getStopLossPrice=function(){var e=Object(ae.a)(te.a.mark(function e(t,n){var r;return te.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r={exchange:"NSE",tradingsymbol:n,symboltoken:t},e.next=3,C.getLTP(r).then(function(e){var t=X(e,"noPop"),n=t&&t.data;if(n&&n.ltp){var r=parseFloat(n.ltp);r-=.7*r/100;var o=a.getMinPriceAllowTick(r);return a.setState({stoploss:o}),o}});case 3:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.placeOrderMethod=function(e){var t={transactiontype:e.transactiontype,tradingsymbol:e.tradingsymbol,symboltoken:e.symboltoken,quantity:e.quantity,ordertype:0===e.buyPrice?"MARKET":"LIMIT",price:e.buyPrice,producttype:"INTRADAY",duration:"DAY",squareoff:"0",stoploss:"0",exchange:"NSE",variety:"NORMAL"};console.log("place order option",t),C.placeOrder(t).then(function(t){var n=X(t);n.status&&"SUCCESS"===n.message&&(a.setState({orderid:n.data&&n.data.orderid}),e.stopLossPrice&&a.placeSLMOrder(e))})},a.historyWiseOrderPlace=function(e,t,n){var r={exchange:"NSE",tradingsymbol:t,symboltoken:e};C.getLTP(r).then(function(r){var o=X(r,"noPop"),l=o&&o.data;console.log(t," ltd data ",l);var s=0;if(l&&l.ltp){var i=wt.totalCapital*wt.perTradeExposurePer/100;s=Math.floor(i/l.ltp)}if(s=s>0?1:0,console.log(t,"  quantity can be order ",s),s){var c="YYYY-MM-DD HH:mm",m=ct("9:15am","h:mma").format(c);console.log("beginningTime",m);var g=ct.duration("21:10:00"),d=ct(new Date).subtract(g),u={exchange:"NSE",symboltoken:e,interval:"FIVE_MINUTE",fromdate:ct(d).format(c),todate:ct(new Date).format(c)};C.getHistoryData(u).then(function(r){var o=X(r,"noPop");if(o&&o.data&&o.data.length){var i=o.data,c=0,m=0,g=0,d=0;if(i.reverse(),i&&i.length>0){for(var u=0;u<20;u++)i[u]&&(c+=i[u][4],m+=i[u][3],i[u][4]>g&&(g=i[u][4]),d<i[u][3]&&(d=i[u][3]));var h=i.length>20?20:i.length,p=c/h,f=m/h,y=f-3*(g-d)/100,b=100*(g-(y=a.getMinPriceAllowTick(y)))/g;console.log(t," LTP ",l.ltp),console.log(t+"highestHigh:",g,"lowestLow",d,"stoploss after tick:",y,"stoploss%",b),console.log(t+"  close avg middle ",p,"lowerest avg",f);var E={transactiontype:"BUY",tradingsymbol:t,symboltoken:e,buyPrice:0,quantity:s,stopLossPrice:y};l&&l.ltp>g&&b<=1.5?a.placeOrderMethod(E):(localStorage.setItem("NseStock_"+n,""),console.log(t+" its not fullfilled"))}}else console.log(t+" candle data emply")})}})},a.onSelectItem=function(e,t){var n=JSON.parse(localStorage.getItem("autoSearchTemp"));if(n.length>0){for(var r="",o=0;o<n.length;o++)if(console.log("fdata",n[o].symbol),n[o].symbol===t){r=n[o];break}var l=localStorage.getItem("watchList");if(l){0===(l=JSON.parse(localStorage.getItem("watchList"))).filter(function(e){return e.symbol===t}).length&&(l.push(r),localStorage.setItem("watchList",JSON.stringify(l)))}else{var s=[];s.push(r),localStorage.setItem("watchList",JSON.stringify(s))}setTimeout(function(){a.updateSocketWatch()},100)}},a.getAveragePrice=function(e){for(var t=localStorage.getItem("oderbookData"),n=0,r=0;r<t.length;r++)if("orderId"===t[r].orderid){n=t[r].averageprice,a.setState({averageprice:n});break}return n},a.cancelOrderOfSame=function(e){var t=a.getOpenPeningOrderId(e.symboltoken),n={variety:t.variety,orderid:t.orderId};C.cancelOrder(n).then(function(e){var t=X(e);t.status&&"SUCCESS"===t.message&&console.log("cancel order",t)})},a.squareOff=function(e){var t={variety:"NORMAL",tradingsymbol:e.tradingsymbol,symboltoken:e.symboltoken,transactiontype:e.buyqty>0?"SELL":"BUY",exchange:e.exchange,ordertype:"MARKET",producttype:e.producttype,duration:"DAY",price:0,squareoff:"0",stoploss:"0",quantity:e.buyqty};C.placeOrder(t).then(function(t){var n=X(t);console.log("squireoff",n),n.status&&"SUCCESS"===n.message&&(a.setState({orderid:n.data&&n.data.orderid}),a.cancelOrderOfSame(e),document.getElementById("orderRefresh")&&document.getElementById("orderRefresh").click())})},a.updateOrderList=function(){C.retrieveOrderBook().then(function(e){var t=X(e);if(t&&t.data){var a=t.data;a.sort(function(e,t){return new Date(t.updatetime)-new Date(e.updatetime)}),localStorage.setItem("oderbookData",JSON.stringify(a))}})},a.placeSLMOrder=function(e){var t={triggerprice:e.stopLossPrice,tradingsymbol:e.tradingsymbol,symboltoken:e.symboltoken,quantity:e.quantity,transactiontype:"BUY"===e.transactiontype?"SELL":"BUY",exchange:"NSE",producttype:"INTRADAY",duration:"DAY",price:0,squareoff:"0",stoploss:"0",ordertype:"STOPLOSS_MARKET",variety:"STOPLOSS"};console.log("SLM option data",t),C.placeOrder(t).then(function(t){var n=X(t);if(n.status&&"SUCCESS"===n.message){a.setState({orderid:n.data&&n.data.orderid});var r=new SpeechSynthesisUtterance;r.text="hey Vijay, "+e.tradingsymbol,window.speechSynthesis.speak(r),document.getElementById("orderRefresh")&&document.getElementById("orderRefresh").click()}})},a.getOpenPeningOrderId=function(e){for(var t=JSON.parse(localStorage.getItem("oderbookData")),a={},n=0;n<t.length;n++)if(t[n].symboltoken===e&&"SELL"===t[n].transactiontype){a.orderId=t[n].orderid,a.variety=t[n].variety;break}return a},a.modifyOrderMethod=function(e,t){var n=a.getOpenPeningOrderId(e.symboltoken);console.log("orderid",a.state.orderData);var r={variety:"STOPLOSS",orderid:n.orderId,ordertype:"STOPLOSS_MARKET",producttype:e.producttype,duration:"DAY",price:0,triggerprice:parseFloat(t),quantity:e.buyqty,tradingsymbol:e.tradingsymbol,symboltoken:e.symboltoken,exchange:e.exchange};C.modifyOrder(r).then(function(a){var n=X(a,"noPop"),r=new SpeechSynthesisUtterance;n.status&&"SUCCESS"===n.message&&(r.text=e.tradingsymbol+" modified "+n.message,window.speechSynthesis.speak(r),localStorage.setItem("firstTimeModify"+e.symboltoken,"No"),localStorage.setItem("lastTriggerprice_"+e.symboltoken,parseFloat(t)))})},a.getMinPriceAllowTick=function(e){e=e.toFixed(2);var t=parseInt(e.split(".")[0]),a=parseFloat(e.split(".")[1]);return e=parseFloat(t+"."+(a-a%5))},a.getPercentage=function(e,t,n){var r=(100*(t-(e=parseFloat(e)))/e).toFixed(2);if(!localStorage.getItem("firstTimeModify"+n.symboltoken)&&r>.7){var o=e+.1*e/100;o=a.getMinPriceAllowTick(o),a.modifyOrderMethod(n,o)}else{var l=parseFloat(localStorage.getItem("lastTriggerprice_"+n.symboltoken));(100*(t-l)/l).toFixed(2)>.7&&(o=l+.25*l/100,o=a.getMinPriceAllowTick(o),a.modifyOrderMethod(n,o))}var s=ct("3:14pm","h:mma"),i=ct("3:15pm","h:mma");return ct(new Date,"h:mma").isBetween(s,i)&&(localStorage.getItem("squiredOff"+n.symboltoken)||(localStorage.setItem("squiredOff"+n.symboltoken,"yes"),a.squareOff(n),console.log("Sqr off called for",n.symbolname))),r},a.state={positionList:[],autoSearchList:[],InstrumentLTP:{},autoSearchTemp:[],foundPatternList:[],symboltoken:"",tradingsymbol:"",buyPrice:0,quantity:1,producttype:"INTRADAY",nr4TotalPer:0,pnlAmountTotal:0,totalBrokerCharges:"",totalNetProfit:0,totelActivatedCount:0,totalBrokerChargesNR4:0,stockTesting:"",perHighLowTotal:0,netPnLAmountOnHighlowTotal:0},a}return Object(w.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=ct("9:15am","h:mma"),a=ct("3:30pm","h:mma"),n=ct(new Date,"h:mma"),r=ct().isoWeekday();r<=5&&n.isBetween(t,a)||(clearInterval(this.state.positionInterval),clearInterval(this.state.scaninterval),clearInterval(this.state.bankNiftyInterval));var o=ct("3:30pm","h:mma");if(r<=5&&n.isBetween(t,o)){var l=setInterval(function(){console.log("1st interval every second",(new Date).toLocaleTimeString()),(new Date).getMinutes()%15===0&&(console.log("5th min completed at",(new Date).toLocaleTimeString()),console.log("next scan at",new Date((new Date).getTime()+7e4).toLocaleTimeString()),setTimeout(function(){console.log("set timout at 70sec ",new Date),e.getCandleHistoryAndStore()},7e4),setInterval(function(){console.log("2st interval every 5min 10Sec",new Date),r<=5&&n.isBetween(t,o)&&e.getCandleHistoryAndStore()},97e4),clearInterval(l))},1e3),s=localStorage.getItem("FoundPatternList")?JSON.parse(localStorage.getItem("FoundPatternList")):[];setInterval(function(){e.refreshLtpOnFoundPattern()},100*s.length+3e5)}var i=localStorage.getItem("FoundPatternList")?JSON.parse(localStorage.getItem("FoundPatternList")):[];this.setState({foundPatternList:i})}},{key:"componentWillUnmount",value:function(){clearInterval(this.state.positionInterval),clearInterval(this.state.scaninterval),clearInterval(this.state.bankNiftyInterval)}},{key:"getNSETopStock",value:function(){var e=this,t=((new Date).toLocaleTimeString()>"15:00:00"&&clearInterval(this.state.scaninterval),wt.totalCapital*wt.dailyLossPer/100);t=-Math.abs(t),this.state.todayProfitPnL<t?(console.log("daily loss crossed",t),clearInterval(this.state.scaninterval)):C.getNSETopStock().then(function(t){var a=X(t,"noPop");if(a.status&&"SUCCESS"===a.message)for(var n=a.result,r=function(t){l=!1;for(var a=0;a<e.state.positionList.length;a++)e.state.positionList[a].symbolname===n[t].symbolName&&(l=!0);l||localStorage.getItem("NseStock_"+n[t].symbolName)||C.autoCompleteSearch(n[t].symbolName).then(function(a){var r=a.data.filter(function(e){return"NSE"===e.exch_seg&&"1"===e.lotsize&&e.name===n[t].symbolName});r.length&&(console.log(r[0].symbol,"found",r),localStorage.setItem("NseStock_"+n[t].symbolName,"orderdone"),e.historyWiseOrderPlace(r[0].token,r[0].symbol,n[t].symbolName))})},o=0;o<n.length;o++){var l;r(o)}})}},{key:"getMySelectedStock",value:function(){var e=this,t=((new Date).toLocaleTimeString()>"15:00:00"&&clearInterval(this.state.selectedStockInteval),wt.totalCapital*wt.dailyLossPer/100);t=-Math.abs(t),this.state.todayProfitPnL<t?(console.log("daily loss crossed",t),clearInterval(this.state.scaninterval)):C.getSelectedStockFromDb().then(function(t){var a=X(t,"noPop");if(a.status&&"SUCCESS"===a.message)for(var n=a.result,r=function(t){l=!1;for(var a=0;a<e.state.positionList.length;a++)e.state.positionList[a].symbolname===n[t].symbol&&(l=!0);l||localStorage.getItem("NseStock_"+n[t].symbolName)||C.autoCompleteSearch(n[t].symbolName).then(function(e){var a=e.data.filter(function(e){return"NSE"===e.exch_seg&&"1"===e.lotsize&&e.name===n[t].symbolName});if(a.length){var r=localStorage.getItem("selectedStockwatchList")?JSON.parse(localStorage.getItem("selectedStockwatchList")):[];r.push(a[0]),localStorage.setItem("selectedStockwatchList",JSON.stringify(r))}})},o=0;o<n.length;o++){var l;r(o)}})}},{key:"getStockOnebyOne",value:function(){var e=this,t=wt.totalCapital*wt.dailyLossPer/100;t=-Math.abs(t),this.state.todayProfitPnL<t?(console.log("daily loss crossed",t),clearInterval(this.state.scaninterval)):(console.log("still ok"),C.getAutoScanStock().then(function(t){var a=X(t,"noPop");if(a.status&&"SUCCESS"===a.message){var n=a.result;if(n&&n.length>0){var r=n[n.length-1].symbolName;localStorage.setItem("scannedStocks",JSON.stringify(n));for(var o=!1,l=0;l<e.state.positionList.length;l++)e.state.positionList[l].symbolname===r&&(o=!0);if(!o&&!localStorage.getItem("scannedstock_"+r)){console.log("found new",r);var s=new SpeechSynthesisUtterance;s.text="hey Vijay, "+r,window.speechSynthesis.speak(s),localStorage.setItem("scannedstock_"+r,"orderdone"),e.checkAndPlaceSingleOrder(r)}}}}))}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(nt,null),r.a.createElement("br",null),r.a.createElement(Xe,null)," ",r.a.createElement(Pt,null),r.a.createElement(A.a,{style:{padding:"5px"},justify:"space-between",direction:"row",container:!0},r.a.createElement(A.a,{item:!0},r.a.createElement(J.a,{variant:"h6"},r.a.createElement("b",null,"Positions (",this.state.positionList&&this.state.positionList.length,") "))),r.a.createElement(A.a,{item:!0,xs:12,sm:3},r.a.createElement(J.a,{component:"h3"},r.a.createElement("b",null,"Date:: ",(new Date).toLocaleString()," "))),r.a.createElement(A.a,{item:!0},r.a.createElement(J.a,{component:"h3"},r.a.createElement("b",null,"Total Turnover ",this.state.totalTornOver," "))),r.a.createElement(A.a,{item:!0},r.a.createElement(J.a,{component:"h3"},r.a.createElement("b",null," Charges")," ",r.a.createElement("b",{style:{color:"#00cbcb"}},"-",this.state.totalBrokerCharges," "))),r.a.createElement(A.a,{item:!0},r.a.createElement(J.a,{component:"h3"},r.a.createElement("b",null,"  P/L ")," ",r.a.createElement("b",{style:{color:this.state.todayProfitPnL>0?"darkmagenta":"#00cbcb"}},this.state.todayProfitPnL," "))),r.a.createElement(A.a,{item:!0},r.a.createElement(J.a,{component:"h3"},r.a.createElement("b",null," Net P/L ")," ",r.a.createElement("b",{style:{color:this.state.todayProfitPnL-this.state.totalBrokerCharges>0?"darkmagenta":"#00cbcb"}},this.state.totalBrokerCharges?(this.state.todayProfitPnL-this.state.totalBrokerCharges).toFixed(2):""," "))),r.a.createElement(A.a,{item:!0},r.a.createElement(M.a,{type:"number",variant:"contained",style:{float:"right"},onClick:function(){return e.getPositionData()}},"Refresh"))),r.a.createElement(A.a,{style:{padding:"5px"},spacing:1,direction:"row",alignItems:"center",container:!0},r.a.createElement(A.a,{item:!0,xs:12,sm:12},r.a.createElement(vt.a,{style:{overflow:"auto",padding:"5px"}},r.a.createElement(Be.a,{size:"small","aria-label":"sticky table"},r.a.createElement(it.a,{style:{whiteSpace:"nowrap",backgroundColor:"lightgray"},variant:"head"},r.a.createElement(qe.a,{key:"1",variant:"head",style:{fontWeight:"bold"}},r.a.createElement(Je.a,{style:{paddingLeft:"3px"},className:"TableHeadFormat",align:"left"},"\xa0Trading symbol"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},"Average Buy Price"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},"Average Sell Price"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},"Bought Qty"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},"Net Qty"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},"Trailing SL"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},"Max Locked P/L"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},"P/L "),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},"Chng % "),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},"LTP"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},"Action"))),r.a.createElement(_e.a,{style:{width:"",whiteSpace:"nowrap"}},this.state.positionList?this.state.positionList.map(function(t){return r.a.createElement(qe.a,{hover:!0,key:t.symboltoken,style:{background:"0"!==t.netqty?"gray":""}},r.a.createElement(Je.a,{style:{paddingLeft:"3px"},align:"left"},"\xa0 ",r.a.createElement("a",{rel:"noopener noreferrer",target:"_blank",href:"https://chartink.com/stocks/"+t.tradingsymbol.split("-")[0]+".html"},t.tradingsymbol.split("-")[0])," "),r.a.createElement(Je.a,{align:"left"},t.totalbuyavgprice),r.a.createElement(Je.a,{align:"left"},t.totalsellavgprice),r.a.createElement(Je.a,{align:"left"},t.buyqty),r.a.createElement(Je.a,{align:"left"},t.netqty),r.a.createElement(Je.a,{align:"left"}," ",t.stopLoss),r.a.createElement(Je.a,{align:"left"}," ",t.stopLossAmount),r.a.createElement(Je.a,{align:"left",style:{color:parseFloat(t.pnl)>0?"darkmagenta":"#00cbcb"}},r.a.createElement("b",null,t.pnl)),r.a.createElement(Je.a,{align:"left"},"0"!==t.netqty?e.getPercentage(t.totalbuyavgprice,t.ltp,t):"",(new Date).toLocaleTimeString()>"15:15:00"?t.percentPnL:""),r.a.createElement(Je.a,{align:"left"},t.ltp),r.a.createElement(Je.a,{align:"left"},"0"!==t.netqty?r.a.createElement(M.a,{size:"small",type:"number",variant:"contained",color:"Secondary",onClick:function(){return e.squareOff(t)}},"Square Off"):""))}):"",r.a.createElement(qe.a,{variant:"head",style:{fontWeight:"bold",backgroundColor:"lightgray"}},r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},"\xa0Total"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},this.state.allbuyavgprice),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},this.state.allsellavgprice),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},this.state.totalQtyTraded),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"}),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"}),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},this.state.totalMaxPnL),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left",style:{color:parseFloat(this.state.todayProfitPnL)>0?"darkmagenta":"#00cbcb"}},this.state.todayProfitPnL," "),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},(new Date).toLocaleTimeString()>"15:15:00"?this.state.totalPercentage&&this.state.totalPercentage.toFixed(2):""),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"}),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"})))))),r.a.createElement(A.a,{item:!0,xs:12,sm:12},r.a.createElement(kt,null)),r.a.createElement(A.a,{item:!0,xs:12,sm:12},r.a.createElement(vt.a,{style:{overflow:"auto",padding:"5px"}},r.a.createElement(A.a,{justify:"space-between",container:!0},r.a.createElement(A.a,{item:!0},r.a.createElement(J.a,{component:"h2",variant:"h6",color:"primary",gutterBottom:!0},"Patterns Founds (",this.state.foundPatternList&&this.state.foundPatternList.length,")",r.a.createElement("span",{id:"stockTesting",style:{fontSize:"18px",color:"gray"}}," ",this.state.stockTesting," "))),r.a.createElement(A.a,{item:!0},r.a.createElement(M.a,{variant:"contained",style:{marginLeft:"20px"},onClick:function(){return e.refreshLtpOnFoundPattern()}},"Live Refresh"))),r.a.createElement(Be.a,{size:"small","aria-label":"sticky table"},r.a.createElement(it.a,{style:{whiteSpace:"nowrap"},variant:"head"},r.a.createElement(qe.a,{key:"1",variant:"head",style:{fontWeight:"bold"}},r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},"Symbol | Activated(",this.state.totelActivatedCount,")"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},"Performance 6M"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},"OnLtp (",this.state.nr4TotalPer.toFixed(2),")%  "),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},"Qty"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},"PnL(",this.state.pnlAmountTotal.toFixed(2),")"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},"Fee(",this.state.totalBrokerChargesNR4.toFixed(2),")"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},"NetPnL(",this.state.totalNetProfit.toFixed(2),")"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},"OnH/L(",this.state.perHighLowTotal.toFixed(2),"% | ",this.state.netPnLAmountOnHighlowTotal.toFixed(2),")  "),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},"Patten"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},"FoundAt"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},"BuyAt"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},"SellAt"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},"UpdatedAt"))),r.a.createElement(_e.a,{style:{width:"",whiteSpace:"nowrap"}},this.state.foundPatternList?this.state.foundPatternList.map(function(t){return r.a.createElement(qe.a,{hover:!0,key:t.symboltoken},r.a.createElement(Je.a,{align:"left"}," ",r.a.createElement(M.a,{variant:"contained",style:{color:t.todayChange?t.todayChange>0?"green":"red":""},onClick:function(){return e.showCandleChart(t.candleChartData,t.symbol)}},t.symbol," ",t.symbolUpdated," ",r.a.createElement(Qe.a,null)," ")),r.a.createElement(Je.a,{title:t.symbol+" : Open all chart",align:"left",style:{fontSize:"9px",cursor:"pointer"},onClick:function(){return e.showMultipleCandleChart(t)}},t.pastPerferm?r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{style:{background:t.pastPerferm.totalLongPer/t.pastPerferm.totalLongs>=1?"#92f192":""}},t.pastPerferm.totalLongs,"L(",t.pastPerferm.totalLongPer,"%) | Avg:",(t.pastPerferm.totalLongPer/t.pastPerferm.totalLongs).toFixed(2),"%")," ",r.a.createElement("br",null),r.a.createElement("span",null,t.pastPerferm.totalLongs,"LH(",t.pastPerferm.totalLongHighPer,"%) | Avg: ",(t.pastPerferm.totalLongHighPer/t.pastPerferm.totalLongs).toFixed(2),"%")," ",r.a.createElement("br",null),r.a.createElement("span",{style:{background:t.pastPerferm.totalShortPer/t.pastPerferm.totalShort>=1?"#e87b7b":""}},t.pastPerferm.totalShort,"S:",t.pastPerferm.totalShortPer,"% | Avg:",(t.pastPerferm.totalShortPer/t.pastPerferm.totalShort).toFixed(2),"%")," ",r.a.createElement("br",null),r.a.createElement("span",null,t.pastPerferm.totalShort,"SL:",t.pastPerferm.totalShortLowPer,"% | Avg:",(t.pastPerferm.totalShortLowPer/t.pastPerferm.totalShort).toFixed(2),"%")," ",r.a.createElement("br",null)):""),r.a.createElement(Je.a,{align:"left"},r.a.createElement("b",null,t.orderActivated," ")),r.a.createElement(Je.a,{align:"left"},t.quantity),r.a.createElement(Je.a,{align:"left"},t.pnlAmount),r.a.createElement(Je.a,{align:"left"},t.brokerageCharges),r.a.createElement(Je.a,{align:"left"},r.a.createElement("b",null,t.netPnLAmount," ")),r.a.createElement(Je.a,{align:"left"},r.a.createElement("b",null,t.OnHighLowActivated," ")),r.a.createElement(Je.a,{align:"left"},t.pattenName),r.a.createElement(Je.a,{align:"left"},t.foundAt&&t.foundAt.substr(0,15)),r.a.createElement(Je.a,{align:"left"},t.BuyAt),r.a.createElement(Je.a,{align:"left"},t.SellAt),r.a.createElement(Je.a,{align:"left"},t.time))}):""))))))}}]),t}(r.a.Component);a(226),a(497),a(490),a(495);Object(_.a)(function(e){return{root:{backgroundColor:e.palette.background.paper,width:"auto"},MuiTabsScroller:{overflow:"auto"}}});var Dt=new ft.w3cwebsocket("wss://omnefeeds.angelbroking.com/NestHtml5Mobile/socket/stream"),Ot=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(S.a)(this,Object(v.a)(t).call(this,e))).onChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value));var t=e.target.value;C.autoCompleteSearch(t).then(function(e){var t=e.data;console.log(t),localStorage.setItem("autoSearchTemp",JSON.stringify(t)),a.setState({autoSearchList:t})})},a.onChangePattern=function(e){if(a.setState(Object(y.a)({},e.target.name,e.target.value)),"NR4_Daywide_daterage"==e.target.value){var t=localStorage.getItem("backTestResultDateRange")&&JSON.parse(localStorage.getItem("backTestResultDateRange"));a.setState({dateAndTypeKeys:Object.keys(t||{}),backTestResultDateRange:t})}},a.onChangeWatchlist=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value));var t=a.state.staticData;a.setState({symbolList:t[e.target.value]}),"selectall"==e.target.value&&a.setState({symbolList:localStorage.getItem("watchList")&&JSON.parse(localStorage.getItem("watchList"))})},a.myCallback=function(e,t){"START_DATE"===t?a.setState({startDate:e}):"END_DATE"===t&&a.setState({endDate:e})},a.getLTP=function(){var e={exchange:"NSE",tradingsymbol:a.state.tradingsymbol,symboltoken:a.state.symboltoken};C.getLTP(e).then(function(e){var t=X(e,"noPop"),n=t&&t.data;a.setState({InstrumentLTP:n})})},a.decodeWebsocketData=function(e){var t=[];try{for(var a=0;a<e.length;a++)t.push(String.fromCharCode(e[a]))}catch(n){}return t.join("")},a.makeConnection=function(e,t){var n='{"task":"cn","channel":"NONLM","token":"'+a.state.feedToken+'","user": "'+a.state.clientcode+'","acctid":"'+a.state.clientcode+'"}';Dt.send(n)},a.updateSocketWatch=function(e,t){var n=a.state.symbolList.map(function(e){return"nse_cm|"+e.token}),r={task:"mw",channel:n=n.join("&"),token:a.state.feedToken,user:a.state.clientcode,acctid:a.state.clientcode};Dt.send(JSON.stringify(r))},a.stopBacktesting=function(){a.setState({stopScaningFlag:!0})},a.backTestAnyPattern=Object(ae.a)(te.a.mark(function e(){var t,n,r,o,l,s,i,c,m;return te.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.setState({backTestResult:[],backTestFlag:!1}),console.log("this.state.patternType",a.state.patternType),a.state.patternType){e.next=5;break}return K.showError("Select pattern type"),e.abrupt("return");case 5:if("NR4"!==a.state.patternType){e.next=8;break}return a.backTestNR4(),e.abrupt("return");case 8:if("NR4ForNextDay"!==a.state.patternType){e.next=11;break}return a.NR4ForNextDay(),e.abrupt("return");case 11:if("NR4_SameDay"!==a.state.patternType){e.next=14;break}return a.backTestNR4SameDay(),e.abrupt("return");case 14:if("NR4_Daywide_daterage"!==a.state.patternType){e.next=31;break}t=ct(a.state.startDate),n=ct(a.state.endDate),r=t,o=n;case 19:if(!r.isSameOrBefore(o,"day")){e.next=29;break}if(console.log("Loop at ".concat(r.format("DD-MM-YYYY"))),a.backTestNR4DatewiseRange(r),!a.state.stopScaningFlag){e.next=24;break}return e.abrupt("break",29);case 24:return e.next=26,new Promise(function(e){return setTimeout(e,310*a.state.symbolList.length)});case 26:r.add(1,"days"),e.next=19;break;case 29:return a.setState({backTestFlag:!0,stopScaningFlag:!1}),e.abrupt("return");case 31:a.setState({backTestResult:[],backTestFlag:!1}),console.log("pattername",a.state.patternType),l=a.state.symbolList,s=1,i=te.a.mark(function e(t){var n;return te.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=l[t],m={exchange:"NSE",symboltoken:n.token,interval:"FIFTEEN_MINUTE",fromdate:ct(a.state.startDate).format("YYYY-MM-DD HH:mm"),todate:ct(new Date).format("YYYY-MM-DD HH:mm")},C.getHistoryData(m).then(function(e){var t=X(e,"noPop");if(t&&t.data&&t.data.length)for(var r=t.data,o=0;o<r.length-35;o++){var l=r.slice(o,o+10),i=r.slice(o+10,o+35);if(console.log("\n"),l.length>=10&&new Date(r[o][0]).toLocaleTimeString()<"14:15:00")switch(a.state.patternType){case"TweezerTop":a.backtestTweezerTop(l,n.symbol,i);break;case"TweezerBottom":a.backtestTweezerBottom(l,n.symbol,i)}s+=r.length}else console.log(" candle data emply")}),e.next=5,new Promise(function(e){return setTimeout(e,300)});case 5:a.setState({stockTesting:t+1+". "+n.symbol,runningTest:s});case 6:case"end":return e.stop()}},e)}),c=0;case 37:if(!(c<l.length)){e.next=42;break}return e.delegateYield(i(c),"t0",39);case 39:c++,e.next=37;break;case 42:case"end":return e.stop()}},e)})),a.NR4ForNextDay=Object(ae.a)(te.a.mark(function e(){var t,n,r,o,l,s;return te.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({FoundPatternList:[],backTestFlag:!1}),t=a.state.symbolList,1,0,n=te.a.mark(function e(n){var r;return te.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t[n],!a.state.stopScaningFlag){e.next=3;break}return e.abrupt("return","break");case 3:return a.setState({stockTesting:n+1+". "+r.symbol}),o=ct.duration("240:00:00"),l=ct(a.state.endDate).subtract(o),s={exchange:"NSE",symboltoken:r.token,interval:"ONE_DAY",fromdate:ct(l).format("YYYY-MM-DD HH:mm"),todate:ct(a.state.endDate).format("YYYY-MM-DD HH:mm")},C.getHistoryData(s).then(function(e){var t=X(e,"noPop");if(t&&t.data&&t.data.length){var n=t.data;n.reverse();var o=n.slice(0,4);if(o.length>=4){var l=[],s=[];o.forEach(function(e){l.push(e[2]-e[3]),s.push([e[0],e[1],e[2],e[3],e[4]])});var i=l[0],c=0;if(l.forEach(function(e){i<=e&&(i=e,c+=1)}),4==c){var m=o[0],g=n[0];console.log(r.symbol,o,l,c,g);var d=(m[2]+m[2]/100/10).toFixed(2),u=(m[3]-m[3]/100/10).toFixed(2),h={foundAt:new Date(m[0]).toString().substr(0,25),symbol:r.symbol,token:r.token,pattenName:"NR4",SellAt:u,high:m[2],low:m[3],BuyAt:d,candleChartData:s,close:m[4]};a.nr4CheckPastPerfommance(r.token,h)}}}else console.log(r.symbol," candle data emply")}).catch(function(e){K.showError(r.symbol+" Candle data not found!")}),e.next=10,new Promise(function(e){return setTimeout(e,350)});case 10:case"end":return e.stop()}},e)}),r=0;case 5:if(!(r<t.length)){e.next=13;break}return e.delegateYield(n(r),"t0",7);case 7:if("break"!==e.t0){e.next=10;break}return e.abrupt("break",13);case 10:r++,e.next=5;break;case 13:a.setState({backTestFlag:!0,stopScaningFlag:!1});case 14:case"end":return e.stop()}},e)})),a.findShortTraadeOnNextDay=function(e,t,n,r){var o=t[3]-t[3]/100/10,l=o+1*o/100,s=[],i=!0,c={},m="",g=r[0][3];if(console.log(e.symbol,"result candle",r),r&&r.length){for(var d=0;d<r.length;d++){var u=r[d];s.push([new Date(u[0]).getTime(),u[1],u[2],u[3],u[4]]),u[2]<g&&(g=u[3])}for(var h=0;h<r.length;h++){m=r[h],i&&m[3]<o&&(console.log(e.symbol,"taken short enty",m[3]),c={foundAt:"Short-"+new Date(m[0]).toLocaleString(),symbol:e.symbol,sellEntyPrice:o,stopLoss:l,brokerageCharges:.06,quantity:Math.floor(1e5/o),candleChartData:n},i=!1);var p=100*(o-m[3])/o;if(console.log(e.symbol,"perChange",p),!i&&p>=1){var f=o-1*o/100;c.buyExitPrice=f,c.perChange=p,c.squareOffAt=new Date(m[0]).toLocaleString(),c.exitStatus="Flat_1%_Booked";break}if(console.log(e.symbol,"high",m[2]),!i&&m[2]>=l){var y=100*(o-l)/o;c.buyExitPrice=l,c.perChange=y,c.squareOffAt=new Date(m[0]).toLocaleString(),c.exitStatus="SL_Hit";break}}if(!i&&!c.sellEntyPrice){y=100*(m[4]-o)/o;c.buyExitPrice=m[4],c.perChange=y,c.squareOffAt=new Date(m[0]).toLocaleString(),c.exitStatus="Market_End"}if(!i&&Math.floor(1e5/o)&&c.buyExitPrice){var b=100*(o-g)/o;c.highAndLow=g,c.perChngOnHighLow=b,c.candleChartDataInside=s,a.setState({backTestResult:[].concat(Object($.a)(a.state.backTestResult),[c])})}}},a.findLongsTraadeOnNextDay=function(e,t,n,r){var o=t[2]+t[2]/100/10,l=o-1*o/100,s=[],i=!0,c={},m="",g=r[0][2];if(r&&r.length){for(var d=0;d<r.length;d++){var u=r[d];s.push([new Date(u[0]).getTime(),u[1],u[2],u[3],u[4]]),g<r[d][2]&&(g=r[d][2])}for(var h=0;h<r.length;h++){m=r[h],i&&m[2]>o&&(c={foundAt:"Long-"+new Date(m[0]).toLocaleString(),symbol:e.symbol,buyExitPrice:o,stopLoss:l,brokerageCharges:.06,quantity:Math.floor(1e5/o),candleChartData:n},i=!1);var p=100*(m[2]-o)/o;if(!i&&p>=1){var f=o+1*o/100;c.sellEntyPrice=f,c.perChange=p,c.squareOffAt=new Date(m[0]).toLocaleString(),c.exitStatus="Flat_1%_Booked";break}if(!i&&m[3]<=l){var y=100*(l-o)/o;c.sellEntyPrice=l,c.perChange=y,c.squareOffAt=new Date(m[0]).toLocaleString(),c.exitStatus="SL_Hit";break}}if(!i&&!c.sellEntyPrice){y=100*(m[4]-o)/o;c.buyExitPrice=m[4],c.perChange=y,c.squareOffAt=new Date(m[0]).toLocaleString(),c.exitStatus="Market_End"}if(!i&&Math.floor(1e5/o)&&c.buyExitPrice){var b=100*(g-o)/o;c.highAndLow=g,c.perChngOnHighLow=b,c.candleChartDataInside=s,console.log(e.symbol,"longTradeFound",c),a.setState({backTestResult:[].concat(Object($.a)(a.state.backTestResult),[c])})}}},a.backTestNR4SameDay=Object(ae.a)(te.a.mark(function e(){var t,n,r,o,l,s,i,c;return te.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({backTestResult:[],backTestFlag:!1,searchFailed:0}),t=a.state.symbolList,n=1,r=0,o=te.a.mark(function e(r){var o;return te.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t[r],!a.state.stopScaningFlag){e.next=3;break}return e.abrupt("return","break");case 3:return s=ct.duration("240:00:00"),i=ct(a.state.endDate).subtract(s),c={exchange:"NSE",symboltoken:o.token,interval:"ONE_DAY",fromdate:ct(i).format("YYYY-MM-DD HH:mm"),todate:ct(a.state.endDate).format("YYYY-MM-DD HH:mm")},C.getHistoryData(c).then(function(e){var t=X(e,"noPop");if(t&&t.data&&t.data.length){var r=t.data;r.reverse();var l=r.slice(1,5);if(l.length>=4){var s=[],i=[];l.forEach(function(e){s.push(e[2]-e[3]),i.push([e[0],e[1],e[2],e[3],e[4]])});var c=s[0],m=0;if(s.forEach(function(e){c<=e&&(c=e,m+=1)}),4==m){var g=l[0],d=r[0];i.unshift([d[0],d[1],d[2],d[3],d[4]]),console.log(o.symbol,l,s,m,d);var u=ct(d[0]).set({hour:9,minute:15}),h=ct(d[0]).set({hour:15,minute:30}),p={exchange:"NSE",symboltoken:o.token,interval:"ONE_MINUTE",fromdate:ct(u).format("YYYY-MM-DD HH:mm"),todate:ct(h).format("YYYY-MM-DD HH:mm")};C.getHistoryData(p).then(function(e){var t=X(e,"noPop");t=t&&t.data,a.findLongsTraadeOnNextDay(o,g,i,t),a.findShortTraadeOnNextDay(o,g,i,t)}).catch(function(e){K.showError(o.symbol+" FIVE_MINUTE Candle data not found!"),a.setState({searchFailed:a.state.searchFailed+1})})}}n=n+r.length-35}else console.log(o.symbol," candle data emply"),K.showError(o.symbol+" FIVE_MINUTE candle data emply!"),a.setState({searchFailed:a.state.searchFailed+1})}).catch(function(e){K.showError(o.symbol+" 1 day Candle data not found!"),a.setState({searchFailed:a.state.searchFailed+1})}),e.next=9,new Promise(function(e){return setTimeout(e,305)});case 9:a.setState({stockTesting:r+1+". "+o.symbol,runningTest:n});case 10:case"end":return e.stop()}},e)}),l=0;case 5:if(!(l<t.length)){e.next=13;break}return e.delegateYield(o(l),"t0",7);case 7:if("break"!==e.t0){e.next=10;break}return e.abrupt("break",13);case 10:l++,e.next=5;break;case 13:a.setState({backTestFlag:!0,stopScaningFlag:!1}),console.log("sumPercentage",r);case 15:case"end":return e.stop()}},e)})),a.backTestNR4DatewiseRange=function(){var e=Object(ae.a)(te.a.mark(function e(t){var n,r,o,l,s,i,c;return te.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({backTestFlag:!1}),n=a.state.symbolList,r=1,0,o=te.a.mark(function e(o){var l;return te.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(l=n[o],!a.state.stopScaningFlag){e.next=3;break}return e.abrupt("return","break");case 3:return s=ct.duration("240:00:00"),i=ct(t).subtract(s),c={exchange:"NSE",symboltoken:l.token,interval:"ONE_DAY",fromdate:ct(i).format("YYYY-MM-DD HH:mm"),todate:ct(t).format("YYYY-MM-DD HH:mm")},C.getHistoryData(c).then(function(e){var n=X(e,"noPop");if(n&&n.data&&n.data.length){var o=n.data;o.reverse();var s=o.slice(1,5);if(s.length>=4){var i=[],c=[];s.forEach(function(e){i.push(e[2]-e[3]),c.push([e[0],e[1],e[2],e[3],e[4]])});var m=i[0],g=0;if(i.forEach(function(e){m<=e&&(m=e,g+=1)}),4==g){var d=s[0],u=o[0];c.unshift([u[0],u[1],u[2],u[3],u[4]]);var h=t.format("DD-MM-YYYY")+" "+a.state.selectedWatchlist,p=localStorage.getItem("backTestResultDateRange")?JSON.parse(localStorage.getItem("backTestResultDateRange")):{},f=p[h]?p[h]:[];console.log(l.symbol,s,i,g,u);var y=(d[2]+d[2]/100/10).toFixed(2);if(u[2]>y){var b=100*(u[4]-y)/y,E=100*(u[2]-y)/y;b,console.log(l.symbol,d[0],"upside","same day high",d[2],"same day low",d[3],"nextdaylow",u[3],"nextdayhigh",u[2],"next day closing",u[4],b+"%");var S={foundAt:"Long - "+new Date(d[0]).toLocaleString(),symbol:l.symbol,sellEntyPrice:u[4],highAndLow:u[2],stopLoss:d[3],buyExitPrice:y,brokerageCharges:.06,perChange:b.toFixed(2),perChngOnHighLow:E.toFixed(2),squareOffAt:new Date(u[0]).toLocaleString(),quantity:Math.floor(1e4/d[2]),candleChartData:c};Math.floor(1e4/d[2])&&(a.setState({backTestResult:[].concat(Object($.a)(a.state.backTestResult),[S])}),f.push(S),p[h]=f,localStorage.setItem("backTestResultDateRange",JSON.stringify(p)))}var v=(d[3]-d[3]/100/10).toFixed(2);if(u[3]<v){b=100*(v-u[4])/d[3];var k=100*(v-u[3])/d[3];b,console.log(l.symbol,d[0],"dowside","same day high",d[2],"same day low",d[3],"nextdaylow",u[3],"nextdayhigh",u[2],"next day closing",u[4],b+"%");S={foundAt:"Short - "+new Date(d[0]).toLocaleString(),symbol:l.symbol,sellEntyPrice:v,stopLoss:d[2],buyExitPrice:u[4],highAndLow:u[3],brokerageCharges:.06,perChange:b.toFixed(2),perChngOnHighLow:k.toFixed(2),squareOffAt:new Date(u[0]).toLocaleString(),quantity:Math.floor(1e4/d[3]),candleChartData:c};Math.floor(1e4/d[3])&&(a.setState({backTestResult:[].concat(Object($.a)(a.state.backTestResult),[S])}),f.push(S),p[h]=f,console.log("backTestResultDateRange",p),localStorage.setItem("backTestResultDateRange",JSON.stringify(p)),a.setState({dateAndTypeKeys:Object.keys(p),backTestResultDateRange:p}))}}}r=r+o.length-35}else console.log(l.symbol," candle data emply")}),e.next=9,new Promise(function(e){return setTimeout(e,300)});case 9:a.setState({stockTesting:t.format("YYYY-MM-DD")+" "+o+"1. "+l.symbol,runningTest:r});case 10:case"end":return e.stop()}},e)}),l=0;case 5:if(!(l<n.length)){e.next=13;break}return e.delegateYield(o(l),"t0",7);case 7:if("break"!==e.t0){e.next=10;break}return e.abrupt("break",13);case 10:l++,e.next=5;break;case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.backTestNR4=Object(ae.a)(te.a.mark(function e(){var t,n,r,o,l,s;return te.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({backTestResult:[],backTestFlag:!1}),t=a.state.symbolList,n=1,r=0,o=te.a.mark(function e(o){var l;return te.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l=t[o],s={exchange:"NSE",symboltoken:l.token,interval:"ONE_DAY",fromdate:ct(a.state.startDate).format("YYYY-MM-DD HH:mm"),todate:ct(a.state.endDate).format("YYYY-MM-DD HH:mm")},C.getHistoryData(s).then(function(e){var t=X(e,"noPop");if(t&&t.data&&t.data.length)for(var o=t.data,s=0;s<o.length-4;s++){var i=o.slice(s,s+4);if(i.length>=4&&new Date(o[s][0]).toLocaleTimeString()<"14:15:00"){i.reverse();var c=[],m=[];i.forEach(function(e){c.push(e[2]-e[3]),m.push([e[0],e[1],e[2],e[3],e[4]])});var g=c[0],d=0;if(c.forEach(function(e){g<=e&&(g=e,d+=1)}),4==d){var u=i[0],h=o[s+4];m.unshift([h[0],h[1],h[2],h[3],h[4]]);var p=(u[2]+u[2]/100/10).toFixed(2);if(h[2]>p){var f=100*(h[a.state.longExitPriceType]-p)/p,y=100*(h[2]-p)/p;r+=f,console.log(l.symbol,u[0],"upside","same day high",u[2],"same day low",u[3],"nextdaylow",h[3],"nextdayhigh",h[2],"next day closing",h[4],f+"%");var b={foundAt:"Long - "+new Date(u[0]).toLocaleString(),symbol:l.symbol,sellEntyPrice:h[a.state.longExitPriceType],stopLoss:u[3],highAndLow:h[2],perChngOnHighLow:y.toFixed(2),buyExitPrice:p,brokerageCharges:.06,perChange:f.toFixed(2),squareOffAt:new Date(h[0]).toLocaleString(),quantity:Math.floor(1e4/u[2]),candleChartData:m};Math.floor(1e4/u[2])&&(a.setState({backTestResult:[].concat(Object($.a)(a.state.backTestResult),[b])}),a.setState({backTestResult:a.state.backTestResult.reverse()}))}var E=(u[3]-u[3]/100/10).toFixed(2);if(h[3]<E){f=100*(E-h[a.state.shortExitPriceType])/u[3];var S=100*(E-h[3])/u[3];r+=f,console.log(l.symbol,u[0],"dowside","same day high",u[2],"same day low",u[3],"nextdaylow",h[3],"nextdayhigh",h[2],"next day closing",h[4],f+"%");b={foundAt:"Short - "+new Date(u[0]).toLocaleString(),symbol:l.symbol,sellEntyPrice:E,perChngOnHighLow:S.toFixed(2),stopLoss:u[2],highAndLow:h[3],buyExitPrice:h[a.state.shortExitPriceType],brokerageCharges:.06,perChange:f.toFixed(2),squareOffAt:new Date(h[0]).toLocaleString(),quantity:Math.floor(1e4/u[3]),candleChartData:m};Math.floor(1e4/u[3])&&a.setState({backTestResult:[].concat(Object($.a)(a.state.backTestResult),[b])})}}}n=n+o.length-35}else console.log(l.symbol," candle data emply")}),e.next=5,new Promise(function(e){return setTimeout(e,300)});case 5:a.setState({stockTesting:o+1+". "+l.symbol,runningTest:n});case 6:case"end":return e.stop()}},e)}),l=0;case 5:if(!(l<t.length)){e.next=10;break}return e.delegateYield(o(l),"t0",7);case 7:l++,e.next=5;break;case 10:a.setState({backTestFlag:!0}),console.log("sumPercentage",r);case 12:case"end":return e.stop()}},e)})),a.nr4CheckPastPerfommance=function(e,t){var n=ct.duration("4320:00:00"),r=ct(a.state.endDate).subtract(n),o=0,l=0,s=0,i=0,c=0,m=0,g=[],d=[];console.log("starting function foundStock",t);var u={exchange:"NSE",symboltoken:e,interval:"ONE_DAY",fromdate:ct(r).format("YYYY-MM-DD HH:mm"),todate:ct(a.state.endDate).format("YYYY-MM-DD HH:mm")};C.getHistoryData(u).then(function(n){var r=X(n,"noPop");if(console.log("candle history",r),r&&r.data&&r.data.length){for(var u=r.data,h=0;h<u.length-4;h++){var p=u.slice(h,h+4);if(p.length>=4&&new Date(u[h][0]).toLocaleTimeString()<"14:15:00"){p.reverse();var f=[],y=[];p.forEach(function(e){f.push(e[2]-e[3]),y.push([e[0],e[1],e[2],e[3],e[4]])});var b=f[0],E=0;if(f.forEach(function(e){b<=e&&(b=e,E+=1)}),4==E){var S=p[0],v=u[h+4];y.unshift([v[0],v[1],v[2],v[3],v[4]]),console.log(e,p,f,E,S[0].toString().substr(0,25));var k=(S[2]+S[2]/100/10).toFixed(2);if(v[2]>k){var w=100*(v[4]-k)/k,x=100*(v[2]-k)/k,L={foundAt:"Long - "+new Date(S[0]).toLocaleString(),sellEntyPrice:v[4],stopLoss:S[3],highAndLow:v[2],perChngOnHighLow:x.toFixed(2),buyExitPrice:k,brokerageCharges:.06,perChange:w.toFixed(2),squareOffAt:new Date(v[0]).toLocaleString(),quantity:Math.floor(1e4/S[2]),candleChartData:y};g.push(L),o+=1,s+=w,c+=x}var T=(S[3]-S[3]/100/10).toFixed(2);if(v[3]<T){w=100*(T-v[4])/S[3];var P=100*(T-v[3])/S[3],C={foundAt:"Short - "+new Date(S[0]).toLocaleString(),sellEntyPrice:T,perChngOnHighLow:P.toFixed(2),stopLoss:S[2],highAndLow:v[3],buyExitPrice:v[4],brokerageCharges:.06,perChange:w.toFixed(2),squareOffAt:new Date(v[0]).toLocaleString(),quantity:Math.floor(1e4/S[3]),candleChartData:y};d.push(C),l+=1,i+=w,m+=P}}}}var D={totalLongs:o,totalShort:l,totalLongPer:s.toFixed(2),totalShortPer:i.toFixed(2),totalLongHighPer:c.toFixed(2),totalShortLowPer:m.toFixed(2)};t&&(t.pastPerferm=D),t.longCandles=g,t.shortCandles=d,console.log("foundStock",t),Math.floor(1e4/S[4])&&(a.setState({FoundPatternList:[].concat(Object($.a)(a.state.FoundPatternList),[t])}),localStorage.setItem("FoundPatternList",JSON.stringify(a.state.FoundPatternList)))}else console.log(e," candle data emply")})},a.backtestTweezerTop=function(e,t,n){if(e&&e.length>0){for(var r=(e=e.reverse())[2]&&e[2][2],o=e[2]&&e[2][3],l=3;l<e.length;l++)r<e[l][2]&&(r=e[l][2]),e[l][3]<o&&(o=e[l][3]);var s=e[9][3],i=e[2][2],c={time:e[0]&&e[0][0],open:e[0]&&e[0][1],high:e[0]&&e[0][2],low:e[0]&&e[0][3],close:e[0]&&e[0][4]},m={time:e[1]&&e[1][0],open:e[1]&&e[1][1],high:e[1]&&e[1][2],low:e[1]&&e[1][3],close:e[1]&&e[1][4]},g=100*(i-s)/s,d=m.low<c.low?m.low:c.low,u=m.high<c.high?m.high:c.high;if(g>=1.5&&r<u&&o<d&&m.open<m.close&&c.open>c.close&&Math.round(m.close)==Math.round(c.open)&&Math.round(m.open)==Math.round(c.close)&&(console.log("%c"+new Date(e[0][0]).toString(),"color: green"),console.log(t,"last 8th candle diff% ",g,"10th Low",s,"3rd high",i),console.log(t,"maxHigh",r,"maxLow",o),console.log("last10Candle",e),console.log(t,"perfect twisser top done close=open || open=close"),console.log("next10Candle",n),n&&n.length)){for(var h=(u+u/100/10).toFixed(2),p=(d-d/100/10).toFixed(2),f=0;f<n.length;f++){if(n[f][2]>h){h,n[f][0];break}if("15:15:00"==new Date(n[f][0]).toLocaleTimeString()){n[f][4],n[f][0];break}}for(var y=n[0][4],b=1;b<n.length&&(n[b][4]<y&&(y=n[b][4],n[b][0]),"15:15:00"!=new Date(n[b][0]).toLocaleTimeString());b++);for(var E=h,S=0;S<n.length;S++){if(!(E>n[S][2])){E=n[S][4].toFixed(2),n[S][0];break}if(E=(n[S][2]+n[S][2]/100/4).toFixed(2),n[S][0],"15:15:00"==new Date(n[S][0]).toLocaleTimeString())break}for(var v=0,k="",w=0;w<n.length;w++){if(100*(n[w][3]-p)/p<-.7){v=n[w][3],k=n[w][0];break}if(n[w][2]>h){v=h,k=n[w][0];break}if("15:15:00"==new Date(n[w][0]).toLocaleTimeString()){v=n[w][3],k=n[w][0];break}}for(var x=0;x<n.length;x++){if(100*(n[x][3]-p)/p<=-1.5){n[x][3],n[x][0];break}if(n[x][2]>h){h,n[x][0];break}if("15:15:00"==new Date(n[x][0]).toLocaleTimeString()){n[x][3],n[x][0];break}}var L=localStorage.getItem("backTestResult")?JSON.parse(localStorage.getItem("backTestResult")):[];if(n[0][3]<d||n[1][3]<d||n[2][3]<d){var T={foundAt:new Date(e[0][0]).toLocaleString(),symbol:t,sellEntyPrice:p,stopLoss:h,orderActivated:!1,buyExitPrice:0,brokerageCharges:.06,quantity:Math.floor(1e4/p)};T.orderActivated=!0,T.squareOffAt=new Date(k).toLocaleString(),T.buyExitPrice=v,T.perChange=(100*(T.sellEntyPrice-T.buyExitPrice)/T.sellEntyPrice).toFixed(2),L.push(T),a.setState({backTestResult:[].concat(Object($.a)(a.state.backTestResult),[T])})}}}a.setState({backTestFlag:!0})},a.backtestTweezerBottom=function(e,t,n){if(e&&e.length>0){for(var r=(e=e.reverse())[2]&&e[2][2],o=e[2]&&e[2][3],l=3;l<e.length;l++)r<e[l][2]&&(r=e[l][2]),e[l][3]<o&&(o=e[l][3]);var s=e[9][3],i=e[2][2],c={time:e[0]&&e[0][0],open:e[0]&&e[0][1],high:e[0]&&e[0][2],low:e[0]&&e[0][3],close:e[0]&&e[0][4]},m={time:e[1]&&e[1][0],open:e[1]&&e[1][1],high:e[1]&&e[1][2],low:e[1]&&e[1][3],close:e[1]&&e[1][4]},g=100*(i-s)/s,d=m.low<c.low?m.low:c.low,u=m.high<c.high?m.high:c.high;if(g<=-1.5&&u<r&&d<o&&m.open>m.close&&c.close>c.open&&(Math.round(m.close)==Math.round(c.open)||Math.round(m.open)==Math.round(c.close))&&(console.log("%c"+new Date(e[0][0]).toString(),"color: green"),console.log(t,"last 8th candle diff% ",g,"10th Low",s,"3rd high",i),console.log(t,"maxHigh",r,"maxLow",o),console.log("last10Candle",e),console.log(t,"perfect twisser top done close=open || open=close"),console.log("next10Candle",n),n&&n.length)){for(var h=(u+u/100/10).toFixed(2),p=(d-d/100/10).toFixed(2),f=0,y="",b=0;b<n.length;b++){if(n[b][2]<p){f=p,y=n[b][0];break}if("15:15:00"==new Date(n[b][0]).toLocaleTimeString()){f=n[b][4],y=n[b][0];break}}for(var E=n[0][4],S=1;S<n.length&&(E<n[S][4]&&(E=n[S][4],n[S][0]),"15:15:00"!=new Date(n[S][0]).toLocaleTimeString());S++);for(var v=p,k=0;k<n.length;k++){if(!(v>n[k][2])){v=n[k][4].toFixed(2),n[k][0];break}if(v=(n[k][2]+n[k][2]/100/4).toFixed(2),n[k][0],"15:15:00"==new Date(n[k][0]).toLocaleTimeString())break}for(var w=0;w<n.length;w++){if(100*(n[w][3]-h)/h>.7){n[w][3],n[w][0];break}if(n[w][2]>p){p,n[w][0];break}if("15:15:00"==new Date(n[w][0]).toLocaleTimeString()){n[w][3],n[w][0];break}}for(var x=0;x<n.length;x++){if(100*(n[x][3]-h)/h>=-1.5){n[x][3],n[x][0];break}if(n[x][2]>p){p,n[x][0];break}if("15:15:00"==new Date(n[x][0]).toLocaleTimeString()){n[x][3],n[x][0];break}}var L=localStorage.getItem("backTestResult")?JSON.parse(localStorage.getItem("backTestResult")):[];if(n[0][3]<d||n[1][3]<d||n[2][3]<d){var T={foundAt:new Date(e[0][0]).toLocaleString(),symbol:t,sellEntyPrice:0,stopLoss:p,orderActivated:!1,buyExitPrice:h,brokerageCharges:.06,quantity:Math.floor(1e4/h)};T.orderActivated=!0,T.squareOffAt=new Date(y).toLocaleString(),T.sellEntyPrice=f,T.perChange=(100*(T.sellEntyPrice-T.buyExitPrice)/T.sellEntyPrice).toFixed(2),L.push(T),a.setState({backTestResult:[].concat(Object($.a)(a.state.backTestResult),[T])})}}}a.setState({backTestFlag:!0})},a.placeOrder=function(e,t){var n={variety:"NORMAL",tradingsymbol:a.state.tradingsymbol,symboltoken:a.state.symboltoken,transactiontype:e,exchange:"NSE",ordertype:0===a.state.buyPrice?"MARKET":"LIMIT",producttype:a.state.producttype,duration:"DAY",price:a.state.buyPrice,squareoff:"0",stoploss:"0",quantity:a.state.quantity};C.placeOrder(n).then(function(e){var n=X(e);n.status&&"SUCCESS"===n.message&&(localStorage.setItem("ifNotBought","false"),a.setState({orderid:n.data&&n.data.orderid}),a.state.stoploss&&a.placeSLMOrder(a.state.stoploss,t))})},a.LoadSymbolDetails=function(e){for(var t="",n=0;n<a.state.symbolList.length;n++)if(a.state.symbolList[n].symbol===e){t=a.state.symbolList[n].token,a.setState({tradingsymbol:e,symboltoken:a.state.symbolList[n].token});break}a.getHistory(t)},a.placeSLMOrder=function(e){var t={tradingsymbol:a.state.tradingsymbol,symboltoken:a.state.symboltoken,transactiontype:e||"SELL",exchange:"NSE",ordertype:"STOPLOSS_MARKET",producttype:a.state.producttype,duration:"DAY",price:0,squareoff:"0",stoploss:"0",quantity:a.state.quantity,triggerprice:a.state.stoploss,variety:"STOPLOSS"};C.placeOrder(t).then(function(e){var t=X(e);t.status&&"SUCCESS"===t.message&&(localStorage.setItem("ifNotBought","false"),a.setState({orderid:t.data&&t.data.orderid}))})},a.getHistory=function(e){var t=ct.duration("00:50:00"),n=ct(new Date).subtract(t),r={exchange:"NSE",symboltoken:e,interval:"ONE_MINUTE",fromdate:ct(n).format("YYYY-MM-DD HH:mm"),todate:ct(new Date).format("YYYY-MM-DD HH:mm")};C.getHistoryData(r).then(function(e){var t=X(e,"noPop");if(t&&t.data){var n=t.data;n&&n.sort(function(e,t){return new Date(t[0])-new Date(e[0])}),n.length>0&&(localStorage.setItem("InstrumentHistroy",JSON.stringify(n)),a.setState({InstrumentHistroy:n,buyPrice:n[0][2]})),a.getLTP()}})},a.onSelectItem=function(e,t){var n=JSON.parse(localStorage.getItem("autoSearchTemp"));if(n.length>0){for(var r="",o=0;o<n.length;o++)if(console.log("fdata",n[o].symbol),n[o].symbol===t){r=n[o];break}var l=localStorage.getItem("watchList")?JSON.parse(localStorage.getItem("watchList")):[];l.filter(function(e){return e.token===t}).length||(l.push(r),localStorage.setItem("watchList",JSON.stringify(l)),C.saveWatchListJSON({stock:r}).then(function(e){var t=X(e,"noPop");console.log(t)})),a.setState({symbolList:JSON.parse(localStorage.getItem("watchList")),search:""}),setTimeout(function(){a.updateSocketWatch()},100)}},a.deleteItemWatchlist=function(e){var t=a.state.symbolList,n=t.findIndex(function(t){return t.symbol===e});t.splice(n,1),a.setState({symbolList:t})},a.getAveragePrice=function(e){for(var t=localStorage.getItem("oderbookData"),n=0,r=0;r<t.length;r++)if("orderId"===t[r].orderid){n=t[r].averageprice,a.setState({averageprice:n});break}return n},a.showCandleChart=function(e,t,a){e=e&&e.reverse(),localStorage.setItem("candleChartData",JSON.stringify(e)),localStorage.setItem("cadleChartSymbol",t),a&&localStorage.setItem("chartInfoDetails",JSON.stringify(a)),document.getElementById("showCandleChart").click()},a.showCandleBothChart=function(e){var t=e.candleChartData&&e.candleChartData.reverse();localStorage.setItem("candleChartData",JSON.stringify(t)),localStorage.setItem("cadleChartSymbol",e.symbol);var a=e.candleChartDataInside;a&&localStorage.setItem("candleChartDataInside",JSON.stringify(a)),document.getElementById("showCandleChart").click()},a.state={sumPercentage:0,autoSearchList:[],isDasable:!1,isError:!1,InstrumentLTP:{},ifNotBought:!0,autoSearchTemp:[],backTestResult:[],backTestFlag:!0,patternType:"NR4_SameDay",symboltoken:"",tradingsymbol:"",buyPrice:0,quantity:1,producttype:"INTRADAY",symbolList:localStorage.getItem("watchList")&&JSON.parse(localStorage.getItem("watchList"))||[],selectedWatchlist:"NIFTY BANK",longExitPriceType:4,shortExitPriceType:4,candleChartData:[],stopScaningFlag:!1,backTestResultDateRange:[],searchFailed:0,FoundPatternList:localStorage.getItem("FoundPatternList")&&JSON.parse(localStorage.getItem("FoundPatternList"))||[]},a.myCallback=a.myCallback.bind(Object(k.a)(a)),a.updateSocketWatch=a.updateSocketWatch.bind(Object(k.a)(a)),a}return Object(w.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){var e=this;C.getStaticData().then(function(t){var a=t.data,n=Object.keys(a);e.setState({totalWatchlist:n}),e.setState({staticData:a});var r=[];n.forEach(function(e){a[e].forEach(function(e){r.filter(function(t){return t.token===e.token}).length||r.push(e)})}),localStorage.setItem("watchList",JSON.stringify(r)),e.setState({symbolList:a[e.state.selectedWatchlist]})});var t=JSON.parse(localStorage.getItem("userTokens")),a=t&&t.feedToken,n=JSON.parse(localStorage.getItem("userProfile")),r=n&&n.clientcode;this.setState({feedToken:a,clientcode:r}),Dt.onopen=function(e){},Dt.onmessage=function(t){var a=window.atob(t.data),n=e.decodeWebsocketData(bt.a.inflate(a)),r=JSON.parse(n);e.state.symbolList&&e.state.symbolList.forEach(function(t){var a=r.filter(function(e){return e.tk==t.token});a.length>0&&a[0].ltp&&e.setState(Object(y.a)({},t.symbol+"ltp",a.length>0&&a[0].ltp)),a.length>0&&a[0].cng&&e.setState(Object(y.a)({},t.symbol+"nc",a.length>0&&a[0].nc));var n=localStorage.getItem("foundTweezerTop_"+t.token)&&JSON.parse(localStorage.getItem("foundTweezerTop"+t.token));n&&n.symboltoken==t.token&&n.entryBelow<a[0].ltp&&(console.log("TweezerTop ",n.tradingsymbol,"entry found at ",a[0].ltp),e.setState({tradingsymbol:n.tradingsymbol,symboltoken:n.symboltoken,buyPrice:0,producttype:"INTRADAY",quantity:n.quantity}))})},Dt.onerror=function(e){console.log("socket error",e)},setInterval(function(){var e='{"task":"hb","channel":"","token":"'+a+'","user": "'+r+'","acctid":"'+r+'"}';Dt.send(e)},59e3),localStorage.getItem("watchList")||localStorage.setItem("watchList",[])}},{key:"render",value:function(){var e=this,t={myCallback:this.myCallback,startDate:"",endDate:"",firstLavel:"Start Date and Time",secondLavel:"End Date and Time"},a=0,n=0,o=0,l=0,s=0,i=0,c=0,g=0,d=0;return r.a.createElement(r.a.Fragment,null,r.a.createElement(nt,null),r.a.createElement(Xe,null),r.a.createElement(A.a,{direction:"row",container:!0},r.a.createElement(A.a,{item:!0,xs:12,sm:2},r.a.createElement(mt.a,{freeSolo:!0,id:"free-solo-2-demo",disableClearable:!0,style:{paddingLeft:"10px",paddingRight:"10px"},onChange:this.onSelectItem,options:this.state.autoSearchList.length>0?this.state.autoSearchList.map(function(e){return e.symbol}):[],renderInput:function(t){return r.a.createElement(Y.a,Object.assign({onChange:e.onChange},t,{label:"Search Symbol ("+e.state.symbolList.length+")",margin:"normal",variant:"standard",name:"search",value:e.state.search,InputProps:Object(m.a)({},t.InputProps,{type:"search"})}))}}),r.a.createElement("div",{style:{marginLeft:"10px"}},r.a.createElement(gt.a,Object(y.a)({style:{paddingLeft:"12px"}},"style",It.selectStyle),r.a.createElement(H.a,{htmlFor:"gender"},"Select Watchlist"),r.a.createElement(dt.a,{value:this.state.selectedWatchlist,name:"selectedWatchlist",onChange:this.onChangeWatchlist},r.a.createElement(ut.a,{value:"selectall"},"Select All"),this.state.totalWatchlist&&this.state.totalWatchlist.map(function(e){return r.a.createElement(ut.a,{value:e},e)})))),r.a.createElement("div",{style:{overflowY:"scroll",height:"75vh"}},this.state.symbolList&&this.state.symbolList.length?this.state.symbolList.map(function(t){return r.a.createElement(r.a.Fragment,null,r.a.createElement(fe.a,{button:!0,style:{fontSize:"12px"}},r.a.createElement(be.a,{style:{color:(e.state[t.symbol+"nc"],"")},onClick:function(){return e.LoadSymbolDetails(t.symbol)},primary:t.name})," ",e.state[t.symbol+"ltp"]," (",e.state[t.symbol+"nc"],"%) ",r.a.createElement(St.a,{onClick:function(){return e.deleteItemWatchlist(t.symbol)}})))}):"")),r.a.createElement(A.a,{item:!0,xs:12,sm:10},r.a.createElement(A.a,{direction:"row",alignItems:"center",container:!0},r.a.createElement(A.a,{style:{display:"none"},direction:"row",alignItems:"center",container:!0},r.a.createElement(A.a,{item:!0,xs:10,sm:5},r.a.createElement(J.a,{variant:"h5"},this.state.tradingsymbol," : ",this.state.InstrumentLTP?this.state.InstrumentLTP.ltp:"","   ",this.state.sbinLtp),"Open : ",this.state.InstrumentLTP?this.state.InstrumentLTP.open:""," \xa0 High : ",this.state.InstrumentLTP?this.state.InstrumentLTP.high:""," \xa0 Low :  ",this.state.InstrumentLTP?this.state.InstrumentLTP.low:"","\xa0 Previous Close :  ",this.state.InstrumentLTP?this.state.InstrumentLTP.close:""," \xa0"),r.a.createElement(A.a,{item:!0,xs:12,sm:2},r.a.createElement(gt.a,{style:It.selectStyle},r.a.createElement(H.a,{htmlFor:"gender"},"Order Type"),r.a.createElement(dt.a,{value:this.state.producttype,name:"producttype",onChange:this.onChange},r.a.createElement(ut.a,{value:"INTRADAY"},"INTRADAY"),r.a.createElement(ut.a,{value:"DELIVERY"},"DELIVERY")))),r.a.createElement(A.a,{item:!0,xs:10,sm:1},r.a.createElement(Y.a,{id:"buyPrice",label:"Buy Price",value:this.state.buyPrice,name:"buyPrice",onChange:this.onChange})),r.a.createElement(A.a,{item:!0,xs:10,sm:1},r.a.createElement(Y.a,{id:"quantity",label:"Qty",value:this.state.quantity,name:"quantity",onChange:this.onChange})),r.a.createElement(A.a,{item:!0,xs:10,sm:1},r.a.createElement(Y.a,{id:"stoploss",label:"SL",value:this.state.stoploss,name:"stoploss",onChange:this.onChange})),r.a.createElement(A.a,{item:!0,xs:1,sm:2},r.a.createElement(M.a,{variant:"contained",color:"",style:{marginLeft:"20px"},onClick:function(){return e.placeOrder("BUY")}},"Buy"),r.a.createElement(M.a,{variant:"contained",color:"",style:{marginLeft:"20px"},onClick:function(){return e.placeOrder("SELL")}},"Sell")),"`            ",r.a.createElement(Be.a,{size:"small","aria-label":"sticky table"},r.a.createElement(it.a,{style:{width:"",whiteSpace:"nowrap"},variant:"head"},r.a.createElement(qe.a,{variant:"head",style:{fontWeight:"bold"}},r.a.createElement(Je.a,{className:"TableHeadFormat",align:"center"},"Timestamp"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"center"},"Open"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"center"},"High"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"center"},"Low"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"center"},"Close "),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"center"},"Volume"))),r.a.createElement(_e.a,{style:{width:"",whiteSpace:"nowrap"}},this.state.InstrumentHistroy&&this.state.InstrumentHistroy?this.state.InstrumentHistroy.map(function(e,t){return r.a.createElement(qe.a,{key:t},r.a.createElement(Je.a,{align:"center"},new Date(e[0]).toLocaleString()),r.a.createElement(Je.a,{align:"center"},e[1]),r.a.createElement(Je.a,{align:"center"},e[2]),r.a.createElement(Je.a,{align:"center"},e[3]),r.a.createElement(Je.a,{align:"center"},e[4]),r.a.createElement(Je.a,{align:"center"},e[5]))}):""))),r.a.createElement(A.a,{direction:"row",alignItems:"center",container:!0},r.a.createElement(A.a,{direction:"row",container:!0,spacing:2},r.a.createElement(A.a,{item:!0,xs:12,sm:2,style:{marginTop:"15px"}},r.a.createElement(gt.a,{style:It.selectStyle},r.a.createElement(H.a,{htmlFor:"Nationality"},"Pattern Type"),r.a.createElement(dt.a,{value:this.state.patternType,name:"patternType",onChange:this.onChangePattern},r.a.createElement(ut.a,{value:"TweezerTop"},"Tweezer Top"),r.a.createElement(ut.a,{value:"TweezerBottom"},"Tweezer Bottom"),r.a.createElement(ut.a,{value:"NR4"},"Narrow Range 4"),r.a.createElement(ut.a,{value:"NR4ForNextDay"},"NR4 For Next Day"),r.a.createElement(ut.a,{value:"NR4_SameDay"},"NR4 ByDate"),r.a.createElement(ut.a,{value:"NR4_Daywide_daterage"},"NR4 Daywise Range")))),r.a.createElement(A.a,{item:!0,xs:12,sm:4},r.a.createElement(st,{callbackFromParent:t})),r.a.createElement(A.a,{item:!0,xs:12,sm:6,style:{marginTop:"28px"}},this.state.backTestFlag?r.a.createElement(M.a,{variant:"contained",onClick:function(){return e.backTestAnyPattern()}},"Search"):r.a.createElement(r.a.Fragment,null," ",r.a.createElement(M.a,null," ",r.a.createElement(pt.a,null)," \xa0 \xa0 Scaning: ",this.state.stockTesting,"  ",this.state.runningTest,"  "),"  ",r.a.createElement(M.a,{variant:"contained",onClick:function(){return e.stopBacktesting()}},"Stop")," "),"SearchFailed:",this.state.searchFailed),r.a.createElement(A.a,{item:!0,xs:12,sm:12},"NR4"==this.state.patternType||"TweezerTop"==this.state.patternType||"TweezerBottom"==this.state.patternType||"NR4_SameDay"==this.state.patternType?r.a.createElement(Be.a,{size:"small","aria-label":"sticky table"},r.a.createElement(it.a,{style:{width:"",whiteSpace:"nowrap"},variant:"head"},r.a.createElement(qe.a,{style:{background:"lightgray"}},r.a.createElement(Je.a,{style:{color:localStorage.getItem("sumPerChange")>0?"green":"red"},align:"center"},r.a.createElement("b",null,localStorage.getItem("sumPerChange"),"%")),r.a.createElement(Je.a,{style:{color:localStorage.getItem("sumPnlValue")>0?"green":"red"},align:"center"},r.a.createElement("b",null,localStorage.getItem("sumPnlValue"))),r.a.createElement(Je.a,{style:{color:localStorage.getItem("sumPerChangeHighLow")>0?"green":"red"},align:"center"},r.a.createElement("b",null,localStorage.getItem("sumPerChangeHighLow"),"%")),r.a.createElement(Je.a,{style:{color:localStorage.getItem("sumPnlValueOnHighLow")>0?"green":"red"},align:"center"},r.a.createElement("b",null,localStorage.getItem("sumPnlValueOnHighLow"))),r.a.createElement(Je.a,{align:"left"},"Total Trades: ",this.state.backTestResult&&this.state.backTestResult.length," Win: ",localStorage.getItem("totalWin")," Loss: ",localStorage.getItem("totalLoss")),r.a.createElement(Je.a,{align:"center"},"Long: ",localStorage.getItem("totalLongTrade")," Short:  ",this.state.backTestResult&&this.state.backTestResult.length-localStorage.getItem("totalLongTrade")),r.a.createElement(Je.a,{align:"left",colSpan:2}," Total Invested  ",localStorage.getItem("totalInvestedValue")),r.a.createElement(Je.a,{align:"center",colSpan:4}," Average gross/trade PnL:  ",r.a.createElement("b",{style:{color:localStorage.getItem("sumPerChange")/this.state.backTestResult.length>0?"green":"red"}},(localStorage.getItem("sumPerChange")/this.state.backTestResult.length).toFixed(2),"%"))),r.a.createElement(qe.a,{variant:"head",style:{fontWeight:"bold"}},r.a.createElement(Je.a,{className:"TableHeadFormat",align:"center"},"CPnl% "),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"center"},"CNetPnL "),r.a.createElement(Je.a,{className:"TableHeadFormat",title:"High on long side | Low in short side",align:"center"},"HLPnL% "),r.a.createElement(Je.a,{className:"TableHeadFormat",title:"High on long side | Low in short side",align:"center"},"HLNet PnL"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},"Symbol"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},"EntryTaken"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"center"},"SquiredOffAt"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"center"},"ExitStatus"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"center"},"Buy"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"center"},"Sell(Qty)"),r.a.createElement(Je.a,{className:"TableHeadFormat",title:"High on long side | Low in short side",align:"center"},"High/Low"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"center"},"StopLoss"))),r.a.createElement(_e.a,{style:{width:"",whiteSpace:"nowrap"}},this.state.backTestResult?this.state.backTestResult.map(function(t,m){return r.a.createElement(qe.a,{hover:!0,key:m},r.a.createElement(Je.a,Object.assign({style:{color:t.perChange>0?"green":"red"},align:"center"},a+=parseFloat(t.perChange||0)),t.perChange,"%"),r.a.createElement(Je.a,Object.assign({},c=t.sellEntyPrice*(t.perChange-t.brokerageCharges)/100*t.quantity,o+=c,g+=t.sellEntyPrice*(t.perChange-t.brokerageCharges)/100*t.quantity>0?1:0,d+=t.sellEntyPrice*(t.perChange-t.brokerageCharges)/100*t.quantity<0?1:0,{style:{color:c>0?"green":"red"},align:"center"})," ",c.toFixed(2)),r.a.createElement(Je.a,Object.assign({style:{color:t.perChngOnHighLow>0?"green":"red"},align:"center"},n+=parseFloat(t.perChngOnHighLow||0))," ",r.a.createElement("b",null,t.perChngOnHighLow,"%")),r.a.createElement(Je.a,Object.assign({},l+=t.sellEntyPrice*(t.perChngOnHighLow-t.brokerageCharges)/100*t.quantity,{style:{color:t.sellEntyPrice*(t.perChngOnHighLow-t.brokerageCharges)/100*t.quantity>0?"green":"red"},align:"center"}),(t.sellEntyPrice*(t.perChngOnHighLow-t.brokerageCharges)/100*t.quantity).toFixed(2)),r.a.createElement(Je.a,{align:"left"}," ",r.a.createElement(M.a,{variant:"contained",style:{marginLeft:"20px"},onClick:function(){return e.showCandleBothChart(t)}},t.symbol," ",r.a.createElement(Qe.a,null)," ")),r.a.createElement(Je.a,Object.assign({align:"left",style:{color:t.foundAt&&0==t.foundAt.indexOf("Long")?"green":"red"}},i+=t.foundAt&&0==t.foundAt.indexOf("Long")?1:0),t.foundAt),r.a.createElement(Je.a,{align:"center"},t.squareOffAt),r.a.createElement(Je.a,{align:"center"},t.exitStatus),r.a.createElement(Je.a,{align:"center"},t.buyExitPrice),r.a.createElement(Je.a,Object.assign({align:"center"},s+=t.foundAt&&0==t.foundAt.indexOf("Long")?parseFloat(t.buyExitPrice*t.quantity):parseFloat(t.sellEntyPrice*t.quantity)),t.sellEntyPrice,"(",t.quantity,")"),r.a.createElement(Je.a,{title:"High on long side | Low in short side",align:"center"},t.highAndLow),r.a.createElement(Je.a,{align:"center"},t.stopLoss))}):"",r.a.createElement(qe.a,{style:{background:"lightgray"}},r.a.createElement(Je.a,{style:{color:a>0?"green":"red"},align:"center"},r.a.createElement("b",null,localStorage.setItem("sumPerChange",a.toFixed(2)),a.toFixed(2),"%")),r.a.createElement(Je.a,{style:{color:o>0?"green":"red"},align:"center"},r.a.createElement("b",null,o.toFixed(2)),localStorage.setItem("sumPnlValue",o.toFixed(2))),r.a.createElement(Je.a,{style:{color:n>0?"green":"red"},align:"center"},r.a.createElement("b",null,localStorage.setItem("sumPerChangeHighLow",n.toFixed(2)),n.toFixed(2),"%")),r.a.createElement(Je.a,{style:{color:l>0?"green":"red"},align:"center"},r.a.createElement("b",null,l.toFixed(2)),localStorage.setItem("sumPnlValueOnHighLow",l.toFixed(2))),r.a.createElement(Je.a,{align:"left"}," ",localStorage.setItem("totalLongTrade",i)," ",localStorage.setItem("totalInvestedValue",s.toFixed(2))," "),r.a.createElement(Je.a,{align:"left"},localStorage.setItem("sumPerChangeHighLow",n.toFixed(2))," ",localStorage.setItem("sumPnlValueOnHighLow",l.toFixed(2))),r.a.createElement(Je.a,{align:"left"},localStorage.setItem("totalWin",g),localStorage.setItem("totalLoss",d)),r.a.createElement(Je.a,{align:"left"}," "),r.a.createElement(Je.a,{align:"left"}," "),r.a.createElement(Je.a,{align:"left"}," "),r.a.createElement(Je.a,{align:"left"}," "),r.a.createElement(Je.a,{align:"left"}," ")))):"","NR4_Daywide_daterage"==this.state.patternType?r.a.createElement(r.a.Fragment,null,this.state.dateAndTypeKeys?this.state.dateAndTypeKeys.map(function(t){return r.a.createElement(Be.a,{size:"small","aria-label":"sticky table",style:{padding:"5px"}},r.a.createElement(it.a,{style:{width:"",whiteSpace:"nowrap"},variant:"head"},r.a.createElement(qe.a,{style:{background:"lightgray"},key:t},r.a.createElement(Je.a,{colSpan:11,className:"TableHeadFormat",align:"center"}," ",t,"  ",(a=0,0,0,n=0,o=0,l=0,s=0,i=0,0))),r.a.createElement(qe.a,{key:t+1,variant:"head",style:{fontWeight:"bold",background:"lightgray"}},r.a.createElement(Je.a,{className:"TableHeadFormat",align:"center"}," CPnL% "),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"center"},"CNetPnL "),r.a.createElement(Je.a,{className:"TableHeadFormat",title:"High on long side | Low in short side",align:"center"},"HLPnL% "),r.a.createElement(Je.a,{className:"TableHeadFormat",title:"High on long side | Low in short side",align:"center"},"HLNet PnL"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},"Symbol"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},"FoundAt"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"center"},"Buy"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"center"},"Sell(Qty)"),r.a.createElement(Je.a,{className:"TableHeadFormat",title:"High on long side | Low in short side",align:"center"},"High/Low"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"center"},"SquiredOffAt"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"center"},"StopLoss"))),r.a.createElement(_e.a,{style:{width:"",whiteSpace:"nowrap"}},e.state.backTestResultDateRange[t].map(function(t,c){return r.a.createElement(qe.a,{hover:!0,key:c},r.a.createElement(Je.a,Object.assign({style:{color:t.perChange>0?"green":"red"},align:"center"},a+=parseFloat(t.perChange||0)),t.perChange,"%"),r.a.createElement(Je.a,Object.assign({},o+=t.sellEntyPrice*(t.perChange-t.brokerageCharges)/100*t.quantity,{style:{color:t.sellEntyPrice*(t.perChange-t.brokerageCharges)/100*t.quantity>0?"green":"red"},align:"center"})," ",(t.sellEntyPrice*(t.perChange-t.brokerageCharges)/100*t.quantity).toFixed(2)),r.a.createElement(Je.a,Object.assign({style:{color:t.perChngOnHighLow>0?"green":"red"},align:"center"},n+=parseFloat(t.perChngOnHighLow||0))," ",r.a.createElement("b",null,t.perChngOnHighLow,"%")),r.a.createElement(Je.a,Object.assign({},l+=t.sellEntyPrice*(t.perChngOnHighLow-t.brokerageCharges)/100*t.quantity,{style:{color:t.sellEntyPrice*(t.perChngOnHighLow-t.brokerageCharges)/100*t.quantity>0?"green":"red"},align:"center"}),(t.sellEntyPrice*(t.perChngOnHighLow-t.brokerageCharges)/100*t.quantity).toFixed(2)),r.a.createElement(Je.a,{align:"left"}," ",r.a.createElement(M.a,{variant:"contained",style:{marginLeft:"20px"},onClick:function(){return e.showCandleChart(t.candleChartData,t.symbol)}},t.symbol," ",r.a.createElement(Qe.a,null)," ")),r.a.createElement(Je.a,Object.assign({align:"left",style:{color:0==t.foundAt.indexOf("Long")?"green":"red"}},i+=0==t.foundAt.indexOf("Long")?1:0),t.foundAt),r.a.createElement(Je.a,{align:"center"},t.buyExitPrice),r.a.createElement(Je.a,Object.assign({align:"center"},s+=0==t.foundAt.indexOf("Long")?parseFloat(t.buyExitPrice*t.quantity):parseFloat(t.sellEntyPrice*t.quantity)),t.sellEntyPrice,"(",t.quantity,")"),r.a.createElement(Je.a,{title:"High on long side | Low in short side",align:"center"},t.highAndLow),r.a.createElement(Je.a,{align:"center"},t.squareOffAt),r.a.createElement(Je.a,{align:"center"},t.stopLoss))}),r.a.createElement(qe.a,{style:{background:"lightgray"}},r.a.createElement(Je.a,{style:{color:a>0?"green":"red"},align:"center"},r.a.createElement("b",null,localStorage.setItem("sumPerChange",a.toFixed(2)),a.toFixed(2),"%")),r.a.createElement(Je.a,{style:{color:o>0?"green":"red"},align:"center"},r.a.createElement("b",null,o.toFixed(2)),localStorage.setItem("sumPnlValue",o.toFixed(2))),r.a.createElement(Je.a,{style:{color:n>0?"green":"red"},align:"center"},r.a.createElement("b",null,localStorage.setItem("sumPerChangeHighLow",n.toFixed(2)),n.toFixed(2),"%")),r.a.createElement(Je.a,{style:{color:l>0?"green":"red"},align:"center"},r.a.createElement("b",null,l.toFixed(2)),localStorage.setItem("sumPnlValueOnHighLow",l.toFixed(2))),r.a.createElement(Je.a,{align:"left"}," ",localStorage.setItem("totalLongTrade",i)," ",localStorage.setItem("totalInvestedValue",s.toFixed(2))," "),r.a.createElement(Je.a,{align:"left"},localStorage.setItem("sumPerChangeHighLow",n.toFixed(2))," ",localStorage.setItem("sumPnlValueOnHighLow",l.toFixed(2))),r.a.createElement(Je.a,{align:"left"}),r.a.createElement(Je.a,{align:"left"}," "),r.a.createElement(Je.a,{align:"left"}," "),r.a.createElement(Je.a,{align:"left"}," "),r.a.createElement(Je.a,{align:"left"}," "))))}):""):"","NR4ForNextDay"==this.state.patternType?r.a.createElement(J.a,{component:"h3",variant:"h6",color:"primary",gutterBottom:!0},"NR4 For Next Day  (",this.state.FoundPatternList.length,")  at ",this.state.endDate&&this.state.endDate?this.state.endDate.toString().substr(0,16):(new Date).toString().substr(0,16)):"","NR4ForNextDay"==this.state.patternType?r.a.createElement(Be.a,{size:"small","aria-label":"sticky table"},r.a.createElement(it.a,{style:{width:"",whiteSpace:"nowrap"},variant:"head"},r.a.createElement(qe.a,{variant:"head",style:{fontWeight:"bold"}},r.a.createElement(Je.a,{className:"TableHeadFormat",align:"center"},"Sr "),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},"Symbol "),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},"FoundAt "),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},"Past Performance "),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},"BuyAt"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},"SellAt"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},"High"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},"Low"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"left"},"Close"))),r.a.createElement(_e.a,{style:{width:"",whiteSpace:"nowrap"}},this.state.FoundPatternList?this.state.FoundPatternList.map(function(t,a){return r.a.createElement(qe.a,{hover:!0,key:a},r.a.createElement(Je.a,{align:"center"},a+1),r.a.createElement(Je.a,{align:"left"}," ",r.a.createElement(M.a,{variant:"contained",style:{marginLeft:"20px"},onClick:function(){return e.showCandleChart(t.candleChartData,t.symbol)}},t.symbol," ",r.a.createElement(Qe.a,null)," ")),r.a.createElement(Je.a,{align:"left"},t.foundAt.substr(0,16)),r.a.createElement(Je.a,{align:"left",title:"based on last one 6 month"},r.a.createElement("span",{style:{background:t.pastPerferm.totalLongPer/t.pastPerferm.totalLongs>=1?"#92f192":""}},r.a.createElement("b",null,t.pastPerferm.totalLongs),"  Longs:  ",t.pastPerferm.totalLongPer,"% (",(t.pastPerferm.totalLongPer/t.pastPerferm.totalLongs).toFixed(2),"% per trade)  ")," ",r.a.createElement("br",null),"Longs on High%: ",t.pastPerferm.totalLongHighPer,"%  (",(t.pastPerferm.totalLongHighPer/t.pastPerferm.totalLongs).toFixed(2),"% per trade)",r.a.createElement("br",null),t.longCandles&&t.longCandles.map(function(a,n){return r.a.createElement(r.a.Fragment,null,r.a.createElement("a",{style:{textDecoration:"underline",background:"lightgray",cursor:"pointer"},onClick:function(){return e.showCandleChart(a.candleChartData,t.symbol,a)}}," ",a.foundAt.substr(7,10)," "),"  \xa0")}),r.a.createElement("br",null),r.a.createElement("span",{style:{background:t.pastPerferm.totalShortPer/t.pastPerferm.totalShort>=1?"#e87b7b":""}},r.a.createElement("b",null,t.pastPerferm.totalShort)," Short: ",t.pastPerferm.totalShortPer,"% (",(t.pastPerferm.totalShortPer/t.pastPerferm.totalShort).toFixed(2),"% per trade) ")," ",r.a.createElement("br",null),"Short on Low%: ",t.pastPerferm.totalShortLowPer,"% (",(t.pastPerferm.totalShortLowPer/t.pastPerferm.totalShort).toFixed(2),"% per trade)",r.a.createElement("br",null),t.shortCandles&&t.shortCandles.map(function(a,n){return r.a.createElement(r.a.Fragment,null,r.a.createElement("a",{style:{textDecoration:"underline",background:"lightgray",cursor:"pointer"},onClick:function(){return e.showCandleChart(a.candleChartData,t.symbol,a)}}," ",a.foundAt.substr(7,10),"  ")," \xa0")})),r.a.createElement(Je.a,{align:"left"},t.BuyAt),r.a.createElement(Je.a,{align:"left"},t.SellAt),r.a.createElement(Je.a,{align:"left"},t.high),r.a.createElement(Je.a,{align:"left"},t.low),r.a.createElement(Je.a,{align:"left"},t.close))}):"")):"")))))))}}]),t}(r.a.Component),It={formContainer:{display:"flex",flexFlow:"row wrap"},textStyle:{display:"flex",justifyContent:"center"},imgStyle:{display:"flex"},selectStyle:{minWidth:"100%",marginBottom:"10px"},MuiTextField:{overflowY:"scroll",fontSize:"12px",maxHeight:"50px"},footerButton:{position:"fixed",left:0,bottom:"20px",width:"100%",textAlign:"right"}},Nt=Ot,Ft=L.a.create({baseURL:""}),At=function(){return function(){var e=Object(ae.a)(te.a.mark(function e(t){var a,n;return te.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a={allPacks:!0,portal:!0},e.next=3,Ft.post("getPrepaidPacks",a);case 3:n=e.sent,t({type:"SET PACK LOADED",payload:n});case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},Ht=(a(112),Object(Fe.a)(function(e){return{root:{margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}})(function(e){var t=e.children,a=e.classes,n=e.onClose,o=Object(Ne.a)(e,["children","classes","onClose"]);return r.a.createElement(He.a,Object.assign({disableTypography:!0,className:a.root},o),r.a.createElement(J.a,{variant:"h6"},t),n?r.a.createElement(ce.a,{"aria-label":"close",className:a.closeButton,onClick:n},r.a.createElement(Re.a,null)):null)})),Mt=Object(Fe.a)(function(e){return{root:{padding:e.spacing(2)}}})(Me.a),jt=Object(Fe.a)(function(e){return{root:{margin:0,padding:e.spacing(1)}}})(je.a);function Yt(e){var t=r.a.useState(!1),a=Object(ne.a)(t,2),n=a[0],o=a[1],l=function(){o(!1)};return r.a.createElement("div",null,r.a.createElement(M.a,{variant:"outlined",color:"primary",onClick:function(){o(!0)}},e.data.indexSymbol),r.a.createElement(Ae.a,{onClose:l,"aria-labelledby":"customized-dialog-title",open:n},r.a.createElement(Ht,{id:"customized-dialog-title",onClose:l},e.data.indexSymbol,"  At ",e.data.timestamp),r.a.createElement(Mt,{dividers:!0},r.a.createElement(Be.a,{stickyHeader:!0,"aria-label":"sticky table",id:"tabledata",size:"medium"},r.a.createElement(qe.a,{variant:"head"},r.a.createElement(Je.a,{align:"left"},r.a.createElement("b",null,"Sr.")),r.a.createElement(Je.a,{align:"left"},r.a.createElement("b",null,"Stock Name")),r.a.createElement(Je.a,{align:"left"},r.a.createElement("b",null,"Last Price")),r.a.createElement(Je.a,{align:"left"},r.a.createElement("b",null,"CHNG%")),r.a.createElement(Je.a,{align:"left"},r.a.createElement("b",null,"Change Points"))),r.a.createElement(_e.a,null,e.data.indexSymbolData?e.data.indexSymbolData.map(function(e,t){return r.a.createElement(qe.a,{hover:!0,key:t},0!==t?r.a.createElement(r.a.Fragment,null,r.a.createElement(Je.a,{align:"left"},t," "),r.a.createElement(Je.a,{align:"left"},e.symbol),r.a.createElement(Je.a,{align:"left"},e.lastPrice),r.a.createElement(Je.a,{align:"left"},e.pChange>0?r.a.createElement("span",{style:{color:"green",fontWeight:"bold"}},e.pChange,"%"):0===e.pChange?r.a.createElement("span",null,e.pChange,"%"):r.a.createElement("span",{style:{color:"red",fontWeight:"bold"}},e.pChange,"%")," "),r.a.createElement(Je.a,{align:"left"},e.change)):"")}):r.a.createElement(r.a.Fragment,null," ",r.a.createElement("br",null)," ",r.a.createElement(M.a,{variant:"outlined",size:"large",color:"primary"},"Refresh")," ")))),r.a.createElement(jt,null,r.a.createElement(M.a,{autoFocus:!0,onClick:l,color:"primary"},"Close"))))}var Rt=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(S.a)(this,Object(v.a)(t).call(this,e))).getIndicesStocks=function(e,t){C.getIndiceStock(e).then(function(n){console.log(n.data);var r=n.data;if(K.showSuccess("Success, Top is"+r.data[1].symbol),a.speckIt("1st top "+e+" stock is "+r.data[1].symbol.toLocaleLowerCase()+" high of "+r.data[1].pChange+"%"),a.speckIt("2nd top "+e+" stock is "+r.data[2].symbol.toLocaleLowerCase()+" high of "+r.data[2].pChange+"%"),a.speckIt("3rd top "+e+" stock is "+r.data[3].symbol.toLocaleLowerCase()+" high of "+r.data[3].pChange+"%"),r){localStorage.setItem(e,JSON.stringify(r)),document.getElementById("topDate_"+t)&&(document.getElementById("topDate_"+t).innerHTML=r.timestamp.substring(12,23));var o=0;document.getElementById("top1_"+t)&&(o=r.data[1].pChange>0?'<span style="color:green">'+r.data[1].pChange+"</span>":'<span style="color:red">'+r.data[1].pChange+"</span>",document.getElementById("top1_"+t).innerHTML=r.data[1].symbol+" "+r.data[1].lastPrice+"("+o+")"),document.getElementById("top2_"+t)&&(o=r.data[2].pChange>0?'<span style="color:green">'+r.data[2].pChange+"</span>":'<span style="color:red">'+r.data[2].pChange+"</span>",document.getElementById("top2_"+t).innerHTML=r.data[2].symbol+" "+r.data[2].lastPrice+"("+o+")"),document.getElementById("top3_"+t)&&(o=r.data[3].pChange>0?'<span style="color:green">'+r.data[3].pChange+"</span>":'<span style="color:red">'+r.data[3].pChange+"</span>",document.getElementById("top3_"+t).innerHTML=r.data[3].symbol+" "+r.data[3].lastPrice+"("+o+")"),document.getElementById("top4_"+t)&&(o=r.data[4].pChange>0?'<span style="color:green">'+r.data[4].pChange+"</span>":'<span style="color:red">'+r.data[4].pChange+"</span>",document.getElementById("top4_"+t).innerHTML=r.data[4].symbol+" "+r.data[4].lastPrice+"("+o+")"),document.getElementById("top5_"+t)&&(o=r.data[5].pChange>0?'<span style="color:green">'+r.data[5].pChange+"</span>":'<span style="color:red">'+r.data[5].pChange+"</span>",document.getElementById("top5_"+t).innerHTML=r.data[5].symbol+" "+r.data[5].lastPrice+"("+o+")")}}).catch(function(t){K.showError(e+" Failed"+r.a.createElement("br",null)+t),a.speckIt(e+" API Failed ")})},a.onChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.speckIt=function(e){(new SpeechSynthesisUtterance).text=e.toString()},a.state={stopnview:"",indexTimeStamp:"",products:JSON.parse(localStorage.getItem("sorteIndexList"))},a}return Object(w.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.loadPackList();var t=new Date;t.getHours()>=9&&t.getHours()<16&&setInterval(function(){e.loadPackList()},120002)}},{key:"loadPackList",value:function(){var e=this;C.getAllIndices().then(function(t){if(t.data){e.setState({indexTimeStamp:t.data.timestamp});var a=t.data.data.sort(function(e,t){return t.percentChange-e.percentChange});localStorage.setItem("sorteIndexList",JSON.stringify(a)),e.setState({products:a}),e.speckIt("1st sector is "+a[0].indexSymbol+" "+a[0].percentChange+"%"),e.speckIt("2nd sector is "+a[1].indexSymbol+" "+a[1].percentChange+"%"),e.speckIt("3rd sector is "+a[2].indexSymbol+" "+a[2].percentChange+"%"),e.getIndicesStocks(a[0].indexSymbol,0),e.getIndicesStocks(a[1].indexSymbol,1),e.getIndicesStocks(a[2].indexSymbol,2)}}).catch(function(t){K.showError("All Indices API Failed"+r.a.createElement("br",null)+t),e.speckIt("All Indices API Failed")})}},{key:"dateFormat",value:function(e){return ct(e).format("DD-MM-YYYY h:mm:ss A")}},{key:"timeFormat",value:function(e){return ct().calendar()}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(nt,null),r.a.createElement(A.a,{direction:"row",container:!0,className:"flexGrow",spacing:1,style:{paddingLeft:"5px",paddingRight:"5px"}},r.a.createElement(A.a,{item:!0,xs:7,sm:7}),r.a.createElement(A.a,{item:!0,xs:12,sm:12,style:{padding:"20px",overflow:"auto",height:"900px"}},r.a.createElement(J.a,{component:"h3",variant:"h6",color:"primary"},"Market - Indices at ",this.state.indexTimeStamp),r.a.createElement(Be.a,{stickyHeader:!0,"aria-label":"sticky table",id:"tabledata",size:"small"},r.a.createElement(qe.a,{variant:"head"},r.a.createElement(Je.a,{align:"left"},r.a.createElement("b",null,"Sr.")),r.a.createElement(Je.a,{align:"left"},r.a.createElement("b",null,"Index Name")),r.a.createElement(Je.a,{align:"left"},r.a.createElement("b",null,"CHNG%")),r.a.createElement(Je.a,{align:"left",title:"Advances/Declines/Unchanged"},r.a.createElement("b",null,"A/D/Un")),r.a.createElement(Je.a,{align:"left"},r.a.createElement("b",null,"Refresh")),r.a.createElement(Je.a,{align:"left"},r.a.createElement("b",null,"TIME")),r.a.createElement(Je.a,{align:"left"},r.a.createElement("b",null,"Top1")),r.a.createElement(Je.a,{align:"left"},r.a.createElement("b",null,"Top2")),r.a.createElement(Je.a,{align:"left"},r.a.createElement("b",null,"Top3")),r.a.createElement(Je.a,{align:"left"},r.a.createElement("b",null,"Top4")),r.a.createElement(Je.a,{align:"left"},r.a.createElement("b",null,"Top5"))),r.a.createElement(_e.a,null,this.state.products?this.state.products.map(function(t,a){return r.a.createElement(qe.a,{hover:!0,key:a},"vijay"!==t.key?r.a.createElement(r.a.Fragment,null,r.a.createElement(Je.a,{align:"left"},a+1," "),r.a.createElement(Je.a,{align:"left"},r.a.createElement(Yt,{data:{indexSymbol:t.indexSymbol+" @ "+t.last,indexSymbolData:JSON.parse(localStorage.getItem(t.indexSymbol))&&JSON.parse(localStorage.getItem(t.indexSymbol)).data,timestamp:JSON.parse(localStorage.getItem(t.indexSymbol))&&JSON.parse(localStorage.getItem(t.indexSymbol)).timestamp}})),r.a.createElement(Je.a,{align:"left"},r.a.createElement("a",{href:"https://www.nseindia.com/api/equity-stockIndices?index="+encodeURIComponent(t.indexSymbol),target:"_blank",rel:"noopener noreferrer"},"  ",t.percentChange>0?r.a.createElement("span",{style:{color:"green",fontWeight:"bold"}},t.percentChange,"%"):0===t.percentChange?r.a.createElement("span",null,t.percentChange,"%"):r.a.createElement("span",{style:{color:"red",fontWeight:"bold"}},t.percentChange,"%")," ")),r.a.createElement(Je.a,{align:"left"},"  ",r.a.createElement("span",{style:{color:"green"}},t.advances)," / ",r.a.createElement("span",{style:{color:"red"}},t.declines)," / ",t.unchanged),r.a.createElement(Je.a,{align:"left"},r.a.createElement(M.a,{variant:"outlined",color:"primary",onClick:function(){return e.getIndicesStocks(t.indexSymbol,a)}},"Refresh")),r.a.createElement(Je.a,{align:"left",id:"topDate_"+a}),r.a.createElement(Je.a,{align:"left",id:"top1_"+a}),r.a.createElement(Je.a,{align:"left",id:"top2_"+a}),r.a.createElement(Je.a,{align:"left",id:"top3_"+a}),r.a.createElement(Je.a,{align:"left",id:"top4_"+a}),r.a.createElement(Je.a,{align:"left",id:"top5_"+a})):"")}):r.a.createElement(pt.a,null))))))}}]),t}(r.a.Component),Bt=Object(s.b)(function(e){return{packs:e.packs.packs.data}},{setPackLoaded:At})(Rt),qt=a(231);function Jt(e){for(var t=e.diffData&&e.diffData.data,a=[],n=[],o=[],l=[],s=0;s<(t.length<10?t.length:10);s++)t[s]&&(a.push(t[s].totPEOI),n.push(t[s].totCEOI),l.push(t[s].diff),o.push(t[s].dateTime.substring(19,11)));var i={labels:o,datasets:[{label:"Put",data:a,fill:!0,backgroundColor:"rgba(75,192,192,0.2)",borderColor:"green"},{label:"Call",data:n,fill:!0,backgroundColor:"rgba(75,192,192,0.1)",borderColor:"red"}]};return r.a.createElement("div",{className:"App"},r.a.createElement(qt.a,{data:i,options:{maintainAspectRatio:!0}}))}var _t=a(164),zt=a.n(_t);function Wt(e){var t={series:[{data:[{x:new Date(15387786e5),y:[6629.81,6650.5,6623.04,6633.33]},{x:new Date(15387804e5),y:[6632.01,6643.59,6620,6630.11]},{x:new Date(15387822e5),y:[6630.71,6648.95,6623.34,6635.65]},{x:new Date(1538784e6),y:[6635.65,6651,6629.67,6638.24]},{x:new Date(15387858e5),y:[6638.24,6640,6620,6624.47]},{x:new Date(15387876e5),y:[6624.53,6636.03,6621.68,6624.31]},{x:new Date(15387894e5),y:[6624.61,6632.2,6617,6626.02]},{x:new Date(15387912e5),y:[6627,6627.62,6584.22,6603.02]},{x:new Date(1538793e6),y:[6605,6608.03,6598.95,6604.01]},{x:new Date(15387948e5),y:[6604.5,6614.4,6602.26,6608.02]},{x:new Date(15387966e5),y:[6608.02,6610.68,6601.99,6608.91]},{x:new Date(15387984e5),y:[6608.91,6618.99,6608.01,6612]},{x:new Date(15388002e5),y:[6612,6615.13,6605.09,6612]},{x:new Date(1538802e6),y:[6612,6624.12,6608.43,6622.95]},{x:new Date(15388038e5),y:[6623.91,6623.91,6615,6615.67]},{x:new Date(15388056e5),y:[6618.69,6618.74,6610,6610.4]},{x:new Date(15388074e5),y:[6611,6622.78,6610.4,6614.9]},{x:new Date(15388092e5),y:[6614.9,6626.2,6613.33,6623.45]},{x:new Date(1538811e6),y:[6623.48,6627,6618.38,6620.35]},{x:new Date(15388128e5),y:[6619.43,6620.35,6610.05,6615.53]},{x:new Date(15388146e5),y:[6615.53,6617.93,6610,6615.19]},{x:new Date(15388164e5),y:[6615.19,6621.6,6608.2,6620]},{x:new Date(15388182e5),y:[6619.54,6625.17,6614.15,6620]},{x:new Date(153882e7),y:[6620.33,6634.15,6617.24,6624.61]},{x:new Date(15388218e5),y:[6625.95,6626,6611.66,6617.58]},{x:new Date(15388236e5),y:[6619,6625.97,6595.27,6598.86]},{x:new Date(15388254e5),y:[6598.86,6598.88,6570,6587.16]},{x:new Date(15388272e5),y:[6588.86,6600,6580,6593.4]},{x:new Date(1538829e6),y:[6593.99,6598.89,6585,6587.81]},{x:new Date(15388308e5),y:[6587.81,6592.73,6567.14,6578]},{x:new Date(15388326e5),y:[6578.35,6581.72,6567.39,6579]},{x:new Date(15388344e5),y:[6579.38,6580.92,6566.77,6575.96]},{x:new Date(15388362e5),y:[6575.96,6589,6571.77,6588.92]},{x:new Date(1538838e6),y:[6588.92,6594,6577.55,6589.22]},{x:new Date(15388398e5),y:[6589.3,6598.89,6589.1,6596.08]},{x:new Date(15388416e5),y:[6597.5,6600,6588.39,6596.25]},{x:new Date(15388434e5),y:[6598.03,6600,6588.73,6595.97]},{x:new Date(15388452e5),y:[6595.97,6602.01,6588.17,6602]},{x:new Date(1538847e6),y:[6602,6607,6596.51,6599.95]},{x:new Date(15388488e5),y:[6600.63,6601.21,6590.39,6591.02]},{x:new Date(15388506e5),y:[6591.02,6603.08,6591,6591]},{x:new Date(15388524e5),y:[6591,6601.32,6585,6592]},{x:new Date(15388542e5),y:[6593.13,6596.01,6590,6593.34]},{x:new Date(1538856e6),y:[6593.34,6604.76,6582.63,6593.86]},{x:new Date(15388578e5),y:[6593.86,6604.28,6586.57,6600.01]},{x:new Date(15388596e5),y:[6601.81,6603.21,6592.78,6596.25]},{x:new Date(15388614e5),y:[6596.25,6604.2,6590,6602.99]},{x:new Date(15388632e5),y:[6602.99,6606,6584.99,6587.81]},{x:new Date(1538865e6),y:[6587.81,6595,6583.27,6591.96]},{x:new Date(15388668e5),y:[6591.97,6596.07,6585,6588.39]},{x:new Date(15388686e5),y:[6587.6,6598.21,6587.6,6594.27]},{x:new Date(15388704e5),y:[6596.44,6601,6590,6596.55]},{x:new Date(15388722e5),y:[6598.91,6605,6596.61,6600.02]},{x:new Date(1538874e6),y:[6600.55,6605,6589.14,6593.01]},{x:new Date(15388758e5),y:[6593.15,6605,6592,6603.06]},{x:new Date(15388776e5),y:[6603.07,6604.5,6599.09,6603.89]},{x:new Date(15388794e5),y:[6604.44,6604.44,6600,6603.5]},{x:new Date(15388812e5),y:[6603.5,6603.99,6597.5,6603.86]},{x:new Date(1538883e6),y:[6603.85,6605,6600,6604.07]},{x:new Date(15388848e5),y:[6604.98,6606,6604.07,6606]}]}],chart:{type:"candlestick",height:350},title:{text:"CandleStick Chart",align:"left"},colors:{upward:"darkmagenta",downward:"#00cbcb"},xaxis:{type:"datetime"},yaxis:{tooltip:{enabled:!0}}};return new zt.a(document.querySelector("#chart"),t).render(),""}var Ut=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(S.a)(this,Object(v.a)(t).call(this,e))).onChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value)),a.filterOptionChain(e.target.name,e.target.value)},a.toFixedAmount=function(e){if(e)return parseFloat(e).toFixed(2)},a.state={products:[],stopnview:"",curnewdata:"",underlyingValue:"",timestamp:"",totalCOI:0,expiry:"",strike:"",FilteredBY:"",AllspTotalOI:[],PEoi:0,CEoi:0,scrollcount:0},a}return Object(w.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){var e=this;C.getFunds().then(function(t){var a=X(t);a.status&"SUCCESS"===a.message&&e.setState({fundData:a.data})})}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(nt,null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(A.a,{direction:"row",container:!0,className:"flexGrow",spacing:2,style:{paddingLeft:"5px",paddingRight:"5px",justifyContent:"center"}},r.a.createElement(A.a,{id:"tabledatachart",item:!0,xs:8,sm:8},r.a.createElement(vt.a,{style:{padding:"25px"}},r.a.createElement(J.a,{variant:"h6"},"Net:   ",this.state.fundData&&this.toFixedAmount(this.state.fundData.net)),r.a.createElement(J.a,{variant:"h6"},"Available Cash :   ",this.state.fundData&&this.toFixedAmount(this.state.fundData.availablecash)),r.a.createElement(J.a,{variant:"h6"},"Aailable Intraday payin :   ",this.state.fundData&&this.toFixedAmount(this.state.fundData.availableintradaypayin)),r.a.createElement(J.a,{variant:"h6"},"Available limit margin :   ",this.state.fundData&&this.toFixedAmount(this.state.fundData.availablelimitmargin)),r.a.createElement(J.a,{variant:"h6"},"Collateral :   ",this.state.fundData&&this.toFixedAmount(this.state.fundData.collateral)),r.a.createElement(J.a,{variant:"h6"},"Utilised debits :   ",this.state.fundData&&this.toFixedAmount(this.state.fundData.utiliseddebits)),r.a.createElement(J.a,{variant:"h6"},"Utilised exposure :   ",this.state.fundData&&this.toFixedAmount(this.state.fundData.utilisedexposure)),r.a.createElement(J.a,{variant:"h6"},"Utilised holding sales :   ",this.state.fundData&&this.toFixedAmount(this.state.fundData.utilisedholdingsales)),r.a.createElement(J.a,{variant:"h6"},"Utilised option premium :   ",this.state.fundData&&this.toFixedAmount(this.state.fundData.utilisedoptionpremium)),r.a.createElement(J.a,{variant:"h6"},"Utilised payout :   ",this.state.fundData&&this.toFixedAmount(this.state.fundData.utilisedpayout)),r.a.createElement(J.a,{variant:"h6"},"Utilised span :   ",this.state.fundData&&this.toFixedAmount(this.state.fundData.utilisedspan)),r.a.createElement(J.a,{variant:"h6"},"Utilised turnover :   ",this.state.fundData&&this.toFixedAmount(this.state.fundData.utilisedturnover)))),r.a.createElement(A.a,{id:"tabledatachart",item:!0,xs:4,sm:4},r.a.createElement(vt.a,{style:{padding:"25px"}},r.a.createElement(J.a,{variant:"h6"},"M2M Unrealized  :   ",this.state.fundData&&this.toFixedAmount(this.state.fundData.m2munrealized)),r.a.createElement(J.a,{variant:"h6"},"M2M Realized  :   ",this.state.fundData&&this.toFixedAmount(this.state.fundData.m2mrealized))))))}}]),t}(r.a.Component),Vt=Object(s.b)(function(e){return{packs:e.packs.packs.data}},{setPackLoaded:At})(Ut),Kt=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(S.a)(this,Object(v.a)(t).call(this,e))).getTodayTrade=function(){C.retrieveTradeBook().then(function(e){var t=X(e);console.log("datamy",t),t&&t.data&&a.setState({oderbookData:t.data})})},a.zoneChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value)),e.target.value.includes("Select All")&&(a.setState({selectedZone:a.state.listofzones}),a.setState({selectAllzone:"Remove All"})),e.target.value.includes("Remove All")&&(a.setState({selectedZone:[]}),a.setState({selectAllzone:"Select All"}))},a.addProduct=function(e){console.log(a.props),a.props.history.push("/banner-add")},a.addProduct=a.addProduct.bind(Object(k.a)(a)),a.editProduct=a.editProduct.bind(Object(k.a)(a)),a.convertBool=a.convertBool.bind(Object(k.a)(a)),a.state={oderbookData:[],listofzones:[],selectedZone:[],zone:"",selectAllzone:"Select All"},a}return Object(w.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){this.getTodayTrade()}},{key:"editProduct",value:function(e){window.localStorage.removeItem("selectedBannerId"),window.localStorage.setItem("selectedBannerId",e),this.props.history.push("/banner-edit")}},{key:"convertBool",value:function(e){return e?"Yes":"No"}},{key:"dateFormat",value:function(e){var t=new Date(e);return t.toLocaleDateString()+" "+t.toTimeString().substring(0,t.toTimeString().indexOf("GMT"))}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(nt,null),r.a.createElement(vt.a,{style:{padding:"10px",overflow:"auto"}},r.a.createElement(A.a,{spacing:1,direction:"row",alignItems:"center",container:!0},r.a.createElement(A.a,{item:!0,xs:12,sm:6},r.a.createElement(J.a,{component:"h2",variant:"h6",color:"primary",gutterBottom:!0},"Today Trades (",this.state.oderbookData.length,")")),r.a.createElement(A.a,{item:!0,xs:12,sm:6},r.a.createElement(M.a,{type:"number",variant:"contained",style:{float:"right"},onClick:function(){return e.getTodayTrade()}},"Refresh"))),r.a.createElement(Be.a,{size:"small","aria-label":"sticky table"},r.a.createElement(it.a,{style:{width:"",whiteSpace:"nowrap"},variant:"head"},r.a.createElement(qe.a,{variant:"head",style:{fontWeight:"bold"}},r.a.createElement(Je.a,{className:"TableHeadFormat",align:"center"},"Orderid"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"center"},"Product Type"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"center"},"Type"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"center"},"Instrument"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"center"},"Qty "),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"center"},"Price"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"center"},"Trade value"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"center"},"Update time"))),r.a.createElement(_e.a,{style:{width:"",whiteSpace:"nowrap"}},this.state.oderbookData&&this.state.oderbookData?this.state.oderbookData.map(function(e){return r.a.createElement(qe.a,{key:e.productId},r.a.createElement(Je.a,{align:"center"},e.orderid),r.a.createElement(Je.a,{align:"center"},e.tradingsymbol),r.a.createElement(Je.a,{align:"center"},e.transactiontype),r.a.createElement(Je.a,{align:"center"},e.producttype),r.a.createElement(Je.a,{align:"center"},e.fillsize),r.a.createElement(Je.a,{align:"center"},e.fillprice),r.a.createElement(Je.a,{align:"center"},e.tradevalue),r.a.createElement(Je.a,{align:"center"},e.filltime))}):r.a.createElement(pt.a,null)))))}}]),t}(r.a.Component),Xt=new ft.w3cwebsocket("wss://smartapisocket.angelbroking.com/websocket"),Gt=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(S.a)(this,Object(v.a)(t).call(this,e))).onChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value));var t=e.target.value;C.autoCompleteSearch(t).then(function(e){var t=e.data;console.log(t),localStorage.setItem("autoSearchTemp",JSON.stringify(t)),a.setState({autoSearchList:t})})},a.myCallback=function(e,t){"START_DATE"===t?a.setState({startDate:e}):"END_DATE"===t&&a.setState({endDate:e})},a.getLTP=function(){var e={exchange:"NSE",tradingsymbol:a.state.tradingsymbol,symboltoken:a.state.symboltoken};C.getLTP(e).then(function(e){var t=X(e,"noPop"),n=t&&t.data;a.setState({InstrumentLTP:n})})},a.decodeWebsocketData=function(e){console.log("atoms");var t=[];try{for(var a=0;a<e.length;a++)t.push(String.fromCharCode(e[a]))}catch(n){}return t.join("")},a.makeConnection=function(e,t){var n={actiontype:"subscribe",feedtype:"order_feed",jwttoken:a.state.feedToken,clientcode:a.state.clientcode,apikey:P};console.log("1st Request :- "+JSON.stringify(n)),Xt.send(JSON.stringify(n))},a.updateSocketWatch=function(e,t){var n=a.state.symbolList.map(function(e){return"nse_cm|"+e.token}),r={task:"mw",channel:n=n.join("&"),token:a.state.feedToken,user:a.state.clientcode,acctid:a.state.clientcode};Xt.send(JSON.stringify(r))},a.placeOrder=function(e){var t={variety:"NORMAL",tradingsymbol:a.state.tradingsymbol,symboltoken:a.state.symboltoken,transactiontype:e,exchange:"NSE",ordertype:0===a.state.buyPrice?"MARKET":"LIMIT",producttype:a.state.producttype,duration:"DAY",price:a.state.buyPrice,squareoff:"0",stoploss:"0",quantity:a.state.quantity};C.placeOrder(t).then(function(e){var t=X(e);console.log(t),t.status&&"SUCCESS"===t.message&&(localStorage.setItem("ifNotBought","false"),a.setState({orderid:t.data&&t.data.orderid}),a.state.stoploss&&a.placeSLMOrder(a.state.stoploss))})},a.LoadSymbolDetails=function(e){for(var t="",n=0;n<a.state.symbolList.length;n++)if(a.state.symbolList[n].symbol===e){t=a.state.symbolList[n].token,a.setState({tradingsymbol:e,symboltoken:a.state.symbolList[n].token});break}a.getHistory(t)},a.placeSLMOrder=function(){var e={tradingsymbol:a.state.tradingsymbol,symboltoken:a.state.symboltoken,transactiontype:"SELL",exchange:"NSE",ordertype:"STOPLOSS_MARKET",producttype:a.state.producttype,duration:"DAY",price:0,squareoff:"0",stoploss:"0",quantity:a.state.quantity,triggerprice:a.state.stoploss,variety:"STOPLOSS"};C.placeOrder(e).then(function(e){var t=X(e);console.log(t),t.status&&"SUCCESS"===t.message&&(localStorage.setItem("ifNotBought","false"),a.setState({orderid:t.data&&t.data.orderid}))})},a.getHistory=function(e){var t=ct.duration("00:50:00"),n=ct(new Date).subtract(t),r={exchange:"NSE",symboltoken:e,interval:"FIFTEEN_MINUTE",fromdate:ct(n).format("YYYY-MM-DD HH:mm"),todate:ct(new Date).format("YYYY-MM-DD HH:mm")};C.getHistoryData(r).then(function(e){var t=X(e,"noPop");if(console.log(t),t&&t.data){var n=t.data;n&&n.sort(function(e,t){return new Date(t[0])-new Date(e[0])}),n.length>0&&(localStorage.setItem("InstrumentHistroy",JSON.stringify(n)),a.setState({InstrumentHistroy:n,buyPrice:n[0][2]})),a.getLTP()}})},a.onSelectItem=function(e,t){var n=JSON.parse(localStorage.getItem("autoSearchTemp"));if(console.log("values",t),console.log("autoSearchTemp",n),n.length>0){for(var r="",o=0;o<n.length;o++)if(console.log("fdata",n[o].symbol),n[o].symbol===t){r=n[o];break}var l=localStorage.getItem("watchList");if(l){0===(l=JSON.parse(localStorage.getItem("watchList"))).filter(function(e){return e.symbol===t}).length&&(l.push(r),localStorage.setItem("watchList",JSON.stringify(l)))}else{var s=[];s.push(r),localStorage.setItem("watchList",JSON.stringify(s))}a.setState({symbolList:JSON.parse(localStorage.getItem("watchList")),search:""}),setTimeout(function(){a.updateSocketWatch()},100)}},a.deleteItemWatchlist=function(e){var t=JSON.parse(localStorage.getItem("watchList")),n=t.findIndex(function(t){return t.symbol===e});t.splice(n,1),localStorage.setItem("watchList",JSON.stringify(t)),a.setState({symbolList:t})},a.getAveragePrice=function(e){for(var t=localStorage.getItem("oderbookData"),n=0,r=0;r<t.length;r++)if("orderId"===t[r].orderid){n=t[r].averageprice,a.setState({averageprice:n});break}return n},a.state={positionList:[],userName:"",password:"",autoSearchList:[],isDasable:!1,isError:!1,InstrumentLTP:{},ifNotBought:!0,autoSearchTemp:[],symboltoken:"",tradingsymbol:"",buyPrice:0,quantity:1,producttype:"INTRADAY",symbolList:JSON.parse(localStorage.getItem("watchList"))},a.myCallback=a.myCallback.bind(Object(k.a)(a)),a}return Object(w.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=JSON.parse(localStorage.getItem("userTokens")),a=t&&t.feedToken,n=JSON.parse(localStorage.getItem("userProfile")),r=n&&n.clientcode;this.setState({feedToken:a,clientcode:r}),Xt.onopen=function(t){e.makeConnection(),console.log("connected")},Xt.onmessage=function(t){var a=window.atob(t.data),n=e.decodeWebsocketData(bt.a.inflate(a));e.setState({positionList:JSON.parse(n)})},Xt.onerror=function(e){console.log("socket error",e)},setInterval(function(){var t={actiontype:"heartbeat",feedtype:"order_feed",jwttoken:e.state.feedToken,clientcode:e.state.clientcode,apikey:P};console.log("heartbeatReq : "+t),Xt.send(t)},59e3),localStorage.getItem("watchList")||localStorage.setItem("watchList",[])}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(nt,null),r.a.createElement(A.a,{spacing:1,direction:"row",alignItems:"center",container:!0},r.a.createElement(A.a,{item:!0,xs:10,sm:12},r.a.createElement(vt.a,{style:{padding:"10px",overflow:"auto"}},r.a.createElement(Be.a,{size:"small","aria-label":"sticky table"},r.a.createElement(it.a,{style:{width:"",whiteSpace:"nowrap"},variant:"head"},r.a.createElement(qe.a,{variant:"head",style:{fontWeight:"bold"}},r.a.createElement(Je.a,{className:"TableHeadFormat",align:"center"},"Trading symbol"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"center"},"Order Type"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"center"},"Product type"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"center"},"Transaction type"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"center"},"Quantity"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"center"},"Average Price"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"center"},"Status "),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"center"},"Order Status"),r.a.createElement(Je.a,{className:"TableHeadFormat",align:"center"},"Exec Time"))),r.a.createElement(_e.a,{style:{width:"",whiteSpace:"nowrap"}},this.state.positionList?this.state.positionList.map(function(e,t){return r.a.createElement(qe.a,{key:t},r.a.createElement(Je.a,{align:"center"},e.tradingsymbol),r.a.createElement(Je.a,{align:"center"},e.ordertype),r.a.createElement(Je.a,{align:"center"},e.producttype),r.a.createElement(Je.a,{align:"center"},e.transactiontype),r.a.createElement(Je.a,{align:"center"},e.quantity),r.a.createElement(Je.a,{align:"center"},e.averageprice),r.a.createElement(Je.a,{align:"center"},e.status),r.a.createElement(Je.a,{align:"center"},e.orderstatus),r.a.createElement(Je.a,{align:"center"},e.exchtime))}):""))))))}}]),t}(r.a.Component),Qt=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(S.a)(this,Object(v.a)(t).call(this,e))).onChange=function(e){a.setState(Object(y.a)({},e.target.name,e.target.value))},a.readCsv=Object(ae.a)(te.a.mark(function e(){var t,n,r,o,l,s;return te.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=a.state.addtowatchlist,n=JSON.parse(t),console.log(n.length),r=[],o=te.a.mark(function e(t){var o;return te.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=n[t],console.log(o),C.autoCompleteSearch(o.SYMBOL).then(function(e){var n=e.data.filter(function(e){return"NSE"===e.exch_seg&&"1"===e.lotsize&&e.name===o.SYMBOL});if(n.length){r.push(n[0]);var l=localStorage.getItem("watchList")?JSON.parse(localStorage.getItem("watchList")):[];l.filter(function(e){return e&&e.token===n[0]&&n[0].token}).length?(a.setState({watchlistCount:l.length}),a.setState({resMessage:[].concat(Object($.a)(a.state.resMessage),[t+". Already in List:  "+o.SYMBOL])})):(a.setState({resMessage:[].concat(Object($.a)(a.state.resMessage),[t+". ======================> New Symbol:  "+o.SYMBOL])}),a.setState({watchlistCount:l.length,counter:a.state.counter+1}),l.push(n[0]),localStorage.setItem("watchList",JSON.stringify(l)),console.log("fdaata"))}a.state.resMessage&&a.state.resMessage.length&&a.setState({resMessage:Object($.a)(a.state.resMessage.reverse())})}),e.next=5,new Promise(function(e){return setTimeout(e,500)});case 5:case"end":return e.stop()}},e)}),l=0;case 6:if(!(l<n.length)){e.next=11;break}return e.delegateYield(o(l),"t0",8);case 8:l++,e.next=6;break;case 11:s={listName:n[0].SYMBOL,listItem:r},console.log("newjosnlist:",s),C.addIntoStaticData(s).then(function(e){var t=X(e,"noPop");a.setState({listName:t.listName,listCount:t.count})});case 14:case"end":return e.stop()}},e)})),a.resetCsv=function(){a.setState({addtowatchlist:"",resMessage:""})},a.state={products:[],stopnview:"",curnewdata:"",underlyingValue:"",timestamp:"",totalCOI:0,expiry:"",strike:"",FilteredBY:"",AllspTotalOI:[],PEoi:0,CEoi:0,scrollcount:0,resMessage:[],counter:0,listCount:0},a}return Object(w.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){var e=localStorage.getItem("watchList")?JSON.parse(localStorage.getItem("watchList")):[];this.setState({watchlistCount:e.length})}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(nt,null),r.a.createElement(vt.a,{style:{padding:"25px"}},r.a.createElement(A.a,{direction:"row",container:!0,className:"flexGrow",spacing:2,style:{paddingLeft:"5px",paddingRight:"5px",justifyContent:"center"}},r.a.createElement(A.a,{item:!0,xs:12,sm:8},r.a.createElement(J.a,{variant:"h6"},"Current Watchlist Count   ",this.state.watchlistCount,"\xa0 \xa0   \xa0 \xa0   \xa0 \xa0",r.a.createElement(M.a,{onClick:function(){localStorage.setItem("watchList",[]),window.location.reload()}},"Delete All"),r.a.createElement("br",null)),r.a.createElement(Y.a,{variant:"outlined",multiline:!0,rows:10,fullwidth:!0,style:{width:"90%",height:"50%"},label:"Paste only JSON to add into watchlist",value:this.state.addtowatchlist,name:"addtowatchlist",onChange:this.onChange})),r.a.createElement(A.a,{item:!0,xs:8,sm:8},r.a.createElement(M.a,{variant:"contained",color:"primary",onClick:function(){return e.readCsv()}}," Add to Watchlist"),"    \xa0 \xa0",r.a.createElement(M.a,{variant:"contained",color:"secondary",onClick:function(){return e.resetCsv()}},"Reset"),"\xa0 \xa0   ",r.a.createElement("b",null,"Total Added to Watchlist : ",this.state.counter),"\xa0 \xa0   ",r.a.createElement("b",null," Static Data Update: ",this.state.listName,"(",this.state.listCount,")")),r.a.createElement(A.a,{item:!0,xs:8,sm:8},this.state.resMessage?this.state.resMessage.map(function(e){return r.a.createElement(r.a.Fragment,null,"  ",r.a.createElement("span",null," ",e," "),"  ",r.a.createElement("br",null)," ")}):""))))}}]),t}(r.a.Component),Zt=Object(s.b)(function(e){return{packs:e.packs.packs.data}},{setPackLoaded:At})(Qt),$t=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(p.a,null,r.a.createElement(f.c,null,r.a.createElement(f.a,{path:"/",exact:!0,component:Z}),r.a.createElement(f.a,{path:"/login",component:Z}),r.a.createElement(f.a,{path:"/sector",component:Bt}),r.a.createElement(f.a,{path:"/chart",component:Jt}),r.a.createElement(f.a,{path:"/candle-chart",component:Wt}),r.a.createElement(f.a,{path:"/home",component:Nt}),r.a.createElement(f.a,{path:"/funds",component:Vt}),r.a.createElement(f.a,{path:"/order",component:kt}),r.a.createElement(f.a,{path:"/trade",component:Kt}),r.a.createElement(f.a,{path:"/order-status-live",component:Gt}),r.a.createElement(f.a,{path:"/position",component:Ct}),r.a.createElement(f.a,{path:"/addtowatchlist",component:Zt}),r.a.createElement(f.a,{path:"*",component:Z}))))};a(422);var ea=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement($t,null),r.a.createElement(V.a,null))};l.a.render(r.a.createElement(s.a,{store:h},r.a.createElement(ea,null)),document.querySelector("#root"))}},[[256,1,2]]]);
//# sourceMappingURL=main.91f25d68.chunk.js.map